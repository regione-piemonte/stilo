1        PACKAGE DMPK_EFACT AUTHID CURRENT_USER IS
2        
3          /****************************************************    INFORMAZIONI GENERALI    ***************************************************************/
4          /************** Argomenti delle stored per il controllo della transazione:                                                                *******/
5          /************** FlgRollBckFullIn -> se 1 in caso di errore viene fatta la rollback completa (non a savepoint),                            *******/
6          /**************         altrimenti la rollback delle sole modifiche effettuate nella stored                                               *******/
7          /**************         ATTENZIONE: la rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log                            *******/
8          /************** FlgAutoCommitIn  -> se vale 1, dopo la rollback e qualunque sia l'esito (positivo o no), la stored esegue una commit finale *****/
9          /************** Tutte le funzioni/procedure che NON hanno gli argomenti in input FlgRollBckFullIn e FlgAutoCommitIn                       *******/
10          /************** NON ESEGUONO AL LORO INTERNO ALCUNA COMMIT nè ROLLBACK                                                                    *******/
11          /************** Tutte le funzioni, tranne quelle da utilizzarsi nelle select, restituiscono 1 in caso di successo, altrimenti 0           *******/
12          /************** Tali funzioni restituiscono, in caso di result 0, un n.ro, un contesto e un messaggio di errore:                          *******/
13          /************** il n.ro è: <0 se errore ORACLE non specificamente gestito                                                                 *******/
14          /**************       da 1->1000 errore "grave" (SEVERE_ERROR) gestito                                                                    *******/
15          /**************       >1000 errore non grave gestito                                                                                      *******/
16          /************** il contesto indica il package e/o funzione/procedura in cui si è verificato l'errore							                        *******/
17          function datediff( p_what in varchar2,
18                              p_d1   in date,
19                              p_d2   in date ) return number;
20        
21           /***** Restituisce l'ultima data di invio di una mail associata ad una unita' documentaria *****/
22          function geTsReinvioDoc(IdUdIn IN  VARCHAR2, AnnoIn IN  VARCHAR2, MeseIn IN  VARCHAR2 , TsInvioRifIn IN DATE) return DATE;
23        
24          function getNrPagineDoc(
25                               IdSpAooIn           in dmt_documents.ID_SP_AOO%type,
26                               CodApplOwnerIn      in dmt_documents.cod_appl_owner%type,
27                               CodIstApplOwnerIn   in dmt_documents.cod_ist_appl_owner%type,
28                               IdDocIn             in number
29                              ) return NUMBER;
30        
31          function getNrTotSla(
32                               IdSpAooIn           in dmt_log_job_caricamenti_file.ID_SP_AOO%type,
33                               CodApplOwnerIn      in dmt_log_job_caricamenti_file.cod_appl_owner%type,
34                               CodIstApplOwnerIn   in dmt_log_job_caricamenti_file.cod_ist_appl_owner%type,
35                               AnnoIn              in number,
36                               MeseIn              in number,
37                               TipoSlaIn           in varchar2,
38                               MaxSlaOreIn         in number,
39                               TipoEsitoSlaOut     in varchar2
40                              ) return NUMBER;
41        
42           function getTsEventoDocLotto(
43                                       IdSpAooIn           dmt_log_job_caricamenti_file.ID_SP_AOO%type,
44                                       CodApplOwnerIn      dmt_log_job_caricamenti_file.cod_appl_owner%type,
45                                       CodIstApplOwnerIn   dmt_log_job_caricamenti_file.cod_ist_appl_owner%type,
46                                       IdDocLottoIn            IN        VARCHAR2,
47                                       CodEventoIn             IN        VARCHAR2) return DATE;
48        
49          function isSlaOK( TsInizioEventoIn in date,
50                            TsFineEventoIn in date,
51                            MaxSlaOreIn number ) return number;
52        
53          procedure SetSavepoint(NomeSavepointIn IN VARCHAR2);
54        
55          procedure RollbackToSavepoint(NomeSavepointIn IN VARCHAR2);
56        
57          /***** Restituisce la denominazione della AOO censita nella rubrica *****/
58          function GetDescSpAoo(	IdSpAooIn             IN	   VARCHAR2)
59        						              return VARCHAR2;                                    -- Descrizione della AOO (valorizzato solo se il return value è 1)
60        
61          /***** Restituisce la denominazione della societa' *****/
62          function GetDescSocieta(	IdSpAooIn             IN	   VARCHAR2,
63                                  IdCiApplicazioneIn    IN     VARCHAR2,
64                                  IdCiIstApplicazioneIn IN     VARCHAR2)
65        						              return VARCHAR2;                                    -- Descrizione della societa' oppure null
66        
67          /***** Funzione per inserire o aggiornare un lotto nella dmt_lotti_documenti *****/
68          function IULotto(    CodIdConnectionTokenIn           IN      DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,          -- (obblig). Codice identificativo del token di connessione
69                               IdUserLavoroIn                   IN      DMT_USERS.ID_USER%type DEFAULT NULL,                    -- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso                                                                                                                          
70                               IdLottoIO                        IN OUT  DMT_LOTTI_DOCUMENTI.ID_LOTTO%type,                      -- Identificativo PK del record
71                               AttributiXMLIn	                  IN		  CLOB,			-- XML contenente nomi e valori degli attributi (conforme allo schema SezioneCache.xsd)
72        																	                                        -- Gli attributi sono:
73                                                                                  --	#NomeLotto				(obblig.) Nome del lotto
74                                                 																	--	#Descrizione                Descrizione del lotto
75                                       																	          --	#CodStato			              Codice stato
76        																	                                        --	#TsLastUpdStato		          Data ultimo aggiornamento stato
77        							                                                            --	#TsStartJob 		            Data inizio job
78                                                                                  --	#TsEndJob 		              Data fine   job
79                                                                                  --	#Note 		                  Note
80                                                                                  --	#NrRecTotale 		            Nr. totale record processati
81                                                                                  --	#NrRecCaricati 		          Nr. record caricati
82                                                                                  --	#NrRecErrori 		            Nr. record con errori
83                                                                                  --	#NrRecWarning 		          Nr. record in warning
84                                                                                  --	#NrRecDoppi 		            Nr. record doppi
85                                                                                  --	#NrRecConsultabili 		      Nr. record consultabili
86                                                                                  --	#NrFileInIndice		          Nr. file in indice
87                                                                                  --	#NrFileRicevuti 		        Nr. file ricevuti
88                                                                                  --	#NrFileAssenti 		          Nr. file assenti
89                                                                                  --	#NrFileNonDescritti 		    Nr. file non descritti
90                                                                                  --	#ProvCiLotto 		            Prov CI lotto
91                                                                                  --	#IdUd  		                  Id UD
92                                                                                  --  #IdEmailNotitifica  		    Id email di notifica
93                                                                                  --  #FlgHidden  		            Flg Hidden
94                                                                                  --  #FlgAnnullato  		          Flg Annullato
95                                                                                  --  #FlgLocked  		            Flg Locked
96                                                                                  --  #WorkflowState              Stato del workflow
97        
98        
99                               FlgIgnoreWarningIn               IN      PLS_INTEGER DEFAULT NULL,                               -- (valori 1/0/NULL) Se 0 o NULL significa che in presenza di WARNING la stored si comporta come in caso di errore; se 1 gli WARNING vengono ignorati
100                               FlgRollBckFullIn                 IN      PLS_INTEGER DEFAULT NULL,                               -- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored   -- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
101                               FlgAutoCommitIn                  IN      PLS_INTEGER DEFAULT NULL,                               -- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
102                               WarningMsgOut                    OUT     VARCHAR2,                                               -- Messaggio di warning (valorizzato solo se non c'è errore)
103                               ErrContextOut                    OUT     VARCHAR2,                                               -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
104                               ErrCodeOut                       OUT     PLS_INTEGER,                                            -- N.ro errore di uscita
105                               ErrMsgOut                        OUT     VARCHAR2                                                -- Messaggio d'errore
106                             ) return PLS_INTEGER;
107        
108        
109        
110        /***** Funzione per inserire o aggiornare un documento di un lotto nella dmt_documenti_lotto *****/
111          function IUDocumentoLotto( CodIdConnectionTokenIn           IN      DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,          -- (obblig). Codice identificativo del token di connessione
112                                     IdUserLavoroIn                   IN      DMT_USERS.ID_USER%type DEFAULT NULL,                    -- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso                                                                                                                          
113                                     IdLottoIn                        IN      DMT_DOCUMENTI_LOTTO.ID_LOTTO%type,                      -- Identificativo PK del record (obblig). 
114        							               IdDocLottoIO                     IN OUT  DMT_DOCUMENTI_LOTTO.ID_DOC_LOTTO%type,                  -- Identificativo PK del record                              
115                                     AttributiXMLIn	                  IN		  CLOB,			-- XML contenente nomi e valori degli attributi (conforme allo schema SezioneCache.xsd)
116        																	                                              -- Gli attributi sono:
117                                                                                        --	#IdDoc 				              Id Doc
118                                                 								                        --	#NroDocumento               Numero del documento
119                                       																	                --	#TsDocumento		            Data del documento
120        							                                                                  --	#TsPubblicazione 		        Data di pubblicazione                                                                                
121                                                                                        --	#CodStato                   Codice stato
122                                                                                        --	#TsLastUpdStato		          Data ultimo aggiornamento stato							                                                            
123                                                                                        --	#Note 		                  Note
124                                                                                        --	#IdUd  		                  Id UD
125                                                                                        --  #FlgHidden  		            Flg Hidden
126                                                                                        --  #FlgAnnullato  		          Flg Annullato
127                                                                                        --  #FlgLocked  		            Flg Locked
128        
129                               FlgIgnoreWarningIn               IN      PLS_INTEGER DEFAULT NULL,                               -- (valori 1/0/NULL) Se 0 o NULL significa che in presenza di WARNING la stored si comporta come in caso di errore; se 1 gli WARNING vengono ignorati
130                               FlgRollBckFullIn                 IN      PLS_INTEGER DEFAULT NULL,                               -- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored   -- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
131                               FlgAutoCommitIn                  IN      PLS_INTEGER DEFAULT NULL,                               -- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
132                               WarningMsgOut                    OUT     VARCHAR2,                                               -- Messaggio di warning (valorizzato solo se non c'è errore)
133                               ErrContextOut                    OUT     VARCHAR2,                                               -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
134                               ErrCodeOut                       OUT     PLS_INTEGER,                                            -- N.ro errore di uscita
135                               ErrMsgOut                        OUT     VARCHAR2                                                -- Messaggio d'errore
136                             ) return PLS_INTEGER;
137        
138        
139        /***** Funzione per inserire o aggiornare un evento lotto nella dmt_log_job_caricamenti_file *****/
140          function IULottoEventi(    CodIdConnectionTokenIn     IN      DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,          -- (obblig). Codice identificativo del token di connessione
141                               IdUserLavoroIn                   IN      DMT_USERS.ID_USER%type DEFAULT NULL,                    -- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso                                                                                                                          
142                               IdEventoIO                       IN OUT  DMT_LOG_JOB_CARICAMENTI_FILE.ID_EVENTO%type,            -- Identificativo PK del record
143                               AttributiXMLIn	                  IN		  CLOB,			-- XML contenente nomi e valori degli attributi (conforme allo schema SezioneCache.xsd)
144        																	                                        -- Gli attributi sono:
145                                                                                  --	#IdJob				             (obblig.) id job   
146                                                                                  --	#IdLotto				           (obblig.) id lotto 
147                                       																	          --	#CodEvento			            Codice evento. Puo' essere un valore del dizionario :  START_JOB, END_JOB, CT_FILEIN, CT_CFILEININV_MAIL_N, BCK_FILEIN 
148                                                                                  --	#CodEsitoEvento			        Codice esito evento. Puo' essere un valore del dizionario :  ESITO_OK, ESITO_KO
149                                                                                  --	#DescEsitoEvento			      Descrizione esito evento.
150        																	                                        --	#TsEvento		                Data evento
151        							                                                            --	#Note 		                  Note
152                                                                                  --  #FlgHidden  		            Flg Hidden
153                                                                                  --  #FlgAnnullato  		          Flg Annullato
154                                                                                  --  #FlgLocked  		            Flg Locked
155        
156                               FlgIgnoreWarningIn               IN      PLS_INTEGER DEFAULT NULL,                               -- (valori 1/0/NULL) Se 0 o NULL significa che in presenza di WARNING la stored si comporta come in caso di errore; se 1 gli WARNING vengono ignorati
157                               FlgRollBckFullIn                 IN      PLS_INTEGER DEFAULT NULL,                               -- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored   -- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
158                               FlgAutoCommitIn                  IN      PLS_INTEGER DEFAULT NULL,                               -- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
159                               WarningMsgOut                    OUT     VARCHAR2,                                               -- Messaggio di warning (valorizzato solo se non c'è errore)
160                               ErrContextOut                    OUT     VARCHAR2,                                               -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
161                               ErrCodeOut                       OUT     PLS_INTEGER,                                            -- N.ro errore di uscita
162                               ErrMsgOut                        OUT     VARCHAR2                                                -- Messaggio d'errore
163                             ) return PLS_INTEGER;
164        
165        
166        /***** Funzione per inserire o aggiornare un evento lotto nella dmt_log_job_caricamenti_file *****/
167          function IUDocumentoLottoEventi(    CodIdConnectionTokenIn     IN      DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,          -- (obblig). Codice identificativo del token di connessione
168                               IdUserLavoroIn                   IN      DMT_USERS.ID_USER%type DEFAULT NULL,                    -- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso                                                                                                                          
169                               IdEventoIO                       IN OUT  DMT_LOG_JOB_CARICAMENTI_FILE.ID_EVENTO%type,            -- Identificativo PK del record
170                               AttributiXMLIn	                  IN		  CLOB,			-- XML contenente nomi e valori degli attributi (conforme allo schema SezioneCache.xsd)
171        																	                                        -- Gli attributi sono:
172                                                                                  --	#IdJob				             (obblig.) id job   
173                                                                                  --	#IdLotto				           (obblig.) id lotto 
174                                                                                  --  #IdDocLotto                (obblig.)  id doc lotto
175                                       																	          --	#CodEvento			            Codice evento. Puo' essere un valore del dizionario (dictionary_entry = 'EVENTI_CARICAMENTO_LOTTI') 
176                                                                                  --	#CodEsitoEvento			        Codice esito evento. Puo' essere un valore del dizionario :  ESITO_OK, ESITO_KO
177                                                                                  --	#DescEsitoEvento			      Descrizione esito evento.
178        																	                                        --	#TsEvento		                Data evento
179        							                                                            --	#Note 		                  Note
180                                                                                  --  #FlgHidden  		            Flg Hidden
181                                                                                  --  #FlgAnnullato  		          Flg Annullato
182                                                                                  --  #FlgLocked  		            Flg Locked
183        
184                               FlgIgnoreWarningIn               IN      PLS_INTEGER DEFAULT NULL,                               -- (valori 1/0/NULL) Se 0 o NULL significa che in presenza di WARNING la stored si comporta come in caso di errore; se 1 gli WARNING vengono ignorati
185                               FlgRollBckFullIn                 IN      PLS_INTEGER DEFAULT NULL,                               -- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored   -- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
186                               FlgAutoCommitIn                  IN      PLS_INTEGER DEFAULT NULL,                               -- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
187                               WarningMsgOut                    OUT     VARCHAR2,                                               -- Messaggio di warning (valorizzato solo se non c'è errore)
188                               ErrContextOut                    OUT     VARCHAR2,                                               -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
189                               ErrCodeOut                       OUT     PLS_INTEGER,                                            -- N.ro errore di uscita
190                               ErrMsgOut                        OUT     VARCHAR2                                                -- Messaggio d'errore
191                             ) return PLS_INTEGER;
192        
193        
194          /******* funzione per ricercare i lotti di documenti inviati per archiviazione su Auriga ********/
195          function TrovaLottiDocIngest(
196                                        CodIdConnectionTokenIn    IN                      DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,   -- (obblig). Codice identificativo del token di connessione
197                                        IdUserLavoroIn            IN                      DMT_USERS.ID_USER%type DEFAULT NULL,           -- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
198                                        FiltriIO                  IN OUT  NOCOPY CLOB,    -- XML contenente nomi e valori dei filtri di ricerca(conforme allo schema SezioneCache.xsd).
199                                                                                          -- Ogni filtro è un tag "Variabile" dell'XML
200                                                                                          -- I filtri che sono liste hanno nomi (tag Variabile/Nome) che iniziano con @.
201                                                                                           -- I nomi dei filtri possibili sono:
202                                                                                          -- IdLotto   : id del lotto      (ricerca case-insensitive in like)
203                                                                                          -- NomeLotto : Nome del lotto    (ricerca case-insensitive in like)
204                                                                                          -- CodStatoLotto : codice dello stato del lotto    ( ricerca esatta )
205                                                                                          -- DataLavorazioneLottoDa : estremo inferiore della data di lavorazione
206                                                                                          -- DataLavorazioneLottoA  : estremo superiore della data di lavorazione
207                                                                                          -- CodApplOwner			    : Serve a restringere la ricerca ai soli documenti e folder caricati a sistema dall'applicazione esterna qui specificata. Se è valorizzato a #BY_CONN_TKN significa l'applicazione da cui si è connessi
208                                                        																	-- CodIstApplOwner			: Serve a restringere la ricerca ai soli documenti e folder caricati a sistema dall'istanza di applicazione esterna qui specificata. Se è valorizzato a #BY_CONN_TKN significa l'istanza di applicazione da cui si è connessi
209        
210                                                                                           ------------- inizio argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
211                                        ColOrderByIO              IN OUT  VARCHAR2,        -- Indica il/i numeri della/e colonna dell'XML (CLOB ResultOut) di output per cui ordinare i record nell'XML stesso (si può ordinare solo per le colonne da 1 a xx). Se l'ordinamento è per più colonne queste vanno separate con "," (es: 2; 2,3)
212                                                                                          -- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul tipo di ordinamento una qualche preimpostazione di sistema/utente ecc.
213                                                                                          -- se non valorizzato (neppure in output) la lista di record restituita non è ordinata
214                                        FlgDescOrderByIO          IN OUT  VARCHAR2,        -- E' una stringa di 1 o 0/NULL, tanti quanti le colonne di ordinamento, separati da ",": 1 significa che l'ordinamento per la data colonna deve essere discendente anzichè ascendente (es: 1; 1,0; 1, )
215                                                                                          -- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul verso di ordinamento una qualche preimpostazione di sistema/utente ecc.
216                                        FlgSenzaPaginazioneIn     IN       PLS_INTEGER DEFAULT NULL,              -- (valori 1/0/NULL) Se 1 l'estrazione non è paginata, altrimenti sì
217                                        NroPaginaIO                IN OUT  PLS_INTEGER,    -- E' il numero della pagina da estrarre; se NULL e l'estrazione è paginata viene estratta la prima pagina
218                                        BachSizeIO                IN OUT  PLS_INTEGER,    -- Indica il massimo n.ro di record da estrarre se l'estrazione non è paginata (FlgSenzaPaginazioneIn=1)
219                                                                                          -- Indica la dimensione (n.ro di record) della pagina se l'estrazione è paginata (FlgSenzaPaginazioneIn 0 o NULL) e in tal caso se non è valorizzato la dimensione della pagina è quella settata per l'utente di lavoro o è pari al valore del parametro STD_PAGE_NUM_ROW del dominio di lavoro
220                                        OverFlowLimitIn            IN      PLS_INTEGER DEFAULT NULL,  -- E' il n.ro di record soddisfacenti la ricerca superato il quale la funzione deve restituire errore di overflow
221                                        FlgSenzaTotIn              IN      PLS_INTEGER DEFAULT NULL,  -- (valori 1/0/NULL) Se 1 significa che non è richiesto come output il totale dei record soddisfacenti la ricerca (se la ricerca è paginata per la prima pagina il totale viene calcolato comunque, per le successive no)
222                                        NroTotRecOut              OUT      PLS_INTEGER,              -- E' il n.ro di record complessivi trovati (valorizzato solo se FlgSenzaTotIn è 0 o NULL o se si estrae la prima pagina)
223                                        NroRecInPaginaOut         OUT     PLS_INTEGER,              -- E' il numero di record nella pagina (valorizzato solo se l'estrazione è paginata, ovvero se FlgSenzaPaginazioneIn 0 o NULL)
224                                        ------------- fine argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
225        
226                                         FlgBatchSearchIn          IN      PLS_INTEGER DEFAULT NULL,  -- (valori 1/0/NULL) Se 1 significa che la stored è utilizzata da un processo batch, altrimenti da un processo online.
227                                                                                                    -- Serve affinchè in caso l'input OverFlowLimitIn non sia valorizzato vengano applicati i limiti di overflow per processo batch o online che sono parametri di configurazione del sistema.
228                                         ColToReturnIn              IN      VARCHAR2 DEFAULT NULL,    -- Stringa con i n.ri delle colonne dell'XML di output ResultOut che si vuole siano presenti.
229                                                                                                      -- Se la stringa è vuota saranno presenti tutte le colonne.
230                                                                                                      -- La colonna 1 sarà presente comunque.
231                                                                                                      -- I n.ri delle varie colonne vanno separati con , o ; e se si vuole indicare un intervallo di colonne gli estremi dell'intervallo vanno separati con - (es: "1-5;7;10" significa colonne da 1 a 5 più le colonne 7 e 10)
232                                         ResultOut                  OUT      NOCOPY CLOB,                -- Lista dei lotti trovati (XML conforme a schema LISTA_STD.xsd)
233                                                                                                      -- Ogni lotto trovato è un tag Riga che può contenere le seguenti colonne:
234                                                                                                    -- 1:  Id. (PK) del lotto
235                                                                                                    -- 2:  Nome del lotto
236                                                                                                    -- 3:  Descrizione del lotto
237                                                                                                    -- 4:  Descrizione società
238                                                                                                    -- 5:  Cod. che identifica lo stato del lotto
239                                                                                                    -- 6:  Descrizione dello stato del lotto
240                                                                                                    -- 7:  La Data che identifica quando è stato fatto l'ultimo aggiornamento dello stato (nel formato dato dal parametro di config. FMT_STD_TIMESTAMP)
241                                                                                                    -- 8:  Data di inizio lavorazione del lotto (nel formato dato dal parametro di config. FMT_STD_TIMESTAMP)
242                                                                                                    -- 9:  Data di fine   lavorazione del lotto (nel formato dato dal parametro di config. FMT_STD_TIMESTAMP)
243                                                                                                    -- 10: Note generiche.
244                                                                                                    -- 11: Nr. doc totali
245                                                                                                    -- 12: Nr. doc caricati
246                                                                                                    -- 13: Nr. doc in errore
247                                                                                                    -- 14: Nr. doc. in warning
248                                                                                                    -- 15: Nr. doc. doppi
249                                                                                                    -- 16: Doc. referenziati in indice
250                                                                                                    -- 17: Doc. trasferiti nel repository
251                                                                                                    -- 18: Doc. non ricevuti
252                                                                                                    -- 19: Doc. non referenziati in indice
253                                                                                                    -- 20: Id utente che ha inserito il record
254                                                                                                    -- 21: Descrizione utente che ha inserito il record
255                                                                                                    -- 22: Ts inserimento record
256                                                                                                    -- 23: Id utente che ha effettuato ultima modifica sul record.
257                                                                                                    -- 24: Descrizione utente che ha effettuato ultima modifica sul record.
258                                                                                                    -- 25: Ts ultima modifica
259                                                                                                    -- 26: (valori 1/0) flgCreatodame :  censito dall'utente di lavoro (1) o da altri (0)
260                                                                                                    -- 27: (valori 1/0) flgValido     :  valido (=1) o logicamente annullato (=0)
261                                                                                                     -- 28: (valori 1/0) recProtetto   :  riservato di sistema e non modificabile da GUI
262                                                                                                    -- 29: Identificativo dell'unità documentaria del documento
263                                                                                                    -- 30: Nr. doc consultabili
264                                         ErrContextOut              OUT      VARCHAR2,                  -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
265                                         ErrCodeOut                OUT      PLS_INTEGER,              -- N.ro errore di uscita
266                                         ErrMsgOut                  OUT     VARCHAR2                  -- Messaggio d'errore
267              )
268              return PLS_INTEGER;                                  -- 1 successo, 0 iin caso di errore
269        
270          /******* funzione per ricercare i documenti di un lotto inviato per archiviazione su Auriga ********/
271          function TrovaDocLottoIngest(
272                                        CodIdConnectionTokenIn    IN      DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,   -- (obblig). Codice identificativo del token di connessione
273                                        IdUserLavoroIn            IN      DMT_USERS.ID_USER%type DEFAULT NULL,           -- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
274                                        IdLottoIn                 IN      VARCHAR2,       -- id del lotto. Non obbligatorio. Se non è indicato vengono estratti i documenti di tutti i lotti
275        
276                                        FiltriIO                  IN OUT  NOCOPY CLOB,    -- XML contenente nomi e valori dei filtri di ricerca(conforme allo schema SezioneCache.xsd).
277                                                                                          -- Ogni filtro è un tag "Variabile" dell'XML
278                                                                                          -- I filtri che sono liste hanno nomi (tag Variabile/Nome) che iniziano con @.
279                                                                                           -- I nomi dei filtri possibili sono:
280                                                                                          -- IdLotto                : Id. (PK) del lotto      ( ricerca esatta )
281                                                                                          -- NomeLotto : Nome del lotto    (ricerca case-insensitive in like)
282                                                                                          -- NomeFile  : Nome del file    (ricerca case-insensitive in like)
283                                                                                          -- NrDocumento     : Numero del dopcumento (ricerca case-insensitive in like)
284                                                                                          -- DataDocumentoDa : estremo inferiore della data del documento
285                                                                                          -- DataDocumentoA  : estremo superiore della data del documento
286                                                                                          -- DataPubblicazioneDa : estremo inferiore della data di pubblicazione
287                                                                                          -- DataPubblicazioneA  : estremo superiore della data di pubblicazione
288                                                                                          -- CodStatoDocumentoLotto : Stato del documento. 1: Acquisito, 2: In errore, 3: In warning
289                                                                                          -- CodApplOwner			    : Serve a restringere la ricerca ai soli documenti e folder caricati a sistema dall'applicazione esterna qui specificata. Se è valorizzato a #BY_CONN_TKN significa l'applicazione da cui si è connessi
290                                                        																	-- CodIstApplOwner			: Serve a restringere la ricerca ai soli documenti e folder caricati a sistema dall'istanza di applicazione esterna qui specificata. Se è valorizzato a #BY_CONN_TKN significa l'istanza di applicazione da cui si è connessi
291        
292        
293                                                                                           ------------- inizio argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
294                                        ColOrderByIO              IN OUT  VARCHAR2,        -- Indica il/i numeri della/e colonna dell'XML (CLOB ResultOut) di output per cui ordinare i record nell'XML stesso (si può ordinare solo per le colonne da 1 a xx). Se l'ordinamento è per più colonne queste vanno separate con "," (es: 2; 2,3)
295                                                                                          -- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul tipo di ordinamento una qualche preimpostazione di sistema/utente ecc.
296                                                                                          -- se non valorizzato (neppure in output) la lista di record restituita non è ordinata
297                                        FlgDescOrderByIO          IN OUT  VARCHAR2,        -- E' una stringa di 1 o 0/NULL, tanti quanti le colonne di ordinamento, separati da ",": 1 significa che l'ordinamento per la data colonna deve essere discendente anzichè ascendente (es: 1; 1,0; 1, )
298                                                                                          -- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul verso di ordinamento una qualche preimpostazione di sistema/utente ecc.
299                                        FlgSenzaPaginazioneIn     IN       PLS_INTEGER DEFAULT NULL,              -- (valori 1/0/NULL) Se 1 l'estrazione non è paginata, altrimenti sì
300                                        NroPaginaIO                IN OUT  PLS_INTEGER,    -- E' il numero della pagina da estrarre; se NULL e l'estrazione è paginata viene estratta la prima pagina
301                                        BachSizeIO                IN OUT  PLS_INTEGER,    -- Indica il massimo n.ro di record da estrarre se l'estrazione non è paginata (FlgSenzaPaginazioneIn=1)
302                                                                                          -- Indica la dimensione (n.ro di record) della pagina se l'estrazione è paginata (FlgSenzaPaginazioneIn 0 o NULL) e in tal caso se non è valorizzato la dimensione della pagina è quella settata per l'utente di lavoro o è pari al valore del parametro STD_PAGE_NUM_ROW del dominio di lavoro
303                                        OverFlowLimitIn            IN      PLS_INTEGER DEFAULT NULL,  -- E' il n.ro di record soddisfacenti la ricerca superato il quale la funzione deve restituire errore di overflow
304                                        FlgSenzaTotIn              IN      PLS_INTEGER DEFAULT NULL,  -- (valori 1/0/NULL) Se 1 significa che non è richiesto come output il totale dei record soddisfacenti la ricerca (se la ricerca è paginata per la prima pagina il totale viene calcolato comunque, per le successive no)
305                                        NroTotRecOut              OUT      PLS_INTEGER,              -- E' il n.ro di record complessivi trovati (valorizzato solo se FlgSenzaTotIn è 0 o NULL o se si estrae la prima pagina)
306                                        NroRecInPaginaOut         OUT     PLS_INTEGER,              -- E' il numero di record nella pagina (valorizzato solo se l'estrazione è paginata, ovvero se FlgSenzaPaginazioneIn 0 o NULL)
307                                        ------------- fine argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
308        
309                                         FlgBatchSearchIn          IN      PLS_INTEGER DEFAULT NULL,  -- (valori 1/0/NULL) Se 1 significa che la stored è utilizzata da un processo batch, altrimenti da un processo online.
310                                                                                                    -- Serve affinchè in caso l'input OverFlowLimitIn non sia valorizzato vengano applicati i limiti di overflow per processo batch o online che sono parametri di configurazione del sistema.
311                                         ColToReturnIn              IN      VARCHAR2 DEFAULT NULL,    -- Stringa con i n.ri delle colonne dell'XML di output ResultOut che si vuole siano presenti.
312                                                                                                      -- Se la stringa è vuota saranno presenti tutte le colonne.
313                                                                                                      -- La colonna 1 sarà presente comunque.
314                                                                                                      -- I n.ri delle varie colonne vanno separati con , o ; e se si vuole indicare un intervallo di colonne gli estremi dell'intervallo vanno separati con - (es: "1-5;7;10" significa colonne da 1 a 5 più le colonne 7 e 10)
315                                         ResultOut                  OUT      NOCOPY CLOB,                -- Lista dei lotti trovati (XML conforme a schema LISTA_STD.xsd)
316                                                                                                    -- Ogni lotto trovato è un tag Riga che può contenere le seguenti colonne:
317                                                                                                    -- col. 1:  Id. (PK) del lotto
318                                                                                                    -- col. 2:  Nome del lotto
319                                                                                                    -- col. 3:  Descrizione del lotto
320                                                                                                    -- col. 4:  Id. (PK) del documento
321                                                                                                    -- col. 5:  Nome file
322                                                                                                    -- col. 6:  Nr. documento
323                                                                                                    -- col. 7:  Cod. che identifica lo stato del documento
324                                                                                                    -- col. 8:  Descrizione dello stato del documento
325                                                                                                    -- col. 9:  La Data che identifica quando è stato fatto l'ultimo aggiornamento dello stato (nel formato dato dal parametro di config. FMT_STD_TIMESTAMP)
326                                                                                                    -- col. 10: Data del documento  (nel formato dato dal parametro di config. FMT_STD_DATA)
327                                                                                                    -- col. 11: Data di pubblicazione (nel formato dato dal parametro di config. FMT_STD_DATA)
328                                                                                                    -- col. 12: Note generiche.
329                                                                                                    -- col. 13: Id utente che ha inserito il record
330                                                                                                    -- col. 14: Descrizione utente che ha inserito il record
331                                                                                                    -- col. 15: Ts inserimento record
332                                                                                                    -- col. 16: Id utente che ha effettuato ultima modifica sul record.
333                                                                                                    -- col. 17: Descrizione utente che ha effettuato ultima modifica sul record.
334                                                                                                    -- col. 18: Ts ultima modifica
335                                                                                                    -- col. 19: (valori 1/0) flgCreatodame :  censito dall'utente di lavoro (1) o da altri (0)
336                                                                                                    -- col. 20: (valori 1/0) flgValido     :  valido (=1) o logicamente annullato (=0)
337                                                                                                    -- col. 21: (valori 1/0) recProtetto   :  riservato di sistema e non modificabile da GUI
338                                                                                                    -- col. 22: Identificativo dell'unità documentaria del documento
339                                                                                                    -- col. 23: Id. del docuemnto del lotto
340                                                                                                    -- col. 24: Descrizione società
341        
342                                         ErrContextOut              OUT      VARCHAR2,                  -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
343                                         ErrCodeOut                OUT      PLS_INTEGER,              -- N.ro errore di uscita
344                                         ErrMsgOut                  OUT     VARCHAR2                  -- Messaggio d'errore
345              )
346              return PLS_INTEGER;  -- 1 successo, 0 in caso di errore
347        
348         /******* funzione per ricercare il dettaglio di un documento del lotto inviati per archiviazione su Auriga ********/
349          function TrovaDocLottoDettaglio(
350        
351                                                    CodIdConnectionTokenIn          IN        DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,    -- (obblig). Codice identificativo del token di connessione
352                                                    IdUserLavoroIn                  IN        DMT_USERS.ID_USER%type DEFAULT NULL,              -- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
353        											IdLottoIn                       IN        VARCHAR2,                                         -- (obblig) id del lotto.
354                                                    IdDocLottoIn                    IN        VARCHAR2,                                         -- (obblig) id del documento del lotto.
355                                                     DatiXMLOut                      OUT        NOCOPY CLOB,                                    -- Dati dei lotti (XML conforme a schema SezioneCache.xsd)
356                                                                                                                                                -- I dati restituiti corrispondono ai seguenti tag Variabile:
357                                                                                                                                                -- #IdLotto                : Id. (PK) del lotto
358        																																		-- #IdDocLotto             : Id. (PK) del documento lotto
359                                                                                                                                                -- #NomeLotto              : Nome del lotto
360                                                                                                                                                -- #DescrizioneLotto       : Descrizione del lotto
361                                                                                                                                                -- #DescrizioneSocieta     : Descrizione società
362                                                                                                                                                -- #CodStato               : Cod. che identifica lo stato del documento
363                                                                                                                                                -- #DescStato              : Descrizione dello stato del documento
364                                                                                                                                                -- #TsLastUpdStato         : La Data che identifica quando è stato fatto l'ultimo aggiornamento dello stato (nel formato dato dal parametro di config. FMT_STD_TIMESTAMP)
365                                                                                                                                                -- #Note                   : Note generiche.
366        																																		-- #NomeFile               : Nome file
367                                                                                                                                                -- #NrDocumento            : Numero del documento
368        																																		-- #TsDocumento            : La Data del documento (nel formato dato dal parametro di config. FMT_STD_TIMESTAMP)
369        																																		-- #TsPubblicazione        : La Data della pubblicazione del documento (nel formato dato dal parametro di config. FMT_STD_TIMESTAMP)
370        																																		-- #IdUd                   : Identificativo dell'unità documentaria
371        																																		-- #IdDocumento            : Identificativo del documento
372        																																		-- #IdUtenteIns            : Id utente che ha inserito il record
373                                                                                                                                                -- #DescUtenteIns          : Descrizione utente che ha inserito il record
374                                                                                                                                                -- #DataIns                : Ts inserimento record
375                                                                                                                                                -- #IdUtenteUltMod         : Id utente che ha effettuato ultima modifica sul record.
376                                                                                                                                                -- #DescUtenteUltMod       : Descrizione utente che ha effettuato ultima modifica sul record.
377                                                                                                                                                -- #DataUltMod             : Ts ultima modifica
378                                                                                                                                                -- #FlgCreatodame          : (valori 1/0). censito dall'utente di lavoro (1) o da altri (0)
379                                                                                                                                                -- #FlgValido              : (valori 1/0). valido (=1) o logicamente annullato (=0)
380                                                                                                                                                -- #RecProtetto            : (valori 1/0). riservato di sistema e non modificabile da GUI
381        
382                                                     ErrContextOut              OUT      VARCHAR2,                  -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
383                                                     ErrCodeOut                OUT      PLS_INTEGER,              -- N.ro errore di uscita
384                                                     ErrMsgOut                  OUT     VARCHAR2                  -- Messaggio d'errore
385              )
386              return PLS_INTEGER;
387        
388        /******* funzione per ricercare il dettaglio di un lotto di documenti inviati per archiviazione su Auriga ********/
389          function TrovaLottiDocIngestDettaglio(
390        
391                                                    CodIdConnectionTokenIn          IN        DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,    -- (obblig). Codice identificativo del token di connessione
392                                                    IdUserLavoroIn                  IN        DMT_USERS.ID_USER%type DEFAULT NULL,              -- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
393                                                    IdLottoIn                       IN        VARCHAR2,                                         -- (obblig) id del lotto.
394                                                     DatiXMLOut                      OUT        NOCOPY CLOB,                                        -- Dati dei lotti (XML conforme a schema SezioneCache.xsd)
395                                                                                                                                                -- I dati restituiti corrispondono ai seguenti tag Variabile:
396                                                                                                                                                -- #IdLotto                : Id. (PK) del lotto
397                                                                                                                                                -- #NomeLotto              : Nome del lotto
398                                                                                                                                                -- #DescrizioneLotto       : Descrizione del lotto
399                                                                                                                                                -- #DescrizioneSocieta     : Descrizione società
400                                                                                                                                                -- #CodStato               : Cod. che identifica lo stato del lotto
401                                                                                                                                                -- #DescStato              : Descrizione dello stato del lotto
402                                                                                                                                                -- #TsLastUpdStato         : La Data che identifica quando è stato fatto l'ultimo aggiornamento dello stato (nel formato dato dal parametro di config. FMT_STD_TIMESTAMP)
403                                                                                                                                                -- #TsStartJob             : Data di inizio lavorazione del lotto (nel formato dato dal parametro di config. FMT_STD_TIMESTAMP)
404                                                                                                                                                -- #TsEndJob               : Data di fine   lavorazione del lotto (nel formato dato dal parametro di config. FMT_STD_TIMESTAMP)
405                                                                                                                                                -- #Note                   : Note generiche.
406                                                                                                                                                -- #NrDocTotali            : Nr. doc totali
407                                                                                                                                                -- #NrDocCaricati          : Nr. doc caricati
408                                                                                                                                                -- #NrDocConsultabili      : Nr. doc consultabili
409                                                                                                                                                -- #NrDocErrore            : Nr. doc in errore
410                                                                                                                                                -- #NrDocWarning           : Nr. doc. in warning
411                                                                                                                                                -- #NrDocDoppi             : Nr. doc. doppi
412                                                                                                                                                -- #NrFileInIndice         : Doc. referenziati in indice
413                                                                                                                                                -- #NrFileRicevuti         : Doc. trasferiti nel repository
414                                                                                                                                                -- #NrFileAssenti          : Doc. non ricevuti
415                                                                                                                                                -- #NrFileNonDescritti     : Doc. non referenziati in indice
416                                                                                                                                                -- #IdUtenteIns            : Id utente che ha inserito il record
417                                                                                                                                                -- #DescUtenteIns          : Descrizione utente che ha inserito il record
418                                                                                                                                                -- #DataIns                : Ts inserimento record
419                                                                                                                                                -- #IdUtenteUltMod         : Id utente che ha effettuato ultima modifica sul record.
420                                                                                                                                                -- #DescUtenteUltMod       : Descrizione utente che ha effettuato ultima modifica sul record.
421                                                                                                                                                -- #DataUltMod             : Ts ultima modifica
422                                                                                                                                                -- #FlgCreatodame          : (valori 1/0). censito dall'utente di lavoro (1) o da altri (0)
423                                                                                                                                                -- #FlgValido              : (valori 1/0). valido (=1) o logicamente annullato (=0)
424                                                                                                                                                -- #RecProtetto            : (valori 1/0). riservato di sistema e non modificabile da GUI
425                                                                                                                                                -- #IdUd                   : Identificativo dell'unità documentaria del lotto
426                                                                                                                                                -- @Documenti, lista con le seguenti colonne:
427                                                                                                                                                -- 1:  Id. (PK) del lotto
428                                                                                                                                                -- 2:  Id. (PK) del documento
429                                                                                                                                                -- 3:  Nome file
430                                                                                                                                                -- 4:  Nr. documento
431                                                                                                                                                -- 5:  Cod. che identifica lo stato del documento
432                                                                                                                                                -- 6:  Descrizione dello stato del documento
433                                                                                                                                                -- 7:  La Data che identifica quando è stato fatto l'ultimo aggiornamento dello stato (nel formato dato dal parametro di config. FMT_STD_TIMESTAMP)
434                                                                                                                                                -- 8:  Data del documento  (nel formato dato dal parametro di config. FMT_STD_DATA)
435                                                                                                                                                -- 9:  Data di pubblicazione (nel formato dato dal parametro di config. FMT_STD_TIMESTAMP)
436                                                                                                                                                -- 10: Note generiche.
437                                                                                                                                                -- 11: Id utente che ha inserito il record
438                                                                                                                                                -- 12: Descrizione utente che ha inserito il record
439                                                                                                                                                -- 13: Ts inserimento record
440                                                                                                                                                -- 14: Id utente che ha effettuato ultima modifica sul record.
441                                                                                                                                                -- 15: Descrizione utente che ha effettuato ultima modifica sul record.
442                                                                                                                                                -- 16: Ts ultima modifica
443                                                                                                                                                -- 17: (valori 1/0) flgCreatodame :  censito dall'utente di lavoro (1) o da altri (0)
444                                                                                                                                                -- 18: (valori 1/0) flgValido     :  valido (=1) o logicamente annullato (=0)
445                                                                                                                                                 -- 19: (valori 1/0) recProtetto   :  riservato di sistema e non modificabile da GUI
446                                                                                                                                                -- 20: Identificativo dell'unità documentaria del documento
447        
448                                                     ErrContextOut              OUT      VARCHAR2,                  -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
449                                                     ErrCodeOut                OUT      PLS_INTEGER,              -- N.ro errore di uscita
450                                                     ErrMsgOut                  OUT     VARCHAR2                  -- Messaggio d'errore
451              )
452              return PLS_INTEGER;    -- 1 successo, 0 in caso di errore
453        
454        	/******* funzione per ricercare gli eventi sui documenti del lotto ********/
455        	function TrovaDocLottoEventi(
456        										                    CodIdConnectionTokenIn    	IN      DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,   	  -- (obblig). Codice identificativo del token di connessione
457        										                    IdUserLavoroIn            	IN      DMT_USERS.ID_USER%type DEFAULT NULL,           		  -- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
458                          										  IdDocLottoIn                IN      VARCHAR2,       									                  -- (obblig). Id del docuemnto del lotto.
459        									                  	  FiltriIO                  	IN OUT  NOCOPY CLOB,    									                  -- XML contenente nomi e valori dei filtri di ricerca(conforme allo schema SezioneCache.xsd).
460                                                                                                                                        -- Ogni filtro è un tag "Variabile" dell'XML
461                                                                                                                                        -- I filtri che sono liste hanno nomi (tag Variabile/Nome) che iniziano con @.
462                                                                                                                                        -- I nomi dei filtri possibili sono:
463        
464                                                ------------- inizio argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
465                                                ColOrderByIO                IN OUT  VARCHAR2,                                           -- Indica il/i numeri della/e colonna dell'XML (CLOB ResultOut) di output per cui ordinare i record nell'XML stesso (si può ordinare solo per le colonne da 1 a xx). Se l'ordinamento è per più colonne queste vanno separate con "," (es: 2; 2,3)
466                                                                                                                                        -- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul tipo di ordinamento una qualche preimpostazione di sistema/utente ecc.
467                                                                                                                                        -- se non valorizzato (neppure in output) la lista di record restituita non è ordinata
468                                                FlgDescOrderByIO            IN OUT  VARCHAR2,                                           -- E' una stringa di 1 o 0/NULL, tanti quanti le colonne di ordinamento, separati da ",": 1 significa che l'ordinamento per la data colonna deve essere discendente anzichè ascendente (es: 1; 1,0; 1, )
469                                                                                                                                        -- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul verso di ordinamento una qualche preimpostazione di sistema/utente ecc.
470                                                FlgSenzaPaginazioneIn       IN      PLS_INTEGER DEFAULT NULL,                           -- (valori 1/0/NULL) Se 1 l'estrazione non è paginata, altrimenti sì
471                                                NroPaginaIO                 IN OUT  PLS_INTEGER,                                        -- E' il numero della pagina da estrarre; se NULL e l'estrazione è paginata viene estratta la prima pagina
472                                                BachSizeIO                  IN OUT  PLS_INTEGER,                                        -- Indica il massimo n.ro di record da estrarre se l'estrazione non è paginata (FlgSenzaPaginazioneIn=1)
473                                                                                                                                        -- Indica la dimensione (n.ro di record) della pagina se l'estrazione è paginata (FlgSenzaPaginazioneIn 0 o NULL) e in tal caso se non è valorizzato la dimensione della pagina è quella settata per l'utente di lavoro o è pari al valore del parametro STD_PAGE_NUM_ROW del dominio di lavoro
474                                                OverFlowLimitIn             IN      PLS_INTEGER DEFAULT NULL,                           -- E' il n.ro di record soddisfacenti la ricerca superato il quale la funzione deve restituire errore di overflow
475                                                FlgSenzaTotIn               IN      PLS_INTEGER DEFAULT NULL,                           -- (valori 1/0/NULL) Se 1 significa che non è richiesto come output il totale dei record soddisfacenti la ricerca (se la ricerca è paginata per la prima pagina il totale viene calcolato comunque, per le successive no)
476                                                NroTotRecOut                OUT     PLS_INTEGER,                                        -- E' il n.ro di record complessivi trovati (valorizzato solo se FlgSenzaTotIn è 0 o NULL o se si estrae la prima pagina)
477                                                NroRecInPaginaOut           OUT     PLS_INTEGER,                                        -- E' il numero di record nella pagina (valorizzato solo se l'estrazione è paginata, ovvero se FlgSenzaPaginazioneIn 0 o NULL)
478                                                ------------- fine argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
479        
480                                                FlgBatchSearchIn            IN      PLS_INTEGER DEFAULT NULL,                           -- (valori 1/0/NULL) Se 1 significa che la stored è utilizzata da un processo batch, altrimenti da un processo online.
481                                                                                                                                        -- Serve affinchè in caso l'input OverFlowLimitIn non sia valorizzato vengano applicati i limiti di overflow per processo batch o online che sono parametri di configurazione del sistema.
482                                                ColToReturnIn               IN      VARCHAR2 DEFAULT NULL,                              -- Stringa con i n.ri delle colonne dell'XML di output ResultOut che si vuole siano presenti.
483                                                                                                                                        -- Se la stringa è vuota saranno presenti tutte le colonne.
484                                                                                                                                        -- La colonna 1 sarà presente comunque.
485                                                                                                                                        -- I n.ri delle varie colonne vanno separati con , o ; e se si vuole indicare un intervallo di colonne gli estremi dell'intervallo vanno separati con - (es: "1-5;7;10" significa colonne da 1 a 5 più le colonne 7 e 10)
486                                                ResultOut                   OUT     NOCOPY CLOB,                                        -- Lista dei record trovati (XML conforme a schema LISTA_STD.xsd)
487                                                                                                                                        -- Ogni record trovato è un tag Riga che può contenere le seguenti colonne:
488        																																                                                                -- col. 1:  Id. (PK)
489                                                                        																																-- col. 2:  Id doc lotto
490                                                                        																																-- col. 3:  Codice evento
491        																																                                                                -- col. 4:  Nome evento
492                                                                                                                                        -- col. 5:  Stato Esito evento
493                                                                                                                                        -- col. 6:  Desc Esito evento
494        																																                                                                -- col. 7:  La Data dell'event0 (nel formato dato dal parametro di config. FMT_STD_TIMESTAMP)
495                                                                        																																-- col. 8: 	Note generiche.
496        																																                                                                -- col. 9:  Id utente che ha inserito il record
497        																																                                                                -- col. 10: Descrizione utente che ha inserito il record
498                                                                        																																-- col. 11: Ts inserimento record
499                                                                        																																-- col. 12: Id utente che ha effettuato ultima modifica sul record.
500        																																                                                                -- col. 13: Descrizione utente che ha effettuato ultima modifica sul record.
501                                                                        																																-- col. 14: Ts ultima modifica
502        																																                                                                -- col. 15: Flag di annullamento logico (valori 1/0)
503                                                                        																																-- col. 16: (valori 1/0) flgCreatodame :  censito dall'utente di lavoro (1) o da altri (0)
504        																																                                                                -- col. 17: (valori 1/0) flgValido     :  valido (=1) o logicamente annullato (=0)
505                                                                        																																-- col. 18: (valori 1/0) recProtetto   :  riservato di sistema e non modificabile da GUI
506                                                ErrContextOut               OUT      VARCHAR2,                                          -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
507                                                ErrCodeOut                  OUT      PLS_INTEGER,                                       -- N.ro errore di uscita
508                                                ErrMsgOut                   OUT     VARCHAR2                                            -- Messaggio d'errore
509              )
510              return PLS_INTEGER;
511        
512              /******* funzione per ricercare gli eventi sul lotto ********/
513           	  function TrovaLottiDocEventi(
514        										                    CodIdConnectionTokenIn    	IN      DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,   	  -- (obblig). Codice identificativo del token di connessione
515        										                    IdUserLavoroIn            	IN      DMT_USERS.ID_USER%type DEFAULT NULL,           		  -- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
516                          										  IdLottoIn                   IN      VARCHAR2,       									                  -- (obblig). Id del docuemnto del lotto.
517        									                  	  FiltriIO                  	IN OUT  NOCOPY CLOB,    									                  -- XML contenente nomi e valori dei filtri di ricerca(conforme allo schema SezioneCache.xsd).
518                                                                                                                                        -- Ogni filtro è un tag "Variabile" dell'XML
519                                                                                                                                        -- I filtri che sono liste hanno nomi (tag Variabile/Nome) che iniziano con @.
520                                                                                                                                        -- I nomi dei filtri possibili sono:
521        
522                                                ------------- inizio argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
523                                                ColOrderByIO                IN OUT  VARCHAR2,                                           -- Indica il/i numeri della/e colonna dell'XML (CLOB ResultOut) di output per cui ordinare i record nell'XML stesso (si può ordinare solo per le colonne da 1 a xx). Se l'ordinamento è per più colonne queste vanno separate con "," (es: 2; 2,3)
524                                                                                                                                        -- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul tipo di ordinamento una qualche preimpostazione di sistema/utente ecc.
525                                                                                                                                        -- se non valorizzato (neppure in output) la lista di record restituita non è ordinata
526                                                FlgDescOrderByIO            IN OUT  VARCHAR2,                                           -- E' una stringa di 1 o 0/NULL, tanti quanti le colonne di ordinamento, separati da ",": 1 significa che l'ordinamento per la data colonna deve essere discendente anzichè ascendente (es: 1; 1,0; 1, )
527                                                                                                                                        -- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul verso di ordinamento una qualche preimpostazione di sistema/utente ecc.
528                                                FlgSenzaPaginazioneIn       IN      PLS_INTEGER DEFAULT NULL,                           -- (valori 1/0/NULL) Se 1 l'estrazione non è paginata, altrimenti sì
529                                                NroPaginaIO                 IN OUT  PLS_INTEGER,                                        -- E' il numero della pagina da estrarre; se NULL e l'estrazione è paginata viene estratta la prima pagina
530                                                BachSizeIO                  IN OUT  PLS_INTEGER,                                        -- Indica il massimo n.ro di record da estrarre se l'estrazione non è paginata (FlgSenzaPaginazioneIn=1)
531                                                                                                                                        -- Indica la dimensione (n.ro di record) della pagina se l'estrazione è paginata (FlgSenzaPaginazioneIn 0 o NULL) e in tal caso se non è valorizzato la dimensione della pagina è quella settata per l'utente di lavoro o è pari al valore del parametro STD_PAGE_NUM_ROW del dominio di lavoro
532                                                OverFlowLimitIn             IN      PLS_INTEGER DEFAULT NULL,                           -- E' il n.ro di record soddisfacenti la ricerca superato il quale la funzione deve restituire errore di overflow
533                                                FlgSenzaTotIn               IN      PLS_INTEGER DEFAULT NULL,                           -- (valori 1/0/NULL) Se 1 significa che non è richiesto come output il totale dei record soddisfacenti la ricerca (se la ricerca è paginata per la prima pagina il totale viene calcolato comunque, per le successive no)
534                                                NroTotRecOut                OUT     PLS_INTEGER,                                        -- E' il n.ro di record complessivi trovati (valorizzato solo se FlgSenzaTotIn è 0 o NULL o se si estrae la prima pagina)
535                                                NroRecInPaginaOut           OUT     PLS_INTEGER,                                        -- E' il numero di record nella pagina (valorizzato solo se l'estrazione è paginata, ovvero se FlgSenzaPaginazioneIn 0 o NULL)
536                                                ------------- fine argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
537        
538                                                FlgBatchSearchIn            IN      PLS_INTEGER DEFAULT NULL,                           -- (valori 1/0/NULL) Se 1 significa che la stored è utilizzata da un processo batch, altrimenti da un processo online.
539                                                                                                                                        -- Serve affinchè in caso l'input OverFlowLimitIn non sia valorizzato vengano applicati i limiti di overflow per processo batch o online che sono parametri di configurazione del sistema.
540                                                ColToReturnIn               IN      VARCHAR2 DEFAULT NULL,                              -- Stringa con i n.ri delle colonne dell'XML di output ResultOut che si vuole siano presenti.
541                                                                                                                                        -- Se la stringa è vuota saranno presenti tutte le colonne.
542                                                                                                                                        -- La colonna 1 sarà presente comunque.
543                                                                                                                                        -- I n.ri delle varie colonne vanno separati con , o ; e se si vuole indicare un intervallo di colonne gli estremi dell'intervallo vanno separati con - (es: "1-5;7;10" significa colonne da 1 a 5 più le colonne 7 e 10)
544                                                ResultOut                   OUT     NOCOPY CLOB,                                        -- Lista dei record trovati (XML conforme a schema LISTA_STD.xsd)
545                                                                                                                                        -- Ogni record trovato è un tag Riga che può contenere le seguenti colonne:
546        																																                                                                -- col. 1:  Id. (PK)
547                                                                        																																-- col. 2:  Id lotto
548                                                                        																																-- col. 3:  Codice evento
549        																																                                                                -- col. 4:  Nome evento
550                                                                                                                                        -- col. 5:  Stato Esito evento
551                                                                                                                                        -- col. 6:  Desc Esito evento
552        																																                                                                -- col. 7:  La Data dell'event0 (nel formato dato dal parametro di config. FMT_STD_TIMESTAMP)
553                                                                        																																-- col. 8: 	Note generiche.
554        																																                                                                -- col. 9:  Id utente che ha inserito il record
555        																																                                                                -- col. 10: Descrizione utente che ha inserito il record
556                                                                        																																-- col. 11: Ts inserimento record
557                                                                        																																-- col. 12: Id utente che ha effettuato ultima modifica sul record.
558        																																                                                                -- col. 13: Descrizione utente che ha effettuato ultima modifica sul record.
559                                                                        																																-- col. 14: Ts ultima modifica
560        																																                                                                -- col. 15: Flag di annullamento logico (valori 1/0)
561                                                                        																																-- col. 16: (valori 1/0) flgCreatodame :  censito dall'utente di lavoro (1) o da altri (0)
562        																																                                                                -- col. 17: (valori 1/0) flgValido     :  valido (=1) o logicamente annullato (=0)
563                                                                        																																-- col. 18: (valori 1/0) recProtetto   :  riservato di sistema e non modificabile da GUI
564                                                ErrContextOut               OUT      VARCHAR2,                                          -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
565                                                ErrCodeOut                  OUT      PLS_INTEGER,                                       -- N.ro errore di uscita
566                                                ErrMsgOut                   OUT     VARCHAR2                                            -- Messaggio d'errore
567              )
568              return PLS_INTEGER;
569        
570              /******* funzione per ricercare i sezionali  ********/
571              function TrovaSezionali(
572                                        CodIdConnectionTokenIn    IN                      DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,   -- (obblig). Codice identificativo del token di connessione
573                                        IdUserLavoroIn            IN                      DMT_USERS.ID_USER%type DEFAULT NULL,           -- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
574        
575                                        FiltriIO                  IN OUT  NOCOPY CLOB,    -- XML contenente nomi e valori dei filtri di ricerca(conforme allo schema SezioneCache.xsd).
576                                                                                          -- Ogni filtro è un tag "Variabile" dell'XML
577                                                                                          -- I filtri che sono liste hanno nomi (tag Variabile/Nome) che iniziano con @.
578                                                                                           -- I nomi dei filtri possibili sono:
579                                                                                          -- IdSezionale   : id del sezionale      ( ricerca esatta )
580                                                                                          -- CodSezionale : Codice del sezionale    (ricerca case-insensitive in like)
581                                                                                          -- DescrizioneSezionale : descrizione del sezionale    (ricerca case-insensitive in like)
582        
583                                                                                           ------------- inizio argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
584                                        ColOrderByIO              IN OUT  VARCHAR2,        -- Indica il/i numeri della/e colonna dell'XML (CLOB ResultOut) di output per cui ordinare i record nell'XML stesso (si può ordinare solo per le colonne da 1 a xx). Se l'ordinamento è per più colonne queste vanno separate con "," (es: 2; 2,3)
585                                                                                          -- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul tipo di ordinamento una qualche preimpostazione di sistema/utente ecc.
586                                                                                          -- se non valorizzato (neppure in output) la lista di record restituita non è ordinata
587                                        FlgDescOrderByIO          IN OUT  VARCHAR2,        -- E' una stringa di 1 o 0/NULL, tanti quanti le colonne di ordinamento, separati da ",": 1 significa che l'ordinamento per la data colonna deve essere discendente anzichè ascendente (es: 1; 1,0; 1, )
588                                                                                          -- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul verso di ordinamento una qualche preimpostazione di sistema/utente ecc.
589                                        FlgSenzaPaginazioneIn     IN       PLS_INTEGER DEFAULT NULL,              -- (valori 1/0/NULL) Se 1 l'estrazione non è paginata, altrimenti sì
590                                        NroPaginaIO                IN OUT  PLS_INTEGER,    -- E' il numero della pagina da estrarre; se NULL e l'estrazione è paginata viene estratta la prima pagina
591                                        BachSizeIO                IN OUT  PLS_INTEGER,    -- Indica il massimo n.ro di record da estrarre se l'estrazione non è paginata (FlgSenzaPaginazioneIn=1)
592                                                                                          -- Indica la dimensione (n.ro di record) della pagina se l'estrazione è paginata (FlgSenzaPaginazioneIn 0 o NULL) e in tal caso se non è valorizzato la dimensione della pagina è quella settata per l'utente di lavoro o è pari al valore del parametro STD_PAGE_NUM_ROW del dominio di lavoro
593                                        OverFlowLimitIn            IN      PLS_INTEGER DEFAULT NULL,  -- E' il n.ro di record soddisfacenti la ricerca superato il quale la funzione deve restituire errore di overflow
594                                        FlgSenzaTotIn              IN      PLS_INTEGER DEFAULT NULL,  -- (valori 1/0/NULL) Se 1 significa che non è richiesto come output il totale dei record soddisfacenti la ricerca (se la ricerca è paginata per la prima pagina il totale viene calcolato comunque, per le successive no)
595                                        NroTotRecOut              OUT      PLS_INTEGER,              -- E' il n.ro di record complessivi trovati (valorizzato solo se FlgSenzaTotIn è 0 o NULL o se si estrae la prima pagina)
596                                        NroRecInPaginaOut         OUT     PLS_INTEGER,              -- E' il numero di record nella pagina (valorizzato solo se l'estrazione è paginata, ovvero se FlgSenzaPaginazioneIn 0 o NULL)
597                                        ------------- fine argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
598        
599                                         FlgBatchSearchIn          IN      PLS_INTEGER DEFAULT NULL,  -- (valori 1/0/NULL) Se 1 significa che la stored è utilizzata da un processo batch, altrimenti da un processo online.
600                                                                                                    -- Serve affinchè in caso l'input OverFlowLimitIn non sia valorizzato vengano applicati i limiti di overflow per processo batch o online che sono parametri di configurazione del sistema.
601                                         ColToReturnIn              IN      VARCHAR2 DEFAULT NULL,    -- Stringa con i n.ri delle colonne dell'XML di output ResultOut che si vuole siano presenti.
602                                                                                                      -- Se la stringa è vuota saranno presenti tutte le colonne.
603                                                                                                      -- La colonna 1 sarà presente comunque.
604                                                                                                      -- I n.ri delle varie colonne vanno separati con , o ; e se si vuole indicare un intervallo di colonne gli estremi dell'intervallo vanno separati con - (es: "1-5;7;10" significa colonne da 1 a 5 più le colonne 7 e 10)
605                                         ResultOut                  OUT      NOCOPY CLOB,                -- Lista dei record trovati (XML conforme a schema LISTA_STD.xsd)
606                                                                                                      -- Ogni record trovato è un tag Riga che può contenere le seguenti colonne:
607                                                                                                    -- 1:  Id. (PK)
608                                                                                                    -- 2:  Codice
609                                                                                                    -- 3:  Descrizione
610                                                                                                    -- 4:  Anno
611                                                                                                    -- 5:  Range DA
612                                                                                                    -- 6:  Range A
613                                                                                                    -- 7:  Id utente che ha inserito il record
614                                                                                                    -- 8:  Descrizione utente che ha inserito il record
615                                                                                                    -- 9:  Ts inserimento record
616                                                                                                    -- 10: Id utente che ha effettuato ultima modifica sul record.
617                                                                                                    -- 11: Descrizione utente che ha effettuato ultima modifica sul record.
618                                                                                                    -- 12: Ts ultima modifica
619                                                                                                    -- 13: (valori 1/0) flgCreatodame :  censito dall'utente di lavoro (1) o da altri (0)
620                                                                                                    -- 14: (valori 1/0) flgValido     :  valido (=1) o logicamente annullato (=0)
621                                                                                                     -- 15: (valori 1/0) recProtetto   :  riservato di sistema e non modificabile da GUI
622                                                                                                    -- 16: (valori 1/0) flgValido     : Flag di validità
623                                         ErrContextOut              OUT      VARCHAR2,                  -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
624                                         ErrCodeOut                OUT      PLS_INTEGER,              -- N.ro errore di uscita
625                                         ErrMsgOut                  OUT     VARCHAR2                  -- Messaggio d'errore
626              )
627              return PLS_INTEGER;
628        
629        
630              /******* funzione per ricercare il dettaglio di un sezionale ********/
631              function TrovaSezionaliDettaglio(     CodIdConnectionTokenIn          IN        DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,    -- (obblig). Codice identificativo del token di connessione
632                                                    IdUserLavoroIn                  IN        DMT_USERS.ID_USER%type DEFAULT NULL,              -- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
633                                                    IdSezionaleIn                   IN        VARCHAR2,                                         -- (obblig) Id. (PK).
634                                                     DatiXMLOut                      OUT        NOCOPY CLOB,                                        -- Dati restituiti (XML conforme a schema SezioneCache.xsd)
635                                                                                                                                                -- I dati restituiti corrispondono ai seguenti tag Variabile:
636                                                                                                                                                -- #IdSezionale            : Id. (PK)
637                                                                                                                                                -- #CodSezionale           : Codice
638                                                                                                                                                -- #DescrizioneSezionale   : Descrizione
639                                                                                                                                                -- #AnnoSezionale          : Anno
640                                                                                                                                                -- #RangeSezionaleDa       : Range DA
641                                                                                                                                                -- #RangeSezionaleA        : Range DA
642                                                                                                                                                -- #IdUtenteIns            : Id utente che ha inserito il record
643                                                                                                                                                -- #DescUtenteIns          : Descrizione utente che ha inserito il record
644                                                                                                                                                -- #DataIns                : Ts inserimento record
645                                                                                                                                                -- #IdUtenteUltMod         : Id utente che ha effettuato ultima modifica sul record.
646                                                                                                                                                -- #DescUtenteUltMod       : Descrizione utente che ha effettuato ultima modifica sul record.
647                                                                                                                                                -- #DataUltMod             : Ts ultima modifica
648                                                                                                                                                -- #FlgCreatodame          : (valori 1/0). censito dall'utente di lavoro (1) o da altri (0)
649                                                                                                                                                -- #FlgAnnullato           : (valori 1/0). valido (=0) o logicamente annullato (=1)
650                                                                                                                                                -- #RecProtetto            : (valori 1/0). riservato di sistema e non modificabile da GUI
651                                                                                                                                                -- #FlgValido              : (valori 1/0). Flag di validità
652                                                     ErrContextOut              OUT      VARCHAR2,                  -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
653                                                     ErrCodeOut                OUT      PLS_INTEGER,              -- N.ro errore di uscita
654                                                     ErrMsgOut                  OUT     VARCHAR2                  -- Messaggio d'errore
655              )
656              return PLS_INTEGER;
657        
658          /***** Funzione per inserire o aggiornare un sezionale *****/
659          function IUSezionale(
660                               CodIdConnectionTokenIn           IN          DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,          -- (obblig). Codice identificativo del token di connessione
661                               IdUserLavoroIn                   IN          DMT_USERS.ID_USER%type DEFAULT NULL,                    -- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
662                               IdSezionaleIO                    IN OUT     DMT_SEZIONALI.ID_SEZIONALE%type,                         -- Identificativo PK del record da modificare. Se non è valorizzato è da inserire ex-novo
663                                                                                                                                  -- In output, salvo in caso di errore, è sempre valorizzato
664                               CodiceSezionaleIn               IN          DMT_SEZIONALI.COD_SEZIONALE%TYPE,                       -- (obblig.) Codice
665                               DescrizioneSezionaleIn           IN          DMT_SEZIONALI.DESCRIZIONE%TYPE,                         -- Descrizione
666                               AnnoSezionaleIn                 IN          DMT_SEZIONALI.ANNO%TYPE,                                -- (obblig.) Anno
667                               RangeSezionaleDaIn               IN          DMT_SEZIONALI.RANGE_DA%TYPE,                            -- Range DA
668                               RangeSezionaleAIn               IN          DMT_SEZIONALI.RANGE_A%TYPE,                             -- Range DA
669                               FlgAnnullatoIn                  IN         PLS_INTEGER DEFAULT null,                               -- (valori 1/0/NULL) Indicatore per annullare il record
670                               FlgLockedIn                     IN          PLS_INTEGER DEFAULT null,                               -- (valori 1/0/NULL) Indicatore di tipo di documento riservato dal sistema e non modificabile/cancellabile da GUI
671        
672                               FlgIgnoreWarningIn              IN         PLS_INTEGER DEFAULT NULL,                                -- (valori 1/0/NULL) Se 0 o NULL significa che in presenza di WARNING la stored si comporta come in caso di errore; se 1 gli WARNING vengono ignorati
673                               FlgRollBckFullIn                 IN         PLS_INTEGER DEFAULT NULL,                                -- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
674                                                                                                                                  -- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
675                               FlgAutoCommitIn                 IN         PLS_INTEGER DEFAULT NULL,                                -- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
676                               WarningMsgOut                   OUT        VARCHAR2,                                                -- Messaggio di warning (valorizzato solo se non c'è errore)
677                               ErrContextOut                   OUT        VARCHAR2,                                                -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
678                               ErrCodeOut                       OUT        PLS_INTEGER,                                            -- N.ro errore di uscita
679                               ErrMsgOut                       OUT         VARCHAR2                                                -- Messaggio d'errore
680                             ) return PLS_INTEGER;
681        
682          /*** Funzione di eliminazione di un sezionale                ***/
683          /*** Si può specificare se l'eliminazione deve essere fisica o solo logica (annullamento)    ***/
684          /*** Se non lo si specifica il sistema fa quella fisica se possibile, se no quella logica    ***/
685          function DSezionale(
686                               CodIdConnectionTokenIn           IN        DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,          -- (obblig). Codice identificativo del token di connessione
687                               IdUserLavoroIn                   IN        DMT_USERS.ID_USER%type DEFAULT NULL,	                  -- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
688        			                 IdSezionaleIn   			           IN 		  DMT_SEZIONALI.ID_SEZIONALE%TYPE,		                    -- (obblig.) Identificativo ID
689        			                 FlgCancFisicaIn			           IN		    PLS_INTEGER DEFAULT NULL,			                          -- (valori 1/0/NULL): Se 1 si richiede la cancellazione fisica; se 0 l'annullamento logico; se non è valorizzato quella possibile delle 2.
690                        			 MotiviIn				                 IN		    DMT_ACTIVITIES.NOTE%type,				                        -- Motivi della cancellazione/annullamento
691                               FlgIgnoreWarningIn 		         IN 	    PLS_INTEGER DEFAULT NULL,			                          -- (valori 1/0/NULL) Se 0 o NULL significa che in presenza di WARNING la stored si comporta come in caso di errore; se 1 gli WARNING vengono ignorati
692        			                 FlgRollBckFullIn			           IN 	    PLS_INTEGER DEFAULT NULL,			                          -- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
693                          		 FlgAutoCommitIn			           IN 	    PLS_INTEGER DEFAULT NULL,			                          -- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
694        			                 WarningMsgOut			             OUT	    VARCHAR2,						                                    -- Messaggio di warning (valorizzato solo se non c'è errore)
695                          		 ErrContextOut			             OUT	    VARCHAR2,						                                    -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
696        			                 ErrCodeOut				               OUT	    PLS_INTEGER,					                                  -- N.ro errore di uscita
697        			                 ErrMsgOut				               OUT 	    VARCHAR2						                                    -- Messaggio d'errore
698        			               ) return PLS_INTEGER;
699        
700          /******* funzione per ricercare gli eventi su una fattura ********/
701          function TrovaFatturaEventi(
702                                                CodIdConnectionTokenIn      IN      DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,       -- (obblig). Codice identificativo del token di connessione
703                                                IdUserLavoroIn              IN      DMT_USERS.ID_USER%type DEFAULT NULL,                 -- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
704                                                IdUdIn                      IN      VARCHAR2,                                           -- (obblig). Id unità documentaria
705                                                FiltriIO                    IN OUT  NOCOPY CLOB,                                        -- XML contenente nomi e valori dei filtri di ricerca(conforme allo schema SezioneCache.xsd).
706                                                                                                                                        -- Ogni filtro è un tag "Variabile" dell'XML
707                                                                                                                                        -- I filtri che sono liste hanno nomi (tag Variabile/Nome) che iniziano con @.
708                                                                                                                                        -- I nomi dei filtri possibili sono:
709        
710                                                ------------- inizio argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
711                                                ColOrderByIO                IN OUT  VARCHAR2,                                           -- Indica il/i numeri della/e colonna dell'XML (CLOB ResultOut) di output per cui ordinare i record nell'XML stesso (si può ordinare solo per le colonne da 1 a xx). Se l'ordinamento è per più colonne queste vanno separate con "," (es: 2; 2,3)
712                                                                                                                                        -- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul tipo di ordinamento una qualche preimpostazione di sistema/utente ecc.
713                                                                                                                                        -- se non valorizzato (neppure in output) la lista di record restituita non è ordinata
714                                                FlgDescOrderByIO            IN OUT  VARCHAR2,                                           -- E' una stringa di 1 o 0/NULL, tanti quanti le colonne di ordinamento, separati da ",": 1 significa che l'ordinamento per la data colonna deve essere discendente anzichè ascendente (es: 1; 1,0; 1, )
715                                                                                                                                        -- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul verso di ordinamento una qualche preimpostazione di sistema/utente ecc.
716                                                FlgSenzaPaginazioneIn       IN      PLS_INTEGER DEFAULT NULL,                           -- (valori 1/0/NULL) Se 1 l'estrazione non è paginata, altrimenti sì
717                                                NroPaginaIO                 IN OUT  PLS_INTEGER,                                        -- E' il numero della pagina da estrarre; se NULL e l'estrazione è paginata viene estratta la prima pagina
718                                                BachSizeIO                  IN OUT  PLS_INTEGER,                                        -- Indica il massimo n.ro di record da estrarre se l'estrazione non è paginata (FlgSenzaPaginazioneIn=1)
719                                                                                                                                        -- Indica la dimensione (n.ro di record) della pagina se l'estrazione è paginata (FlgSenzaPaginazioneIn 0 o NULL) e in tal caso se non è valorizzato la dimensione della pagina è quella settata per l'utente di lavoro o è pari al valore del parametro STD_PAGE_NUM_ROW del dominio di lavoro
720                                                OverFlowLimitIn             IN      PLS_INTEGER DEFAULT NULL,                           -- E' il n.ro di record soddisfacenti la ricerca superato il quale la funzione deve restituire errore di overflow
721                                                FlgSenzaTotIn               IN      PLS_INTEGER DEFAULT NULL,                           -- (valori 1/0/NULL) Se 1 significa che non è richiesto come output il totale dei record soddisfacenti la ricerca (se la ricerca è paginata per la prima pagina il totale viene calcolato comunque, per le successive no)
722                                                NroTotRecOut                OUT     PLS_INTEGER,                                        -- E' il n.ro di record complessivi trovati (valorizzato solo se FlgSenzaTotIn è 0 o NULL o se si estrae la prima pagina)
723                                                NroRecInPaginaOut           OUT     PLS_INTEGER,                                        -- E' il numero di record nella pagina (valorizzato solo se l'estrazione è paginata, ovvero se FlgSenzaPaginazioneIn 0 o NULL)
724                                                ------------- fine argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
725        
726                                                FlgBatchSearchIn            IN      PLS_INTEGER DEFAULT NULL,                           -- (valori 1/0/NULL) Se 1 significa che la stored è utilizzata da un processo batch, altrimenti da un processo online.
727                                                                                                                                        -- Serve affinchè in caso l'input OverFlowLimitIn non sia valorizzato vengano applicati i limiti di overflow per processo batch o online che sono parametri di configurazione del sistema.
728                                                ColToReturnIn               IN      VARCHAR2 DEFAULT NULL,                              -- Stringa con i n.ri delle colonne dell'XML di output ResultOut che si vuole siano presenti.
729                                                                                                                                        -- Se la stringa è vuota saranno presenti tutte le colonne.
730                                                                                                                                        -- La colonna 1 sarà presente comunque.
731                                                                                                                                        -- I n.ri delle varie colonne vanno separati con , o ; e se si vuole indicare un intervallo di colonne gli estremi dell'intervallo vanno separati con - (es: "1-5;7;10" significa colonne da 1 a 5 più le colonne 7 e 10)
732                                                ResultOut                   OUT     NOCOPY CLOB,                                        -- Lista dei record trovati (XML conforme a schema LISTA_STD.xsd)
733                                                                                                                                        -- Ogni record trovato è un tag Riga che può contenere le seguenti colonne:
734        																																                                                                -- col. 1:  Id. (PK)
735                                                                        																																-- col. 2:  Codice evento
736        																																                                                                -- col. 3:  Nome evento
737                                                                                                                                        -- col. 4:  Stato Esito evento
738                                                                                                                                        -- col. 5:  Desc Esito evento
739        																																                                                                -- col. 6:  La Data dell'evento (nel formato dato dal parametro di config. FMT_STD_TIMESTAMP)
740                                                                        																																-- col. 7: 	Note generiche.
741                    																																																                    -- col. 8:  Id ud
742        																																																                                -- col. 9:  Id Doc
743        
744                                                ErrContextOut               OUT      VARCHAR2,                                          -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
745                                                ErrCodeOut                  OUT      PLS_INTEGER,                                       -- N.ro errore di uscita
746                                                ErrMsgOut                   OUT     VARCHAR2                                            -- Messaggio d'errore
747              )
748              return PLS_INTEGER;
749        
750           /******* funzione per ricercare i dati per il report FATTURAZIONE  ********/
751          function TrovaReportFatturazione(
752                                        CodIdConnectionTokenIn    IN                      DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,   -- (obblig). Codice identificativo del token di connessione
753                                        IdUserLavoroIn            IN                      DMT_USERS.ID_USER%type DEFAULT NULL,           -- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
754                                        FiltriIO                  IN OUT  NOCOPY CLOB,    -- XML contenente nomi e valori dei filtri di ricerca(conforme allo schema SezioneCache.xsd).
755                                                                                          -- Ogni filtro è un tag "Variabile" dell'XML
756                                                                                          -- I filtri che sono liste hanno nomi (tag Variabile/Nome) che iniziano con @.
757                                                                                          -- I nomi dei filtri possibili sono:
758                                                                                          -- Mese              : mese di riferimento  ( ricerca esatta )
759                                                                                          -- Anno              : anno di riferimento  ( ricerca esatta )
760                                                                                          -- CodApplOwner	     : Serve a restringere la ricerca ai soli documenti e folder caricati a sistema dall'applicazione esterna qui specificata. Se è valorizzato a #BY_CONN_TKN significa l'applicazione da cui si è connessi
761                                                        								                  -- CodIstApplOwner   : Serve a restringere la ricerca ai soli documenti e folder caricati a sistema dall'istanza di applicazione esterna qui specificata. Se è valorizzato a #BY_CONN_TKN significa l'istanza di applicazione da cui si è connessi
762                                                                                           ------------- inizio argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
763                                        ColOrderByIO              IN OUT  VARCHAR2,        -- Indica il/i numeri della/e colonna dell'XML (CLOB ResultOut) di output per cui ordinare i record nell'XML stesso (si può ordinare solo per le colonne da 1 a xx). Se l'ordinamento è per più colonne queste vanno separate con "," (es: 2; 2,3)
764                                                                                          -- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul tipo di ordinamento una qualche preimpostazione di sistema/utente ecc.
765                                                                                          -- se non valorizzato (neppure in output) la lista di record restituita non è ordinata
766                                        FlgDescOrderByIO          IN OUT  VARCHAR2,        -- E' una stringa di 1 o 0/NULL, tanti quanti le colonne di ordinamento, separati da ",": 1 significa che l'ordinamento per la data colonna deve essere discendente anzichè ascendente (es: 1; 1,0; 1, )
767                                                                                          -- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul verso di ordinamento una qualche preimpostazione di sistema/utente ecc.
768                                        FlgSenzaPaginazioneIn     IN       PLS_INTEGER DEFAULT NULL,              -- (valori 1/0/NULL) Se 1 l'estrazione non è paginata, altrimenti sì
769                                        NroPaginaIO                IN OUT  PLS_INTEGER,    -- E' il numero della pagina da estrarre; se NULL e l'estrazione è paginata viene estratta la prima pagina
770                                        BachSizeIO                IN OUT  PLS_INTEGER,    -- Indica il massimo n.ro di record da estrarre se l'estrazione non è paginata (FlgSenzaPaginazioneIn=1)
771                                                                                          -- Indica la dimensione (n.ro di record) della pagina se l'estrazione è paginata (FlgSenzaPaginazioneIn 0 o NULL) e in tal caso se non è valorizzato la dimensione della pagina è quella settata per l'utente di lavoro o è pari al valore del parametro STD_PAGE_NUM_ROW del dominio di lavoro
772                                        OverFlowLimitIn            IN      PLS_INTEGER DEFAULT NULL,  -- E' il n.ro di record soddisfacenti la ricerca superato il quale la funzione deve restituire errore di overflow
773                                        FlgSenzaTotIn              IN      PLS_INTEGER DEFAULT NULL,  -- (valori 1/0/NULL) Se 1 significa che non è richiesto come output il totale dei record soddisfacenti la ricerca (se la ricerca è paginata per la prima pagina il totale viene calcolato comunque, per le successive no)
774                                        NroTotRecOut              OUT      PLS_INTEGER,              -- E' il n.ro di record complessivi trovati (valorizzato solo se FlgSenzaTotIn è 0 o NULL o se si estrae la prima pagina)
775                                        NroRecInPaginaOut         OUT     PLS_INTEGER,              -- E' il numero di record nella pagina (valorizzato solo se l'estrazione è paginata, ovvero se FlgSenzaPaginazioneIn 0 o NULL)
776                                        ------------- fine argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
777        
778                                         FlgBatchSearchIn          IN      PLS_INTEGER DEFAULT NULL,  -- (valori 1/0/NULL) Se 1 significa che la stored è utilizzata da un processo batch, altrimenti da un processo online.
779                                                                                                    -- Serve affinchè in caso l'input OverFlowLimitIn non sia valorizzato vengano applicati i limiti di overflow per processo batch o online che sono parametri di configurazione del sistema.
780                                         ColToReturnIn              IN      VARCHAR2 DEFAULT NULL,    -- Stringa con i n.ri delle colonne dell'XML di output ResultOut che si vuole siano presenti.
781                                                                                                      -- Se la stringa è vuota saranno presenti tutte le colonne.
782                                                                                                      -- La colonna 1 sarà presente comunque.
783                                                                                                      -- I n.ri delle varie colonne vanno separati con , o ; e se si vuole indicare un intervallo di colonne gli estremi dell'intervallo vanno separati con - (es: "1-5;7;10" significa colonne da 1 a 5 più le colonne 7 e 10)
784                                         ResultOut                  OUT      NOCOPY CLOB,             -- Lista dei record trovati (XML conforme a schema LISTA_STD.xsd)
785                                                                                                      -- Ogni record trovato è un tag Riga che può contenere le seguenti colonne:
786        																							                                                -- 1:  Descrizione società
787                                                                                                      -- 2:  Anno
788                                                                                                      -- 3:  Mese
789                                                                                                      -- 5:  Centro di costo
790                                                                                                      -- 6:  Codice Tipologia dato rendicontato
791                                                                                                      -- 7:  Tipologia dato rendicontato
792                                                                                                      -- 8:  Nr. dati conteggiati
793                                                                                                      -- 9:  Nr. totale pagine file
794                                                                                                      --10:  Nr. totale dimensione file
795                                         ErrContextOut              OUT      VARCHAR2,                -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
796                                         ErrCodeOut                OUT      PLS_INTEGER,              -- N.ro errore di uscita
797                                         ErrMsgOut                  OUT     VARCHAR2                  -- Messaggio d'errore
798              )
799              return PLS_INTEGER;
800        
801        
802        
803           /******* funzione per visualizzare la lista degli utenti rendicontati nel report FATTURAZIONE  ********/
804          function TrovaReportFatturazUtenti(
805                                        CodIdConnectionTokenIn    IN                      DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,   -- (obblig). Codice identificativo del token di connessione
806                                        IdUserLavoroIn            IN                      DMT_USERS.ID_USER%type DEFAULT NULL,           -- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
807                                        FiltriIO                  IN  OUT  NOCOPY CLOB,   -- XML contenente nomi e valori dei filtri di ricerca(conforme allo schema SezioneCache.xsd).
808                                                                                          -- Ogni filtro è un tag "Variabile" dell'XML
809                                                                                          -- I filtri che sono liste hanno nomi (tag Variabile/Nome) che iniziano con @.
810                                                                                          -- I nomi dei filtri possibili sono:
811                                                                                          -- Mese               : mese di riferimento  ( ricerca esatta )
812                                                                                          -- Anno               : anno di riferimento  ( ricerca esatta )
813                                                                                          -- CodApplOwner        : Serve a restringere la ricerca ai soli documenti e folder caricati a sistema dall'applicazione esterna qui specificata. Se è valorizzato a #BY_CONN_TKN significa l'applicazione da cui si è connessi
814                                                                                          -- CodIstApplOwner    : Serve a restringere la ricerca ai soli documenti e folder caricati a sistema dall'istanza di applicazione esterna qui specificata. Se è valorizzato a #BY_CONN_TKN significa l'istanza di applicazione da cui si è connessi
815        
816                                                                                          ------------- inizio argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
817                                        ColOrderByIO              IN  OUT  VARCHAR2,      -- Indica il/i numeri della/e colonna dell'XML (CLOB ResultOut) di output per cui ordinare i record nell'XML stesso (si può ordinare solo per le colonne da 1 a xx). Se l'ordinamento è per più colonne queste vanno separate con "," (es: 2; 2,3)
818                                                                                          -- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul tipo di ordinamento una qualche preimpostazione di sistema/utente ecc.
819                                                                                          -- se non valorizzato (neppure in output) la lista di record restituita non è ordinata
820                                        FlgDescOrderByIO          IN  OUT  VARCHAR2,      -- E' una stringa di 1 o 0/NULL, tanti quanti le colonne di ordinamento, separati da ",": 1 significa che l'ordinamento per la data colonna deve essere discendente anzichè ascendente (es: 1; 1,0; 1, )
821                                                                                          -- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul verso di ordinamento una qualche preimpostazione di sistema/utente ecc.
822                                        FlgSenzaPaginazioneIn     IN       PLS_INTEGER DEFAULT NULL,              -- (valori 1/0/NULL) Se 1 l'estrazione non è paginata, altrimenti sì
823                                        NroPaginaIO               IN  OUT  PLS_INTEGER,    -- E' il numero della pagina da estrarre; se NULL e l'estrazione è paginata viene estratta la prima pagina
824                                        BachSizeIO                IN  OUT  PLS_INTEGER,    -- Indica il massimo n.ro di record da estrarre se l'estrazione non è paginata (FlgSenzaPaginazioneIn=1)
825                                                                                          -- Indica la dimensione (n.ro di record) della pagina se l'estrazione è paginata (FlgSenzaPaginazioneIn 0 o NULL) e in tal caso se non è valorizzato la dimensione della pagina è quella settata per l'utente di lavoro o è pari al valore del parametro STD_PAGE_NUM_ROW del dominio di lavoro
826                                        OverFlowLimitIn           IN       PLS_INTEGER DEFAULT NULL,  -- E' il n.ro di record soddisfacenti la ricerca superato il quale la funzione deve restituire errore di overflow
827                                        FlgSenzaTotIn             IN       PLS_INTEGER DEFAULT NULL,  -- (valori 1/0/NULL) Se 1 significa che non è richiesto come output il totale dei record soddisfacenti la ricerca (se la ricerca è paginata per la prima pagina il totale viene calcolato comunque, per le successive no)
828                                        NroTotRecOut              OUT      PLS_INTEGER,              -- E' il n.ro di record complessivi trovati (valorizzato solo se FlgSenzaTotIn è 0 o NULL o se si estrae la prima pagina)
829                                        NroRecInPaginaOut         OUT      PLS_INTEGER,              -- E' il numero di record nella pagina (valorizzato solo se l'estrazione è paginata, ovvero se FlgSenzaPaginazioneIn 0 o NULL)
830                                        ------------- fine argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
831        
832                                         FlgBatchSearchIn         IN       PLS_INTEGER DEFAULT NULL,  -- (valori 1/0/NULL) Se 1 significa che la stored è utilizzata da un processo batch, altrimenti da un processo online.
833                                                                                                      -- Serve affinchè in caso l'input OverFlowLimitIn non sia valorizzato vengano applicati i limiti di overflow per processo batch o online che sono parametri di configurazione del sistema.
834                                         ColToReturnIn            IN       VARCHAR2 DEFAULT NULL,     -- Stringa con i n.ri delle colonne dell'XML di output ResultOut che si vuole siano presenti.
835                                                                                                      -- Se la stringa è vuota saranno presenti tutte le colonne.
836                                                                                                      -- La colonna 1 sarà presente comunque.
837                                                                                                      -- I n.ri delle varie colonne vanno separati con , o ; e se si vuole indicare un intervallo di colonne gli estremi dell'intervallo vanno separati con - (es: "1-5;7;10" significa colonne da 1 a 5 più le colonne 7 e 10)
838                                         ResultOut                OUT      NOCOPY CLOB,               -- Lista dei record trovati (XML conforme a schema LISTA_STD.xsd)
839                                                                                                      -- Ogni record trovato è un tag Riga che può contenere le seguenti colonne:
840                                                                                                      -- 1:  Descrizione società
841                                                                                                      -- 2:  Anno
842                                                                                                      -- 3:  Mese
843                                                                                                      -- 4:  Nome Utente
844                                                                                                      -- 5:  Data Creazione
845        
846                                         ErrContextOut            OUT      VARCHAR2,                  -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
847                                         ErrCodeOut               OUT      PLS_INTEGER,               -- N.ro errore di uscita
848                                         ErrMsgOut                OUT      VARCHAR2                   -- Messaggio d'errore
849              )
850              return PLS_INTEGER;                                  -- 1 successo, 0 in caso di errore
851        
852        
853          /******* funzione per visualizzare la lista delle fatture PA rendicontate nel report FATTURAZIONE  ********/
854          function TrovaReportFatturazPA(
855                                        CodIdConnectionTokenIn    IN                      DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,   -- (obblig). Codice identificativo del token di connessione
856                                        IdUserLavoroIn            IN                      DMT_USERS.ID_USER%type DEFAULT NULL,           -- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
857                                        FiltriIO                  IN  OUT  NOCOPY CLOB,   -- XML contenente nomi e valori dei filtri di ricerca(conforme allo schema SezioneCache.xsd).
858                                                                                          -- Ogni filtro è un tag "Variabile" dell'XML
859                                                                                          -- I filtri che sono liste hanno nomi (tag Variabile/Nome) che iniziano con @.
860                                                                                          -- I nomi dei filtri possibili sono:
861                                                                                          -- Mese               : mese di riferimento  ( ricerca esatta )
862                                                                                          -- Anno               : anno di riferimento  ( ricerca esatta )
863                                                                                          -- CodApplOwner        : Serve a restringere la ricerca ai soli documenti e folder caricati a sistema dall'applicazione esterna qui specificata. Se è valorizzato a #BY_CONN_TKN significa l'applicazione da cui si è connessi
864                                                                                          -- CodIstApplOwner    : Serve a restringere la ricerca ai soli documenti e folder caricati a sistema dall'istanza di applicazione esterna qui specificata. Se è valorizzato a #BY_CONN_TKN significa l'istanza di applicazione da cui si è connessi
865        
866                                                                                          ------------- inizio argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
867                                        ColOrderByIO              IN  OUT  VARCHAR2,      -- Indica il/i numeri della/e colonna dell'XML (CLOB ResultOut) di output per cui ordinare i record nell'XML stesso (si può ordinare solo per le colonne da 1 a xx). Se l'ordinamento è per più colonne queste vanno separate con "," (es: 2; 2,3)
868                                                                                          -- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul tipo di ordinamento una qualche preimpostazione di sistema/utente ecc.
869                                                                                          -- se non valorizzato (neppure in output) la lista di record restituita non è ordinata
870                                        FlgDescOrderByIO          IN  OUT  VARCHAR2,      -- E' una stringa di 1 o 0/NULL, tanti quanti le colonne di ordinamento, separati da ",": 1 significa che l'ordinamento per la data colonna deve essere discendente anzichè ascendente (es: 1; 1,0; 1, )
871                                                                                          -- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul verso di ordinamento una qualche preimpostazione di sistema/utente ecc.
872                                        FlgSenzaPaginazioneIn     IN       PLS_INTEGER DEFAULT NULL,              -- (valori 1/0/NULL) Se 1 l'estrazione non è paginata, altrimenti sì
873                                        NroPaginaIO               IN  OUT  PLS_INTEGER,    -- E' il numero della pagina da estrarre; se NULL e l'estrazione è paginata viene estratta la prima pagina
874                                        BachSizeIO                IN  OUT  PLS_INTEGER,    -- Indica il massimo n.ro di record da estrarre se l'estrazione non è paginata (FlgSenzaPaginazioneIn=1)
875                                                                                          -- Indica la dimensione (n.ro di record) della pagina se l'estrazione è paginata (FlgSenzaPaginazioneIn 0 o NULL) e in tal caso se non è valorizzato la dimensione della pagina è quella settata per l'utente di lavoro o è pari al valore del parametro STD_PAGE_NUM_ROW del dominio di lavoro
876                                        OverFlowLimitIn           IN       PLS_INTEGER DEFAULT NULL,  -- E' il n.ro di record soddisfacenti la ricerca superato il quale la funzione deve restituire errore di overflow
877                                        FlgSenzaTotIn             IN       PLS_INTEGER DEFAULT NULL,  -- (valori 1/0/NULL) Se 1 significa che non è richiesto come output il totale dei record soddisfacenti la ricerca (se la ricerca è paginata per la prima pagina il totale viene calcolato comunque, per le successive no)
878                                        NroTotRecOut              OUT      PLS_INTEGER,              -- E' il n.ro di record complessivi trovati (valorizzato solo se FlgSenzaTotIn è 0 o NULL o se si estrae la prima pagina)
879                                        NroRecInPaginaOut         OUT      PLS_INTEGER,              -- E' il numero di record nella pagina (valorizzato solo se l'estrazione è paginata, ovvero se FlgSenzaPaginazioneIn 0 o NULL)
880                                        ------------- fine argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
881        
882                                         FlgBatchSearchIn         IN       PLS_INTEGER DEFAULT NULL,  -- (valori 1/0/NULL) Se 1 significa che la stored è utilizzata da un processo batch, altrimenti da un processo online.
883                                                                                                      -- Serve affinchè in caso l'input OverFlowLimitIn non sia valorizzato vengano applicati i limiti di overflow per processo batch o online che sono parametri di configurazione del sistema.
884                                         ColToReturnIn            IN       VARCHAR2 DEFAULT NULL,     -- Stringa con i n.ri delle colonne dell'XML di output ResultOut che si vuole siano presenti.
885                                                                                                      -- Se la stringa è vuota saranno presenti tutte le colonne.
886                                                                                                      -- La colonna 1 sarà presente comunque.
887                                                                                                      -- I n.ri delle varie colonne vanno separati con , o ; e se si vuole indicare un intervallo di colonne gli estremi dell'intervallo vanno separati con - (es: "1-5;7;10" significa colonne da 1 a 5 più le colonne 7 e 10)
888                                         ResultOut                OUT      NOCOPY CLOB,               -- Lista dei record trovati (XML conforme a schema LISTA_STD.xsd)
889                                                                                                      -- Ogni record trovato è un tag Riga che può contenere le seguenti colonne:
890                                                                                                      -- 1:  Descrizione società
891                                                                                                      -- 2:  Anno
892                                                                                                      -- 3:  Mese
893                                                                                                      -- 4:  Numero documento
894                                                                                                      -- 5:  Data documento
895                                                                                                      -- 6:  Data caricamento documento
896        
897                                         ErrContextOut            OUT      VARCHAR2,                  -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
898                                         ErrCodeOut               OUT      PLS_INTEGER,               -- N.ro errore di uscita
899                                         ErrMsgOut                OUT      VARCHAR2                   -- Messaggio d'errore
900              )
901              return PLS_INTEGER;                                  -- 1 successo, 0 in caso di errore
902        
903        
904        /******* funzione per visualizzare la lista delle fatture NON PA rendicontate nel report FATTURAZIONE  ********/
905          function TrovaReportFatturazNOPA(
906                                        CodIdConnectionTokenIn    IN                      DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,   -- (obblig). Codice identificativo del token di connessione
907                                        IdUserLavoroIn            IN                      DMT_USERS.ID_USER%type DEFAULT NULL,           -- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
908                                        FiltriIO                  IN  OUT  NOCOPY CLOB,   -- XML contenente nomi e valori dei filtri di ricerca(conforme allo schema SezioneCache.xsd).
909                                                                                          -- Ogni filtro è un tag "Variabile" dell'XML
910                                                                                          -- I filtri che sono liste hanno nomi (tag Variabile/Nome) che iniziano con @.
911                                                                                          -- I nomi dei filtri possibili sono:
912                                                                                          -- Mese               : mese di riferimento  ( ricerca esatta )
913                                                                                          -- Anno               : anno di riferimento  ( ricerca esatta )
914                                                                                          -- CodApplOwner        : Serve a restringere la ricerca ai soli documenti e folder caricati a sistema dall'applicazione esterna qui specificata. Se è valorizzato a #BY_CONN_TKN significa l'applicazione da cui si è connessi
915                                                                                          -- CodIstApplOwner    : Serve a restringere la ricerca ai soli documenti e folder caricati a sistema dall'istanza di applicazione esterna qui specificata. Se è valorizzato a #BY_CONN_TKN significa l'istanza di applicazione da cui si è connessi
916        
917                                                                                          ------------- inizio argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
918                                        ColOrderByIO              IN  OUT  VARCHAR2,      -- Indica il/i numeri della/e colonna dell'XML (CLOB ResultOut) di output per cui ordinare i record nell'XML stesso (si può ordinare solo per le colonne da 1 a xx). Se l'ordinamento è per più colonne queste vanno separate con "," (es: 2; 2,3)
919                                                                                          -- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul tipo di ordinamento una qualche preimpostazione di sistema/utente ecc.
920                                                                                          -- se non valorizzato (neppure in output) la lista di record restituita non è ordinata
921                                        FlgDescOrderByIO          IN  OUT  VARCHAR2,      -- E' una stringa di 1 o 0/NULL, tanti quanti le colonne di ordinamento, separati da ",": 1 significa che l'ordinamento per la data colonna deve essere discendente anzichè ascendente (es: 1; 1,0; 1, )
922                                                                                          -- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul verso di ordinamento una qualche preimpostazione di sistema/utente ecc.
923                                        FlgSenzaPaginazioneIn     IN       PLS_INTEGER DEFAULT NULL,              -- (valori 1/0/NULL) Se 1 l'estrazione non è paginata, altrimenti sì
924                                        NroPaginaIO               IN  OUT  PLS_INTEGER,    -- E' il numero della pagina da estrarre; se NULL e l'estrazione è paginata viene estratta la prima pagina
925                                        BachSizeIO                IN  OUT  PLS_INTEGER,    -- Indica il massimo n.ro di record da estrarre se l'estrazione non è paginata (FlgSenzaPaginazioneIn=1)
926                                                                                          -- Indica la dimensione (n.ro di record) della pagina se l'estrazione è paginata (FlgSenzaPaginazioneIn 0 o NULL) e in tal caso se non è valorizzato la dimensione della pagina è quella settata per l'utente di lavoro o è pari al valore del parametro STD_PAGE_NUM_ROW del dominio di lavoro
927                                        OverFlowLimitIn           IN       PLS_INTEGER DEFAULT NULL,  -- E' il n.ro di record soddisfacenti la ricerca superato il quale la funzione deve restituire errore di overflow
928                                        FlgSenzaTotIn             IN       PLS_INTEGER DEFAULT NULL,  -- (valori 1/0/NULL) Se 1 significa che non è richiesto come output il totale dei record soddisfacenti la ricerca (se la ricerca è paginata per la prima pagina il totale viene calcolato comunque, per le successive no)
929                                        NroTotRecOut              OUT      PLS_INTEGER,              -- E' il n.ro di record complessivi trovati (valorizzato solo se FlgSenzaTotIn è 0 o NULL o se si estrae la prima pagina)
930                                        NroRecInPaginaOut         OUT      PLS_INTEGER,              -- E' il numero di record nella pagina (valorizzato solo se l'estrazione è paginata, ovvero se FlgSenzaPaginazioneIn 0 o NULL)
931                                        ------------- fine argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
932        
933                                         FlgBatchSearchIn         IN       PLS_INTEGER DEFAULT NULL,  -- (valori 1/0/NULL) Se 1 significa che la stored è utilizzata da un processo batch, altrimenti da un processo online.
934                                                                                                      -- Serve affinchè in caso l'input OverFlowLimitIn non sia valorizzato vengano applicati i limiti di overflow per processo batch o online che sono parametri di configurazione del sistema.
935                                         ColToReturnIn            IN       VARCHAR2 DEFAULT NULL,     -- Stringa con i n.ri delle colonne dell'XML di output ResultOut che si vuole siano presenti.
936                                                                                                      -- Se la stringa è vuota saranno presenti tutte le colonne.
937                                                                                                      -- La colonna 1 sarà presente comunque.
938                                                                                                      -- I n.ri delle varie colonne vanno separati con , o ; e se si vuole indicare un intervallo di colonne gli estremi dell'intervallo vanno separati con - (es: "1-5;7;10" significa colonne da 1 a 5 più le colonne 7 e 10)
939                                         ResultOut                OUT      NOCOPY CLOB,               -- Lista dei record trovati (XML conforme a schema LISTA_STD.xsd)
940                                                                                                      -- Ogni record trovato è un tag Riga che può contenere le seguenti colonne:
941                                                                                                      -- 1:  Descrizione società
942                                                                                                      -- 2:  Anno
943                                                                                                      -- 3:  Mese
944                                                                                                      -- 4:  Numero documento
945                                                                                                      -- 5:  Data documento
946                                                                                                      -- 6:  Data caricamento documento
947        
948                                         ErrContextOut            OUT      VARCHAR2,                  -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
949                                         ErrCodeOut               OUT      PLS_INTEGER,               -- N.ro errore di uscita
950                                         ErrMsgOut                OUT      VARCHAR2                   -- Messaggio d'errore
951              )
952              return PLS_INTEGER;                                  -- 1 successo, 0 in caso di errore
953        
954        
955          /******* funzione per visualizzare la lista delle fatture inviate con allegato PDF rendicontate nel report FATTURAZIONE  ********/
956          function TrovaReportFatturazMailPDF(
957                                        CodIdConnectionTokenIn    IN                      DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,   -- (obblig). Codice identificativo del token di connessione
958                                        IdUserLavoroIn            IN                      DMT_USERS.ID_USER%type DEFAULT NULL,           -- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
959                                        FiltriIO                  IN  OUT  NOCOPY CLOB,   -- XML contenente nomi e valori dei filtri di ricerca(conforme allo schema SezioneCache.xsd).
960                                                                                          -- Ogni filtro è un tag "Variabile" dell'XML
961                                                                                          -- I filtri che sono liste hanno nomi (tag Variabile/Nome) che iniziano con @.
962                                                                                          -- I nomi dei filtri possibili sono:
963                                                                                          -- Mese               : mese di riferimento  ( ricerca esatta )
964                                                                                          -- Anno               : anno di riferimento  ( ricerca esatta )
965                                                                                          -- CodApplOwner        : Serve a restringere la ricerca ai soli documenti e folder caricati a sistema dall'applicazione esterna qui specificata. Se è valorizzato a #BY_CONN_TKN significa l'applicazione da cui si è connessi
966                                                                                          -- CodIstApplOwner    : Serve a restringere la ricerca ai soli documenti e folder caricati a sistema dall'istanza di applicazione esterna qui specificata. Se è valorizzato a #BY_CONN_TKN significa l'istanza di applicazione da cui si è connessi
967        
968                                                                                          ------------- inizio argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
969                                        ColOrderByIO              IN  OUT  VARCHAR2,      -- Indica il/i numeri della/e colonna dell'XML (CLOB ResultOut) di output per cui ordinare i record nell'XML stesso (si può ordinare solo per le colonne da 1 a xx). Se l'ordinamento è per più colonne queste vanno separate con "," (es: 2; 2,3)
970                                                                                          -- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul tipo di ordinamento una qualche preimpostazione di sistema/utente ecc.
971                                                                                          -- se non valorizzato (neppure in output) la lista di record restituita non è ordinata
972                                        FlgDescOrderByIO          IN  OUT  VARCHAR2,      -- E' una stringa di 1 o 0/NULL, tanti quanti le colonne di ordinamento, separati da ",": 1 significa che l'ordinamento per la data colonna deve essere discendente anzichè ascendente (es: 1; 1,0; 1, )
973                                                                                          -- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul verso di ordinamento una qualche preimpostazione di sistema/utente ecc.
974                                        FlgSenzaPaginazioneIn     IN       PLS_INTEGER DEFAULT NULL,              -- (valori 1/0/NULL) Se 1 l'estrazione non è paginata, altrimenti sì
975                                        NroPaginaIO               IN  OUT  PLS_INTEGER,    -- E' il numero della pagina da estrarre; se NULL e l'estrazione è paginata viene estratta la prima pagina
976                                        BachSizeIO                IN  OUT  PLS_INTEGER,    -- Indica il massimo n.ro di record da estrarre se l'estrazione non è paginata (FlgSenzaPaginazioneIn=1)
977                                                                                          -- Indica la dimensione (n.ro di record) della pagina se l'estrazione è paginata (FlgSenzaPaginazioneIn 0 o NULL) e in tal caso se non è valorizzato la dimensione della pagina è quella settata per l'utente di lavoro o è pari al valore del parametro STD_PAGE_NUM_ROW del dominio di lavoro
978                                        OverFlowLimitIn           IN       PLS_INTEGER DEFAULT NULL,  -- E' il n.ro di record soddisfacenti la ricerca superato il quale la funzione deve restituire errore di overflow
979                                        FlgSenzaTotIn             IN       PLS_INTEGER DEFAULT NULL,  -- (valori 1/0/NULL) Se 1 significa che non è richiesto come output il totale dei record soddisfacenti la ricerca (se la ricerca è paginata per la prima pagina il totale viene calcolato comunque, per le successive no)
980                                        NroTotRecOut              OUT      PLS_INTEGER,              -- E' il n.ro di record complessivi trovati (valorizzato solo se FlgSenzaTotIn è 0 o NULL o se si estrae la prima pagina)
981                                        NroRecInPaginaOut         OUT      PLS_INTEGER,              -- E' il numero di record nella pagina (valorizzato solo se l'estrazione è paginata, ovvero se FlgSenzaPaginazioneIn 0 o NULL)
982                                        ------------- fine argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
983        
984                                         FlgBatchSearchIn         IN       PLS_INTEGER DEFAULT NULL,  -- (valori 1/0/NULL) Se 1 significa che la stored è utilizzata da un processo batch, altrimenti da un processo online.
985                                                                                                      -- Serve affinchè in caso l'input OverFlowLimitIn non sia valorizzato vengano applicati i limiti di overflow per processo batch o online che sono parametri di configurazione del sistema.
986                                         ColToReturnIn            IN       VARCHAR2 DEFAULT NULL,     -- Stringa con i n.ri delle colonne dell'XML di output ResultOut che si vuole siano presenti.
987                                                                                                      -- Se la stringa è vuota saranno presenti tutte le colonne.
988                                                                                                      -- La colonna 1 sarà presente comunque.
989                                                                                                      -- I n.ri delle varie colonne vanno separati con , o ; e se si vuole indicare un intervallo di colonne gli estremi dell'intervallo vanno separati con - (es: "1-5;7;10" significa colonne da 1 a 5 più le colonne 7 e 10)
990                                         ResultOut                OUT      NOCOPY CLOB,               -- Lista dei record trovati (XML conforme a schema LISTA_STD.xsd)
991                                                                                                      -- Ogni record trovato è un tag Riga che può contenere le seguenti colonne:
992                                                                                                      -- 1:  Descrizione società
993                                                                                                      -- 2:  Anno
994                                                                                                      -- 3:  Mese
995                                                                                                      -- 4:  Numero documento
996                                                                                                      -- 5:  Data invio
997                                                                                                      -- 6:  Data reinvio
998        
999                                         ErrContextOut            OUT      VARCHAR2,                  -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
1000                                         ErrCodeOut               OUT      PLS_INTEGER,               -- N.ro errore di uscita
1001                                         ErrMsgOut                OUT      VARCHAR2                   -- Messaggio d'errore
1002              )
1003              return PLS_INTEGER;                                 -- 1 successo, 0 in caso di errore
1004        
1005        function TrovaReportFatturazMailLINK(
1006                                        CodIdConnectionTokenIn    IN                      DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,   -- (obblig). Codice identificativo del token di connessione
1007                                        IdUserLavoroIn            IN                      DMT_USERS.ID_USER%type DEFAULT NULL,           -- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
1008                                        FiltriIO                  IN  OUT  NOCOPY CLOB,   -- XML contenente nomi e valori dei filtri di ricerca(conforme allo schema SezioneCache.xsd).
1009                                                                                          -- Ogni filtro è un tag "Variabile" dell'XML
1010                                                                                          -- I filtri che sono liste hanno nomi (tag Variabile/Nome) che iniziano con @.
1011                                                                                          -- I nomi dei filtri possibili sono:
1012                                                                                          -- Mese               : mese di riferimento  ( ricerca esatta )
1013                                                                                          -- Anno               : anno di riferimento  ( ricerca esatta )
1014                                                                                          -- CodApplOwner        : Serve a restringere la ricerca ai soli documenti e folder caricati a sistema dall'applicazione esterna qui specificata. Se è valorizzato a #BY_CONN_TKN significa l'applicazione da cui si è connessi
1015                                                                                          -- CodIstApplOwner    : Serve a restringere la ricerca ai soli documenti e folder caricati a sistema dall'istanza di applicazione esterna qui specificata. Se è valorizzato a #BY_CONN_TKN significa l'istanza di applicazione da cui si è connessi
1016        
1017                                                                                          ------------- inizio argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
1018                                        ColOrderByIO              IN  OUT  VARCHAR2,      -- Indica il/i numeri della/e colonna dell'XML (CLOB ResultOut) di output per cui ordinare i record nell'XML stesso (si può ordinare solo per le colonne da 1 a xx). Se l'ordinamento è per più colonne queste vanno separate con "," (es: 2; 2,3)
1019                                                                                          -- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul tipo di ordinamento una qualche preimpostazione di sistema/utente ecc.
1020                                                                                          -- se non valorizzato (neppure in output) la lista di record restituita non è ordinata
1021                                        FlgDescOrderByIO          IN  OUT  VARCHAR2,      -- E' una stringa di 1 o 0/NULL, tanti quanti le colonne di ordinamento, separati da ",": 1 significa che l'ordinamento per la data colonna deve essere discendente anzichè ascendente (es: 1; 1,0; 1, )
1022                                                                                          -- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul verso di ordinamento una qualche preimpostazione di sistema/utente ecc.
1023                                        FlgSenzaPaginazioneIn     IN       PLS_INTEGER DEFAULT NULL,              -- (valori 1/0/NULL) Se 1 l'estrazione non è paginata, altrimenti sì
1024                                        NroPaginaIO               IN  OUT  PLS_INTEGER,    -- E' il numero della pagina da estrarre; se NULL e l'estrazione è paginata viene estratta la prima pagina
1025                                        BachSizeIO                IN  OUT  PLS_INTEGER,    -- Indica il massimo n.ro di record da estrarre se l'estrazione non è paginata (FlgSenzaPaginazioneIn=1)
1026                                                                                          -- Indica la dimensione (n.ro di record) della pagina se l'estrazione è paginata (FlgSenzaPaginazioneIn 0 o NULL) e in tal caso se non è valorizzato la dimensione della pagina è quella settata per l'utente di lavoro o è pari al valore del parametro STD_PAGE_NUM_ROW del dominio di lavoro
1027                                        OverFlowLimitIn           IN       PLS_INTEGER DEFAULT NULL,  -- E' il n.ro di record soddisfacenti la ricerca superato il quale la funzione deve restituire errore di overflow
1028                                        FlgSenzaTotIn             IN       PLS_INTEGER DEFAULT NULL,  -- (valori 1/0/NULL) Se 1 significa che non è richiesto come output il totale dei record soddisfacenti la ricerca (se la ricerca è paginata per la prima pagina il totale viene calcolato comunque, per le successive no)
1029                                        NroTotRecOut              OUT      PLS_INTEGER,              -- E' il n.ro di record complessivi trovati (valorizzato solo se FlgSenzaTotIn è 0 o NULL o se si estrae la prima pagina)
1030                                        NroRecInPaginaOut         OUT      PLS_INTEGER,              -- E' il numero di record nella pagina (valorizzato solo se l'estrazione è paginata, ovvero se FlgSenzaPaginazioneIn 0 o NULL)
1031                                        ------------- fine argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
1032        
1033                                         FlgBatchSearchIn         IN       PLS_INTEGER DEFAULT NULL,  -- (valori 1/0/NULL) Se 1 significa che la stored è utilizzata da un processo batch, altrimenti da un processo online.
1034                                                                                                      -- Serve affinchè in caso l'input OverFlowLimitIn non sia valorizzato vengano applicati i limiti di overflow per processo batch o online che sono parametri di configurazione del sistema.
1035                                         ColToReturnIn            IN       VARCHAR2 DEFAULT NULL,     -- Stringa con i n.ri delle colonne dell'XML di output ResultOut che si vuole siano presenti.
1036                                                                                                      -- Se la stringa è vuota saranno presenti tutte le colonne.
1037                                                                                                      -- La colonna 1 sarà presente comunque.
1038                                                                                                      -- I n.ri delle varie colonne vanno separati con , o ; e se si vuole indicare un intervallo di colonne gli estremi dell'intervallo vanno separati con - (es: "1-5;7;10" significa colonne da 1 a 5 più le colonne 7 e 10)
1039                                         ResultOut                OUT      NOCOPY CLOB,               -- Lista dei record trovati (XML conforme a schema LISTA_STD.xsd)
1040                                                                                                      -- Ogni record trovato è un tag Riga che può contenere le seguenti colonne:
1041                                                                                                      -- 1:  Descrizione società
1042                                                                                                      -- 2:  Anno
1043                                                                                                      -- 3:  Mese
1044                                                                                                      -- 4:  Numero documento
1045                                                                                                      -- 5:  Data invio
1046                                                                                                      -- 6:  Data reinvio
1047        
1048                                         ErrContextOut            OUT      VARCHAR2,                  -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
1049                                         ErrCodeOut               OUT      PLS_INTEGER,               -- N.ro errore di uscita
1050                                         ErrMsgOut                OUT      VARCHAR2                   -- Messaggio d'errore
1051              )
1052              return PLS_INTEGER;                                  -- 1 successo, 0 in caso di errore
1053        
1054        
1055          /******* funzione per visualizzare la lista delle fatture inviate via PEC rendicontate nel report FATTURAZIONE  ********/
1056          function TrovaReportFatturazMailPEC(
1057                                        CodIdConnectionTokenIn    IN                      DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,   -- (obblig). Codice identificativo del token di connessione
1058                                        IdUserLavoroIn            IN                      DMT_USERS.ID_USER%type DEFAULT NULL,           -- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
1059                                        FiltriIO                  IN  OUT  NOCOPY CLOB,   -- XML contenente nomi e valori dei filtri di ricerca(conforme allo schema SezioneCache.xsd).
1060                                                                                          -- Ogni filtro è un tag "Variabile" dell'XML
1061                                                                                          -- I filtri che sono liste hanno nomi (tag Variabile/Nome) che iniziano con @.
1062                                                                                          -- I nomi dei filtri possibili sono:
1063                                                                                          -- Mese               : mese di riferimento  ( ricerca esatta )
1064                                                                                          -- Anno               : anno di riferimento  ( ricerca esatta )
1065                                                                                          -- CodApplOwner        : Serve a restringere la ricerca ai soli documenti e folder caricati a sistema dall'applicazione esterna qui specificata. Se è valorizzato a #BY_CONN_TKN significa l'applicazione da cui si è connessi
1066                                                                                          -- CodIstApplOwner    : Serve a restringere la ricerca ai soli documenti e folder caricati a sistema dall'istanza di applicazione esterna qui specificata. Se è valorizzato a #BY_CONN_TKN significa l'istanza di applicazione da cui si è connessi
1067        
1068                                                                                          ------------- inizio argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
1069                                        ColOrderByIO              IN  OUT  VARCHAR2,      -- Indica il/i numeri della/e colonna dell'XML (CLOB ResultOut) di output per cui ordinare i record nell'XML stesso (si può ordinare solo per le colonne da 1 a xx). Se l'ordinamento è per più colonne queste vanno separate con "," (es: 2; 2,3)
1070                                                                                          -- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul tipo di ordinamento una qualche preimpostazione di sistema/utente ecc.
1071                                                                                          -- se non valorizzato (neppure in output) la lista di record restituita non è ordinata
1072                                        FlgDescOrderByIO          IN  OUT  VARCHAR2,      -- E' una stringa di 1 o 0/NULL, tanti quanti le colonne di ordinamento, separati da ",": 1 significa che l'ordinamento per la data colonna deve essere discendente anzichè ascendente (es: 1; 1,0; 1, )
1073                                                                                          -- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul verso di ordinamento una qualche preimpostazione di sistema/utente ecc.
1074                                        FlgSenzaPaginazioneIn     IN       PLS_INTEGER DEFAULT NULL,              -- (valori 1/0/NULL) Se 1 l'estrazione non è paginata, altrimenti sì
1075                                        NroPaginaIO               IN  OUT  PLS_INTEGER,    -- E' il numero della pagina da estrarre; se NULL e l'estrazione è paginata viene estratta la prima pagina
1076                                        BachSizeIO                IN  OUT  PLS_INTEGER,    -- Indica il massimo n.ro di record da estrarre se l'estrazione non è paginata (FlgSenzaPaginazioneIn=1)
1077                                                                                          -- Indica la dimensione (n.ro di record) della pagina se l'estrazione è paginata (FlgSenzaPaginazioneIn 0 o NULL) e in tal caso se non è valorizzato la dimensione della pagina è quella settata per l'utente di lavoro o è pari al valore del parametro STD_PAGE_NUM_ROW del dominio di lavoro
1078                                        OverFlowLimitIn           IN       PLS_INTEGER DEFAULT NULL,  -- E' il n.ro di record soddisfacenti la ricerca superato il quale la funzione deve restituire errore di overflow
1079                                        FlgSenzaTotIn             IN       PLS_INTEGER DEFAULT NULL,  -- (valori 1/0/NULL) Se 1 significa che non è richiesto come output il totale dei record soddisfacenti la ricerca (se la ricerca è paginata per la prima pagina il totale viene calcolato comunque, per le successive no)
1080                                        NroTotRecOut              OUT      PLS_INTEGER,              -- E' il n.ro di record complessivi trovati (valorizzato solo se FlgSenzaTotIn è 0 o NULL o se si estrae la prima pagina)
1081                                        NroRecInPaginaOut         OUT      PLS_INTEGER,              -- E' il numero di record nella pagina (valorizzato solo se l'estrazione è paginata, ovvero se FlgSenzaPaginazioneIn 0 o NULL)
1082                                        ------------- fine argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
1083        
1084                                         FlgBatchSearchIn         IN       PLS_INTEGER DEFAULT NULL,  -- (valori 1/0/NULL) Se 1 significa che la stored è utilizzata da un processo batch, altrimenti da un processo online.
1085                                                                                                      -- Serve affinchè in caso l'input OverFlowLimitIn non sia valorizzato vengano applicati i limiti di overflow per processo batch o online che sono parametri di configurazione del sistema.
1086                                         ColToReturnIn            IN       VARCHAR2 DEFAULT NULL,     -- Stringa con i n.ri delle colonne dell'XML di output ResultOut che si vuole siano presenti.
1087                                                                                                      -- Se la stringa è vuota saranno presenti tutte le colonne.
1088                                                                                                      -- La colonna 1 sarà presente comunque.
1089                                                                                                      -- I n.ri delle varie colonne vanno separati con , o ; e se si vuole indicare un intervallo di colonne gli estremi dell'intervallo vanno separati con - (es: "1-5;7;10" significa colonne da 1 a 5 più le colonne 7 e 10)
1090                                         ResultOut                OUT      NOCOPY CLOB,               -- Lista dei record trovati (XML conforme a schema LISTA_STD.xsd)
1091                                                                                                      -- Ogni record trovato è un tag Riga che può contenere le seguenti colonne:
1092                                                                                                      -- 1:  Descrizione società
1093                                                                                                      -- 2:  Anno
1094                                                                                                      -- 3:  Mese
1095                                                                                                      -- 4:  Numero documento
1096                                                                                                      -- 5:  Data invio
1097                                                                                                      -- 6:  Data reinvio
1098        
1099                                         ErrContextOut            OUT      VARCHAR2,                  -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
1100                                         ErrCodeOut               OUT      PLS_INTEGER,               -- N.ro errore di uscita
1101                                         ErrMsgOut                OUT      VARCHAR2                   -- Messaggio d'errore
1102              )
1103              return PLS_INTEGER;                                  -- 1 successo, 0 in caso di errore
1104        
1105         /******* funzione per visualizzare la lista delle notifiche ricevute da SDI rendicontate nel report FATTURAZIONE  ********/
1106          function TrovaReportFatturazNotifSDI(
1107                                        CodIdConnectionTokenIn    IN                      DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,   -- (obblig). Codice identificativo del token di connessione
1108                                        IdUserLavoroIn            IN                      DMT_USERS.ID_USER%type DEFAULT NULL,           -- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
1109                                        FiltriIO                  IN  OUT  NOCOPY CLOB,   -- XML contenente nomi e valori dei filtri di ricerca(conforme allo schema SezioneCache.xsd).
1110                                                                                          -- Ogni filtro è un tag "Variabile" dell'XML
1111                                                                                          -- I filtri che sono liste hanno nomi (tag Variabile/Nome) che iniziano con @.
1112                                                                                          -- I nomi dei filtri possibili sono:
1113                                                                                          -- Mese               : mese di riferimento  ( ricerca esatta )
1114                                                                                          -- Anno               : anno di riferimento  ( ricerca esatta )
1115                                                                                          -- CodApplOwner       : Serve a restringere la ricerca ai soli documenti e folder caricati a sistema dall'applicazione esterna qui specificata. Se è valorizzato a #BY_CONN_TKN significa l'applicazione da cui si è connessi
1116                                                                                          -- CodIstApplOwner    : Serve a restringere la ricerca ai soli documenti e folder caricati a sistema dall'istanza di applicazione esterna qui specificata. Se è valorizzato a #BY_CONN_TKN significa l'istanza di applicazione da cui si è connessi
1117        																				  -- TipoNotifica       : Uno dei seguenti valori :
1118        																				                      --  notifica di decorrenza termini
1119        																				                      --  notifica di file non recapitabile
1120        																				                      --  ricevuta di consegna
1121        																				                      --  notifica e ricevute
1122        																				                      --  notifica di scarto
1123        																				                      --  notifica esito
1124        
1125                                                                                          ------------- inizio argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
1126                                        ColOrderByIO              IN  OUT  VARCHAR2,      -- Indica il/i numeri della/e colonna dell'XML (CLOB ResultOut) di output per cui ordinare i record nell'XML stesso (si può ordinare solo per le colonne da 1 a xx). Se l'ordinamento è per più colonne queste vanno separate con "," (es: 2; 2,3)
1127                                                                                          -- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul tipo di ordinamento una qualche preimpostazione di sistema/utente ecc.
1128                                                                                          -- se non valorizzato (neppure in output) la lista di record restituita non è ordinata
1129                                        FlgDescOrderByIO          IN  OUT  VARCHAR2,      -- E' una stringa di 1 o 0/NULL, tanti quanti le colonne di ordinamento, separati da ",": 1 significa che l'ordinamento per la data colonna deve essere discendente anzichè ascendente (es: 1; 1,0; 1, )
1130                                                                                          -- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul verso di ordinamento una qualche preimpostazione di sistema/utente ecc.
1131                                        FlgSenzaPaginazioneIn     IN       PLS_INTEGER DEFAULT NULL,              -- (valori 1/0/NULL) Se 1 l'estrazione non è paginata, altrimenti sì
1132                                        NroPaginaIO               IN  OUT  PLS_INTEGER,    -- E' il numero della pagina da estrarre; se NULL e l'estrazione è paginata viene estratta la prima pagina
1133                                        BachSizeIO                IN  OUT  PLS_INTEGER,    -- Indica il massimo n.ro di record da estrarre se l'estrazione non è paginata (FlgSenzaPaginazioneIn=1)
1134                                                                                          -- Indica la dimensione (n.ro di record) della pagina se l'estrazione è paginata (FlgSenzaPaginazioneIn 0 o NULL) e in tal caso se non è valorizzato la dimensione della pagina è quella settata per l'utente di lavoro o è pari al valore del parametro STD_PAGE_NUM_ROW del dominio di lavoro
1135                                        OverFlowLimitIn           IN       PLS_INTEGER DEFAULT NULL,  -- E' il n.ro di record soddisfacenti la ricerca superato il quale la funzione deve restituire errore di overflow
1136                                        FlgSenzaTotIn             IN       PLS_INTEGER DEFAULT NULL,  -- (valori 1/0/NULL) Se 1 significa che non è richiesto come output il totale dei record soddisfacenti la ricerca (se la ricerca è paginata per la prima pagina il totale viene calcolato comunque, per le successive no)
1137                                        NroTotRecOut              OUT      PLS_INTEGER,              -- E' il n.ro di record complessivi trovati (valorizzato solo se FlgSenzaTotIn è 0 o NULL o se si estrae la prima pagina)
1138                                        NroRecInPaginaOut         OUT      PLS_INTEGER,              -- E' il numero di record nella pagina (valorizzato solo se l'estrazione è paginata, ovvero se FlgSenzaPaginazioneIn 0 o NULL)
1139                                        ------------- fine argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
1140        
1141                                         FlgBatchSearchIn         IN       PLS_INTEGER DEFAULT NULL,  -- (valori 1/0/NULL) Se 1 significa che la stored è utilizzata da un processo batch, altrimenti da un processo online.
1142                                                                                                      -- Serve affinchè in caso l'input OverFlowLimitIn non sia valorizzato vengano applicati i limiti di overflow per processo batch o online che sono parametri di configurazione del sistema.
1143                                         ColToReturnIn            IN       VARCHAR2 DEFAULT NULL,     -- Stringa con i n.ri delle colonne dell'XML di output ResultOut che si vuole siano presenti.
1144                                                                                                      -- Se la stringa è vuota saranno presenti tutte le colonne.
1145                                                                                                      -- La colonna 1 sarà presente comunque.
1146                                                                                                      -- I n.ri delle varie colonne vanno separati con , o ; e se si vuole indicare un intervallo di colonne gli estremi dell'intervallo vanno separati con - (es: "1-5;7;10" significa colonne da 1 a 5 più le colonne 7 e 10)
1147                                         ResultOut                OUT      NOCOPY CLOB,               -- Lista dei record trovati (XML conforme a schema LISTA_STD.xsd)
1148                                                                                                      -- Ogni record trovato è un tag Riga che può contenere le seguenti colonne:
1149                                                                                                      -- 1:  Descrizione società
1150                                                                                                      -- 2:  Anno
1151                                                                                                      -- 3:  Mese
1152                                                                                                      -- 4:  Numero documento
1153                                                                                                      -- 5:  Data arrivo
1154        
1155                                         ErrContextOut            OUT      VARCHAR2,                  -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
1156                                         ErrCodeOut               OUT      PLS_INTEGER,               -- N.ro errore di uscita
1157                                         ErrMsgOut                OUT      VARCHAR2                   -- Messaggio d'errore
1158              )
1159              return PLS_INTEGER;                                  -- 1 successo, 0 in caso di errore
1160        
1161          /******* funzione per ricercare i dati per il report KPI  ********/
1162          function TrovaReportKpi(
1163                                        CodIdConnectionTokenIn    IN                      DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,   -- (obblig). Codice identificativo del token di connessione
1164                                        IdUserLavoroIn            IN                      DMT_USERS.ID_USER%type DEFAULT NULL,           -- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
1165                                        FiltriIO                  IN OUT  NOCOPY CLOB,    -- XML contenente nomi e valori dei filtri di ricerca(conforme allo schema SezioneCache.xsd).
1166                                                                                          -- Ogni filtro è un tag "Variabile" dell'XML
1167                                                                                          -- I filtri che sono liste hanno nomi (tag Variabile/Nome) che iniziano con @.
1168                                                                                          -- I nomi dei filtri possibili sono:
1169                                                                                          -- Mese               : mese di riferimento  ( ricerca esatta )
1170                                                                                          -- Anno               : anno di riferimento  ( ricerca esatta )
1171                                                                                          -- CodApplOwner        : Serve a restringere la ricerca ai soli documenti e folder caricati a sistema dall'applicazione esterna qui specificata. Se è valorizzato a #BY_CONN_TKN significa l'applicazione da cui si è connessi
1172                                                                                          -- CodIstApplOwner    : Serve a restringere la ricerca ai soli documenti e folder caricati a sistema dall'istanza di applicazione esterna qui specificata. Se è valorizzato a #BY_CONN_TKN significa l'istanza di applicazione da cui si è connessi
1173        
1174                                                                                           ------------- inizio argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
1175                                        ColOrderByIO              IN OUT  VARCHAR2,        -- Indica il/i numeri della/e colonna dell'XML (CLOB ResultOut) di output per cui ordinare i record nell'XML stesso (si può ordinare solo per le colonne da 1 a xx). Se l'ordinamento è per più colonne queste vanno separate con "," (es: 2; 2,3)
1176                                                                                          -- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul tipo di ordinamento una qualche preimpostazione di sistema/utente ecc.
1177                                                                                          -- se non valorizzato (neppure in output) la lista di record restituita non è ordinata
1178                                        FlgDescOrderByIO          IN OUT  VARCHAR2,        -- E' una stringa di 1 o 0/NULL, tanti quanti le colonne di ordinamento, separati da ",": 1 significa che l'ordinamento per la data colonna deve essere discendente anzichè ascendente (es: 1; 1,0; 1, )
1179                                                                                          -- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul verso di ordinamento una qualche preimpostazione di sistema/utente ecc.
1180                                        FlgSenzaPaginazioneIn     IN       PLS_INTEGER DEFAULT NULL,              -- (valori 1/0/NULL) Se 1 l'estrazione non è paginata, altrimenti sì
1181                                        NroPaginaIO                IN OUT  PLS_INTEGER,    -- E' il numero della pagina da estrarre; se NULL e l'estrazione è paginata viene estratta la prima pagina
1182                                        BachSizeIO                IN OUT  PLS_INTEGER,    -- Indica il massimo n.ro di record da estrarre se l'estrazione non è paginata (FlgSenzaPaginazioneIn=1)
1183                                                                                          -- Indica la dimensione (n.ro di record) della pagina se l'estrazione è paginata (FlgSenzaPaginazioneIn 0 o NULL) e in tal caso se non è valorizzato la dimensione della pagina è quella settata per l'utente di lavoro o è pari al valore del parametro STD_PAGE_NUM_ROW del dominio di lavoro
1184                                        OverFlowLimitIn            IN      PLS_INTEGER DEFAULT NULL,  -- E' il n.ro di record soddisfacenti la ricerca superato il quale la funzione deve restituire errore di overflow
1185                                        FlgSenzaTotIn              IN      PLS_INTEGER DEFAULT NULL,  -- (valori 1/0/NULL) Se 1 significa che non è richiesto come output il totale dei record soddisfacenti la ricerca (se la ricerca è paginata per la prima pagina il totale viene calcolato comunque, per le successive no)
1186                                        NroTotRecOut              OUT      PLS_INTEGER,              -- E' il n.ro di record complessivi trovati (valorizzato solo se FlgSenzaTotIn è 0 o NULL o se si estrae la prima pagina)
1187                                        NroRecInPaginaOut         OUT     PLS_INTEGER,              -- E' il numero di record nella pagina (valorizzato solo se l'estrazione è paginata, ovvero se FlgSenzaPaginazioneIn 0 o NULL)
1188                                        ------------- fine argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
1189        
1190                                         FlgBatchSearchIn          IN      PLS_INTEGER DEFAULT NULL,  -- (valori 1/0/NULL) Se 1 significa che la stored è utilizzata da un processo batch, altrimenti da un processo online.
1191                                                                                                    -- Serve affinchè in caso l'input OverFlowLimitIn non sia valorizzato vengano applicati i limiti di overflow per processo batch o online che sono parametri di configurazione del sistema.
1192                                         ColToReturnIn              IN      VARCHAR2 DEFAULT NULL,    -- Stringa con i n.ri delle colonne dell'XML di output ResultOut che si vuole siano presenti.
1193                                                                                                      -- Se la stringa è vuota saranno presenti tutte le colonne.
1194                                                                                                      -- La colonna 1 sarà presente comunque.
1195                                                                                                      -- I n.ri delle varie colonne vanno separati con , o ; e se si vuole indicare un intervallo di colonne gli estremi dell'intervallo vanno separati con - (es: "1-5;7;10" significa colonne da 1 a 5 più le colonne 7 e 10)
1196                                         ResultOut                  OUT      NOCOPY CLOB,             -- Lista dei record trovati (XML conforme a schema LISTA_STD.xsd)
1197                                                                                                      -- Ogni record trovato è un tag Riga che può contenere le seguenti colonne:
1198                                                                                                      -- 1:  Descrizione società
1199                                                                                                      -- 2:  Anno
1200                                                                                                      -- 3:  Mese
1201                                                                                                      -- 4:  Nr. totale doc conteggiati
1202                                                                                                      -- 5:  Nr. totale doc in errore
1203                                                                                                      -- 6:  Nr. totale doc doppi
1204                                         ErrContextOut              OUT      VARCHAR2,                  -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
1205                                         ErrCodeOut                OUT      PLS_INTEGER,              -- N.ro errore di uscita
1206                                         ErrMsgOut                  OUT     VARCHAR2                  -- Messaggio d'errore
1207              )
1208              return PLS_INTEGER;
1209        
1210            /******* funzione per ricercare i dati per il report SLA  ********/
1211          function TrovaReportSla(
1212                                        CodIdConnectionTokenIn    IN                      DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,   -- (obblig). Codice identificativo del token di connessione
1213                                        IdUserLavoroIn            IN                      DMT_USERS.ID_USER%type DEFAULT NULL,           -- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
1214                                        TipoSlaIn                 in varchar2,            -- Tipo di sla da calcolare. Valori possibili :   EFACT_DOC_LOTTO_EVENTO_ARCH_FILE
1215                                        MaxSlaOreIn               in number,
1216                                        FiltriIO                  IN OUT  NOCOPY CLOB,    -- XML contenente nomi e valori dei filtri di ricerca(conforme allo schema SezioneCache.xsd).
1217                                                                                          -- Ogni filtro è un tag "Variabile" dell'XML
1218                                                                                          -- I filtri che sono liste hanno nomi (tag Variabile/Nome) che iniziano con @.
1219                                                                                          -- I nomi dei filtri possibili sono:
1220                                                                                          -- Mese              : mese di riferimento  ( ricerca esatta )
1221                                                                                          -- Anno              : anno di riferimento  ( ricerca esatta )
1222                                                                                          -- CodApplOwner       : Serve a restringere la ricerca ai soli documenti e folder caricati a sistema dall'applicazione esterna qui specificata. Se è valorizzato a #BY_CONN_TKN significa l'applicazione da cui si è connessi
1223                                                                                          -- CodIstApplOwner   : Serve a restringere la ricerca ai soli documenti e folder caricati a sistema dall'istanza di applicazione esterna qui specificata. Se è valorizzato a #BY_CONN_TKN significa l'istanza di applicazione da cui si è connessi
1224                                                                                          ------------- inizio argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
1225                                        ColOrderByIO              IN OUT  VARCHAR2,       -- Indica il/i numeri della/e colonna dell'XML (CLOB ResultOut) di output per cui ordinare i record nell'XML stesso (si può ordinare solo per le colonne da 1 a xx). Se l'ordinamento è per più colonne queste vanno separate con "," (es: 2; 2,3)
1226                                                                                          -- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul tipo di ordinamento una qualche preimpostazione di sistema/utente ecc.
1227                                                                                          -- se non valorizzato (neppure in output) la lista di record restituita non è ordinata
1228                                        FlgDescOrderByIO          IN OUT  VARCHAR2,       -- E' una stringa di 1 o 0/NULL, tanti quanti le colonne di ordinamento, separati da ",": 1 significa che l'ordinamento per la data colonna deve essere discendente anzichè ascendente (es: 1; 1,0; 1, )
1229                                                                                          -- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul verso di ordinamento una qualche preimpostazione di sistema/utente ecc.
1230                                        FlgSenzaPaginazioneIn     IN      PLS_INTEGER DEFAULT NULL,              -- (valori 1/0/NULL) Se 1 l'estrazione non è paginata, altrimenti sì
1231                                        NroPaginaIO               IN OUT  PLS_INTEGER,    -- E' il numero della pagina da estrarre; se NULL e l'estrazione è paginata viene estratta la prima pagina
1232                                        BachSizeIO                IN OUT  PLS_INTEGER,    -- Indica il massimo n.ro di record da estrarre se l'estrazione non è paginata (FlgSenzaPaginazioneIn=1)
1233                                                                                          -- Indica la dimensione (n.ro di record) della pagina se l'estrazione è paginata (FlgSenzaPaginazioneIn 0 o NULL) e in tal caso se non è valorizzato la dimensione della pagina è quella settata per l'utente di lavoro o è pari al valore del parametro STD_PAGE_NUM_ROW del dominio di lavoro
1234                                        OverFlowLimitIn            IN     PLS_INTEGER DEFAULT NULL,  -- E' il n.ro di record soddisfacenti la ricerca superato il quale la funzione deve restituire errore di overflow
1235                                        FlgSenzaTotIn              IN     PLS_INTEGER DEFAULT NULL,  -- (valori 1/0/NULL) Se 1 significa che non è richiesto come output il totale dei record soddisfacenti la ricerca (se la ricerca è paginata per la prima pagina il totale viene calcolato comunque, per le successive no)
1236                                        NroTotRecOut              OUT     PLS_INTEGER,              -- E' il n.ro di record complessivi trovati (valorizzato solo se FlgSenzaTotIn è 0 o NULL o se si estrae la prima pagina)
1237                                        NroRecInPaginaOut         OUT     PLS_INTEGER,              -- E' il numero di record nella pagina (valorizzato solo se l'estrazione è paginata, ovvero se FlgSenzaPaginazioneIn 0 o NULL)
1238                                        ------------- fine argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
1239        
1240                                         FlgBatchSearchIn          IN     PLS_INTEGER DEFAULT NULL,  -- (valori 1/0/NULL) Se 1 significa che la stored è utilizzata da un processo batch, altrimenti da un processo online.
1241                                                                                                    -- Serve affinchè in caso l'input OverFlowLimitIn non sia valorizzato vengano applicati i limiti di overflow per processo batch o online che sono parametri di configurazione del sistema.
1242                                         ColToReturnIn              IN    VARCHAR2 DEFAULT NULL,    -- Stringa con i n.ri delle colonne dell'XML di output ResultOut che si vuole siano presenti.
1243                                                                                                    -- Se la stringa è vuota saranno presenti tutte le colonne.
1244                                                                                                    -- La colonna 1 sarà presente comunque.
1245                                                                                                    -- I n.ri delle varie colonne vanno separati con , o ; e se si vuole indicare un intervallo di colonne gli estremi dell'intervallo vanno separati con - (es: "1-5;7;10" significa colonne da 1 a 5 più le colonne 7 e 10)
1246                                         ResultOut                  OUT    NOCOPY CLOB,             -- Lista dei record trovati (XML conforme a schema LISTA_STD.xsd)
1247                                                                                                    -- Ogni record trovato è un tag Riga che può contenere le seguenti colonne:
1248                                                                                                    -- 1:  Descrizione società
1249                                                                                                    -- 2:  Anno
1250                                                                                                    -- 3:  Mese
1251                                                                                                    -- 4:  Nr. oggetti OK
1252                                                                                                    -- 5:  Nr. oggetti KO
1253                                                                                                    -- 6:  Nr. oggetti totali
1254                                                                                                    -- 7:  Percentuale oggetti OK
1255                                         ErrContextOut              OUT   VARCHAR2,                 -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
1256                                         ErrCodeOut                 OUT   PLS_INTEGER,              -- N.ro errore di uscita
1257                                         ErrMsgOut                  OUT   VARCHAR2                  -- Messaggio d'errore
1258              )
1259              return PLS_INTEGER;
1260        
1261          /******* funzione per ricercare il dettaglio del report SLA  ********/
1262          function TrovaReportSlaDettaglio(
1263                                        CodIdConnectionTokenIn    IN                      DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,   -- (obblig). Codice identificativo del token di connessione
1264                                        IdUserLavoroIn            IN                      DMT_USERS.ID_USER%type DEFAULT NULL,           -- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
1265                                        IdSpAooIn                 IN dmt_log_job_caricamenti_file.ID_SP_AOO%type,
1266                                        CodApplOwnerIn            IN dmt_log_job_caricamenti_file.cod_appl_owner%type,
1267                                        CodIstApplOwnerIn         IN dmt_log_job_caricamenti_file.cod_ist_appl_owner%type,
1268                                        AnnoIn                    IN number,
1269                                        MeseIn                    IN number,
1270                                        TipoSlaIn                 IN varchar2,
1271                                        MaxSlaOreIn               in number,
1272                                        DatiXMLOut                OUT        NOCOPY CLOB,      -- Dati di dettaglio XML conforme a schema SezioneCache.xsd)
1273                                                                                               -- I dati restituiti corrispondono ai seguenti tag Variabile:
1274        
1275                                                                                               -- #DescrizioneSocieta     : Descrizione società
1276                                                                                               -- #Anno                   : Anno
1277                                                                                               -- #Mese                   : Mese
1278                                                                                               -- #NrOggettiOk            : Nr. oggetti OK
1279                                                                                               -- #NrOggettiKo            : Nr. oggetti KO
1280                                                                                               -- #NrOggettiTotali        : Nr. oggetti totali
1281                                                                                               -- #PercOggettiOk          : Percentuale oggetti OK
1282                                                                                               -- @ListaOggettiSla, lista con le seguenti colonne:
1283        
1284                                                                                                -- 1:  Id. (PK)
1285                                                                                                -- 2:  Anno
1286                                                                                                -- 3:  Mese
1287                                                                                                -- 4:  Id Lotto
1288                                                                                                -- 5:  Nome lotto
1289                                                                                                -- 6:  Id Doc. lotto
1290                                                                                                -- 7:  Data inizio evento
1291                                                                                                -- 8:  Data fine evento
1292                                                                                                -- 9:  Data inizio SLA
1293                                                                                                --10:  Data fine SLA
1294                                                                                                --11:  Durata evento
1295                                                                                                --12:  Esito SLA
1296        
1297                                         ErrContextOut              OUT   VARCHAR2,                 -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
1298                                         ErrCodeOut                 OUT   PLS_INTEGER,              -- N.ro errore di uscita
1299                                         ErrMsgOut                  OUT   VARCHAR2                  -- Messaggio d'errore
1300              )
1301              return PLS_INTEGER;
1302        
1303          /***** Funzione per aggiornare il campo id_email_notifica della dmt_lotti_documenti  *****/
1304          function UpdateIdMailNotifica(
1305                                        CodIdConnectionTokenIn           IN          DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,  -- (obblig). Codice identificativo del token di connessione
1306                                        IdUserLavoroIn                   IN          DMT_USERS.ID_USER%type DEFAULT NULL,            -- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
1307                                        IdLottoIn                        IN          VARCHAR2,                                       -- (obblig) id del lotto.
1308                                        IdEmailNotificaIn                IN          VARCHAR2,                                       -- Id email di notifica
1309                                        FlgRollBckFullIn                 IN          PLS_INTEGER DEFAULT NULL,                       -- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
1310                                        FlgAutoCommitIn                  IN          PLS_INTEGER DEFAULT NULL,                       -- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
1311                                        ErrContextOut                    OUT         VARCHAR2,                                       -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
1312                                        ErrCodeOut                       OUT         PLS_INTEGER,                                    -- N.ro errore di uscita
1313                                        ErrMsgOut                        OUT         VARCHAR2                                        -- Messaggio d'errore
1314                                      ) return PLS_INTEGER;
1315        
1316        
1317          /***** Restituisce gli stati di una mail associata ad una unità documentaria  *****/
1318          -- Gli stati restituiti sono :
1319          -- StatoConsolidamento 	    : Descrizione dello stato di consolidamento della e-mail inviata.
1320          --					                  Valori possibili: accettata; non accettata; avvertimenti in consegna, errori in consegna, consegnata, consegnata parzialmente, protocollazione confermata, protocollazione parzialmente confermata
1321          function GetStatoEmailUd(
1322             			                 CodIdConnectionTokenIn		     IN		DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%type,    -- (obblig). Codice identificativo del token di connessione
1323        			                     IdUserLavoroIn				         IN		DMT_USERS.ID_USER%type DEFAULT NULL,              -- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
1324        			                     IdUDIn   					           IN   DMT_UNITA_DOC.ID_UD%type,			              -- (obblig.) Identificativo dell'unità documentaria (registrata o meno a protocollo) inviata via e-mail
1325                                   StatoConsolidamentoOut        OUT  VARCHAR2,                                         -- Descrizione dello stato di consolidamento per le e-mail inviate.
1326                                   ErrContextOut                 OUT  VARCHAR2,             -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
1327                                   ErrCodeOut                    OUT  PLS_INTEGER,          -- N.ro errore di uscita
1328                                   ErrMsgOut                     OUT  VARCHAR2)             -- Messaggio d'errore
1329                                   return PLS_INTEGER;                                      -- Restituisce 1 (successo) in caso la variabile sia stata trovata nessuna o una ed una sola volta come variabile semplice, altrimenti 0
1330        
1331        
1332        
1333        
1334              /***** Funzione per estrarre i CID e BA  *****/
1335          function TrovaCidBa(
1336                                        CodIdConnectionTokenIn           IN          DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,  -- (obblig). Codice identificativo del token di connessione
1337                                        IdUserLavoroIn                   IN          DMT_USERS.ID_USER%type DEFAULT NULL,            -- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
1338        								DesSocietaIn					 IN          VARCHAR2,										 -- 1° filtro di ricerca: Descrizione della societa
1339                                        CidIn                            IN          VARCHAR2,                                       -- 2° filtro di ricerca: Cid da trovare con tutti i suoi BA.
1340                                        BaIn                             IN          VARCHAR2,                                       -- 3° filtro di ricerca: BA da trovare.
1341                                        DesClienteIn                     IN          VARCHAR2,                                       -- 4° filtro di ricerca: Denominazione del cliente da trovare.
1342                                        CFIn                             IN          VARCHAR2,                                       -- 5° filtro di ricerca: CF del cliente da trovare.
1343                                        PIVAIn                           IN          VARCHAR2,                                       -- 6° filtro di ricerca: PIVA da trovare.
1344        								GruppoRifIn				         IN			 VARCHAR2,										 -- 7° filtro di ricerca: Gruppo di riferimento
1345                                        FlgSenzaPaginazioneIn            IN PLS_INTEGER DEFAULT NULL,               -- (valori 1/0/NULL) Se 1 l'estrazione non è paginata, altrimenti sì
1346                                        NroPaginaIO                      IN OUT    PLS_INTEGER,                     -- E' il numero della pagina da estrarre; se NULL e l'estrazione è paginata viene estratta la prima pagina
1347                                        BachSizeIO                       IN OUT    PLS_INTEGER,                     -- Indica il massimo n.ro di record da estrarre se l'estrazione non è paginata (FlgSenzaPaginazioneIn=1)
1348                                                                                                                    -- Indica la dimensione (n.ro di record) della pagina se l'estrazione è paginata (FlgSenzaPaginazioneIn 0 o NULL) e in tal caso se non è valorizzato la dimensione della pagina è quella settata per l'utente di lavoro o è pari al valore del parametro STD_PAGE_NUM_ROW del dominio di lavoro
1349                                        OverFlowLimitIn                  IN    PLS_INTEGER DEFAULT NULL,            -- E' il n.ro di record soddisfacenti la ricerca superato il quale la funzione deve restituire errore di overflow
1350                                        FlgSenzaTotIn                    IN    PLS_INTEGER DEFAULT NULL,            -- (valori 1/0/NULL) Se 1 significa che non è richiesto come output il totale dei record soddisfacenti la ricerca (se la ricerca è paginata per la prima pagina il totale viene calcolato comunque, per le successive no)
1351                                        NroTotRecOut                     OUT PLS_INTEGER,                           -- E' il n.ro di record complessivi trovati (valorizzato solo se FlgSenzaTotIn è 0 o NULL o se si estrae la prima pagina)
1352                                        NroRecInPaginaOut                OUT PLS_INTEGER,                           -- E' il numero di record nella pagina (valorizzato solo se l'estrazione è paginata, ovvero se FlgSenzaPaginazioneIn 0 o NULL)
1353        
1354                                        ResultOut                        OUT         NOCOPY CLOB,               -- Lista dei record trovati (XML conforme a schema LISTA_STD.xsd)
1355                                                                                                                -- La lista è strutturata in modo che la prima riga ruiporta solo il CID
1356                                                                                                                -- e, dato il CID, ogni riga successiva contiene i  record relativi ai BA (il CID è cmq ripetuto in ogni riga)
1357                                                                                                                -- 1 id_sogg_rubrica, id del soggetto in rubrica
1358                                                                                                                -- 2 id_cliente, id del cliente
1359                                                                                                                -- 3 denominazione,
1360                                                                                                                -- 4 CID,
1361                                                                                                                -- 5 BA,
1362                                                                                                                -- 6 IPA,
1363                                                                                                                -- 7 CIG,
1364                                                                                                                -- 8 CUP,
1365                                                                                                                -- 9 CONTRATTO,
1366                                                                                                                --10 PIVA_CF,
1367                                                                                                                --11 CF,
1368                                                                                                                --12 PIVA,
1369                                                                                                                --13 INDPA,
1370                                                                                                                --14 RIF_AMM_INPS,
1371                                                                                                                --15 POS_FIN,
1372                                                                                                                --16 ANN_FIN,
1373                                                                                                                --17 COD_RE,
1374                                                                                                                --18 REND_RE,
1375                                                                                                                --19 ESIGIBILITA_IVA,
1376                                                                                                                --20 FLG_SEGNO_IMPORTI
1377        																										--21 SOCIETA
1378        																										--22 COD_GRUPPO_RIF
1379                                        FlgRollBckFullIn                 IN          PLS_INTEGER DEFAULT NULL,                       -- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
1380                                        FlgAutoCommitIn                  IN          PLS_INTEGER DEFAULT NULL,                       -- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
1381                                        ErrContextOut                    OUT         VARCHAR2,                                       -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
1382                                        ErrCodeOut                       OUT         PLS_INTEGER,                                    -- N.ro errore di uscita
1383                                        ErrMsgOut                        OUT         VARCHAR2                                        -- Messaggio d'errore
1384                                      ) return PLS_INTEGER;
1385        
1386        /***** Funzione per inserire o aggiornare il log di una registrazione di consenso  *****/
1387          function IULogRegistrazioneConsenso(
1388                                             CodIdConnectionTokenIn           IN          DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,          -- (obblig). Codice identificativo del token di connessione
1389                                             IdUserLavoroIn                   IN          DMT_USERS.ID_USER%type DEFAULT NULL,                    -- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
1390                   		                       IdLogRegConsensoIO               IN OUT      DMT_LOG_REG_CONSENSI.ID_LOG_REG_CONSENSO%type,          -- Identificativo PK del record da modificare. Se non è valorizzato è da inserire ex-novo
1391        
1392                                             IdDestinatarioIn                 IN          DMT_LOG_REG_CONSENSI.ID_DESTINATARIO%TYPE,
1393                                             CodDestinatarioIn                IN          DMT_LOG_REG_CONSENSI.COD_DESTINATARIO%TYPE,
1394                                             RagSocialeDestinatarioIn         IN          DMT_LOG_REG_CONSENSI.RAG_SOCIALE_DESTINATARIO%TYPE,
1395                                             CfPivaDestinatarioIn             IN          DMT_LOG_REG_CONSENSI.CF_PIVA_DESTINATARIO%TYPE,
1396                                             EmailDestinatarioIn              IN          DMT_LOG_REG_CONSENSI.EMAIL_DESTINATARIO%TYPE,
1397                                             TelefonoDestinatarioIn           IN          DMT_LOG_REG_CONSENSI.TEL_DESTINATARIO%TYPE,
1398                                             NomeRifDestinatarioIn            IN          DMT_LOG_REG_CONSENSI.NOME_RIF_DESTINATARIO%TYPE,
1399                                             TsRichiestaIn                    IN          VARCHAR2,
1400                                             EsitoRichiestIn                  IN          DMT_LOG_REG_CONSENSI.ESITO_RICHIESTA%TYPE,
1401        
1402                              			         AttributiAddIn			              IN		      CLOB DEFAULT NULL,		-- Attributi addizionali. XML contenente nomi e valori degli attributi dinamici da aggiornare (conforme allo schema SezioneCache.xsd)
1403                                                     																	                          -- Gli attributi già presenti in DB e per i quali non c'è corrispondente nell'XML restano invariati
1404        																	                        										                          -- Per tutti gli attributi vale quanto segue:
1405        										                          																	                        -- Un attributo da settare è un tag "Variabile" dell'XML il cui tag "Nome" contiene il nome identificativo dell'attributo (ATTR_NAME di DMT_ATTRIBUTES_DEF)
1406        																	            										                                      -- Un attributo da settare è una variabile con tag "ValoreSemplice" se è un attributo a singolo valore e non strutturato (cioè con tipo diverso da COMPLEX)
1407        										                          																	                        -- altrimenti è una variabile con tag "Lista" che ha un'unica colonna con "Nro" pari a 1 se l'attributo non è strutturato, che ha invece tante colonne quanti gli attributi componenti (ordinate in base al loro NRO_ORD_IN_SUP) se l'attributo è complesso
1408        																	            										                                      -- Nel caso di variabili con tag "Lista" i valori specificati nell'XML si aggiungono o sostituiscono quelli già presenti in DB a seconda che nell'XML sia presente o meno una variabile con tag "Nome" pari a #Append_<Nome attributo> e tag "ValoreSemplice" pari a 1
1409        										                          																	                        -- In particolare se non sono specificati valori nell'XML (tag Lista vuoto) e se i valori non sono da aggiungere significa che tutti i valori dell'attributo già presenti in DB vanno rimossi
1410        
1411                                             FlgAnnullatoIn                   IN          PLS_INTEGER DEFAULT null,     -- (valori 1/0/NULL) Indicatore per annullare il record
1412                                             FlgLockedIn                      IN          PLS_INTEGER DEFAULT null,     -- (valori 1/0/NULL) Indicatore di tipo di documento riservato dal sistema e non modificabile/cancellabile da GUI
1413                                             FlgIgnoreWarningIn               IN          PLS_INTEGER DEFAULT NULL,     -- (valori 1/0/NULL) Se 0 o NULL significa che in presenza di WARNING la stored si comporta come in caso di errore; se 1 gli WARNING vengono ignorati
1414                                             FlgRollBckFullIn                 IN          PLS_INTEGER DEFAULT NULL,     -- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
1415                                                                                                                        -- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
1416                                             FlgAutoCommitIn                  IN          PLS_INTEGER DEFAULT NULL,     -- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
1417                                             WarningMsgOut                    OUT         VARCHAR2,                     -- Messaggio di warning (valorizzato solo se non c'è errore)
1418                                             ErrContextOut                    OUT         VARCHAR2,                     -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
1419                                             ErrCodeOut                       OUT         PLS_INTEGER,                  -- N.ro errore di uscita
1420                                             ErrMsgOut                        OUT         VARCHAR2                      -- Messaggio d'errore
1421                             ) return PLS_INTEGER;
1422        
1423         /******* funzione per ricercare i log delle registrazioni di consenso  ********/
1424          function TrovaLogRegistrazioneConsenso(
1425                                                 CodIdConnectionTokenIn    IN                      DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,   -- (obblig). Codice identificativo del token di connessione
1426                                                 IdUserLavoroIn            IN                      DMT_USERS.ID_USER%type DEFAULT NULL,           -- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
1427        
1428                                                 FiltriIO                  IN OUT  NOCOPY CLOB,    -- XML contenente nomi e valori dei filtri di ricerca(conforme allo schema SezioneCache.xsd).
1429                                                                                                   -- Ogni filtro è un tag "Variabile" dell'XML
1430                                                                                                   -- I filtri che sono liste hanno nomi (tag Variabile/Nome) che iniziano con @.
1431                                                                                                   -- I nomi dei filtri possibili sono:
1432                                                                                                   -- IdLogRegConsenso       : id del log                          ( ricerca esatta )
1433                                                                                                   -- CodDestinatario        : Codice del destinatario             (ricerca case-insensitive in like)
1434                                                                                                   -- RagSocialeDestinatario : ragione sociale del destinatario    (ricerca case-insensitive in like)
1435                                                                                                   -- EsitoRichiesta         : Esito richiesta ( A=Accetata, D=Doppia , E=Errata )
1436                                                                                                   -- DataRichiestaDa        : estremo inferiore della data di richiesta
1437                                                                                                   -- DataRichiestaA         : estremo superiore della data di richiesta
1438                                                 ------------- inizio argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
1439                                                 FlgSenzaPaginazioneIn     IN       PLS_INTEGER DEFAULT NULL,              -- (valori 1/0/NULL) Se 1 l'estrazione non è paginata, altrimenti sì
1440                                                 NroPaginaIO                IN OUT  PLS_INTEGER,    -- E' il numero della pagina da estrarre; se NULL e l'estrazione è paginata viene estratta la prima pagina
1441                                                 BachSizeIO                IN OUT  PLS_INTEGER,    -- Indica il massimo n.ro di record da estrarre se l'estrazione non è paginata (FlgSenzaPaginazioneIn=1)
1442                                                                                                   -- Indica la dimensione (n.ro di record) della pagina se l'estrazione è paginata (FlgSenzaPaginazioneIn 0 o NULL) e in tal caso se non è valorizzato la dimensione della pagina è quella settata per l'utente di lavoro o è pari al valore del parametro STD_PAGE_NUM_ROW del dominio di lavoro
1443                                                 OverFlowLimitIn            IN      PLS_INTEGER DEFAULT NULL,  -- E' il n.ro di record soddisfacenti la ricerca superato il quale la funzione deve restituire errore di overflow
1444                                                 FlgSenzaTotIn              IN      PLS_INTEGER DEFAULT NULL,  -- (valori 1/0/NULL) Se 1 significa che non è richiesto come output il totale dei record soddisfacenti la ricerca (se la ricerca è paginata per la prima pagina il totale viene calcolato comunque, per le successive no)
1445                                                 NroTotRecOut              OUT      PLS_INTEGER,              -- E' il n.ro di record complessivi trovati (valorizzato solo se FlgSenzaTotIn è 0 o NULL o se si estrae la prima pagina)
1446                                                 NroRecInPaginaOut         OUT     PLS_INTEGER,              -- E' il numero di record nella pagina (valorizzato solo se l'estrazione è paginata, ovvero se FlgSenzaPaginazioneIn 0 o NULL)
1447                                                 ------------- fine argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
1448        
1449                                                 FlgBatchSearchIn          IN      PLS_INTEGER DEFAULT NULL,  -- (valori 1/0/NULL) Se 1 significa che la stored è utilizzata da un processo batch, altrimenti da un processo online.
1450                                                                                                               -- Serve affinchè in caso l'input OverFlowLimitIn non sia valorizzato vengano applicati i limiti di overflow per processo batch o online che sono parametri di configurazione del sistema.
1451                                                 ResultOut                  OUT      NOCOPY CLOB,             -- Lista dei record trovati (XML conforme a schema LISTA_STD.xsd)
1452                                                                                                               -- Ogni record trovato è un tag Riga che può contenere le seguenti colonne:
1453                                                                                                               --  1:  Id. (PK)
1454        				                                                       																			   --  2:  Id destinatario
1455                                                                                                               --  3:  Codice destinatario
1456                                                                                                               --  4:  Ragione sociale destinatario
1457                                                                                                               --  5:  Cf/Piva destinatario
1458                                                                                                               --  6:  Email destinatario
1459                                                                                                               --  7:  Telefono destinatario
1460        																						                                                        	 --  8:  Riferimento destinatario
1461        																							                                                      	 --  9:  Data richieata ( dd/mm/yyyy hh:mi:ss )
1462                                                            	 																							   -- 10:  Esito richiesta ( A=Accetata, D=Doppia , E=Errata )
1463                                                                                                      			   -- 11:  Id utente che ha inserito il record
1464        			                                                                                                 -- 12:  Descrizione utente che ha inserito il record
1465                			                                                                                         -- 13:  Ts inserimento record
1466                        			                                                                                 -- 14:  Id utente che ha effettuato ultima modifica sul record.
1467                                			                                                                         -- 15:  Descrizione utente che ha effettuato ultima modifica sul record.
1468                                        			                                                                 -- 16:  Ts ultima modifica
1469                                                			                                                         -- 17:  (valori 1/0) flgAnnullato     :  valido (=0) o logicamente annullato (=1)
1470                                                        			                                                 -- 18:  (valori 1/0) flgValido     : Flag di validità
1471                                         			   ErrContextOut              OUT      VARCHAR2,                 -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
1472                                         			   ErrCodeOut                 OUT      PLS_INTEGER,              -- N.ro errore di uscita
1473                                         			   ErrMsgOut                  OUT      VARCHAR2                  -- Messaggio d'errore
1474              )
1475              return PLS_INTEGER;                                  -- 1 successo, 0 in caso di errore
1476        
1477        
1478          /******* funzione per verificare la presenza  di un destinatario nell'anagrafica check di airliquide  ********/
1479          function isDestinatarioInAnagCheck(
1480                                                    CodIdConnectionTokenIn    IN    DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,   -- (obblig). Codice identificativo del token di connessione
1481                                                    IdUserLavoroIn            IN    DMT_USERS.ID_USER%type DEFAULT NULL,             -- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
1482                                                    IdDestinatarioIn          IN    VARCHAR2,                                        -- (obblig.) Identificativo id destinatario
1483                                                    CfPIvaDestinatarioIn      IN    VARCHAR2,                                        -- (obblig.) Identificativo codice fiscale destinatario
1484                                                    trovatoOut                OUT   PLS_INTEGER,                                     -- 1 : destinatario presente in anagrafica. 0 : destinatario non presente in anagrafica
1485                                                    ErrContextOut             OUT   VARCHAR2,            -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
1486                                                    ErrCodeOut                OUT   PLS_INTEGER,         -- N.ro errore di uscita
1487                                                    ErrMsgOut                 OUT   VARCHAR2)            -- Messaggio d'errore
1488           return PLS_INTEGER;
1489        
1490        
1491        		/********** funzione per ricercare i clienti di conti correnti che hanno documenti (Banco Do Brasil) **********/
1492        		function TrovaClientiCC_BDB(
1493        			CodIdConnectionTokenIn	IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
1494        																					-- (obblig). Codice identificativo del token di connessione
1495        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
1496        			FiltriIn				IN		CLOB,									-- XML SezioneCache con i filtri di ricerca. Filtri previsti:
1497        																					-- CodCliente	Filtro case-insensitive in like sul codice cliente
1498        																					-- DesCliente: parole contenute nel nome del cliente (ricerca per parole fatta con indici context)
1499        																					-- OperDesCliente(considerato solo se filtro precedente valorizzato) Indica l'operatore di ricerca sul filtro precedente (se diverso da contiene); valori: inizia, uguale, finisce, contiene, like
1500        																					-- AccountNum	Filtro case-insensitive sul N° di conto corrente
1501        																					-- @CodAccountClass	Codice/i dei tipi dei conti correnti. E' una ricerca esatta. Filtro lista con una sola colonna per ogni riga
1502        																					-- @CodAgenzia			Codice/i delle agenzie a cui afferiscono i conti correnti. E' una ricerca esatta. Filtro lista con una sola colonna per ogni riga
1503        			ColOrderByIO			IN OUT	VARCHAR2,								-- Indica il/i numeri della/e colonna dell'XML (CLOB ListaXMLOut) di output per cui ordinare i record nell'XML stesso (si può ordinare per tutte le colonne). Se l'ordinamento è per più colonne queste vanno separate con "," (es: 2; 2,3)
1504        																					-- se non valorizzato (neppure in output) la lista di record restituita non è ordinata
1505        			FlgDescOrderByIO  		IN OUT	VARCHAR2,								-- E' una stringa di 1 o 0/NULL, tanti quanti le colonne di ordinamento, separati da ",": 1 significa che l'ordinamento per la data colonna deve essere discendente anzichè ascendente (es: 1; 1,0; 1, )
1506        																					-- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul verso di ordinamento una qualche preimpostazione di sistema/utente ecc.
1507        			FlgSenzaPaginazioneIn 	IN 		PLS_INTEGER DEFAULT NULL,            	-- (valori 1/0/NULL) Se 1 l'estrazione non è paginata, altrimenti sì
1508        			NroPaginaIO      		IN OUT	PLS_INTEGER,                  			-- E' il numero della pagina da estrarre; se NULL e l'estrazione è paginata viene estratta la prima pagina
1509           			BachSizeIO				IN OUT	PLS_INTEGER,							-- Indica il massimo n.ro di record da estrarre se l'estrazione non è paginata (FlgSenzaPaginazioneIn=1)
1510        																					-- Indica la dimensione (n.ro di record) della pagina se l'estrazione è paginata (FlgSenzaPaginazioneIn 0 o NULL) e in tal caso se non è valorizzato la dimensione della pagina è quella settata per l'utente di lavoro o è pari al valore del parametro STD_PAGE_NUM_ROW del dominio di lavoro
1511        			OverFlowLimitIn			IN		PLS_INTEGER DEFAULT NULL,				-- E' il n.ro di record soddisfacenti la ricerca superato il quale la funzione deve restituire errore di overflow o avvertimento
1512        			FlgSenzaTotIn			IN		PLS_INTEGER DEFAULT NULL,				-- (valori 1/0/NULL) Se 1 significa che non è richiesto come output il totale dei record soddisfacenti la ricerca (se la ricerca è paginata per la prima pagina il totale viene calcolato comunque, per le successive no)
1513        			NroTotRecOut			OUT		PLS_INTEGER,							-- E' il n.ro di record complessivi trovati (valorizzato solo se FlgSenzaTotIn è 0 o NULL o se si estrae la prima pagina), salvo che nel caso sia stato superato il limite di overflow (warning) e allora coincide con il n.ro di record estratti che sono pari al limite di overflow
1514             		NroRecInPaginaOut 		OUT   	PLS_INTEGER,                     		-- E' il numero di record nella pagina (valorizzato solo se l'estrazione è paginata, ovvero se FlgSenzaPaginazioneIn 0 o NULL)
1515        			FlgBatchSearchIn		IN		PLS_INTEGER DEFAULT NULL,				-- (valori 1/0/NULL) Se 1 significa che la stored è utilizzata da un processo batch, altrimenti da un processo online.
1516        																					-- Serve affinchè in caso l'input OverFlowLimitIn non sia valorizzato vengano applicati i limiti di overflow per processo batch o online che sono parametri di configurazione
1517        			------------- fine argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
1518        			ListaXMLOut				OUT		NOCOPY CLOB,							-- Lista dei clienti di conti correnti trovati (XML conforme a schema LISTA_STD.xsd)
1519        																					-- Ogni cliente di conto corrente è un tag Riga che contiene le seguenti colonne:
1520        																					-- 1: Cod cliente
1521        																					-- 2: Nome cliente
1522        																					-- 3: N° di conto corrente
1523        																					-- 4: Codice del tipo di conto corrente
1524        																					-- 5: Tipo di conto corrente (decodifica)
1525        																					-- 6: Codice agenzia
1526        																					-- 7: Nome agenzia (decodifica)
1527        																					-- 8: N.ro di documenti del dato cliente e conto
1528        			ErrContextOut			OUT		VARCHAR2,								-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
1529        			ErrCodeOut				OUT		PLS_INTEGER,							-- N.ro errore di uscita
1530        			ErrMsgOut				OUT 	VARCHAR2,								-- Messaggio d'errore
1531        			RigaTagNameIn			IN		VARCHAR2 DEFAULT NULL,					-- (opzionale) Come rinominare il tag Riga dell'XML ListaXMLOut di output
1532        			ColTagNameIn			IN		DMVA_STRING DEFAULT NULL				-- (opzionale) Come rinominare i tag delle colonne in alternativa a Colonna Nro=.. nell'XML ListaXMLOut di output
1533        			)return PLS_INTEGER;													-- Vale 1 se tutto è andato a buon fine, altrimenti 0
1534        
1535        		/********** funzione utilizzata per Banco Do Brasil per la prima lista estratta con la ricerca per date **********/
1536        		function TrovaGruppiDoc_BDB(
1537        			CodIdConnectionTokenIn	IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
1538        																					-- (obblig). Codice identificativo del token di connessione
1539        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
1540        			FiltriIn				IN		CLOB,									-- XML SezioneCache con i filtri di ricerca. Filtri previsti:
1541        																					---DtElaborazioneDa Estremo inferiore del filtro di ricerca sulla data di elaborazione dei documenti (nel formato dato dal parametro di config. FMT_STD_DATA)
1542        																					-- DtElaborazioneA	Estremo superiore del filtro di ricerca sulla data di elaborazione dei documenti (nel formato dato dal parametro di config. FMT_STD_DATA)
1543        																					-- DtDocumentoDa 	Estremo inferiore del filtro di ricerca sulla data dei documenti (nel formato dato dal parametro di config. FMT_STD_DATA)
1544        																					-- DtDocumentoA		Estremo superiore del filtro di ricerca sulla data dei documenti (nel formato dato dal parametro di config. FMT_STD_DATA)
1545        																					-- @CodAccountClass	Codice/i dei tipi dei conti correnti. E' una ricerca esatta. Filtro lista con una sola colonna per ogni riga
1546        																					-- @CodTipoDoc	Codice/i dei tipi di documenti. E' una ricerca esatta. Filtro lista con una sola colonna per ogni riga
1547        			ColOrderByIO			IN OUT	VARCHAR2,								-- Indica il/i numeri della/e colonna dell'XML (CLOB ListaXMLOut) di output per cui ordinare i record nell'XML stesso (si può ordinare per tutte le colonne). Se l'ordinamento è per più colonne queste vanno separate con "," (es: 2; 2,3)
1548        																					-- se non valorizzato (neppure in output) la lista di record restituita non è ordinata
1549        			FlgDescOrderByIO  		IN OUT	VARCHAR2,								-- E' una stringa di 1 o 0/NULL, tanti quanti le colonne di ordinamento, separati da ",": 1 significa che l'ordinamento per la data colonna deve essere discendente anzichè ascendente (es: 1; 1,0; 1, )
1550        																					-- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul verso di ordinamento una qualche preimpostazione di sistema/utente ecc.
1551        			FlgSenzaPaginazioneIn 	IN 		PLS_INTEGER DEFAULT NULL,            	-- (valori 1/0/NULL) Se 1 l'estrazione non è paginata, altrimenti sì
1552        			NroPaginaIO      		IN OUT	PLS_INTEGER,                  			-- E' il numero della pagina da estrarre; se NULL e l'estrazione è paginata viene estratta la prima pagina
1553           			BachSizeIO				IN OUT	PLS_INTEGER,							-- Indica il massimo n.ro di record da estrarre se l'estrazione non è paginata (FlgSenzaPaginazioneIn=1)
1554        																					-- Indica la dimensione (n.ro di record) della pagina se l'estrazione è paginata (FlgSenzaPaginazioneIn 0 o NULL) e in tal caso se non è valorizzato la dimensione della pagina è quella settata per l'utente di lavoro o è pari al valore del parametro STD_PAGE_NUM_ROW del dominio di lavoro
1555        			OverFlowLimitIn			IN		PLS_INTEGER DEFAULT NULL,				-- E' il n.ro di record soddisfacenti la ricerca superato il quale la funzione deve restituire errore di overflow o avvertimento
1556        			FlgSenzaTotIn			IN		PLS_INTEGER DEFAULT NULL,				-- (valori 1/0/NULL) Se 1 significa che non è richiesto come output il totale dei record soddisfacenti la ricerca (se la ricerca è paginata per la prima pagina il totale viene calcolato comunque, per le successive no)
1557        			NroTotRecOut			OUT		PLS_INTEGER,							-- E' il n.ro di record complessivi trovati (valorizzato solo se FlgSenzaTotIn è 0 o NULL o se si estrae la prima pagina), salvo che nel caso sia stato superato il limite di overflow (warning) e allora coincide con il n.ro di record estratti che sono pari al limite di overflow
1558             		NroRecInPaginaOut 		OUT   	PLS_INTEGER,                     		-- E' il numero di record nella pagina (valorizzato solo se l'estrazione è paginata, ovvero se FlgSenzaPaginazioneIn 0 o NULL)
1559        			FlgBatchSearchIn		IN		PLS_INTEGER DEFAULT NULL,				-- (valori 1/0/NULL) Se 1 significa che la stored è utilizzata da un processo batch, altrimenti da un processo online.
1560        																					-- Serve affinchè in caso l'input OverFlowLimitIn non sia valorizzato vengano applicati i limiti di overflow per processo batch o online che sono parametri di configurazione
1561        			------------- fine argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
1562        			ListaXMLOut				OUT		NOCOPY CLOB,							-- Lista con i gruppi di documenti trovati (XML conforme a schema LISTA_STD.xsd)
1563        																					-- Ogni gruppo è un tag Riga che contiene le seguenti colonne:
1564        																					-- 1: Data documento (nel formato dato dal parametro di config. FMT_STD_DATA)
1565        																					-- 2: Data elaborazione documento (nel formato dato dal parametro di config. FMT_STD_DATA)
1566        																					-- 3: Codice del tipo di conto corrente
1567        																					-- 4: Tipo di conto corrente (decodifica)
1568        																					-- 5: Codice del tipo di documenti
1569        																					-- 6: Tipo di documenti  (decodifica)
1570        																					-- 7: N.ro di documenti del gruppo
1571        			ErrContextOut			OUT		VARCHAR2,								-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
1572        			ErrCodeOut				OUT		PLS_INTEGER,							-- N.ro errore di uscita
1573        			ErrMsgOut				OUT 	VARCHAR2,								-- Messaggio d'errore
1574        			RigaTagNameIn			IN		VARCHAR2 DEFAULT NULL,					-- (opzionale) Come rinominare il tag Riga dell'XML ListaXMLOut di output
1575        			ColTagNameIn			IN		DMVA_STRING DEFAULT NULL				-- (opzionale) Come rinominare i tag delle colonne in alternativa a Colonna Nro=.. nell'XML ListaXMLOut di output
1576        			)return PLS_INTEGER;													-- Vale 1 se tutto è andato a buon fine, altrimenti 0
1577        
1578        		/********** funzione utilizzata per Banco Do Brasil per ottenere la lista detail con i documenti relativi ad un record della lista master **********/
1579        		function TrovaDocDetailList_BDB(
1580        			CodIdConnectionTokenIn	IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
1581        																					-- (obblig). Codice identificativo del token di connessione
1582        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
1583        			FiltriIn				IN		CLOB,									-- XML SezioneCache con i filtri di ricerca, tra cui gli estremi del record della lista master
1584        																					-- TipoRecordMaster (obbligatorio) Indica il tipo di record della lista master: C (gruppo documenti di un conto corrente); D (gruppo documenti per data)
1585        																					-- CodCliente		Codice cliente	(ricerca esatta)
1586        																					-- AccountNum		N° di conto corrente (ricerca esatta)
1587        																					-- CodAccountClass	Codice del tipo di conto corrente (ricerca esatta)
1588        																					-- CodAgenzia		Codice dell'agenzia (ricerca esatta)
1589        																					---DtElaborazione 	Data elaborazione deocumenti (nel formato dato dal parametro di config. FMT_STD_DATA)
1590        																					-- DtDocumento 		Data dei documenti (nel formato dato dal parametro di config. FMT_STD_DATA)
1591        																					-- CodTipoDoc		Codice del tipo dei documenti
1592        			ColOrderByIO			IN OUT	VARCHAR2,								-- Indica il/i numeri della/e colonna dell'XML (CLOB ListaXMLOut) di output per cui ordinare i record nell'XML stesso (si può ordinare per tutte le colonne). Se l'ordinamento è per più colonne queste vanno separate con "," (es: 2; 2,3)
1593        																					-- se non valorizzato (neppure in output) la lista di record restituita non è ordinata
1594        			FlgDescOrderByIO  		IN OUT	VARCHAR2,								-- E' una stringa di 1 o 0/NULL, tanti quanti le colonne di ordinamento, separati da ",": 1 significa che l'ordinamento per la data colonna deve essere discendente anzichè ascendente (es: 1; 1,0; 1, )
1595        																					-- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul verso di ordinamento una qualche preimpostazione di sistema/utente ecc.
1596        			FlgSenzaPaginazioneIn 	IN 		PLS_INTEGER DEFAULT NULL,            	-- (valori 1/0/NULL) Se 1 l'estrazione non è paginata, altrimenti sì
1597        			NroPaginaIO      		IN OUT	PLS_INTEGER,                  			-- E' il numero della pagina da estrarre; se NULL e l'estrazione è paginata viene estratta la prima pagina
1598           			BachSizeIO				IN OUT	PLS_INTEGER,							-- Indica il massimo n.ro di record da estrarre se l'estrazione non è paginata (FlgSenzaPaginazioneIn=1)
1599        																					-- Indica la dimensione (n.ro di record) della pagina se l'estrazione è paginata (FlgSenzaPaginazioneIn 0 o NULL) e in tal caso se non è valorizzato la dimensione della pagina è quella settata per l'utente di lavoro o è pari al valore del parametro STD_PAGE_NUM_ROW del dominio di lavoro
1600        			OverFlowLimitIn			IN		PLS_INTEGER DEFAULT NULL,				-- E' il n.ro di record soddisfacenti la ricerca superato il quale la funzione deve restituire errore di overflow o avvertimento
1601        			FlgSenzaTotIn			IN		PLS_INTEGER DEFAULT NULL,				-- (valori 1/0/NULL) Se 1 significa che non è richiesto come output il totale dei record soddisfacenti la ricerca (se la ricerca è paginata per la prima pagina il totale viene calcolato comunque, per le successive no)
1602        			NroTotRecOut			OUT		PLS_INTEGER,							-- E' il n.ro di record complessivi trovati (valorizzato solo se FlgSenzaTotIn è 0 o NULL o se si estrae la prima pagina), salvo che nel caso sia stato superato il limite di overflow (warning) e allora coincide con il n.ro di record estratti che sono pari al limite di overflow
1603             		NroRecInPaginaOut 		OUT   	PLS_INTEGER,                     		-- E' il numero di record nella pagina (valorizzato solo se l'estrazione è paginata, ovvero se FlgSenzaPaginazioneIn 0 o NULL)
1604        			FlgBatchSearchIn		IN		PLS_INTEGER DEFAULT NULL,				-- (valori 1/0/NULL) Se 1 significa che la stored è utilizzata da un processo batch, altrimenti da un processo online.
1605        																					-- Serve affinchè in caso l'input OverFlowLimitIn non sia valorizzato vengano applicati i limiti di overflow per processo batch o online che sono parametri di configurazione
1606        			------------- fine argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
1607        			ListaXMLOut				OUT		NOCOPY CLOB,							-- Lista con i documenti trovati (XML conforme a schema LISTA_STD.xsd)
1608        																					-- Ogni documento è un tag Riga che contiene le seguenti colonne:
1609        																					-- 1: Data documento (nel formato dato dal parametro di config. FMT_STD_DATA)
1610        																					-- 2: Data elaborazione documento (nel formato dato dal parametro di config. FMT_STD_DATA)
1611        																					-- 3: Codice del tipo di conto corrente
1612        																					-- 4: Tipo di conto corrente (decodifica)
1613        																					-- 5: Codice del tipo di documenti
1614        																					-- 6: Tipo di documenti  (decodifica)
1615        																					-- 7: Cod cliente
1616        																					-- 8: Nome cliente
1617        																					-- 9: N° di conto corrente
1618        																					-- 10: Codice banca
1619        																					-- 11: Nome banca (decodifica)
1620        																					-- 12: Codice agenzia
1621        																					-- 13: Nome agenzia (decodifica)
1622        																					-- 14: History
1623        																					-- 15: Cod. template
1624        																					-- 16: Flag di template definitivo (valori 1/0)
1625        																					-- 17: Flag di stampa cliente (valori 1/0)
1626        																					-- 18: Flag di stampa sede (valori 1/0)
1627        																					-- 19: Nome file
1628        																					-- 20: URI ultima versione file
1629        																					-- 21: N.ro di versioni del file
1630        																					-- 22: ID_DOC del documento
1631        																					-- 23: ID_UD
1632        			ErrContextOut			OUT		VARCHAR2,								-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
1633        			ErrCodeOut				OUT		PLS_INTEGER,							-- N.ro errore di uscita
1634        			ErrMsgOut				OUT 	VARCHAR2,								-- Messaggio d'errore
1635        			RigaTagNameIn			IN		VARCHAR2 DEFAULT NULL,					-- (opzionale) Come rinominare il tag Riga dell'XML ListaXMLOut di output
1636        			ColTagNameIn			IN		DMVA_STRING DEFAULT NULL				-- (opzionale) Come rinominare i tag delle colonne in alternativa a Colonna Nro=.. nell'XML ListaXMLOut di output
1637        			)return PLS_INTEGER;													-- Vale 1 se tutto è andato a buon fine, altrimenti 0
1638        
1639        
1640        		/*********** funzione usata dai caricamenti di Banco Do Brasil per verificare se esiste già un documento				********/
1641        		/*********** con la chiave Data documento, Cod. Cliente, N° e classe conto, Cod. provenienza del tipo di documento 		********/
1642        		function FindIdDoc_BDB(
1643        			IdSpAOOIn				IN		DMT_SOGGETTI_PROD_AOO.ID_SP_AOO%type,	-- (obblig.) Id. del dominio in cui cercare il documento
1644        			DtDocumentoIn			IN		VARCHAR2,								-- (obblig.) Data del documento nel formato DD/MM/YYYY
1645        			CodClienteIn			IN		VARCHAR2,								-- (obblig.) Cod. del cliente cui si riferisce il documento
1646        			AccountNumIn			IN		VARCHAR2,								-- (obblig.) N° del conto corrente cui si riferisce il documento
1647        			CodAccountClassIn		IN		VARCHAR2,								-- (obblig.) Codice della classe del conto corrente cui si riferisce il documento
1648        			ProvCIDocTypeIn			IN		VARCHAR2,								-- (obblig.) Cod. del tipo del documento
1649        			IdDocOut				OUT		DMT_DOCUMENTS.ID_DOC%type,				-- Id. del documento trovato
1650        			IdUDOut					OUT		DMT_UNITA_DOC.ID_UD%type,				-- ID_UD dell'unità documentaria di appartenenza del documento trovato
1651        			ErrContextOut			OUT		VARCHAR2,								-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
1652        			ErrCodeOut				OUT		PLS_INTEGER,							-- N.ro errore di uscita
1653        			ErrMsgOut				OUT 	VARCHAR2								-- Messaggio d'errore
1654        			)return PLS_INTEGER;													-- Vale 1 se la verifica di esistenza del documento è stata ppssibile, 0 in caso di errore
1655        
1656        
1657            /***** Restituisce la denominazione della AOO  *****/
1658            function FindDescSpAoo(  
1659                                     IdSpAOOIn			       IN		  DMT_SOGGETTI_PROD_AOO.ID_SP_AOO%type,	-- (obblig.) Id. del dominio 
1660        						                 IdCiApplicazioneIn    IN     VARCHAR2,
1661                                     IdCiIstApplicazioneIn IN     VARCHAR2,						 
1662        		                         DescSpAooOut		       OUT    VARCHAR2,				      -- Descrizione della AOO		
1663        		                         ErrContextOut		     OUT		VARCHAR2,		    -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
1664        		                         ErrCodeOut			       OUT		PLS_INTEGER,    -- N.ro errore di uscita
1665                		                 ErrMsgOut			       OUT 	  VARCHAR2			-- Messaggio d'errore
1666        		                        )return PLS_INTEGER;      							  -- Vale 1 se la verifica di esistenza del documento è stata possibile, 0 in caso di errore
1667        
1668            /*********** Restituisce il codice accoppiata presente nella tabella T_ALG_MATRICE_PRODOTTI_NETA ***/
1669            function GetCodiceAccoppiataNETA( TIPO_FORNITURA_in     IN    VARCHAR2,     -- (obblig.) Identificativo tipo fornitura
1670                                              TIPO_SERVIZIO_in      IN    VARCHAR2,     -- (obblig.) Identificativo tipo servizio
1671                                              TIPO_OFFERTA_in       IN    VARCHAR2,     -- (obblig.) Identificativo tipo offerta
1672                                              TIPO_TRATTAMENTO_in   IN    VARCHAR2,     -- (obblig.) Identificativo tipo trattamento
1673                                              FLG_ENERGIA_VERDE_in  IN    VARCHAR2,     -- (obblig.) Identificativo flag energia verde (S/N)
1674                                              FLG_RESIDENZA_in      IN    VARCHAR2,     -- (obblig.) Identificativo flag residenza/non residenza (S/N)
1675                                              POTENZA_in            IN    VARCHAR2,     -- (obblig.) Identificativo potenza  
1676                                              CodiceAccoppiataOut   OUT   VARCHAR2,     -- Codice accoppiata prodotto/offerta
1677                                              ErrContextOut         OUT   VARCHAR2,     -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
1678                                              ErrCodeOut            OUT   PLS_INTEGER,  -- N.ro errore di uscita
1679                                              ErrMsgOut             OUT   VARCHAR2)     -- Messaggio d'errore
1680                                              return PLS_INTEGER;                       -- Restituisce 1 (successo) in caso la variabile sia stata trovata nessuna o una ed una sola volta come variabile semplice, altrimenti 0
1681        
1682          /*********** Restituisce le informazioni (ragione sociale e codice NETA) presenti nella tabella t_alg_player_distr_ee_neta  ***/
1683          function GetPlayerDistributoreEENETA( CODICE_DISTRIBUTORE_in   IN    VARCHAR2,     -- (obblig.) Identificativo codice distributore
1684                                             CodicePlayerNETAOut      OUT   VARCHAR2,     -- Codice player distributore NETA
1685        											               RagSocialePlayerNETAOut  OUT   VARCHAR2,     -- Ragione sociale player distributore NETA											  
1686                                             ErrContextOut         OUT   VARCHAR2,     -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
1687                                             ErrCodeOut            OUT   PLS_INTEGER,  -- N.ro errore di uscita
1688                                             ErrMsgOut             OUT   VARCHAR2)     -- Messaggio d'errore
1689                                             return PLS_INTEGER;                     -- Restituisce 1 (successo) in caso la variabile sia stata trovata nessuna o una ed una sola volta come variabile semplice, altrimenti 0
1690        
1691          /******* Restituisce la lista delle operazioni disponibili sul lotto ********/
1692          function GetListaOperazioniLotto(
1693                                             CodIdConnectionTokenIn    IN                      DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,   -- (obblig). Codice identificativo del token di connessione
1694                                             IdUserLavoroIn            IN                      DMT_USERS.ID_USER%type DEFAULT NULL,           -- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
1695                                             IdLottoIn                 IN      VARCHAR2,                                           -- (obblig). Id del documento del lotto.
1696                                             ResultOut                 OUT     NOCOPY CLOB,     -- Lista dei record trovati (XML conforme a schema LISTA_STD.xsd)
1697                                                                                                -- Ogni record trovato è un tag Riga che può contenere le seguenti colonne:
1698                                                                                                --  1:  Nome Operazione
1699                                             ErrContextOut             OUT     VARCHAR2,        -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
1700                                             ErrCodeOut                OUT     PLS_INTEGER,     -- N.ro errore di uscita
1701                                             ErrMsgOut                 OUT     VARCHAR2         -- Messaggio d'errore
1702                                            ) return PLS_INTEGER;
1703        
1704          /******* Restituisce la lista degli eventi in errore  ********/
1705          function GetListaEventiInErrore(   IdLottoIn                 IN      VARCHAR2                                           -- (obblig). Id del documento del lotto.
1706                                         ) return VARCHAR2;
1707        
1708          /*********** Verifica se l'idSpAoo e' associato al dominio  **/
1709          function isVersione(idSpAoo in number , dominio in varchar2) return boolean;
1710        
1711          /******* Restituisce il conteggio di un evento con esito OK oppure KO   ********/
1712          function getNrTotEventi( IdSpAooIn           in dmt_log_job_caricamenti_file.ID_SP_AOO%type,
1713                                   CodApplOwnerIn      in dmt_log_job_caricamenti_file.cod_appl_owner%type,
1714                                   CodIstApplOwnerIn   in dmt_log_job_caricamenti_file.cod_ist_appl_owner%type,
1715                                   AnnoIn              in number,
1716                                   MeseIn              in number,
1717                                   CodEventoIn         in varchar2,                       
1718                                   TipoEsitoIn         in varchar2
1719                              ) return NUMBER;  
1720        
1721          /******* funzione per ricercare i dati per il report dei DESTINATARI (per nestle')  ********/
1722          function TrovaReportDestinatari(
1723                                        CodIdConnectionTokenIn    IN                      DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,   -- (obblig). Codice identificativo del token di connessione
1724                                        IdUserLavoroIn            IN                      DMT_USERS.ID_USER%type DEFAULT NULL,           -- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
1725                                        FiltriIO                  IN OUT  NOCOPY CLOB,    -- XML contenente nomi e valori dei filtri di ricerca(conforme allo schema SezioneCache.xsd).
1726                                                                                          -- Ogni filtro è un tag "Variabile" dell'XML
1727                                                                                          -- I filtri che sono liste hanno nomi (tag Variabile/Nome) che iniziano con @.                                                                                  
1728                                                                                           ------------- inizio argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
1729                                        ColOrderByIO              IN OUT  VARCHAR2,        -- Indica il/i numeri della/e colonna dell'XML (CLOB ResultOut) di output per cui ordinare i record nell'XML stesso (si può ordinare solo per le colonne da 1 a xx). Se l'ordinamento è per più colonne queste vanno separate con "," (es: 2; 2,3)
1730                                                                                          -- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul tipo di ordinamento una qualche preimpostazione di sistema/utente ecc.
1731                                                                                          -- se non valorizzato (neppure in output) la lista di record restituita non è ordinata
1732                                        FlgDescOrderByIO          IN OUT  VARCHAR2,        -- E' una stringa di 1 o 0/NULL, tanti quanti le colonne di ordinamento, separati da ",": 1 significa che l'ordinamento per la data colonna deve essere discendente anzichè ascendente (es: 1; 1,0; 1, )
1733                                                                                          -- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul verso di ordinamento una qualche preimpostazione di sistema/utente ecc.
1734                                        FlgSenzaPaginazioneIn     IN      PLS_INTEGER DEFAULT NULL,              -- (valori 1/0/NULL) Se 1 l'estrazione non è paginata, altrimenti sì
1735                                        NroPaginaIO               IN OUT  PLS_INTEGER,    -- E' il numero della pagina da estrarre; se NULL e l'estrazione è paginata viene estratta la prima pagina
1736                                        BachSizeIO                IN OUT  PLS_INTEGER,    -- Indica il massimo n.ro di record da estrarre se l'estrazione non è paginata (FlgSenzaPaginazioneIn=1)
1737                                                                                          -- Indica la dimensione (n.ro di record) della pagina se l'estrazione è paginata (FlgSenzaPaginazioneIn 0 o NULL) e in tal caso se non è valorizzato la dimensione della pagina è quella settata per l'utente di lavoro o è pari al valore del parametro STD_PAGE_NUM_ROW del dominio di lavoro
1738                                        OverFlowLimitIn           IN      PLS_INTEGER DEFAULT NULL,  -- E' il n.ro di record soddisfacenti la ricerca superato il quale la funzione deve restituire errore di overflow
1739                                        FlgSenzaTotIn             IN      PLS_INTEGER DEFAULT NULL,  -- (valori 1/0/NULL) Se 1 significa che non è richiesto come output il totale dei record soddisfacenti la ricerca (se la ricerca è paginata per la prima pagina il totale viene calcolato comunque, per le successive no)
1740                                        NroTotRecOut             OUT      PLS_INTEGER,              -- E' il n.ro di record complessivi trovati (valorizzato solo se FlgSenzaTotIn è 0 o NULL o se si estrae la prima pagina)
1741                                        NroRecInPaginaOut        OUT     PLS_INTEGER,              -- E' il numero di record nella pagina (valorizzato solo se l'estrazione è paginata, ovvero se FlgSenzaPaginazioneIn 0 o NULL)
1742                                        ------------- fine argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
1743        
1744                                         FlgBatchSearchIn          IN      PLS_INTEGER DEFAULT NULL,  -- (valori 1/0/NULL) Se 1 significa che la stored è utilizzata da un processo batch, altrimenti da un processo online.
1745                                                                                                    -- Serve affinchè in caso l'input OverFlowLimitIn non sia valorizzato vengano applicati i limiti di overflow per processo batch o online che sono parametri di configurazione del sistema.
1746                                         ColToReturnIn              IN      VARCHAR2 DEFAULT NULL,    -- Stringa con i n.ri delle colonne dell'XML di output ResultOut che si vuole siano presenti.
1747                                                                                                      -- Se la stringa è vuota saranno presenti tutte le colonne.
1748                                                                                                      -- La colonna 1 sarà presente comunque.
1749                                                                                                      -- I n.ri delle varie colonne vanno separati con , o ; e se si vuole indicare un intervallo di colonne gli estremi dell'intervallo vanno separati con - (es: "1-5;7;10" significa colonne da 1 a 5 più le colonne 7 e 10)
1750                                         ResultOut                  OUT      NOCOPY CLOB,             -- Lista dei record trovati (XML conforme a schema LISTA_STD.xsd)
1751                                                                                                      -- Ogni record trovato è un tag Riga che può contenere le seguenti colonne:
1752        																							                                                -- 1:  Id. destinatario
1753                                                      																							  -- 2:  Descrizione Sales Organization
1754        																							                                                -- 3:  Descrizione Distribution Channel
1755                                                      																							  -- 4:  Codice Destinatario
1756        																							                                                -- 5:  Descrizione Destinatario
1757                                                      																							  -- 6:  Descrizione Canale
1758        																							                                                -- 7:  Email Mittente
1759                                                      																							  -- 8:  Email Destinatario
1760                                                      																							  -- 9:  Username utente
1761        																							                                                --10:  Cognome Nome utente
1762                                                      																							  --11:  flgObsoleto (0/1)
1763        																							                                                --12:  Data Ultimo Aggiornamento
1764                                                      																							  --13:  Nome Utente Ultimo Aggiornamento
1765        
1766                                         ErrContextOut              OUT      VARCHAR2,                 -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
1767                                         ErrCodeOut                 OUT      PLS_INTEGER,              -- N.ro errore di uscita
1768                                         ErrMsgOut                  OUT      VARCHAR2                  -- Messaggio d'errore
1769              )
1770              return PLS_INTEGER;
1771        
1772           /******* funzione per ricercare i dati per il report FFIRR (per nestle')  ********/
1773           function TrovaReportFFIRR(
1774                                        CodIdConnectionTokenIn    IN                      DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,   -- (obblig). Codice identificativo del token di connessione
1775                                        IdUserLavoroIn            IN                      DMT_USERS.ID_USER%type DEFAULT NULL,           -- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
1776                                        FiltriIO                  IN OUT  NOCOPY CLOB,    -- XML contenente nomi e valori dei filtri di ricerca(conforme allo schema SezioneCache.xsd).
1777                                                                                          -- Ogni filtro è un tag "Variabile" dell'XML
1778                                                                                          -- I filtri che sono liste hanno nomi (tag Variabile/Nome) che iniziano con @.                                                                                  
1779                                                                                          ------------- inizio argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
1780                                        ColOrderByIO              IN OUT  VARCHAR2,       -- Indica il/i numeri della/e colonna dell'XML (CLOB ResultOut) di output per cui ordinare i record nell'XML stesso (si può ordinare solo per le colonne da 1 a xx). Se l'ordinamento è per più colonne queste vanno separate con "," (es: 2; 2,3)
1781                                                                                          -- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul tipo di ordinamento una qualche preimpostazione di sistema/utente ecc.
1782                                                                                          -- se non valorizzato (neppure in output) la lista di record restituita non è ordinata
1783                                        FlgDescOrderByIO          IN OUT  VARCHAR2,       -- E' una stringa di 1 o 0/NULL, tanti quanti le colonne di ordinamento, separati da ",": 1 significa che l'ordinamento per la data colonna deve essere discendente anzichè ascendente (es: 1; 1,0; 1, )
1784                                                                                          -- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul verso di ordinamento una qualche preimpostazione di sistema/utente ecc.
1785                                        FlgSenzaPaginazioneIn     IN      PLS_INTEGER DEFAULT NULL,              -- (valori 1/0/NULL) Se 1 l'estrazione non è paginata, altrimenti sì
1786                                        NroPaginaIO               IN OUT  PLS_INTEGER,    -- E' il numero della pagina da estrarre; se NULL e l'estrazione è paginata viene estratta la prima pagina
1787                                        BachSizeIO                IN OUT  PLS_INTEGER,    -- Indica il massimo n.ro di record da estrarre se l'estrazione non è paginata (FlgSenzaPaginazioneIn=1)
1788                                                                                          -- Indica la dimensione (n.ro di record) della pagina se l'estrazione è paginata (FlgSenzaPaginazioneIn 0 o NULL) e in tal caso se non è valorizzato la dimensione della pagina è quella settata per l'utente di lavoro o è pari al valore del parametro STD_PAGE_NUM_ROW del dominio di lavoro
1789                                        OverFlowLimitIn           IN      PLS_INTEGER DEFAULT NULL,  -- E' il n.ro di record soddisfacenti la ricerca superato il quale la funzione deve restituire errore di overflow
1790                                        FlgSenzaTotIn             IN      PLS_INTEGER DEFAULT NULL,  -- (valori 1/0/NULL) Se 1 significa che non è richiesto come output il totale dei record soddisfacenti la ricerca (se la ricerca è paginata per la prima pagina il totale viene calcolato comunque, per le successive no)
1791                                        NroTotRecOut             OUT      PLS_INTEGER,               -- E' il n.ro di record complessivi trovati (valorizzato solo se FlgSenzaTotIn è 0 o NULL o se si estrae la prima pagina)
1792                                        NroRecInPaginaOut        OUT      PLS_INTEGER,               -- E' il numero di record nella pagina (valorizzato solo se l'estrazione è paginata, ovvero se FlgSenzaPaginazioneIn 0 o NULL)
1793                                        ------------- fine argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
1794        
1795                                        FlgBatchSearchIn          IN      PLS_INTEGER DEFAULT NULL,  -- (valori 1/0/NULL) Se 1 significa che la stored è utilizzata da un processo batch, altrimenti da un processo online.
1796                                                                                                     -- Serve affinchè in caso l'input OverFlowLimitIn non sia valorizzato vengano applicati i limiti di overflow per processo batch o online che sono parametri di configurazione del sistema.
1797                                        ColToReturnIn             IN      VARCHAR2 DEFAULT NULL,     -- Stringa con i n.ri delle colonne dell'XML di output ResultOut che si vuole siano presenti.
1798                                                                                                      -- Se la stringa è vuota saranno presenti tutte le colonne.
1799                                                                                                      -- La colonna 1 sarà presente comunque.
1800                                                                                                      -- I n.ri delle varie colonne vanno separati con , o ; e se si vuole indicare un intervallo di colonne gli estremi dell'intervallo vanno separati con - (es: "1-5;7;10" significa colonne da 1 a 5 più le colonne 7 e 10)
1801                                        ResultOut                OUT      NOCOPY CLOB,               -- Lista dei record trovati (XML conforme a schema LISTA_STD.xsd)
1802                                                                                                      -- Ogni record trovato è un tag Riga che può contenere le seguenti colonne:
1803        																							                                                -- 1:  Invoice Number
1804                                                      																							  -- 2:  Creation Date
1805        																							                                                -- 3:  Posting Date
1806                                                      																							  -- 4:  Posting Status
1807        																							                                                -- 5:  Invoice Type
1808                                                      																							  -- 6:  Billing Document Description
1809        																							                                                -- 7:  Sold To
1810                                                      																							  -- 8:  Sold To Name
1811                                        ErrContextOut              OUT      VARCHAR2,                -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
1812                                        ErrCodeOut                 OUT      PLS_INTEGER,             -- N.ro errore di uscita
1813                                        ErrMsgOut                  OUT      VARCHAR2                 -- Messaggio d'errore
1814              )
1815              return PLS_INTEGER;
1816        
1817        
1818          /******* Restituisce il valore dell'attributo FLG_OBSOLETO_CLUSTER  ********/
1819          function GetFlagObsoletoClusterValue( IdDestinatarioIn                 IN      VARCHAR2,                                           -- (obblig). Id del destinatario.
1820                                                NroOccValueIn                    IN      VARCHAR2                                           -- (obblig). Nro occ value
1821                                              ) return VARCHAR2;
1822        
1823          /******* Restituisce la descrizione della sales organization associata all'unita' documentaria  ********/
1824          function GetDescSalesOrganizationFromUd( IdUdIn  IN VARCHAR2   -- (obblig). Id della unita' documentaria.
1825                                                 ) return VARCHAR2;
1826        
1827          /******* Restituisce la descrizione della distribution channel associata all'unita' documentaria  ********/
1828          function GetDescDistribChannelFromUd( IdUdIn  IN VARCHAR2   -- (obblig). Id della unita' documentaria.
1829                                                   ) return VARCHAR2;
1830        
1831          /******* Restituisce l'id della sales organization associata all'unita' documentaria  ********/
1832          function GetIdSalesOrganizationFromUd( IdUdIn  IN VARCHAR2   -- (obblig). Id della unita' documentaria.
1833                                                 ) return NUMBER;
1834        
1835          /******* Restituisce l'id della distribution channel associata all'unita' documentaria  ********/
1836          function GetIdDistribChannelFromUd( IdUdIn  IN VARCHAR2   -- (obblig). Id della unita' documentaria.
1837                                                  ) return NUMBER;
1838        
1839          /******* Restituisce il numero di documenti che si sono trovati in uno stato predefinito per giorni da 0 a 2  ********/
1840          function GetDocInStatoDa0A2gg( IdSpAooIn               in dmt_documents.ID_SP_AOO%type,
1841                                         CodApplOwnerIn          in dmt_documents.cod_appl_owner%type,
1842                                         CodIstApplOwnerIn       in dmt_documents.cod_ist_appl_owner%type,
1843                                         IdDocTypeIn             in dmt_documents.id_doc_type%type,
1844                                         IdSalesOrganizationIn   in number,
1845                                         IdDistributionChannelIn in number,
1846                                         CodStatoDettIn          in dmt_unita_doc.cod_stato_dett%type
1847                                        ) return NUMBER;
1848        
1849          /******* Restituisce il numero di documenti che si sono trovati in uno stato predefinito per giorni 3  ********/
1850          function GetDocInStatoDa3gg( IdSpAooIn               in dmt_documents.ID_SP_AOO%type,
1851                                       CodApplOwnerIn          in dmt_documents.cod_appl_owner%type,
1852                                       CodIstApplOwnerIn       in dmt_documents.cod_ist_appl_owner%type,
1853                                       IdDocTypeIn             in dmt_documents.id_doc_type%type,
1854                                       IdSalesOrganizationIn   in number,
1855                                       IdDistributionChannelIn in number,
1856                                       CodStatoDettIn          in dmt_unita_doc.cod_stato_dett%type
1857                                      ) return NUMBER;
1858        
1859          /******* Restituisce il numero di documenti che si sono trovati in uno stato predefinito per giorni 4  ********/
1860          function GetDocInStatoDa4gg( IdSpAooIn               in dmt_documents.ID_SP_AOO%type,
1861                                       CodApplOwnerIn          in dmt_documents.cod_appl_owner%type,
1862                                       CodIstApplOwnerIn       in dmt_documents.cod_ist_appl_owner%type,
1863                                       IdDocTypeIn             in dmt_documents.id_doc_type%type,
1864                                       IdSalesOrganizationIn   in number,
1865                                       IdDistributionChannelIn in number,
1866                                       CodStatoDettIn          in dmt_unita_doc.cod_stato_dett%type
1867                                      ) return NUMBER;
1868        
1869          /******* Restituisce il numero di documenti che si sono trovati in uno stato predefinito per giorni da 5 a 10  ********/
1870          function GetDocInStatoDa5a10gg( IdSpAooIn               in dmt_documents.ID_SP_AOO%type,
1871                                       CodApplOwnerIn          in dmt_documents.cod_appl_owner%type,
1872                                       CodIstApplOwnerIn       in dmt_documents.cod_ist_appl_owner%type,
1873                                       IdDocTypeIn             in dmt_documents.id_doc_type%type,
1874                                       IdSalesOrganizationIn   in number,
1875                                       IdDistributionChannelIn in number,
1876                                       CodStatoDettIn          in dmt_unita_doc.cod_stato_dett%type
1877                                      ) return NUMBER;
1878        
1879          /******* Restituisce il numero di documenti che si sono trovati in uno stato predefinito per giorni oltre 10  ********/
1880          function GetDocInStatoDaOltre10gg( IdSpAooIn               in dmt_documents.ID_SP_AOO%type,
1881                                       CodApplOwnerIn          in dmt_documents.cod_appl_owner%type,
1882                                       CodIstApplOwnerIn       in dmt_documents.cod_ist_appl_owner%type,
1883                                       IdDocTypeIn             in dmt_documents.id_doc_type%type,
1884                                       IdSalesOrganizationIn   in number,
1885                                       IdDistributionChannelIn in number,
1886                                       CodStatoDettIn          in dmt_unita_doc.cod_stato_dett%type
1887                                      ) return NUMBER;
1888        
1889          /******* Restituisce il numero di documenti che sono stati consultati entro giorni da 0 a 5  ********/
1890          function GetDocConsultatiDa0A5gg( IdSpAooIn               in dmt_documents.ID_SP_AOO%type,
1891                                            CodApplOwnerIn          in dmt_documents.cod_appl_owner%type,
1892                                            CodIstApplOwnerIn       in dmt_documents.cod_ist_appl_owner%type,
1893                                            AnnoIn                  in number,
1894                                            MeseIn                  in number,
1895                                            IdSalesOrganizationIn   in number,
1896                                            IdDistributionChannelIn in number
1897                                          ) return NUMBER;
1898        
1899          /******* Restituisce il numero di documenti che sono stati consultati entro giorni da 0 a 10  ********/
1900          function GetDocConsultatiDa0A10gg( IdSpAooIn               in dmt_documents.ID_SP_AOO%type,
1901                                             CodApplOwnerIn          in dmt_documents.cod_appl_owner%type,
1902                                             CodIstApplOwnerIn       in dmt_documents.cod_ist_appl_owner%type,
1903                                             AnnoIn                  in number,
1904                                             MeseIn                  in number,
1905                                             IdSalesOrganizationIn   in number,
1906                                             IdDistributionChannelIn in number
1907                                           ) return NUMBER;
1908        
1909          /******* Restituisce il numero di documenti che sono stati consultati entro giorni oltre 10  ********/
1910          function GetDocConsultatiDaOltre10gg( IdSpAooIn               in dmt_documents.ID_SP_AOO%type,
1911                                                CodApplOwnerIn          in dmt_documents.cod_appl_owner%type,
1912                                                CodIstApplOwnerIn       in dmt_documents.cod_ist_appl_owner%type,
1913                                                AnnoIn                  in number,
1914                                                MeseIn                  in number,
1915                                                IdSalesOrganizationIn   in number,
1916                                                IdDistributionChannelIn in number
1917                                              ) return NUMBER;
1918        
1919        
1920          /******* funzione per generare il report KPI MAIL FOR ALL  (nestle) ********/
1921          function TrovaReportKpiNestleMailForALL(
1922                                        CodIdConnectionTokenIn    IN                      DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,   -- (obblig). Codice identificativo del token di connessione
1923                                        IdUserLavoroIn            IN                      DMT_USERS.ID_USER%type DEFAULT NULL,           -- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
1924                                        FiltriIO                  IN OUT  NOCOPY CLOB,    -- XML contenente nomi e valori dei filtri di ricerca(conforme allo schema SezioneCache.xsd).
1925                                                                                          -- Ogni filtro è un tag "Variabile" dell'XML
1926                                                                                          -- I filtri che sono liste hanno nomi (tag Variabile/Nome) che iniziano con @.
1927                                                                                          -- I nomi dei filtri possibili sono:
1928                                                                                          -- Mese              : mese di riferimento  ( ricerca esatta )
1929                                                                                          -- Anno              : anno di riferimento  ( ricerca esatta )
1930                                                                                          -- CodApplOwner	     : Serve a restringere la ricerca ai soli documenti e folder caricati a sistema dall'applicazione esterna qui specificata. Se è valorizzato a #BY_CONN_TKN significa l'applicazione da cui si è connessi
1931                                                        								                  -- CodIstApplOwner   : Serve a restringere la ricerca ai soli documenti e folder caricati a sistema dall'istanza di applicazione esterna qui specificata. Se è valorizzato a #BY_CONN_TKN significa l'istanza di applicazione da cui si è connessi
1932                                                                                          ------------- inizio argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
1933                                        ColOrderByIO              IN OUT  VARCHAR2,       -- Indica il/i numeri della/e colonna dell'XML (CLOB ResultOut) di output per cui ordinare i record nell'XML stesso (si può ordinare solo per le colonne da 1 a xx). Se l'ordinamento è per più colonne queste vanno separate con "," (es: 2; 2,3)
1934                                                                                          -- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul tipo di ordinamento una qualche preimpostazione di sistema/utente ecc.
1935                                                                                          -- se non valorizzato (neppure in output) la lista di record restituita non è ordinata
1936                                        FlgDescOrderByIO          IN OUT  VARCHAR2,       -- E' una stringa di 1 o 0/NULL, tanti quanti le colonne di ordinamento, separati da ",": 1 significa che l'ordinamento per la data colonna deve essere discendente anzichè ascendente (es: 1; 1,0; 1, )
1937                                                                                          -- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul verso di ordinamento una qualche preimpostazione di sistema/utente ecc.
1938                                        FlgSenzaPaginazioneIn     IN      PLS_INTEGER DEFAULT NULL,              -- (valori 1/0/NULL) Se 1 l'estrazione non è paginata, altrimenti sì
1939                                        NroPaginaIO               IN OUT  PLS_INTEGER,    -- E' il numero della pagina da estrarre; se NULL e l'estrazione è paginata viene estratta la prima pagina
1940                                        BachSizeIO                IN OUT  PLS_INTEGER,    -- Indica il massimo n.ro di record da estrarre se l'estrazione non è paginata (FlgSenzaPaginazioneIn=1)
1941                                                                                          -- Indica la dimensione (n.ro di record) della pagina se l'estrazione è paginata (FlgSenzaPaginazioneIn 0 o NULL) e in tal caso se non è valorizzato la dimensione della pagina è quella settata per l'utente di lavoro o è pari al valore del parametro STD_PAGE_NUM_ROW del dominio di lavoro
1942                                        OverFlowLimitIn           IN      PLS_INTEGER DEFAULT NULL, -- E' il n.ro di record soddisfacenti la ricerca superato il quale la funzione deve restituire errore di overflow
1943                                        FlgSenzaTotIn             IN      PLS_INTEGER DEFAULT NULL, -- (valori 1/0/NULL) Se 1 significa che non è richiesto come output il totale dei record soddisfacenti la ricerca (se la ricerca è paginata per la prima pagina il totale viene calcolato comunque, per le successive no)
1944                                        NroTotRecOut              OUT     PLS_INTEGER,              -- E' il n.ro di record complessivi trovati (valorizzato solo se FlgSenzaTotIn è 0 o NULL o se si estrae la prima pagina)
1945                                        NroRecInPaginaOut         OUT     PLS_INTEGER,              -- E' il numero di record nella pagina (valorizzato solo se l'estrazione è paginata, ovvero se FlgSenzaPaginazioneIn 0 o NULL)
1946                                        ------------- fine argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
1947        
1948                                         FlgBatchSearchIn          IN      PLS_INTEGER DEFAULT NULL,  -- (valori 1/0/NULL) Se 1 significa che la stored è utilizzata da un processo batch, altrimenti da un processo online.
1949                                                                                                      -- Serve affinchè in caso l'input OverFlowLimitIn non sia valorizzato vengano applicati i limiti di overflow per processo batch o online che sono parametri di configurazione del sistema.
1950                                         ColToReturnIn             IN      VARCHAR2 DEFAULT NULL,     -- Stringa con i n.ri delle colonne dell'XML di output ResultOut che si vuole siano presenti.
1951                                                                                                      -- Se la stringa è vuota saranno presenti tutte le colonne.
1952                                                                                                      -- La colonna 1 sarà presente comunque.
1953                                                                                                      -- I n.ri delle varie colonne vanno separati con , o ; e se si vuole indicare un intervallo di colonne gli estremi dell'intervallo vanno separati con - (es: "1-5;7;10" significa colonne da 1 a 5 più le colonne 7 e 10)
1954                                         ResultOut                 OUT      NOCOPY CLOB,              -- Lista dei record trovati (XML conforme a schema LISTA_STD.xsd)
1955                                                                                                      -- Ogni record trovato è un tag Riga che può contenere le seguenti colonne:
1956        																							                                                -- 1:  Id Societa' ( codApplOwner |*| codIstApplOwner )
1957                                                                                                      -- 2:  Descrizione società
1958                                                                                                      -- 3:  Anno
1959                                                                                                      -- 4:  Mese
1960                                                                                                      -- 5:  Totale documenti letti entro 5  gg
1961                                                       												                        -- 6:  Totale documenti letti entro 10 gg
1962        																							                                                -- 7:  Totale documenti letti oltre 10 gg
1963        																							                                                -- 8:  Totale documenti postalizzati
1964                                                       																							  -- 9:  Percentuale documenti letti entro 5  gg
1965                                                       												                        -- 10: Percentuale documenti letti entro 10 gg
1966        																							                                                -- 11: Percentuale documenti letti oltre 10 gg
1967        																							                                                -- 12: Percentuale documenti postalizzati
1968                                                       																							  -- 13: Totale Mail inviate
1969                                         ErrContextOut              OUT      VARCHAR2,                -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
1970                                         ErrCodeOut                OUT      PLS_INTEGER,              -- N.ro errore di uscita
1971                                         ErrMsgOut                  OUT     VARCHAR2                  -- Messaggio d'errore
1972              )
1973              return PLS_INTEGER;
1974        
1975          /******* funzione per generare il report KPI MAIL FOR SALES ORGANIZATION  (nestle) ********/
1976          function TrovaReportKpiNestleMailForSO(
1977                                        CodIdConnectionTokenIn    IN                      DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,   -- (obblig). Codice identificativo del token di connessione
1978                                        IdUserLavoroIn            IN                      DMT_USERS.ID_USER%type DEFAULT NULL,           -- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
1979                                        FiltriIO                  IN OUT  NOCOPY CLOB,    -- XML contenente nomi e valori dei filtri di ricerca(conforme allo schema SezioneCache.xsd).
1980                                                                                          -- Ogni filtro è un tag "Variabile" dell'XML
1981                                                                                          -- I filtri che sono liste hanno nomi (tag Variabile/Nome) che iniziano con @.
1982                                                                                          -- I nomi dei filtri possibili sono:
1983                                                                                          -- Mese              : mese di riferimento  ( ricerca esatta )
1984                                                                                          -- Anno              : anno di riferimento  ( ricerca esatta )
1985                                                                                          -- CodApplOwner	     : Serve a restringere la ricerca ai soli documenti e folder caricati a sistema dall'applicazione esterna qui specificata. Se è valorizzato a #BY_CONN_TKN significa l'applicazione da cui si è connessi
1986                                                        								                  -- CodIstApplOwner   : Serve a restringere la ricerca ai soli documenti e folder caricati a sistema dall'istanza di applicazione esterna qui specificata. Se è valorizzato a #BY_CONN_TKN significa l'istanza di applicazione da cui si è connessi
1987                                                                                           ------------- inizio argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
1988                                        ColOrderByIO              IN OUT  VARCHAR2,        -- Indica il/i numeri della/e colonna dell'XML (CLOB ResultOut) di output per cui ordinare i record nell'XML stesso (si può ordinare solo per le colonne da 1 a xx). Se l'ordinamento è per più colonne queste vanno separate con "," (es: 2; 2,3)
1989                                                                                          -- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul tipo di ordinamento una qualche preimpostazione di sistema/utente ecc.
1990                                                                                          -- se non valorizzato (neppure in output) la lista di record restituita non è ordinata
1991                                        FlgDescOrderByIO          IN OUT  VARCHAR2,        -- E' una stringa di 1 o 0/NULL, tanti quanti le colonne di ordinamento, separati da ",": 1 significa che l'ordinamento per la data colonna deve essere discendente anzichè ascendente (es: 1; 1,0; 1, )
1992                                                                                          -- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul verso di ordinamento una qualche preimpostazione di sistema/utente ecc.
1993                                        FlgSenzaPaginazioneIn     IN       PLS_INTEGER DEFAULT NULL,              -- (valori 1/0/NULL) Se 1 l'estrazione non è paginata, altrimenti sì
1994                                        NroPaginaIO                IN OUT  PLS_INTEGER,    -- E' il numero della pagina da estrarre; se NULL e l'estrazione è paginata viene estratta la prima pagina
1995                                        BachSizeIO                IN OUT  PLS_INTEGER,    -- Indica il massimo n.ro di record da estrarre se l'estrazione non è paginata (FlgSenzaPaginazioneIn=1)
1996                                                                                          -- Indica la dimensione (n.ro di record) della pagina se l'estrazione è paginata (FlgSenzaPaginazioneIn 0 o NULL) e in tal caso se non è valorizzato la dimensione della pagina è quella settata per l'utente di lavoro o è pari al valore del parametro STD_PAGE_NUM_ROW del dominio di lavoro
1997                                        OverFlowLimitIn            IN      PLS_INTEGER DEFAULT NULL,  -- E' il n.ro di record soddisfacenti la ricerca superato il quale la funzione deve restituire errore di overflow
1998                                        FlgSenzaTotIn              IN      PLS_INTEGER DEFAULT NULL,  -- (valori 1/0/NULL) Se 1 significa che non è richiesto come output il totale dei record soddisfacenti la ricerca (se la ricerca è paginata per la prima pagina il totale viene calcolato comunque, per le successive no)
1999                                        NroTotRecOut              OUT      PLS_INTEGER,              -- E' il n.ro di record complessivi trovati (valorizzato solo se FlgSenzaTotIn è 0 o NULL o se si estrae la prima pagina)
2000                                        NroRecInPaginaOut         OUT     PLS_INTEGER,              -- E' il numero di record nella pagina (valorizzato solo se l'estrazione è paginata, ovvero se FlgSenzaPaginazioneIn 0 o NULL)
2001                                        ------------- fine argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
2002        
2003                                         FlgBatchSearchIn          IN      PLS_INTEGER DEFAULT NULL,  -- (valori 1/0/NULL) Se 1 significa che la stored è utilizzata da un processo batch, altrimenti da un processo online.
2004                                                                                                    -- Serve affinchè in caso l'input OverFlowLimitIn non sia valorizzato vengano applicati i limiti di overflow per processo batch o online che sono parametri di configurazione del sistema.
2005                                         ColToReturnIn              IN      VARCHAR2 DEFAULT NULL,    -- Stringa con i n.ri delle colonne dell'XML di output ResultOut che si vuole siano presenti.
2006                                                                                                      -- Se la stringa è vuota saranno presenti tutte le colonne.
2007                                                                                                      -- La colonna 1 sarà presente comunque.
2008                                                                                                      -- I n.ri delle varie colonne vanno separati con , o ; e se si vuole indicare un intervallo di colonne gli estremi dell'intervallo vanno separati con - (es: "1-5;7;10" significa colonne da 1 a 5 più le colonne 7 e 10)
2009                                         ResultOut                  OUT      NOCOPY CLOB,             -- Lista dei record trovati (XML conforme a schema LISTA_STD.xsd)
2010                                                                                                      -- Ogni record trovato è un tag Riga che può contenere le seguenti colonne:
2011        																							                                                -- 1:  Id Societa' ( codApplOwner |*| codIstApplOwner )
2012                                                                                                      -- 2:  Descrizione società
2013                                                                                                      -- 3:  Descrizione Sales Organization
2014                                                                                                      -- 4:  Anno
2015                                                                                                      -- 5:  Mese
2016                                                                                                      -- 6:  Percentuale mail lette entro 5  gg
2017                                                       																							  -- 7:  Percentuale mail lette entro 10 gg
2018        																							                                                -- 8:  Percentuale mail lette oltre 10 gg
2019        																							                                                -- 9:  Percentuale documenti postalizzati
2020        																							                                                --10:  Totale Mail inviate
2021                                         ErrContextOut              OUT      VARCHAR2,                -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
2022                                         ErrCodeOut                OUT      PLS_INTEGER,              -- N.ro errore di uscita
2023                                         ErrMsgOut                  OUT     VARCHAR2                  -- Messaggio d'errore
2024              )
2025              return PLS_INTEGER;
2026        
2027        
2028          /******* funzione per generare il report KPI STATI  (nestle) ********/
2029          function TrovaReportKpiNestleStati(
2030                                        CodIdConnectionTokenIn    IN                      DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,   -- (obblig). Codice identificativo del token di connessione
2031                                        IdUserLavoroIn            IN                      DMT_USERS.ID_USER%type DEFAULT NULL,           -- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
2032                                        FiltriIO                  IN OUT  NOCOPY CLOB,    -- XML contenente nomi e valori dei filtri di ricerca(conforme allo schema SezioneCache.xsd).
2033                                                                                          -- Ogni filtro è un tag "Variabile" dell'XML
2034                                                                                          -- I filtri che sono liste hanno nomi (tag Variabile/Nome) che iniziano con @.
2035                                                                                          -- I nomi dei filtri possibili sono:
2036                                                                                          -- Mese              : mese di riferimento  ( ricerca esatta )
2037                                                                                          -- Anno              : anno di riferimento  ( ricerca esatta )
2038                                                                                          -- CodApplOwner	     : Serve a restringere la ricerca ai soli documenti e folder caricati a sistema dall'applicazione esterna qui specificata. Se è valorizzato a #BY_CONN_TKN significa l'applicazione da cui si è connessi
2039                                                        								                  -- CodIstApplOwner   : Serve a restringere la ricerca ai soli documenti e folder caricati a sistema dall'istanza di applicazione esterna qui specificata. Se è valorizzato a #BY_CONN_TKN significa l'istanza di applicazione da cui si è connessi
2040                                                                                           ------------- inizio argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
2041                                        ColOrderByIO              IN OUT  VARCHAR2,        -- Indica il/i numeri della/e colonna dell'XML (CLOB ResultOut) di output per cui ordinare i record nell'XML stesso (si può ordinare solo per le colonne da 1 a xx). Se l'ordinamento è per più colonne queste vanno separate con "," (es: 2; 2,3)
2042                                                                                          -- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul tipo di ordinamento una qualche preimpostazione di sistema/utente ecc.
2043                                                                                          -- se non valorizzato (neppure in output) la lista di record restituita non è ordinata
2044                                        FlgDescOrderByIO          IN OUT  VARCHAR2,        -- E' una stringa di 1 o 0/NULL, tanti quanti le colonne di ordinamento, separati da ",": 1 significa che l'ordinamento per la data colonna deve essere discendente anzichè ascendente (es: 1; 1,0; 1, )
2045                                                                                          -- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul verso di ordinamento una qualche preimpostazione di sistema/utente ecc.
2046                                        FlgSenzaPaginazioneIn     IN       PLS_INTEGER DEFAULT NULL,              -- (valori 1/0/NULL) Se 1 l'estrazione non è paginata, altrimenti sì
2047                                        NroPaginaIO                IN OUT  PLS_INTEGER,    -- E' il numero della pagina da estrarre; se NULL e l'estrazione è paginata viene estratta la prima pagina
2048                                        BachSizeIO                IN OUT  PLS_INTEGER,    -- Indica il massimo n.ro di record da estrarre se l'estrazione non è paginata (FlgSenzaPaginazioneIn=1)
2049                                                                                          -- Indica la dimensione (n.ro di record) della pagina se l'estrazione è paginata (FlgSenzaPaginazioneIn 0 o NULL) e in tal caso se non è valorizzato la dimensione della pagina è quella settata per l'utente di lavoro o è pari al valore del parametro STD_PAGE_NUM_ROW del dominio di lavoro
2050                                        OverFlowLimitIn            IN      PLS_INTEGER DEFAULT NULL,  -- E' il n.ro di record soddisfacenti la ricerca superato il quale la funzione deve restituire errore di overflow
2051                                        FlgSenzaTotIn              IN      PLS_INTEGER DEFAULT NULL,  -- (valori 1/0/NULL) Se 1 significa che non è richiesto come output il totale dei record soddisfacenti la ricerca (se la ricerca è paginata per la prima pagina il totale viene calcolato comunque, per le successive no)
2052                                        NroTotRecOut              OUT      PLS_INTEGER,              -- E' il n.ro di record complessivi trovati (valorizzato solo se FlgSenzaTotIn è 0 o NULL o se si estrae la prima pagina)
2053                                        NroRecInPaginaOut         OUT     PLS_INTEGER,              -- E' il numero di record nella pagina (valorizzato solo se l'estrazione è paginata, ovvero se FlgSenzaPaginazioneIn 0 o NULL)
2054                                        ------------- fine argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
2055        
2056                                         FlgBatchSearchIn          IN      PLS_INTEGER DEFAULT NULL,  -- (valori 1/0/NULL) Se 1 significa che la stored è utilizzata da un processo batch, altrimenti da un processo online.
2057                                                                                                    -- Serve affinchè in caso l'input OverFlowLimitIn non sia valorizzato vengano applicati i limiti di overflow per processo batch o online che sono parametri di configurazione del sistema.
2058                                         ColToReturnIn              IN      VARCHAR2 DEFAULT NULL,    -- Stringa con i n.ri delle colonne dell'XML di output ResultOut che si vuole siano presenti.
2059                                                                                                      -- Se la stringa è vuota saranno presenti tutte le colonne.
2060                                                                                                      -- La colonna 1 sarà presente comunque.
2061                                                                                                      -- I n.ri delle varie colonne vanno separati con , o ; e se si vuole indicare un intervallo di colonne gli estremi dell'intervallo vanno separati con - (es: "1-5;7;10" significa colonne da 1 a 5 più le colonne 7 e 10)
2062                                         ResultOut                  OUT      NOCOPY CLOB,             -- Lista dei record trovati (XML conforme a schema LISTA_STD.xsd)
2063                                                                                                      -- Ogni record trovato è un tag Riga che può contenere le seguenti colonne:
2064        																							                                                -- 1:  Id Societa' ( codApplOwner |*| codIstApplOwner )
2065                                                                                                      -- 2:  Descrizione società
2066                                                                                                      -- 3:  Descrizione Sales Organization
2067                                                                                                      -- 4:  Descrizione Distribution Channel
2068                                                                                                      -- 5:  Stato
2069                                                                                                      -- 6:  Tipo Documento
2070                                                                                                      -- 7:  Descrizione vettore
2071                                                                                                      -- 8:  Numero documenti nello stato per giorni da 0 a 2 
2072                                                       																							  -- 9:  Numero documenti nello stato per giorni 3
2073        																							                                                --10:  Numero documenti nello stato per giorni 4
2074        																							                                                --11:  Numero documenti nello stato per giorni da 5 a 10
2075                                                                                                      --12:  Numero documenti nello stato per giorni oltre 10
2076                                                                                                      --13:  Totale
2077        
2078                                         ErrContextOut              OUT      VARCHAR2,                  -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
2079                                         ErrCodeOut                OUT      PLS_INTEGER,              -- N.ro errore di uscita
2080                                         ErrMsgOut                  OUT     VARCHAR2                  -- Messaggio d'errore
2081              )
2082              return PLS_INTEGER;
2083        
2084          /***** Restituisce il codice del canale di invio associato all'unita' documentaria *****/
2085          function GetCodCanaleInvioDestUd(
2086             			                          CodIdConnectionTokenIn		     IN		DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%type,    -- (obblig). Codice identificativo del token di connessione
2087        			                              IdUserLavoroIn				         IN		DMT_USERS.ID_USER%type DEFAULT NULL,              -- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
2088        			                              IdUDIn   					             IN   DMT_UNITA_DOC.ID_UD%type,			                    -- (obblig.) Identificativo dell'unità documentaria (registrata o meno a protocollo) inviata via e-mail
2089                                            CodiceCanaleInvioDestOut       OUT  VARCHAR2,                                         -- Codice Canale Invio
2090                                            ErrContextOut                  OUT  VARCHAR2,                                         -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
2091                                            ErrCodeOut                     OUT  PLS_INTEGER,                                      -- N.ro errore di uscita
2092                                            ErrMsgOut                      OUT  VARCHAR2)                                         -- Messaggio d'errore
2093                                            return PLS_INTEGER;                                                                   -- Restituisce 1 (successo) in caso la variabile sia stata trovata nessuna o una ed una sola volta come variabile semplice, altrimenti 0
2094        
2095          /***** Funzione per aggiornare il canale e indirizzo mail del destinatario cluster  *****/
2096        	function UpdDestCluster(
2097                                  CodIdConnectionTokenIn	     IN	  DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE, -- (obblig). Codice identificativo del token di connessione																	
2098        			                    IdUserLavoroIn			         IN		DMT_USERS.ID_USER%type DEFAULT NULL,	         -- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso																	
2099        			                    CodClienteDestIn		         IN   VARCHAR2,                                      -- (obblig). Id. del cliente destinatario. 
2100                                  IdUoClusterIn                IN   VARCHAR2,                                      -- (obblig). IdUo del cluster
2101                                  CodiceCanaledestinatarioIn   IN   VARCHAR2,                                      -- Codice canale da aggiornare/inserire,			
2102                                  EmailDestinatarioIn          IN   VARCHAR2,                                      -- Indirizzo email da aggiornare/inserire,			
2103        
2104                                  FlgRollBckFullIn		         IN 		PLS_INTEGER DEFAULT NULL,		                 -- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
2105        																			                                                                     -- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
2106        			                    FlgAutoCommitIn			         IN 		PLS_INTEGER DEFAULT NULL,		                 -- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
2107        			                    ErrContextOut			           OUT		VARCHAR2,						                         -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
2108        			                    ErrCodeOut				           OUT		PLS_INTEGER,					                       -- N.ro errore di uscita
2109        			                    ErrMsgOut				             OUT    VARCHAR2					                           -- Messaggio d'errore
2110        			                  ) return PLS_INTEGER;											                                         -- Vale 1 se tutto è andato a buon fine (senza warning), altrimenti 0 (in caso di errore o warning)                  
2111        
2112        
2113          /******* funzione per ricercare i dati per il report LOTTI BUCATI (per nestle')  ********/
2114          function TrovaReportLottiBucati(
2115                                          CodIdConnectionTokenIn    IN                      DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,   -- (obblig). Codice identificativo del token di connessione
2116                                          IdUserLavoroIn            IN                      DMT_USERS.ID_USER%type DEFAULT NULL,           -- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
2117                                          FiltriIO                  IN OUT  NOCOPY CLOB,    -- XML contenente nomi e valori dei filtri di ricerca(conforme allo schema SezioneCache.xsd).
2118                                                                                            -- Ogni filtro è un tag "Variabile" dell'XML
2119                                                                                            -- I filtri che sono liste hanno nomi (tag Variabile/Nome) che iniziano con @.                                                                                  
2120                                                                                            ------------- inizio argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
2121                                          ColOrderByIO              IN OUT  VARCHAR2,       -- Indica il/i numeri della/e colonna dell'XML (CLOB ResultOut) di output per cui ordinare i record nell'XML stesso (si può ordinare solo per le colonne da 1 a xx). Se l'ordinamento è per più colonne queste vanno separate con "," (es: 2; 2,3)
2122                                                                                            -- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul tipo di ordinamento una qualche preimpostazione di sistema/utente ecc.
2123                                                                                            -- se non valorizzato (neppure in output) la lista di record restituita non è ordinata
2124                                          FlgDescOrderByIO          IN OUT  VARCHAR2,       -- E' una stringa di 1 o 0/NULL, tanti quanti le colonne di ordinamento, separati da ",": 1 significa che l'ordinamento per la data colonna deve essere discendente anzichè ascendente (es: 1; 1,0; 1, )
2125                                                                                            -- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul verso di ordinamento una qualche preimpostazione di sistema/utente ecc.
2126                                          FlgSenzaPaginazioneIn     IN      PLS_INTEGER DEFAULT NULL,              -- (valori 1/0/NULL) Se 1 l'estrazione non è paginata, altrimenti sì
2127                                          NroPaginaIO               IN OUT  PLS_INTEGER,    -- E' il numero della pagina da estrarre; se NULL e l'estrazione è paginata viene estratta la prima pagina
2128                                          BachSizeIO                IN OUT  PLS_INTEGER,    -- Indica il massimo n.ro di record da estrarre se l'estrazione non è paginata (FlgSenzaPaginazioneIn=1)
2129                                                                                            -- Indica la dimensione (n.ro di record) della pagina se l'estrazione è paginata (FlgSenzaPaginazioneIn 0 o NULL) e in tal caso se non è valorizzato la dimensione della pagina è quella settata per l'utente di lavoro o è pari al valore del parametro STD_PAGE_NUM_ROW del dominio di lavoro
2130                                          OverFlowLimitIn           IN      PLS_INTEGER DEFAULT NULL,  -- E' il n.ro di record soddisfacenti la ricerca superato il quale la funzione deve restituire errore di overflow
2131                                          FlgSenzaTotIn             IN      PLS_INTEGER DEFAULT NULL,  -- (valori 1/0/NULL) Se 1 significa che non è richiesto come output il totale dei record soddisfacenti la ricerca (se la ricerca è paginata per la prima pagina il totale viene calcolato comunque, per le successive no)
2132                                          NroTotRecOut             OUT      PLS_INTEGER,               -- E' il n.ro di record complessivi trovati (valorizzato solo se FlgSenzaTotIn è 0 o NULL o se si estrae la prima pagina)
2133                                          NroRecInPaginaOut        OUT      PLS_INTEGER,               -- E' il numero di record nella pagina (valorizzato solo se l'estrazione è paginata, ovvero se FlgSenzaPaginazioneIn 0 o NULL)
2134                                          ------------- fine argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
2135        
2136                                           FlgBatchSearchIn         IN      PLS_INTEGER DEFAULT NULL,  -- (valori 1/0/NULL) Se 1 significa che la stored è utilizzata da un processo batch, altrimenti da un processo online.
2137                                                                                                       -- Serve affinchè in caso l'input OverFlowLimitIn non sia valorizzato vengano applicati i limiti di overflow per processo batch o online che sono parametri di configurazione del sistema.
2138                                           ColToReturnIn            IN      VARCHAR2 DEFAULT NULL,     -- Stringa con i n.ri delle colonne dell'XML di output ResultOut che si vuole siano presenti.
2139                                                                                                       -- Se la stringa è vuota saranno presenti tutte le colonne.
2140                                                                                                       -- La colonna 1 sarà presente comunque.
2141                                                                                                       -- I n.ri delle varie colonne vanno separati con , o ; e se si vuole indicare un intervallo di colonne gli estremi dell'intervallo vanno separati con - (es: "1-5;7;10" significa colonne da 1 a 5 più le colonne 7 e 10)
2142                                           ResultOut                OUT     NOCOPY CLOB,               -- Lista dei record trovati (XML conforme a schema LISTA_STD.xsd)
2143                                                                                                       -- Ogni record trovato è un tag Riga che può contenere le seguenti colonne:
2144        																							                                                 -- 1:  Numero Lotto mancante
2145        
2146                                           ErrContextOut            OUT      VARCHAR2,                 -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
2147                                           ErrCodeOut               OUT      PLS_INTEGER,              -- N.ro errore di uscita
2148                                           ErrMsgOut                OUT      VARCHAR2                  -- Messaggio d'errore
2149              )
2150              return PLS_INTEGER;
2151        
2152        
2153        
2154          /******* funzione per ricercare i riferimentio bancari ********/
2155          function TrovaRiferimentiBancari(
2156                                           CodIdConnectionTokenIn    IN                      DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,   -- (obblig). Codice identificativo del token di connessione
2157                                           IdUserLavoroIn            IN                      DMT_USERS.ID_USER%type DEFAULT NULL,           -- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
2158                                           FiltriIO                  IN OUT  NOCOPY CLOB,    -- XML contenente nomi e valori dei filtri di ricerca(conforme allo schema SezioneCache.xsd).
2159                                                                                             -- Ogni filtro è un tag "Variabile" dell'XML
2160                                                                                             -- I filtri che sono liste hanno nomi (tag Variabile/Nome) che iniziano con @.
2161                                                                                             -- I nomi dei filtri possibili sono:
2162                                                                                             -- IdRiferimento                     : Id. (PK) del riferimento                  (ricerca esatta)
2163                                                                                             -- DescrizioneRiferimentoBancario    : Descrizione del riferimento bancario      (ricerca case-insensitive in like)
2164                                                                                             -- RagioneSocialeIstitutoFinanziario : Ragione sociale istituto finanziario      (ricerca case-insensitive in like)
2165                                                                                             -- CodiceIBAN                        : Codice IBAN                               (ricerca case-insensitive in like)
2166                                                   																				   -- CodiceABI                         : Codice ABI                                (ricerca case-insensitive in like)
2167                                                   																				   -- CodiceCAB                         : Codice CAB                                (ricerca case-insensitive in like)																				  
2168                                                                                             ------------- inizio argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
2169                                           ColOrderByIO              IN OUT  VARCHAR2,       -- Indica il/i numeri della/e colonna dell'XML (CLOB ResultOut) di output per cui ordinare i record nell'XML stesso (si può ordinare solo per le colonne da 1 a xx). Se l'ordinamento è per più colonne queste vanno separate con "," (es: 2; 2,3)
2170                                                                                             -- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul tipo di ordinamento una qualche preimpostazione di sistema/utente ecc.
2171                                                                                             -- se non valorizzato (neppure in output) la lista di record restituita non è ordinata
2172                                           FlgDescOrderByIO          IN OUT  VARCHAR2,       -- E' una stringa di 1 o 0/NULL, tanti quanti le colonne di ordinamento, separati da ",": 1 significa che l'ordinamento per la data colonna deve essere discendente anzichè ascendente (es: 1; 1,0; 1, )
2173                                                                                             -- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul verso di ordinamento una qualche preimpostazione di sistema/utente ecc.
2174                                           FlgSenzaPaginazioneIn     IN       PLS_INTEGER DEFAULT NULL,              -- (valori 1/0/NULL) Se 1 l'estrazione non è paginata, altrimenti sì
2175                                           NroPaginaIO               IN OUT   PLS_INTEGER,   -- E' il numero della pagina da estrarre; se NULL e l'estrazione è paginata viene estratta la prima pagina
2176                                           BachSizeIO                IN OUT   PLS_INTEGER,   -- Indica il massimo n.ro di record da estrarre se l'estrazione non è paginata (FlgSenzaPaginazioneIn=1)
2177                                                                                             -- Indica la dimensione (n.ro di record) della pagina se l'estrazione è paginata (FlgSenzaPaginazioneIn 0 o NULL) e in tal caso se non è valorizzato la dimensione della pagina è quella settata per l'utente di lavoro o è pari al valore del parametro STD_PAGE_NUM_ROW del dominio di lavoro
2178                                           OverFlowLimitIn           IN       PLS_INTEGER DEFAULT NULL,  -- E' il n.ro di record soddisfacenti la ricerca superato il quale la funzione deve restituire errore di overflow
2179                                           FlgSenzaTotIn             IN       PLS_INTEGER DEFAULT NULL,  -- (valori 1/0/NULL) Se 1 significa che non è richiesto come output il totale dei record soddisfacenti la ricerca (se la ricerca è paginata per la prima pagina il totale viene calcolato comunque, per le successive no)
2180                                           NroTotRecOut              OUT      PLS_INTEGER,               -- E' il n.ro di record complessivi trovati (valorizzato solo se FlgSenzaTotIn è 0 o NULL o se si estrae la prima pagina)
2181                                           NroRecInPaginaOut         OUT      PLS_INTEGER,               -- E' il numero di record nella pagina (valorizzato solo se l'estrazione è paginata, ovvero se FlgSenzaPaginazioneIn 0 o NULL)
2182                                           ------------- fine argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
2183        
2184                                           FlgBatchSearchIn          IN       PLS_INTEGER DEFAULT NULL,  -- (valori 1/0/NULL) Se 1 significa che la stored è utilizzata da un processo batch, altrimenti da un processo online.
2185                                                                                                         -- Serve affinchè in caso l'input OverFlowLimitIn non sia valorizzato vengano applicati i limiti di overflow per processo batch o online che sono parametri di configurazione del sistema.
2186                                           ResultOut                 OUT      NOCOPY CLOB,               -- Lista dei record trovati (XML conforme a schema LISTA_STD.xsd)
2187                                                                                                         -- Ogni record trovato è un tag Riga che può contenere le seguenti colonne:
2188                                                                                                         -- 1:  Id. (PK) del riferimento
2189                                                                                                         -- 2:  Descrizione del riferimento bancario
2190                                                                                                         -- 3:  Ragione sociale istituto finanziario
2191                                                                                                         -- 4:  codice IBAN 
2192                                                                                                         -- 5:  codice ABI
2193                                                                                                         -- 6:  codice CAB
2194        																							                                                   -- 7:  Id utente che ha inserito il record
2195        																							                                                   -- 8:  Descrizione utente che ha inserito il record
2196        																							                                                   -- 9:  Id utente che ha effettuato ultima modifica sul record.
2197        																							                                                   --10:  Descrizione utente che ha effettuato ultima modifica sul record.
2198        																							                                                   --11:  Ts inserimento record  (nel formato dato dal parametro di config. FMT_STD_TIMESTAMP)
2199        																							                                                   --12:  Ts ultima modifica (nel formato dato dal parametro di config. FMT_STD_TIMESTAMP)
2200                                                                                                         --13: (valori 1/0) flgValido     :  valido (=1) o logicamente annullato (=0)
2201                                                                                                         --14: (valori 1/0) recProtetto   :  riservato di sistema e non modificabile da GUI
2202                                                                                                         --15: (valori 1/0) flgAssociato  :  il riferimento e' associato ad un cliente (=1) o non associsto (=0)                                                                                            
2203                                           ErrContextOut              OUT      VARCHAR2,                 -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
2204                                           ErrCodeOut                 OUT      PLS_INTEGER,              -- N.ro errore di uscita
2205                                           ErrMsgOut                  OUT      VARCHAR2                  -- Messaggio d'errore
2206              )
2207              return PLS_INTEGER;     
2208        
2209          /***** Funzione per inserire o aggiornare un riferimento bancario *****/
2210          function IURiferimentoBancario(
2211                                         CodIdConnectionTokenIn               IN          DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,          -- (obblig). Codice identificativo del token di connessione
2212                                         IdUserLavoroIn                       IN          DMT_USERS.ID_USER%type DEFAULT NULL,                    -- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
2213                                         IdRiferimentoIO                      IN OUT      DMT_RIFERIMENTI_BANCARI.ID_RIFERIMENTO%type,            -- Identificativo PK del record da modificare. Se non è valorizzato è da inserire ex-novo   -- In output, salvo in caso di errore, è sempre valorizzato
2214                                         DescrizioneRiferimentoIn             IN          DMT_RIFERIMENTI_BANCARI.DESC_RIF_BANCARIO%TYPE,         -- (obblig.) Descrizione del riferimento bancario (univoco)
2215                                         RagioneSocialeIstitutoFinanzIn       IN          DMT_RIFERIMENTI_BANCARI.RAG_SOC_IST_FINANZIARIO%TYPE,   -- (obblig.) Ragione sociale istituto finanziario
2216                                         CodiceIBANIn                         IN          DMT_RIFERIMENTI_BANCARI.CODICE_IBAN%TYPE,               -- (obblig.) Codice IBAN
2217                                         CodiceABIIn                          IN          DMT_RIFERIMENTI_BANCARI.CODICE_ABI%TYPE,                -- (obblig.) Codice ABI
2218                                         CodiceCABIn                          IN          DMT_RIFERIMENTI_BANCARI.CODICE_CAB%TYPE,                -- (obblig.) Codice CAB
2219                                         FlgAnnullatoIn                       IN          PLS_INTEGER DEFAULT null,                               -- (valori 1/0/NULL) Indicatore per annullare il record
2220                                         FlgLockedIn                          IN          PLS_INTEGER DEFAULT null,                               -- (valori 1/0/NULL) Indicatore di tipo di documento riservato dal sistema e non modificabile/cancellabile da GUI
2221                                         FlgIgnoreWarningIn                   IN          PLS_INTEGER DEFAULT NULL,                               -- (valori 1/0/NULL) Se 0 o NULL significa che in presenza di WARNING la stored si comporta come in caso di errore; se 1 gli WARNING vengono ignorati
2222                                         FlgRollBckFullIn                     IN          PLS_INTEGER DEFAULT NULL,                               -- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
2223                                                                                                                                                  -- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
2224                                         FlgAutoCommitIn                      IN          PLS_INTEGER DEFAULT NULL,                               -- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
2225                                         WarningMsgOut                        OUT         VARCHAR2,                                               -- Messaggio di warning (valorizzato solo se non c'è errore)
2226                                         ErrContextOut                        OUT         VARCHAR2,                                               -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
2227                                         ErrCodeOut                           OUT         PLS_INTEGER,                                            -- N.ro errore di uscita
2228                                         ErrMsgOut                            OUT         VARCHAR2                                                -- Messaggio d'errore
2229                                       ) return PLS_INTEGER;
2230        
2231        
2232          /*** Funzione di eliminazione di un riferimento bancario                ***/
2233          /*** Si può specificare se l'eliminazione deve essere fisica o solo logica (annullamento)    ***/
2234          /*** Se non lo si specifica il sistema fa quella fisica se possibile, se no quella logica    ***/
2235          function DRiferimentoBancario(
2236                                        CodIdConnectionTokenIn           IN      DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,         -- (obblig). Codice identificativo del token di connessione
2237                                        IdUserLavoroIn                   IN      DMT_USERS.ID_USER%type DEFAULT NULL,	                  -- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
2238        			                          IdRiferimentoIn   			         IN 	   DMT_RIFERIMENTI_BANCARI.ID_RIFERIMENTO%TYPE,		      -- (obblig.) Identificativo ID
2239        			                          FlgCancFisicaIn			             IN		   PLS_INTEGER DEFAULT NULL,			                  -- (valori 1/0/NULL): Se 1 si richiede la cancellazione fisica; se 0 l'annullamento logico; se non è valorizzato quella possibile delle 2.
2240                        			          MotiviIn				                 IN		   DMT_ACTIVITIES.NOTE%type,				              -- Motivi della cancellazione/annullamento
2241                                        FlgIgnoreWarningIn 		           IN 	   PLS_INTEGER DEFAULT NULL,			                          -- (valori 1/0/NULL) Se 0 o NULL significa che in presenza di WARNING la stored si comporta come in caso di errore; se 1 gli WARNING vengono ignorati
2242        			                          FlgRollBckFullIn			           IN 	   PLS_INTEGER DEFAULT NULL,			                          -- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
2243                          		          FlgAutoCommitIn			             IN 	   PLS_INTEGER DEFAULT NULL,			                          -- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
2244        			                          WarningMsgOut			               OUT	   VARCHAR2,						                                    -- Messaggio di warning (valorizzato solo se non c'è errore)
2245                          		          ErrContextOut			               OUT	   VARCHAR2,						                                    -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
2246        			                          ErrCodeOut				               OUT	   PLS_INTEGER,					                                  -- N.ro errore di uscita
2247        			                          ErrMsgOut				                 OUT 	   VARCHAR2						                                    -- Messaggio d'errore
2248        			                   ) return PLS_INTEGER;
2249        
2250        
2251          /******* Restituisce i livelli della sale organization e della distribution channel associati all'unita' documentaria  ********/
2252          function GetLivelliStrutturaOrgFromUd(IdUDIn                              IN    DMT_UNITA_DOC.ID_UD%type, -- (obblig.) Identificativo dell'unità documentaria (registrata o meno a protocollo) inviata via e-mail
2253                                                LivelliSalesOrganizationOut        OUT    VARCHAR2,                 -- Livelli della sales organization associata all'unita' documentaria
2254        									                      LivelliDistributionChannelOut      OUT    VARCHAR2,                 -- Livelli della sales organization associata all'unita' documentaria
2255        									                      CentroDiCostoOut                   OUT    VARCHAR2,                 -- Centro di costo associato all'unita' documentaria
2256        									                      ErrContextOut                      OUT    VARCHAR2,                 -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
2257                                                ErrCodeOut                         OUT    PLS_INTEGER,              -- N.ro errore di uscita
2258                                                ErrMsgOut                          OUT    VARCHAR2)                 -- Messaggio d'errore
2259                                                return PLS_INTEGER;
2260        
2261        
2262          function GetValSequence(SequenceNameIn IN VARCHAR2,                     -- Nome della sequence
2263                                  ValSequenceOut OUT NUMBER,                      -- Valore della sequence restituito
2264                                  ErrContextOut  OUT    VARCHAR2,                 -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
2265                                  ErrCodeOut     OUT    PLS_INTEGER,              -- N.ro errore di uscita
2266                                  ErrMsgOut      OUT    VARCHAR2)                 -- Messaggio d'errore
2267                                  return PLS_INTEGER;
2268        
2269        
2270          function isNumber (p_string IN VARCHAR2) RETURN INT;
2271        
2272        
2273          /******* Restituisce le informazioni dell'applicazione e dell'istanza associati all'unita' documentaria  ********/
2274          function GetInfoApplicazioneFromUd(CodIdConnectionTokenIn        IN    DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,   -- (obblig). Codice identificativo del token di connessione
2275                                             IdUserLavoroIn                IN    DMT_USERS.ID_USER%type DEFAULT NULL,           -- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
2276                                             IdUDIn                        IN    DMT_UNITA_DOC.ID_UD%type,              -- (obblig.) Identificativo dell'unità documentaria (registrata o meno a protocollo) inviata via e-mail
2277                                             CiApplicazioneOwnerOut        OUT   DMT_UNITA_DOC.COD_APPL_OWNER%type,     -- CI APPLICAZIONE
2278        									                   CiIstanzaApplicazioneOwnerOut OUT   DMT_UNITA_DOC.COD_IST_APPL_OWNER%type, -- CI ISTANZA APPLICAZIONE
2279                                             ErrContextOut    OUT    VARCHAR2,                                          -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
2280        									                   ErrCodeOut                    OUT   PLS_INTEGER,                           -- N.ro errore di uscita
2281                                             ErrMsgOut                     OUT   VARCHAR2)                              -- Messaggio d'errore
2282                                             return PLS_INTEGER;
2283        
2284         /******* Restituisce il token associato alla societa'  ********/
2285          function GetConnectionTokenSocieta(IdCiApplicazioneIn    IN    VARCHAR2,       -- (obblig.) Identificativo dell'applicazione
2286                                             IdCiIstApplicazioneIn IN    VARCHAR2,       -- (obblig.) Identificativo dell'istanza
2287        									                   UserIdIn              IN    VARCHAR2,       -- Identificativo dell'utente
2288                                             PasswordIn            IN    VARCHAR2,       -- Identificativo della password
2289        									                   ConnectionTokenOut    OUT   VARCHAR2,       -- Token associato alla societa'
2290                                             ErrContextOut         OUT   VARCHAR2,       -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
2291        									                   ErrCodeOut            OUT   PLS_INTEGER,    -- N.ro errore di uscita
2292                                             ErrMsgOut             OUT   VARCHAR2)       -- Messaggio d'errore
2293                                             return PLS_INTEGER;									                                       
2294        
2295         /******* Restituisce la lista delle operazioni disponibili sul documento ********/
2296          function GetListaOperazioniDoc(
2297                                             CodIdConnectionTokenIn    IN      DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,   -- (obblig). Codice identificativo del token di connessione
2298                                             IdUserLavoroIn            IN      DMT_USERS.ID_USER%type DEFAULT NULL,           -- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
2299                                             IdUDIn                    IN      DMT_UNITA_DOC.ID_UD%type, -- (obblig.) Identificativo dell'unità documentaria
2300                                             CodCategoriaRelIn         IN      VARCHAR2,        -- Tipo di categoria (valori FP = fattura passiva, CO = Contratto)
2301                                             ResultOut                 OUT     NOCOPY CLOB,     -- Lista dei record trovati (XML conforme a schema LISTA_STD.xsd)
2302                                                                                                -- Ogni record trovato è un tag Riga che può contenere le seguenti colonne:
2303                                                                                                --  1:  Codice Azione 
2304                                                                                                --  2:  Nome Azione
2305                                                                                                --  3:  Codice stato successivo
2306                                                                                                --  4:  Menu' Icona
2307                                             ErrContextOut             OUT     VARCHAR2,        -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
2308                                             ErrCodeOut                OUT     PLS_INTEGER,     -- N.ro errore di uscita
2309                                             ErrMsgOut                 OUT     VARCHAR2         -- Messaggio d'errore
2310                                            ) return PLS_INTEGER;
2311        
2312          /******* Restituisce il prov_ci_doc_type associato ad un id_doc_type ********/
2313          function GetProvCiDocTypeOfDocTypes(CodIdConnectionTokenIn        IN    DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,   -- (obblig). Codice identificativo del token di connessione
2314                                              IdUserLavoroIn                IN    DMT_USERS.ID_USER%type DEFAULT NULL,             -- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
2315                                              IdDocTypeIn                   IN    DMT_DOC_TYPES.ID_DOC_TYPE%type,                  -- (obblig.) Identificativo del doc type
2316                                              ProvCiDocTypeOut              OUT   DMT_DOC_TYPES.PROV_CI_DOC_TYPE%type,             -- PROV_CI_DOC_TYPE
2317                                              ErrContextOut                 OUT   VARCHAR2,                                        -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
2318         									                    ErrCodeOut                    OUT   PLS_INTEGER,                                     -- N.ro errore di uscita
2319                                              ErrMsgOut                     OUT   VARCHAR2)                                        -- Messaggio d'errore
2320                                              return PLS_INTEGER;
2321        
2322        	/******* funzione per ricercare i destinatari e-mail della fatture passive associate ad un certo Rif. Amministrazione ********/
2323            function TrovaEmailDestFP(
2324                                           CodIdConnectionTokenIn    IN                      DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,   -- (obblig). Codice identificativo del token di connessione
2325                                           IdUserLavoroIn            IN                      DMT_USERS.ID_USER%type DEFAULT NULL,           -- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
2326                                           FiltriIO                  IN OUT  NOCOPY CLOB,    -- XML contenente nomi e valori dei filtri di ricerca(conforme allo schema SezioneCache.xsd).
2327                                                                                             -- Ogni filtro è un tag "Variabile" dell'XML
2328                                                                                             -- I filtri che sono liste hanno nomi (tag Variabile/Nome) che iniziano con @.
2329                                                                                             -- I nomi dei filtri possibili sono:
2330                                                                                             -- RifAmministrazione          (ricerca case-insensitive in like)	
2331        																					 -- IndirizzoEmailDest			(ricerca case-insensitive in like)
2332                                           ------------- inizio argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
2333                                           ColOrderByIO              IN OUT  VARCHAR2,       -- Indica il/i numeri della/e colonna dell'XML (CLOB ResultOut) di output per cui ordinare i record nell'XML stesso (si può ordinare solo per le colonne da 1 a xx). Se l'ordinamento è per più colonne queste vanno separate con "," (es: 2; 2,3)
2334                                                                                             -- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul tipo di ordinamento una qualche preimpostazione di sistema/utente ecc.
2335                                                                                             -- se non valorizzato (neppure in output) la lista di record restituita non è ordinata
2336                                           FlgDescOrderByIO          IN OUT  VARCHAR2,       -- E' una stringa di 1 o 0/NULL, tanti quanti le colonne di ordinamento, separati da ",": 1 significa che l'ordinamento per la data colonna deve essere discendente anzichè ascendente (es: 1; 1,0; 1, )
2337                                                                                             -- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul verso di ordinamento una qualche preimpostazione di sistema/utente ecc.
2338                                           FlgSenzaPaginazioneIn     IN       PLS_INTEGER DEFAULT NULL,              -- (valori 1/0/NULL) Se 1 l'estrazione non è paginata, altrimenti sì
2339                                           NroPaginaIO               IN OUT   PLS_INTEGER,   -- E' il numero della pagina da estrarre; se NULL e l'estrazione è paginata viene estratta la prima pagina
2340                                           BachSizeIO                IN OUT   PLS_INTEGER,   -- Indica il massimo n.ro di record da estrarre se l'estrazione non è paginata (FlgSenzaPaginazioneIn=1)
2341                                                                                             -- Indica la dimensione (n.ro di record) della pagina se l'estrazione è paginata (FlgSenzaPaginazioneIn 0 o NULL) e in tal caso se non è valorizzato la dimensione della pagina è quella settata per l'utente di lavoro o è pari al valore del parametro STD_PAGE_NUM_ROW del dominio di lavoro
2342                                           OverFlowLimitIn           IN       PLS_INTEGER DEFAULT NULL,  -- E' il n.ro di record soddisfacenti la ricerca superato il quale la funzione deve restituire errore di overflow
2343                                           FlgSenzaTotIn             IN       PLS_INTEGER DEFAULT NULL,  -- (valori 1/0/NULL) Se 1 significa che non è richiesto come output il totale dei record soddisfacenti la ricerca (se la ricerca è paginata per la prima pagina il totale viene calcolato comunque, per le successive no)
2344                                           NroTotRecOut              OUT      PLS_INTEGER,               -- E' il n.ro di record complessivi trovati (valorizzato solo se FlgSenzaTotIn è 0 o NULL o se si estrae la prima pagina)
2345                                           NroRecInPaginaOut         OUT      PLS_INTEGER,               -- E' il numero di record nella pagina (valorizzato solo se l'estrazione è paginata, ovvero se FlgSenzaPaginazioneIn 0 o NULL)
2346                                           ------------- fine argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
2347        
2348                                           FlgBatchSearchIn          IN       PLS_INTEGER DEFAULT NULL,  -- (valori 1/0/NULL) Se 1 significa che la stored è utilizzata da un processo batch, altrimenti da un processo online.
2349                                                                                                         -- Serve affinchè in caso l'input OverFlowLimitIn non sia valorizzato vengano applicati i limiti di overflow per processo batch o online che sono parametri di configurazione del sistema.
2350                                           ResultOut                 OUT      NOCOPY CLOB,               -- Lista dei record trovati (XML conforme a schema LISTA_STD.xsd)
2351                                                                                                         -- Ogni record trovato è un tag Riga che può contenere le seguenti colonne:
2352                                                                                                         -- 1:  Id. (PK) del record
2353                                                                                                         -- 2:  Cod. applicazione-società + codice istanza (separati da |*|)
2354                                                                                                         -- 3:  Rif. amminstrazione
2355                                                                                                         -- 4 	Indirizzo/i e-mail a cui inviare le fatture (se più di uno separati da ;)
2356                                          ErrContextOut              OUT      VARCHAR2,                 -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
2357                                           ErrCodeOut                 OUT      PLS_INTEGER,              -- N.ro errore di uscita
2358                                           ErrMsgOut                  OUT      VARCHAR2                  -- Messaggio d'errore
2359              )
2360              return PLS_INTEGER;     
2361        
2362        	  /***** Funzione per inserire o aggiornare i destinatari e-mail della fatture passive associate ad un certo Rif. Amministrazione ********/
2363        	  function IUEmailDestFP(
2364        									 CodIdConnectionTokenIn               IN          DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,          -- (obblig). Codice identificativo del token di connessione
2365        									 IdUserLavoroIn                       IN          DMT_USERS.ID_USER%type DEFAULT NULL,                    -- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
2366        									 IdRelazioneIO                        IN OUT      INTEGER,           									  -- Identificativo PK del record da modificare. Se non è valorizzato è da inserire ex-novo   -- In output, salvo in caso di errore, è sempre valorizzato
2367        									 CodApplIstanzaIn					  IN 		  VARCHAR2,												  -- (obbig se cliente con più società) Codice applicazione |*| codice istanza applicazione della società
2368        									 RifAmministrazioneIn				  IN		  VARCHAR2,												  -- (Obblig.) Rif. amministrazione di chi ha mandato la fattura
2369        									 EmailDestFPIn						  IN		  VARCHAR2,												  -- (Obblig.) Indirizzo/i e-mail a cui mandare la fattura (se più di uno separati da ;)
2370        									 DenominazioneIn            IN		      VARCHAR2,												  	                    -- (Obblig.) Denominazione -- aggiunto da Domdantoni 27/11/2019
2371                           FlgIgnoreWarningIn                   IN          PLS_INTEGER DEFAULT NULL,                               -- (valori 1/0/NULL) Se 0 o NULL significa che in presenza di WARNING la stored si comporta come in caso di errore; se 1 gli WARNING vengono ignorati
2372        									 FlgRollBckFullIn                     IN          PLS_INTEGER DEFAULT NULL,                               -- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
2373        																																			  -- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
2374        									 FlgAutoCommitIn                      IN          PLS_INTEGER DEFAULT NULL,                               -- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
2375        									 WarningMsgOut                        OUT         VARCHAR2,                                               -- Messaggio di warning (valorizzato solo se non c'è errore)
2376        									 ErrContextOut                        OUT         VARCHAR2,                                               -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
2377        									 ErrCodeOut                           OUT         PLS_INTEGER,                                            -- N.ro errore di uscita
2378        									 ErrMsgOut                            OUT         VARCHAR2                                                -- Messaggio d'errore
2379        								   ) return PLS_INTEGER;
2380        
2381        
2382        	/*** Funzione di eliminazione di tutti i destinatari e-mail della fatture passive associate ad un certo Rif. Amministrazione ********/
2383        	/*** Si può specificare se l'eliminazione deve essere fisica o solo logica (annullamento)    ***/
2384        	/*** Se non lo si specifica il sistema fa quella fisica se possibile, se no quella logica    ***/
2385        	function DEmailDestFP(
2386        								CodIdConnectionTokenIn           IN      DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,         -- (obblig). Codice identificativo del token di connessione
2387        								IdUserLavoroIn                   IN      DMT_USERS.ID_USER%type DEFAULT NULL,	                  -- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
2388        			                    IdRelazioneIn   			     IN 	 INTEGER,												-- (obblig.) Identificativo PK del record da modificare		     
2389        								FlgCancFisicaIn			             IN		   PLS_INTEGER DEFAULT NULL,			                  -- (valori 1/0/NULL): Se 1 si richiede la cancellazione fisica; se 0 l'annullamento logico; se non è valorizzato quella possibile delle 2.
2390                        			    MotiviIn				                 IN		   DMT_ACTIVITIES.NOTE%type,				              -- Motivi della cancellazione/annullamento
2391                                        FlgIgnoreWarningIn 		           IN 	   PLS_INTEGER DEFAULT NULL,			                          -- (valori 1/0/NULL) Se 0 o NULL significa che in presenza di WARNING la stored si comporta come in caso di errore; se 1 gli WARNING vengono ignorati
2392        			                          FlgRollBckFullIn			           IN 	   PLS_INTEGER DEFAULT NULL,			                          -- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
2393                          		          FlgAutoCommitIn			             IN 	   PLS_INTEGER DEFAULT NULL,			                          -- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
2394        			                          WarningMsgOut			               OUT	   VARCHAR2,						                                    -- Messaggio di warning (valorizzato solo se non c'è errore)
2395                          		          ErrContextOut			               OUT	   VARCHAR2,						                                    -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
2396        			                          ErrCodeOut				               OUT	   PLS_INTEGER,					                                  -- N.ro errore di uscita
2397        			                          ErrMsgOut				                 OUT 	   VARCHAR2						                                    -- Messaggio d'errore
2398        			                   ) return PLS_INTEGER;
2399        
2400        
2401         /***** Funzione per verificare se tutti i file elettronici associati ad una unita' documentaria sono stati caricati *****/
2402          function HasFileElettroniciUploadedUd(CodIdConnectionTokenIn		      IN	 DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%type,    -- (obblig). Codice identificativo del token di connessione
2403        			                                  IdUserLavoroIn				          IN	 DMT_USERS.ID_USER%type DEFAULT NULL,              -- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
2404        			                                  IdUDIn   					              IN   DMT_UNITA_DOC.ID_UD%type,			              -- (obblig.) Identificativo dell'unità documentaria (registrata o meno a protocollo) inviata via e-mail
2405                                                EsitoOut                        OUT  INTEGER,                                          -- Esito 1/0
2406                                                ErrContextOut                   OUT  VARCHAR2,                                         -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
2407                                                ErrCodeOut                      OUT  PLS_INTEGER,                                      -- N.ro errore di uscita
2408                                                ErrMsgOut                       OUT  VARCHAR2)                                         -- Messaggio d'errore
2409                                                return PLS_INTEGER;
2410        
2411         /***** Funzione per verificare se il tipo_pagamento di un contratto BiAuto e' FINANZ *****/
2412          function IsTipoPagamentoFinanziamento( IdUDIn IN DMT_UNITA_DOC.ID_UD%type ) return number;
2413          
2414         /***** Funzione per verificare se un tipo allegato ha un default *****/
2415          function EsiteDefaultTipoAllegato( TipoContrattoIn IN   DMT_BIAUTO_TIPO_ALLEGATI.TIPO_CONTRATTO%type,
2416                                             TipoPagamentoIn IN   DMT_BIAUTO_TIPO_ALLEGATI.TIPO_PAGAMENTO%type,
2417                                             TipoServizioIn  IN   DMT_BIAUTO_TIPO_ALLEGATI.TIPO_SERVIZIO%type,
2418                                             FlgPermutaIn    IN   DMT_BIAUTO_TIPO_ALLEGATI.FLG_PERMUTA%type,
2419                                             TipoAllegatoIn  IN   DMT_BIAUTO_TIPO_ALLEGATI.TIPO_ALLEGATO%type
2420                                           ) return number;
2421        
2422        
2423          /******* funzione per ricercare gli altri allegati associati alla fattura ********/
2424          function TrovaAltriAllegatiFattura(
2425                                           CodIdConnectionTokenIn    IN                      DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,   -- (obblig). Codice identificativo del token di connessione
2426                                           IdUserLavoroIn            IN                      DMT_USERS.ID_USER%type DEFAULT NULL,           -- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
2427                                           FiltriIO                  IN OUT  NOCOPY CLOB,    -- XML contenente nomi e valori dei filtri di ricerca(conforme allo schema SezioneCache.xsd).
2428                                                                                             -- Ogni filtro è un tag "Variabile" dell'XML
2429                                                                                             -- I filtri che sono liste hanno nomi (tag Variabile/Nome) che iniziano con @.
2430                                                                                             -- I nomi dei filtri possibili sono:
2431                                                                                             -- CodApplOwner      : Codice applicazione societa'. Se è valorizzato a #BY_CONN_TKN significa l'applicazione da cui si è connessi
2432                                                                                             -- CodIstApplOwner   : Codic istanza societa'. Se è valorizzato a #BY_CONN_TKN significa l'istanza di applicazione da cui si è connessi
2433                                                                                             ------------- inizio argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
2434                                           ColOrderByIO              IN OUT  VARCHAR2,       -- Indica il/i numeri della/e colonna dell'XML (CLOB ResultOut) di output per cui ordinare i record nell'XML stesso (si può ordinare solo per le colonne da 1 a xx). Se l'ordinamento è per più colonne queste vanno separate con "," (es: 2; 2,3)
2435                                                                                             -- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul tipo di ordinamento una qualche preimpostazione di sistema/utente ecc.
2436                                                                                             -- se non valorizzato (neppure in output) la lista di record restituita non è ordinata
2437                                           FlgDescOrderByIO          IN OUT  VARCHAR2,       -- E' una stringa di 1 o 0/NULL, tanti quanti le colonne di ordinamento, separati da ",": 1 significa che l'ordinamento per la data colonna deve essere discendente anzichè ascendente (es: 1; 1,0; 1, )
2438                                                                                             -- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul verso di ordinamento una qualche preimpostazione di sistema/utente ecc.
2439                                           FlgSenzaPaginazioneIn     IN       PLS_INTEGER DEFAULT NULL,              -- (valori 1/0/NULL) Se 1 l'estrazione non è paginata, altrimenti sì
2440                                           NroPaginaIO               IN OUT   PLS_INTEGER,   -- E' il numero della pagina da estrarre; se NULL e l'estrazione è paginata viene estratta la prima pagina
2441                                           BachSizeIO                IN OUT   PLS_INTEGER,   -- Indica il massimo n.ro di record da estrarre se l'estrazione non è paginata (FlgSenzaPaginazioneIn=1)
2442                                                                                             -- Indica la dimensione (n.ro di record) della pagina se l'estrazione è paginata (FlgSenzaPaginazioneIn 0 o NULL) e in tal caso se non è valorizzato la dimensione della pagina è quella settata per l'utente di lavoro o è pari al valore del parametro STD_PAGE_NUM_ROW del dominio di lavoro
2443                                           OverFlowLimitIn           IN       PLS_INTEGER DEFAULT NULL,  -- E' il n.ro di record soddisfacenti la ricerca superato il quale la funzione deve restituire errore di overflow
2444                                           FlgSenzaTotIn             IN       PLS_INTEGER DEFAULT NULL,  -- (valori 1/0/NULL) Se 1 significa che non è richiesto come output il totale dei record soddisfacenti la ricerca (se la ricerca è paginata per la prima pagina il totale viene calcolato comunque, per le successive no)
2445                                           NroTotRecOut              OUT      PLS_INTEGER,               -- E' il n.ro di record complessivi trovati (valorizzato solo se FlgSenzaTotIn è 0 o NULL o se si estrae la prima pagina)
2446                                           NroRecInPaginaOut         OUT      PLS_INTEGER,               -- E' il numero di record nella pagina (valorizzato solo se l'estrazione è paginata, ovvero se FlgSenzaPaginazioneIn 0 o NULL)
2447                                           ------------- fine argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
2448        
2449                                           FlgBatchSearchIn          IN       PLS_INTEGER DEFAULT NULL,  -- (valori 1/0/NULL) Se 1 significa che la stored è utilizzata da un processo batch, altrimenti da un processo online.
2450                                                                                                         -- Serve affinchè in caso l'input OverFlowLimitIn non sia valorizzato vengano applicati i limiti di overflow per processo batch o online che sono parametri di configurazione del sistema.
2451                                           ResultOut                 OUT      NOCOPY CLOB,               -- Lista dei record trovati (XML conforme a schema LISTA_STD.xsd)
2452                                                                                                         -- Ogni record trovato è un tag Riga che può contenere le seguenti colonne:
2453                                                                                                         -- 1:  Id. (PK) dell'allegato
2454                                                                                                         -- 2:  Lista dei Nomi file
2455                                                                                                         -- 3:  Tipologia
2456                                                                                                         -- 4:  Valori
2457                                                                                                         -- 5:  Data inizio validita'
2458                                                                                                         -- 6:  Data fine validita'
2459                                                                                                         -- 7:  Id ud
2460                                                                                                         -- 8:  Descrizione utente che ha inserito il record
2461        																							                                                   -- 9:  Descrizione utente che ha effettuato ultima modifica sul record.
2462        																							                                                   --10:  Ts inserimento record  (nel formato dato dal parametro di config. FMT_STD_TIMESTAMP)
2463        																							                                                   --11:  Ts ultima modifica (nel formato dato dal parametro di config. FMT_STD_TIMESTAMP)
2464                                                                                                         --12:  flgAnn :  annullato (=1) o valido (=0)
2465                                           ErrContextOut              OUT      VARCHAR2,                 -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
2466                                           ErrCodeOut                 OUT      PLS_INTEGER,              -- N.ro errore di uscita
2467                                           ErrMsgOut                  OUT      VARCHAR2                  -- Messaggio d'errore
2468              )
2469              return PLS_INTEGER;
2470              
2471          /******* funzione per ricercare il dettaglio di un altro allegato  ********/
2472          function TrovaAltriAllegatiFatturaDett( CodIdConnectionTokenIn          IN        DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,    -- (obblig). Codice identificativo del token di connessione
2473                                                  IdUserLavoroIn                  IN        DMT_USERS.ID_USER%type DEFAULT NULL,              -- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
2474                                                  IdKeyIn                         IN        VARCHAR2,                                         -- (obblig) Id. (PK).
2475                                                  DatiXMLOut                      OUT       NOCOPY CLOB,                                      -- Dati restituiti (XML conforme a schema SezioneCache.xsd)
2476                                                                                                                                              -- I dati restituiti corrispondono ai seguenti tag Variabile:
2477                                                                                                                                              -- #IdKey                     : Id. (PK) dell'allegato
2478                                                                                                                                              -- #CodTipologia              : Codice della tipologia
2479                                                                                                                                              -- #DescrizioneTipologia      : Descrizione della tipologia
2480                                                                                                                                              -- @ListaValori, lista con una sola colonna stringa
2481                                                                                                                                              -- #DataInizioValidita        : Data inizio validita'
2482                                                                                                                                              -- #DataFineValidita          : Data fine validita'
2483                                                                                                                                              -- #IdUd                      : Id Ud
2484                                                                                                                                              -- #IdUtenteIns               : Id utente che ha inserito il record
2485                                                                                                                                              -- #DescUtenteIns             : Descrizione utente che ha inserito il record
2486                                                                                                                                              -- #DataIns                   : Ts inserimento record
2487                                                                                                                                              -- #IdUtenteUltMod            : Id utente che ha effettuato ultima modifica sul record.
2488                                                                                                                                              -- #DescUtenteUltMod          : Descrizione utente che ha effettuato ultima modifica sul record.
2489                                                                                                                                              -- #DataUltMod                : Ts ultima modifica                                                                                                                                        
2490                                                                                                                                              -- #FlgAnnullato              : annullato (=1) o valido (=0)                                                                                                                                                                                                                                                                                
2491                                                  ErrContextOut                   OUT       VARCHAR2,                                         -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
2492                                                  ErrCodeOut                      OUT       PLS_INTEGER,                                      -- N.ro errore di uscita
2493                                                  ErrMsgOut                       OUT       VARCHAR2                                          -- Messaggio d'errore
2494              )
2495              return PLS_INTEGER;
2496              
2497        
2498          /***** Funzione per inserire o aggiornare un altro allegato *****/
2499          function IUAltriAllegatiFattura(CodIdConnectionTokenIn     IN      DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,          -- (obblig). Codice identificativo del token di connessione
2500                                          IdUserLavoroIn             IN      DMT_USERS.ID_USER%type DEFAULT NULL,                    -- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso                                                                                                                          
2501                                          IdKeyIO                    IN OUT  DMT_ALTRI_ALLEGATI_FATTURE.ID_KEY%type,                 -- Identificativo PK del record
2502                                          AttributiXMLIn	           IN	CLOB,			-- XML contenente nomi e valori degli attributi (conforme allo schema SezioneCache.xsd)
2503        																	                                        -- Gli attributi sono:
2504                                                                                  -- #CodTipologia              : Codice della tipologia
2505                                                                                  -- #DataInizioValidita        : Data inizio validita'
2506                                                                                  -- #DataFineValidita          : Data fine validita'
2507                                                                                  -- #IdUd                      : Id Ud
2508                                                                                  -- #FlgAnnullato  		        : annullato (=1) o valido (=0)                                                                                                                                                    
2509        			                            XMLValoriIn		             IN		CLOB DEFAULT NULL,	-- Lista dei valori  (XML conforme a schema LISTA_STD.xsd)
2510        																	                                                    -- Ogni valore è un tag "Riga" che contiene una stringa
2511                                          FlgIgnoreWarningIn               IN      PLS_INTEGER DEFAULT NULL,                               -- (valori 1/0/NULL) Se 0 o NULL significa che in presenza di WARNING la stored si comporta come in caso di errore; se 1 gli WARNING vengono ignorati
2512                                          FlgRollBckFullIn                 IN      PLS_INTEGER DEFAULT NULL,                               -- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored   -- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
2513                                          FlgAutoCommitIn                  IN      PLS_INTEGER DEFAULT NULL,                               -- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
2514                                          WarningMsgOut                    OUT     VARCHAR2,                                               -- Messaggio di warning (valorizzato solo se non c'è errore)
2515                                          ErrContextOut                    OUT     VARCHAR2,                                               -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
2516                                          ErrCodeOut                       OUT     PLS_INTEGER,                                            -- N.ro errore di uscita
2517                                          ErrMsgOut                        OUT     VARCHAR2                                                -- Messaggio d'errore
2518                                         ) return PLS_INTEGER;
2519                 
2520          
2521          /*** Funzione di eliminazione di un altro allegato  ***/
2522          /*** Si può specificare se l'eliminazione deve essere fisica o solo logica (annullamento)    ***/
2523          /*** Se non lo si specifica il sistema fa quella fisica se possibile, se no quella logica    ***/
2524          function DAltriAllegatiFattura(
2525                                         CodIdConnectionTokenIn     IN      DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,          -- (obblig). Codice identificativo del token di connessione
2526                                         IdUserLavoroIn             IN      DMT_USERS.ID_USER%type DEFAULT NULL,	                  -- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
2527                  			                 IdKeyIn   			            IN 		  DMT_ALTRI_ALLEGATI_FATTURE.ID_KEY%type,		              -- (obblig.) Identificativo ID
2528        			                           FlgCancFisicaIn			      IN		  PLS_INTEGER DEFAULT NULL,			                          -- (valori 1/0/NULL): Se 1 si richiede la cancellazione fisica; se 0 l'annullamento logico; se non è valorizzato quella possibile delle 2.
2529                                  			 MotiviIn				            IN		  DMT_ACTIVITIES.NOTE%type,				                        -- Motivi della cancellazione/annullamento
2530                                         FlgIgnoreWarningIn 		    IN 	    PLS_INTEGER DEFAULT NULL,			                          -- (valori 1/0/NULL) Se 0 o NULL significa che in presenza di WARNING la stored si comporta come in caso di errore; se 1 gli WARNING vengono ignorati
2531        			                           FlgRollBckFullIn			      IN 	    PLS_INTEGER DEFAULT NULL,			                          -- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
2532                                    		 FlgAutoCommitIn			      IN 	    PLS_INTEGER DEFAULT NULL,			                          -- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
2533        			                           WarningMsgOut			        OUT	    VARCHAR2,						                                    -- Messaggio di warning (valorizzato solo se non c'è errore)
2534                          	          	 ErrContextOut			        OUT	    VARCHAR2,						                                    -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
2535                  			                 ErrCodeOut				          OUT	    PLS_INTEGER,					                                  -- N.ro errore di uscita
2536        			                           ErrMsgOut				          OUT 	  VARCHAR2						                                    -- Messaggio d'errore
2537        			                         ) return PLS_INTEGER;
2538                               
2539           /******* Restituisce la lista dei valori presenti nella nested valori_ammessi nella tabella DMT_ALTRI_ALLEGATI_FATTURA  ********/
2540           function GetValAmmAltriAllegatiFattura(  IdKeyIn  IN    VARCHAR2   -- (obblig). Id key del record.
2541                                                 ) return VARCHAR2;
2542        
2543           /******* Restituisce i nomi dei file associati alla id ud presente nella tabella DMT_ALTRI_ALLEGATI_FATTURA  ********/
2544           function GetDisplayFilenameAltriAllFatt( IdUdIn  IN    VARCHAR2   -- (obblig). Id ud.
2545                                                  ) return VARCHAR2;
2546              
2547          END;