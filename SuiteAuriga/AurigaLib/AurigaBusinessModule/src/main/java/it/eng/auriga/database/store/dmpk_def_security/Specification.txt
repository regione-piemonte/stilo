1        PACKAGE DMPK_DEF_SECURITY AUTHID CURRENT_USER IS
2        
3        	/********* è il package che si occupa della definizione di tutte le entità legate alla sicurezza (tranne utenti, UO e ruoli) e della loro profilatura ********/ 
4        
5        	/****************************************************		INFORMAZIONI GENERALI		*******************************************************/
6        	/************** Argomenti delle stored per il controllo della transazione:											*******/
7        	/************** FlgRollBckFullIn -> se 1 in caso di errore viene fatta la rollback completa (non a savepoint), 					*******/
8        	/************** 				altrimenti la rollback delle sole modifiche effettuate nella stored						*******/
9        	/************** 				ATTENZIONE: la rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log			*******/
10        	/************** FlgAutoCommitIn  -> se vale 1, dopo la rollback e qualunque sia l'esito (positivo o no), la stored esegue una commit finale *****/
11        	/************** Tutte le funzioni/procedure che NON hanno gli argomenti in input FlgRollBckFullIn e FlgAutoCommitIn 				*******/
12        	/************** NON ESEGUONO AL LORO INTERNO ALCUNA COMMIT nè ROLLBACK 												*******/
13        
14        	/************** Tutte le funzioni, tranne quelle da utilizzarsi nelle select, restituiscono 1 in caso di successo, altrimenti 0		*******/
15        	/************** Tali funzioni restituiscono, in caso di result 0, un n.ro, un contesto e un messaggio di errore:					*******/
16        	/************** il n.ro è: <0 se errore ORACLE non specificamente gestito 											*******/
17        	/**************		   da 1->1000 errore "grave" (SEVERE_ERROR) gestito											*******/
18        	/**************		   >1000 errore non grave gestito														*******/
19        	/************** il contesto indica il package e/o funzione/procedura in cui si è verificato l'errore							*******/
20        
21        	/********** funzione per ottenere l'id. dell'organigramma in vigore per un dato soggetto prod./AOO ad un dato timestamp **********/
22        	function GetIdOrganigrammaSpAOO(
23        			IdSpAOOIn		IN		DMT_SOGGETTI_PROD_AOO.ID_SP_AOO%type,	-- (obblig) Id. del soggetto produttore o AOO per cui trovare l'organigramma
24        			TsRifIn			IN		DATE DEFAULT sysdate					-- Data e ora a cui ricavare l'organigramma
25        																			-- se non specificata si intende sysdate
26        			) return DMT_ORGANIGRAMMI.ID_ORGANIGRAMMA%type;					-- Id. dell'organigramma
27        																			-- in caso di errore o se non c'è il piano è NULL
28        
29        	/******* serve a ricercare una funzione del sistema (eventualmente solo se disponibile in un dato dominio di lavoro) a partire dal suo codice e/o sua descrizione		******/
30        	/******* restituisce il codice identificativo della funzione solo se a partire dagli estremi immessi riesce a identificarla univocamente			 			******/
31        	function FindFunzione(
32        			IdDominioIn				IN		DMT_SOGGETTI_PROD_AOO.ID_SP_AOO%type,	-- Identificativo del dominio di lavoro (se NULL si intende lo schema)	
33        			CodFunzIn				IN		VARCHAR2 DEFAULT NULL,				-- Codice della funzione (stringa restituita dalla function dmpk_utility.GetCodFunz per quella funzione: ricerca case-sensitive esatta)	
34        			DesFunzIn				IN		VARCHAR2 DEFAULT NULL,				-- Stringa contenuta nella descrizione della funzione (ricerca case-insenstive in like, se si mettono caratteri wilcard)
35        			FlgSoloDispIn			IN		PLS_INTEGER DEFAULT 1				-- (valori 1/0/NULL) Indica se la funzione deve essere valida e disponile nel dominio di lavoro (1) o no
36        			) return VARCHAR2;											-- restituisce il codice della funzione (stringa restituita dalla function dmpk_utility.GetCodFunz per quella funzione) se individuata univocamente, altrimenti NULL
37        
38        	/****** 	serve a ricercare le funzione del sistema e/o delle applicazioni esterne che vi si appogiano *******/
39        	function TrovaFunzioni(
40        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
41        																	-- (obblig). Codice identificativo del token di connessione
42        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
43        			FlgPreimpostaFiltroIn		IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1 i filtri e l'ordinamento vengono settati secondo le impostazioni dell'utente di lavoro, altrimenti restano come passati in input
44        			CodFunzP1IO				IN OUT	DMT_FUNZIONI.COD_FUNZ_P1%type,		-- 1° filtro di ricerca: Prima parte del codice della funzione, cioè quella che indica la macro-area di appartenenza (Ricerca case-sensitive esatta)	
45        			CodFunzP2IO				IN OUT	DMT_FUNZIONI.COD_FUNZ_P2%type,		-- 2° filtro di ricerca: 2a parte del codice della funzione, cioè quella che indica l'area di appartenenza (Ricerca case-sensitive esatta)	
46        			CodFunzP3IO				IN OUT	DMT_FUNZIONI.COD_FUNZ_P3%type,		-- 3° filtro di ricerca: 3a parte del codice della funzione (Ricerca case-sensitive esatta)	
47        			CodFunzPnIO				IN OUT	VARCHAR2,						-- 4° filtro di ricerca: codice che deve essere contenuto in una qualsiasi delle 3 parti che compongono il codice della funzione (Ricerca case-sensitive esatta)	
48        			DesFunzIO				IN OUT	VARCHAR2,						-- 5° filtro di ricerca: Stringa contenuta nella descrizione delle funzioni (ricerca case-insenstive in like)
49        			LivelloFunzIO			IN OUT	PLS_INTEGER,					-- 6° filtro di ricerca (valori ammessi 1/2/3/NULL): Serve a restringere la ricerca alle funzioni di primo livello (quelle che hanno COD_FUNZ_P2 e COD_FUNZ_P3 nulli), 2° livello (quelle che hanno COD_FUNZ_P3 nullo) e 3° livello (quelle che hanno COD_FUNZ_P3 valorizzato)
50        			FlgConSottoFunzioniIO		IN OUT	PLS_INTEGER,					-- 7° filtro di ricerca (valori 1/0/NULL) Se 1 indica che vanno ricercate funzioni con sotto-funzioni, se 0 funzioni senza sotto-funzioni
51        			FlgSoloDispIO			IN OUT	PLS_INTEGER,					-- 8° filtro di ricerca: (valori 1/0/NULL) Indica se le funzioni da cercare devono essere valide e disponili nel dominio di lavoro (1) o no
52        			FlgSoloConOpzStdIO		IN OUT	PLS_INTEGER,					-- 9° filtro di ricerca (valori 1/0/NULL) Se 1 indica che vanno ricercate solo le funzioni con opzioni standard, se 0 solo quelle senza opzioni standard
53        			CodApplOwnerIO			IN OUT	VARCHAR2,						-- 10° filtro di ricerca: Codice dell'applicazione "proprietaria" delle funzioni. Se valorizzata pari a #BY_CONN_TKN e si è connessi da un'applicazione esterna si ricercano solo funzioni di cui è proprietaria quell'applicazione
54        			CodIstApplOwnerIO			IN OUT	VARCHAR2,						-- 11° filtro di ricerca: Codice dell'istanza di applicazione "proprietaria" delle funzioni. Se valorizzata pari a #BY_CONN_TKN e si è connessi da un'applicazione esterna si ricercano solo funzioni di cui è proprietaria l'istanza di applicazione esterna da cui si è connessi
55        			FlgRestrApplOwnerIO		IN OUT	INTEGER,						-- (valori 1/0/NULL) Se 1 vengono estratte solo funzioni di cui è proprietaria l'applicazione proprietaria (ed eventuale istanza) specificata in CodApplOwnerIO; se 0 o NULL e se CodApplOwnerIO è valorizzata vengono estratte solo le funzioni senza applicazione proprietaria o con applicazione proprietria pari a quella specificata
56        			------------- inizio argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
57        			ColOrderByIO			IN OUT	VARCHAR2,						-- Indica il/i numeri della/e colonna dell'XML (CLOB ListaXMLOut) di output per cui ordinare i record nell'XML stesso (si può ordinare solo per le colonne da 1 a 6). Se l'ordinamento è per più colonne queste vanno separate con "," (es: 2; 2,3)
58        																	-- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul tipo di ordinamento una qualche preimpostazione di sistema/utente ecc.
59        																	-- se non valorizzato (neppure in output) la lista di record restituita non è ordinata
60        			FlgDescOrderByIO  		IN OUT	VARCHAR2,						-- E' una stringa di 1 o 0/NULL, tanti quanti le colonne di ordinamento, separati da ",": 1 significa che l'ordinamento per la data colonna deve essere discendente anzichè ascendente (es: 1; 1,0; 1, )
61        																	-- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul verso di ordinamento una qualche preimpostazione di sistema/utente ecc.			
62        			FlgSenzaPaginazioneIn 		IN 		PLS_INTEGER DEFAULT NULL,            	-- (valori 1/0/NULL) Se 1 l'estrazione non è paginata, altrimenti sì
63        			NroPaginaIO      			IN OUT	PLS_INTEGER,                  		-- E' il numero della pagina da estrarre; se NULL e l'estrazione è paginata viene estratta la prima pagina
64           			BachSizeIO				IN OUT	PLS_INTEGER,					-- Indica il massimo n.ro di record da estrarre se l'estrazione non è paginata (FlgSenzaPaginazioneIn=1)  
65        																	-- Indica la dimensione (n.ro di record) della pagina se l'estrazione è paginata (FlgSenzaPaginazioneIn 0 o NULL) e in tal caso se non è valorizzato la dimensione della pagina è quella settata per l'utente di lavoro o è pari al valore del parametro STD_PAGE_NUM_ROW del dominio di lavoro				
66        			OverFlowLimitIn			IN		PLS_INTEGER DEFAULT NULL,			-- E' il n.ro di record soddisfacenti la ricerca superato il quale la funzione deve restituire errore di overflow
67        			FlgSenzaTotIn			IN		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 significa che non è richiesto come output il totale dei record soddisfacenti la ricerca (se la ricerca è paginata per la prima pagina il totale viene calcolato comunque, per le successive no)
68        			NroTotRecOut			OUT		PLS_INTEGER,					-- E' il n.ro di record complessivi trovati (valorizzato solo se FlgSenzaTotIn è 0 o NULL o se si estrae la prima pagina)
69             			NroRecInPaginaOut 		OUT   	PLS_INTEGER,                     		-- E' il numero di record nella pagina (valorizzato solo se l'estrazione è paginata, ovvero se FlgSenzaPaginazioneIn 0 o NULL)
70        			------------- fine argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
71        			ListaXMLOut				OUT		NOCOPY CLOB,					-- Lista delle funzionalità di sistema trovate (XML conforme a schema LISTA_STD.xsd)
72        																	-- Ogni funzionalità di sistema è un tag Riga che contiene le seguenti colonne: 
73        																	-- 1: Codice completo della funzione (stringa restituita dalla function dmpk_utility.GetCodFunz per quella funzione)
74        																	-- 2: Parte 1 del codice funzione
75        																	-- 3: Parte 2 del codice funzione
76        																	-- 4: Parte 3 del codice funzione
77        																	-- 5: Descrizione semplice della funzione (senza le descrizioni delle funzioni superiori a prefisso)
78        																	-- 6: Descrizione estesa della funzione (con le descrizioni delle funzioni superiori a prefisso)
79        																	-- 7: (valori 1/0) Flag di funzione con opzioni standard (1) o senza (0)
80        																	-- 8: (valori 1/0) Flag di funzione valida e attiva nel dominio	
81        																	-- 9: (valori 1/0/NULL) Flag che indica che la funzione è relativa all'applicazione CodApplOwnerIO ed eventuale sua istanza CodIstApplOwnerIO
82        																	-- 10: Descrizione dell'applicazione (ed eventuale sua istanza) proprietaria della funzione
83        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
84        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
85        			ErrMsgOut				OUT 		VARCHAR2,						-- Messaggio d'errore
86        			FlgStatoAbilIn			IN		PLS_INTEGER default NULL,			-- (valori 1/0/NULL): filtro di ricerca per restringere la ricerca alle sole funzioni cui l'utente/UO/scrivania/profilo ecc specificato nell'argomento IdDestAbilIn ha (= 1) o non ha (=0) abilitazione (con le opzioni eventualmente specificate nell'argomento OpzioniAbilIn)
87        			FlgTpDestAbilIn			IN		VARCHAR2 default NULL,				-- (obblig. e gestito solo se FlgStatoAbilIn è valorizzato) Indica il tipo di chi (utente o UO ecc) deve avere o non avere abilitazione - con tutte le opzioni specificate in OpzioniAbilIn - verso le funzioni da ricercare
88        																	-- Valori ammessi: 
89        																	--	UO	=	U.O. 
90        																	-- 	SV	=	Scrivania virtuale
91        																	--	UT	=	Utente
92        																	--	PR	=	Profilo
93        																	--	GP	=	Gruppo di privilegi
94        																	--	RA	=	Ruolo amministrativo
95        			IdDestAbilIn			IN		INTEGER default NULL,				-- (obblig. e gestito solo se FlgStatoAbilIn è valorizzato) Identificativo (ID_UO o ID_SCRIVANIA o ID_USER o ID_PROFILO o ID_GRUPPO_PRIV o ID_RUOLO_AMM) di chi deve avere o non avere abilitazione - con tutte le opzioni specificate in OpzioniAbilIn - verso le funzioni da ricercare
96        			OpzioniAbilIn			IN		VARCHAR2 DEFAULT NULL,				-- Indica la/le opzione (se più di una separate da ;) con cui IdDestAbilIn deve essere abilitato o meno (a seconda che FlgStatoAbilIn sia 1 o 0) alle funzioni da ricercare
97        																	-- Opzioni possibili:
98        																	--	M	=	Solo modifica
99        																	--	I	=	Inserimento e modifica
100        																	--	FC	=	Full control
101        																	--	SP	=	relativamente agli archivi di tutto il soggetto produttore
102        																	--	eSP	=	relativamente agli archivi di tutti i soggetti produttori in banca dati 
103        			RigaTagNameIn			IN		VARCHAR2 DEFAULT NULL,				-- (opzionale) Come rinominare il tag Riga dell'XML ListaXMLOut di output
104        			ColTagNameIn			IN		DMVA_STRING DEFAULT NULL			-- (opzionale) Come rinominare i tag delle colonne in alternativa a Colonna Nro=.. nell'XML ListaXMLOut di output
105        			)return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine, altrimenti 0
106        
107        	/****** 	funzione per ricercare le applicazioni esterne e loro istanze censite in banca dati		*******/
108        	function TrovaApplicazioneEsterna(
109        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
110        																	-- (obblig). Codice identificativo del token di connessione
111        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
112        			FlgPreimpostaFiltroIn		IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1 i filtri e l'ordinamento vengono settati secondo le impostazioni dell'utente di lavoro, altrimenti restano come passati in input
113        			--------------- inizio filtri di ricerca-------------------
114        			CodApplicazioneIO			IN OUT	DMT_APPLICAZIONI_ESTERNE.CI_APPLICAZIONE%TYPE ,		
115        																	-- 1° filtro di ricerca: codice identificativo dell'applicazione (ricerca case-insensitive in like )
116        			CodIstanzaApplicazioneIO	IN OUT	DMT_APPLICAZIONI_ESTERNE.CI_ISTANZA_APPLICAZIONE%TYPE,		
117        																	-- 2° filtro di ricerca: codice identificativo dell'istanza di applicazione (ricerca case-insensitive in like)
118        			DescrizioneApplIstanzaIO	IN OUT	DMT_APPLICAZIONI_ESTERNE.DESCRIZIONE%TYPE,	
119        																	-- 3° filtro di ricerca: descrizione dell'applicazione esterna e/o sua istanza (ricerca case-insensitive in like)  
120        			IdSpAOOIO				IN OUT	DMT_APPLICAZIONI_ESTERNE.ID_SP_AOO%type,	-- 4° filtro di ricerca: id. del soggetto produttore/AOO sulla cui repository lavorano le applicazioni esterne e/o loro istanze da ricercare
121        																	-- Se NULL e si è connessi ad un certo dominio (soggetto produttore/AOO) vengono comunque estratte solo le applicazioni esterne e/o loro istanze che insistono sulla/e repository di quel dominio
122        			FlgUsaCredenzialiProprieIO	IN OUT	PLS_INTEGER,					-- 5° filtro di ricerca (valori 1/0/NULL) Serve a restiringere la ricerca alle applicazioni e istanze che usano per l'autenticazione:
123        																	-- 	1 = credenziali proprie diverse da quelle del sistema documentale
124        																	--	0 = le stesse del sistema documentale
125        			FlgInclAnnullatiIO		IN OUT	INTEGER,						-- (valori 1/0/NULL) 6° filtro di ricerca: se 1 vengono estratte anche le applicazioni esterne/loro istanze logicamente annullate, altrimenti no	
126        			CriteriSuAttrDinIO		IN OUT 	NOCOPY CLOB,					-- Altri criteri di ricerca sugli attributi addizionali delle applicazioni esterne e loro istanze (XML conforme a schema LISTA_STD.xsd). Se più di uno vengono applicati in AND.
127        																	-- Ogni criterio è un tag Riga che può contenere le seguenti colonne:
128        																	--	1) Nome (ATTR_NAME) dell'attributo cui è relativo il criterio
129        																	--	2) (obblig.) Operatore logico. Valori possibili:
130        																	--		"uguale" (ricerca esatta) 
131        																	--		"simile a (case-sensitive)" (ricerca case-sensitive in like)
132        																	--		"simile a (case-insensitive)" (ricerca case-insensitive in like e che ignora i caratteri quali spazi, ., ecc)
133        																	--		"maggiore" (se attributo numerico o data)
134        																	--		"maggiore o uguale" (se attributo numerico o data)
135        																	--		"minore" (se attributo numerico o data)
136        																	--		"minore o uguale" (se attributo numerico o data)
137        																	--		"tra" (se attributo numerico o data)
138        																	--		"non valorizzato"
139        																	--		"valorizzato"
140        																	--		"spuntato" (se attributo di tipo casella di spunta)
141        																	--		"non spuntato" (se attributo di tipo casella di spunta)
142        																	--	3) 1° valore di confronto (obblig. e gestito solo se l'operatore non ha uno dei seguenti valori: valorizzato, non valorizzato, spuntato, non spuntato) (se l'attributo è numerico deve avere la virgola come separatore dei decimali, se è di tipo data deve essere in uno dei formato dati dai parametri di conf. FMT_STD_DATA e FMT_STD_TIMESTAMP)
143        																	--	4) 2° valore di confronto (obblig. e gestito solo se l'operatore è "tra") (se l'attributo è numerico deve avere la virgola come separatore dei decimali, se è di tipo data deve essere in uno dei formato dati dai parametri di conf. FMT_STD_DATA e FMT_STD_TIMESTAMP)
144        																	--	5) Label dell''attributo cui è relativo il criterio (se sotto-attributo di complesso <label del complesso> - <label del sotto-attributo>
145        			------------- inizio argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
146        			ColOrderByIO			IN OUT	VARCHAR2,						-- Indica il/i numeri della/e colonna dell'XML (CLOB ListaXMLOut) di output per cui ordinare i record nell'XML stesso (si può ordinare solo per le colonne da 1 a 5). Se l'ordinamento è per più colonne queste vanno separate con "," (es: 2; 2,3)
147        																	-- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul tipo di ordinamento una qualche preimpostazione di sistema/utente ecc.
148        																	-- se non valorizzato (neppure in output) la lista di record restituita non è ordinata
149        			FlgDescOrderByIO  		IN OUT	VARCHAR2,						-- E' una stringa di 1 o 0/NULL, tanti quanti le colonne di ordinamento, separati da ",": 1 significa che l'ordinamento per la data colonna deve essere discendente anzichè ascendente (es: 1; 1,0; 1, )
150        																	-- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul verso di ordinamento una qualche preimpostazione di sistema/utente ecc.			
151        			FlgSenzaPaginazioneIn 		IN 		PLS_INTEGER DEFAULT NULL,            	-- (valori 1/0/NULL) Se 1 l'estrazione non è paginata, altrimenti sì
152        			NroPaginaIO      			IN OUT	PLS_INTEGER,                  		-- E' il numero della pagina da estrarre; se NULL e l'estrazione è paginata viene estratta la prima pagina
153           			BachSizeIO				IN OUT	PLS_INTEGER,					-- Indica il massimo n.ro di record da estrarre se l'estrazione non è paginata (FlgSenzaPaginazioneIn=1)  
154        																	-- Indica la dimensione (n.ro di record) della pagina se l'estrazione è paginata (FlgSenzaPaginazioneIn 0 o NULL) e in tal caso se non è valorizzato la dimensione della pagina è quella settata per l'utente di lavoro o è pari al valore del parametro STD_PAGE_NUM_ROW del dominio di lavoro				
155        			OverFlowLimitIn			IN		PLS_INTEGER DEFAULT NULL,			-- E' il n.ro di record soddisfacenti la ricerca superato il quale la funzione deve restituire errore di overflow
156        			FlgSenzaTotIn			IN		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 significa che non è richiesto come output il totale dei record soddisfacenti la ricerca (se la ricerca è paginata per la prima pagina il totale viene calcolato comunque, per le successive no)
157        			NroTotRecOut			OUT		PLS_INTEGER,					-- E' il n.ro di record complessivi trovati (valorizzato solo se FlgSenzaTotIn è 0 o NULL o se si estrae la prima pagina)
158             			NroRecInPaginaOut 		OUT   	PLS_INTEGER,                     		-- E' il numero di record nella pagina (valorizzato solo se l'estrazione è paginata, ovvero se FlgSenzaPaginazioneIn 0 o NULL)
159        			------------- fine argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
160        			ListaXMLOut				OUT		NOCOPY CLOB,					-- Lista delle applicazioni esterne e loro istanze trovate (XML conforme a schema LISTA_STD.xsd)
161        																	-- Ogni applicazione esterna e sua istanza è un tag Riga che contiene le seguenti colonne: 
162        																	-- 1: Codice dell'applicazione esterna
163        																	-- 2: Codice dell'istanza dell'applicazione esterna
164        																	-- 3: Descrizione dell'applicazione esterna/sua istanza
165        																	-- 4: (valori 1/0) Se 1 si tratta di un'applicazione esterna/sua istanza in cui ci si autentica con credenziali diverse da quelle del documentale
166        																	-- 5: (valori 1/0) Se 1 si tratta di un'applicazione esterna/sua istanza annullata
167        																	-- 6: Data e ora di prima connessione dall'applicazione/sua istanza (nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP)
168        																	-- 7: Data e ora di ultima connessione dall'applicazione/sua istanza (nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP)
169        																	-- 8: Timestamp di creazione dell'applicazione esterna/sua istanza (nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP)
170        																	-- 9: Descrizione dell'utente di creazione dell'applicazione esterna/sua istanza 
171        																	-- 10: Timestamp di ultima modifica dei dati dell'applicazione esterna/sua istanza (nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP)
172        																	-- 11: Descrizione dell'utente di ultima modifica dei dati dell'applicazione esterna/sua istanza 																						
173        																	-- 12: (valori 1/0) Se 1 indica che l'applicazione rappresenta una società del gruppo di società rappesentato dal dominio (ID_SP_AOO) cui si è collegati
174        																	-- 13: Codice fiscale della società che l'applicazione rappresenta
175        																	-- 14: Partita della società che l'applicazione rappresenta
176        																	-- 15: Indirizzo/i e-mail PEC attraverso cui inviare comunicazione all'applicazione/società (se più di uno separati da ;) 
177        																	-- 16: Indirizzo/i e-mail PEO attraverso cui inviare comunicazione all'applicazione/società (se più di uno separati da ;) 
178        																	-- 17: Modalita' di invio dei documenti alle societa' (attributo MODALITA_INVIO_DOC_SOCIETA) 
179                                                                            -- 18: Formato di invio dei documenti alle societa' (attributo FORMATO_INVIO_DOC_SOCIETA)
180                                                                            -- 19: Indirizzo email destinazione dei documenti alle societa' (attributo EMAIL_DEST_DOC_SOCIETA)
181                                                                            -- 20: Protocollo invio ftp (ftp/ftps) (attributo PROTOCOLLO_FTP)
182                                                                            -- 21: Indirizzo ftp (attributo INDIRIZZO_FTP)
183                                                                            -- 22: Username ftp (attributo USERNAME_FTP)
184                                                                            -- 23: Password ftp (attributo PWD_FTP)
185        			FlgAbilInsOut	 		OUT 		PLS_INTEGER ,            			-- (valori 1/0) Se 1 si ha abilitazione a creazione di nuove applicazioni esterne/loro istanze 
186        			FlgAbilUpdOut 			OUT 		PLS_INTEGER ,            			-- (valori 1/0) Se 1 si ha abilitazione a modifica di applicazioni esterne/loro istanze 
187        			FlgAbilDelOut 			OUT 		PLS_INTEGER,            			-- (valori 1/0) Se 1 si ha abilitazione a cancellazione di applicazioni esterne/loro istanze 
188        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
189        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
190        			ErrMsgOut				OUT 		VARCHAR2,						-- Messaggio d'errore
191        			RigaTagNameIn			IN		VARCHAR2 DEFAULT NULL,				-- (opzionale) Come rinominare il tag Riga dell'XML ListaXMLOut di output
192        			ColTagNameIn			IN		DMVA_STRING DEFAULT NULL)			-- (opzionale) Come rinominare i tag delle colonne in alternativa a Colonna Nro=.. nell'XML ListaXMLOut di output
193        			return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine, altrimenti 0
194        
195        	/***** Funzione per inserire o aggiornare un'applicazione esterna o sua istanza 									*****/	
196        	/***** Se si specificano codice applicazione ed eventuale codice istanza già presenti si va in modifica, altrimenti in inserimento 	*****/		
197        	function IUApplicazioneEsterna(
198        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
199        																	-- (obblig). Codice identificativo del token di connessione
200        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
201        			CodApplicazioneIO			IN OUT	DMT_APPLICAZIONI_ESTERNE.CI_APPLICAZIONE%TYPE ,		
202        																	-- (obblig.) Codice identificativo dell'applicazione
203        			CodIstanzaApplicazioneIO	IN OUT	DMT_APPLICAZIONI_ESTERNE.CI_ISTANZA_APPLICAZIONE%TYPE,		
204        																	-- Codice identificativo dell'istanza di applicazione
205        			DescrizioneApplIstanzaIn	IN		DMT_APPLICAZIONI_ESTERNE.DESCRIZIONE%TYPE DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
206        																	-- Descrizione dell'applicazione esterna e/o sua istanza   
207        			IdSpAOOIn				IN 		DMT_APPLICAZIONI_ESTERNE.ID_SP_AOO%type DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),
208        																	-- Id. del soggetto produttore/AOO sulla cui repository lavora l'applicazione esterna o sua istanza
209        																	-- Se si è connessi ad un dominio che è un soggetto produttore o AOO, il soggetto produttore/AOO sulla cui repository lavora l'applicazione esterna o sua istanza viene comunque inteso pari al dominio da cui si è connessi
210        																	-- altrimenti questo input non può essere NULL
211        			FlgUsaCredenzialiProprieIn	IN 		PLS_INTEGER DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),
212        																	-- (valori 1/0/NULL) Indica se l'applicazione o la sua istanze usa per l'autenticazione:
213        																	-- 	1 = credenziali proprie diverse da quelle del sistema documentale
214        																	--	0 o NULL = le stesse del sistema documentale
215        			AttributiAddIn			IN		CLOB DEFAULT NULL,				-- XML contenente nomi e valori degli attributi dinamici da aggiornare (conforme allo schema SezioneCache.xsd) 
216        																	-- Gli attributi già presenti in DB e per i quali non c'è corrispondente nell'XML restano invariati
217        																	-- Per tutti gli attributi vale quanto segue:
218        																	-- Un attributo da settare è un tag "Variabile" dell'XML il cui tag "Nome" contiene il nome identificativo dell'attributo (ATTR_NAME di DMT_ATTRIBUTES_DEF)
219        																	-- Un attributo da settare è una variabile con tag "ValoreSemplice" se è un attributo a singolo valore e non strutturato (cioè con tipo diverso da COMPLEX)
220        																	-- altrimenti è una variabile con tag "Lista" che ha un'unica colonna con "Nro" pari a 1 se l'attributo non è strutturato, che ha invece tante colonne quanti gli attributi componenti (ordinate in base al loro NRO_ORD_IN_SUP) se l'attributo è complesso 
221        																	-- Nel caso di variabili con tag "Lista" i valori specificati nell'XML si aggiungono o sostituiscono quelli già presenti in DB a seconda che nell'XML sia presente o meno una variabile con tag "Nome" pari a #Append_<Nome attributo> e tag "ValoreSemplice" pari a 1  
222        																	-- In particolare se non sono specificati valori nell'XML (tag Lista vuoto) e se i valori non sono da aggiungere significa che tutti i valori dell'attributo già presenti in DB vanno rimossi
223        			FlgIgnoreWarningIn 		IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 0 o NULL significa che in presenza di WARNING la stored si comporta come in caso di errore; se 1 gli WARNING vengono ignorati
224        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
225        																	-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
226        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
227        			WarningMsgOut			OUT		VARCHAR2,						-- Messaggio di warning (valorizzato solo se non c'è errore)
228        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
229        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
230        			ErrMsgOut				OUT 		VARCHAR2						-- Messaggio d'errore
231        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine (senza warning), altrimenti 0 (in caso di errore o warning)
232        
233        	/*** Funzione di eliminazione di un'applicazione esterna o sua istanza 					***/	
234        	/*** Si può specificare se l'eliminazione deve essere fisica o solo logica (annullamento)		***/
235        	/*** Se non lo si specifica il sistema fa quella fisica se possibile, se no quella logica		***/
236        	function DApplicazioneEsterna(
237        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
238        																	-- (obblig). Codice identificativo del token di connessione
239        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
240        			CodApplicazioneIn			IN 		DMT_APPLICAZIONI_ESTERNE.CI_APPLICAZIONE%TYPE ,		
241        																	-- (obblig.) Codice identificativo dell'applicazione
242        			CodIstanzaApplicazioneIn	IN 		DMT_APPLICAZIONI_ESTERNE.CI_ISTANZA_APPLICAZIONE%TYPE,		
243        																	-- Codice identificativo dell'istanza di applicazione
244        			FlgCancFisicaIn			IN		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL): Se 1 si richiede la cancellazione fisica; se 0 l'annullamento logico; se non è valorizzato quella possibile delle 2. 		
245        			MotiviIn				IN		DMT_ACTIVITIES.NOTE%type,			-- Motivi della cancellazione/annullamento
246        			FlgIgnoreWarningIn 		IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 0 o NULL significa che in presenza di WARNING la stored si comporta come in caso di errore; se 1 gli WARNING vengono ignorati
247        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
248        																	-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
249        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
250        			WarningMsgOut			OUT		VARCHAR2,						-- Messaggio di warning (valorizzato solo se non c'è errore)
251        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
252        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
253        			ErrMsgOut				OUT 		VARCHAR2						-- Messaggio d'errore
254        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine (senza warning), altrimenti 0 (in caso di errore o warning)
255        
256        	/***** funzione per estrarre i dati di un'applicazione esterna o sua istanza 				***/
257        	/***** noto il suo codice identificativo										***/							
258        	function LoadDettApplicazioneEsterna(
259        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
260        																	-- (obblig). Codice identificativo del token di connessione
261        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
262        			CodApplicazioneIn			IN 		DMT_APPLICAZIONI_ESTERNE.CI_APPLICAZIONE%TYPE ,		
263        																	-- (obblig.) Codice identificativo dell'applicazione
264        			CodIstanzaApplicazioneIn	IN 		DMT_APPLICAZIONI_ESTERNE.CI_ISTANZA_APPLICAZIONE%TYPE,		
265        																	-- Codice identificativo dell'istanza di applicazione
266        			DescrizioneApplIstanzaOut	OUT		DMT_APPLICAZIONI_ESTERNE.DESCRIZIONE%TYPE,-- Descrizione dell'applicazione esterna e/o sua istanza   
267        			IdSpAOOOut				OUT		DMT_APPLICAZIONI_ESTERNE.ID_SP_AOO%type,	-- Id. del soggetto produttore/AOO sulla cui repository lavora l'applicazione esterna o sua istanza
268        			FlgUsaCredenzialiProprieOut	OUT 		PLS_INTEGER,					-- (valori 1/0) Indica se l'applicazione o la sua istanze usa per l'autenticazione:
269        																	-- 	1 = credenziali proprie diverse da quelle del sistema documentale
270        																	--	0 = le stesse del sistema documentale
271        			TsFirstLogonOut			OUT		VARCHAR2,						-- Data e ora di prima connessione dall'applicazione/sua istanza (nel formato dato dal parametro FMT_STD_TIMESTAMP)
272        			TsLastLogonOut			OUT		VARCHAR2,						-- Data e ora di ultima connessione dall'applicazione/sua istanza (nel formato dato dal parametro FMT_STD_TIMESTAMP
273        			RowidOut				OUT		VARCHAR2,						-- Rowid del record del tipo di processo
274        			AttributiAddOut			OUT		NOCOPY CLOB,					-- Lista degli eventuali ulteriori attributi con cui caratterizzare l'applicazione esterna e/o sua istanza (XML conforme a schema LISTA_STD.xsd)
275        																	-- Ogni attributo è un tag "Riga" che contiene le seguenti colonne:
276        																	-- 1: N.ro (valori da 1 a n) del riquadro (fieldset) in cui mostrare l'attributo
277        																	-- 2: Nome identificativo dell'attributo (ATTR_NAME)
278        																	-- 3: Label del campo con cui rappresentare l'attributo 
279        																	-- 4: Tipo di attributo. Valori: DATE, DATETIME, TEXT, TEXT-AREA, CHECK, INTEGER, EURO, DECIMAL, COMBO-BOX, LISTA
280        																	-- 5: N.ro massimo di caratteri/cifre
281        																	-- 6: Larghezza del campo con cui rappresentare l'attributo (size)
282        																	-- 7: Valore dell'attributo
283        																	-- 8: Label del riquadro (fieldset) in cui mostrare l'attributo
284        																	-- 9: (valori 1/0) 1 indica che l'attributo è obbligatorio, 0 che è facoltativo
285        																	-- 10: Altezza (in nro righe) del campo con cui rappresentare l'attributo (se TEXT-AREA)
286        																	-- 11:(valori 1/0) 1 indica se l'attributo è modificabile, 0 che è in sola visualizzazione   
287        			FlgMostraAltriAttrOut		OUT		PLS_INTEGER,					-- (valori 1/0) Se 1 nella GUI vanno mostrati gli attributi addizionali (ce ne sono di visibile all'utente), se 0 no
288        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
289        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
290        			ErrMsgOut				OUT 		VARCHAR2)						-- Messaggio d'errore
291        			return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine, altrimenti 0
292        
293        
294        	/******* Funzione per assegnare ad un dato destinatario (Soggetto Produttore/AOO/UO/scrivania/utente/profilo/ruolo/gruppo di privilegi)  	*******/
295        	/******* privilegi su un dato oggetto di definizione del contesto organizzativo,archivistico e procedurale 						*******/
296        	/******* ATTENZIONE: se i privilegi sono già dati non viene dato errore 											*******/
297        	function GrantPrivSuOggDefContesto(
298        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
299        																	-- (obblig). Codice identificativo del token di connessione
300        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
301        			FlgTpObjPrivOnIn			IN		VARCHAR2,						-- (obblig.) Indica il tipo di oggetto su cui dare i privilegi
302        																	-- Valori ammessi:
303        																	--	F	=	Funzionalità del sistema; 
304        																	--	TP	=	Tipo di processo/procedimento; 
305        																	--	TD	=	Tipo di documento; 
306        																	--	TF	=	Tipo di folder; 
307        																	--	C	=	Classificazione; 
308        																	--	TR	=	Tipo di registrazione (protocollo o repertorio o altro);  
309        																	--	MR	=	Modello di registrazione
310        			CIObjPrivOnIn			IN		DMT_PRIVILEGI.CI_OGG_PRIVILEGIO%type DEFAULT NULL,	
311        																	-- Codice identificativo dell'oggetto su cui dare i privilegi (se funzione è la stringa restituita dalla function dmpk_utility.GetCodFunz per quella funzione, se tipo di registrazione è il suo ID_TP_REGISTRAZIONE, non la categoria e sigla)	
312        			DesObjPrivOnIn			IN		VARCHAR2 DEFAULT NULL,				-- Descrizione/denominazione dell'oggetto su cui dare i privilegi (ricerca case insensitive in like)
313        			LivelliClassifPrivOnIn		IN		VARCHAR2 DEFAULT NULL,				-- (da valorizzare solo se FlgTpObjPrivOnIn=C) Stringa con i n.ri livello della classificazione su cui dare i privilegi (tutti o solo alcuni; però se si specifica un livello è obbligatorio indicare tutti i livelli superiori; vanno indicati come appaiono nella GUI, ovvero romani se previsto, 0 o -- se nulli; vanno separati dal separatore dei livelli di classificazione valido per il soggetto produttore/AOO)
314        			FlgTpObjPrivToIn			IN		VARCHAR2,						-- (obblig.) Indica il tipo di destinatario a cui dare i privilegi
315        																	-- Valori ammessi: 
316        																	-- 	SA	=	Soggetto produttore/AOO
317        																	--	UO	=	U.O. 
318        																	-- 	SV	=	Scrivania virtuale
319        																	--	UT	=	Utente
320        																	--	PR	=	Profilo
321        																	--	GP	=	Gruppo di privilegi
322        																	--	RA	=	Ruolo amministrativo (consentito solo se si assegna abilitazione a funzione, ovvero se FlgTpObjPrivOnIn=F)
323        			IdObjPrivToIn			IN		INTEGER DEFAULT NULL,				-- Identificativo (ID_SP_AOO o ID_UO o ID_SCRIVANIA o ID_USER o ID_PROFILO o ID_GRUPPO_PRIV o ID_RUOLO_AMM) del destinatario dei privilegi
324        			DesObjPrivToIn			IN		VARCHAR2 DEFAULT NULL,				-- Descrizione/denominazione del destinatario dei privilegi (ricerca case insensitive in like)
325        			LivelliUOPrivToIn			IN		VARCHAR2 DEFAULT NULL,				-- (da valorizzare solo se FlgTpObjPrivToIn=UO o SV) Stringa con i n.ri livello della UO destinataria o a cui appartiene la scrivania destinataria (tutti o alcuni; però se si specifica un livello è obbligatorio indicare tutti i livelli superiori; vanno specificati come appaiono nella GUI, ovvero romani se previsto, 0 o -- se nulli; sono separati dal separatore dei livelli valido per il soggetto produttore/AOO di appartenenza della UO)
326        			DesUOAppScrivaniaToIn		IN		VARCHAR2 DEFAULT NULL,				-- (da valorizzare solo se FlgTpObjPrivToIn=SV) Denominazione della UO in cui si trova la scrivania destinataria (o suo inizio; ricerca case insensitive in like). Può essere quella semplice o la concatenazione con separatore "|" delle denominazioni delle UO superiori + quella della UO	
327        			DesUserScrivaniaToIn		IN		VARCHAR2 DEFAULT NULL,				-- (da valorizzare solo se FlgTpObjPrivToIn=SV) Denominazione dell'utente che occupa la scrivania destinataria (ricerca case insensitive in like).
328        			ListaPrivilegiIn			IN		VARCHAR2 DEFAULT NULL,				-- Indica i privilegi (se più di uno separati da ;) da aggiungere (non va specificato nulla nel caso di oggetti, per esempio certe funzioni, in cui l'oggetto e il destinatario già definiscono il privilegio)
329        																	-- Valori possibili:
330        																	-- 	FC	=	Full control 
331        																	--	I	=	Inserimento (e anche modifica) 
332        																	--	M	=	Modifica
333        																	--	A	=	ad Assegnare/Avviare/registrare/creare 
334        																	--	F	=	a Firmare 
335        																	--  P   =   a Pubblicare
336        																	--	AF	=	ad Aprire Fascicoli 
337        																	--	SP	=	relativamente agli archivi di tutto il soggetto produttore
338        																	--	eSP	=	relativamente agli archivi di tutti i soggetti produttori in banca dati 
339        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
340        																	-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
341        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
342        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
343        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
344        			ErrMsgOut				OUT 		VARCHAR2						-- Messaggio d'errore
345        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine (senza warning), altrimenti 0 (in caso di errore o warning)
346        
347        	/******* Funzione per assegnare ad un dato destinatario (Soggetto Produttore/AOO/UO/scrivania/utente/profilo/ruolo/gruppo di privilegi)  	*******/
348        	/******* o privilegi su oggetti omogenei di definizione del contesto organizzativo,archivistico e procedurale o gruppi di privilegi		*******/
349        	/******* ATTENZIONE: se i privilegi/gruppi di privilegi sono già dati non viene dato errore 								*******/
350        	function GrantPrivSuDefContesto(
351        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
352        																	-- (obblig). Codice identificativo del token di connessione
353        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
354        			FlgTpObjPrivToIn			IN		VARCHAR2,						-- (obblig.) Indica il tipo di destinatario a cui dare i privilegi
355        																	-- Valori ammessi: 
356        																	-- 	SA	=	Soggetto produttore/AOO
357        																	--	UO	=	U.O. 
358        																	-- 	SV	=	Scrivania virtuale
359        																	--	UT	=	Utente
360        																	--	PR	=	Profilo
361        																	--	GP	=	Gruppo di privilegi
362        																	--	RA	=	Ruolo amministrativo (consentito solo se si assegna abilitazione a funzione, ovvero se FlgTpObjPrivOnIn=F)
363        			IdObjPrivToIn			IN		INTEGER DEFAULT NULL,				-- Identificativo (ID_SP_AOO o ID_UO o ID_SCRIVANIA o ID_USER o ID_PROFILO o ID_GRUPPO_PRIV o ID_RUOLO_AMM) del destinatario dei privilegi
364        			DesObjPrivToIn			IN		VARCHAR2 DEFAULT NULL,				-- Descrizione/denominazione del destinatario dei privilegi (ricerca case insensitive in like)
365        			LivelliUOPrivToIn			IN		VARCHAR2 DEFAULT NULL,				-- (da valorizzare solo se FlgTpObjPrivToIn=UO o SV) Stringa con i n.ri livello della UO destinataria o a cui appartiene la scrivania destinataria (tutti o alcuni; però se si specifica un livello è obbligatorio indicare tutti i livelli superiori; vanno specificati come appaiono nella GUI, ovvero romani se previsto, 0 o -- se nulli; sono separati dal separatore dei livelli valido per il soggetto produttore/AOO di appartenenza della UO)
366        			DesUOAppScrivaniaToIn		IN		VARCHAR2 DEFAULT NULL,				-- (da valorizzare solo se FlgTpObjPrivToIn=SV) Denominazione della UO in cui si trova la scrivania destinataria (o suo inizio; ricerca case insensitive in like). Può essere quella semplice o la concatenazione con separatore "|" delle denominazioni delle UO superiori + quella della UO	
367        			DesUserScrivaniaToIn		IN		VARCHAR2 DEFAULT NULL,				-- (da valorizzare solo se FlgTpObjPrivToIn=SV) Denominazione dell'utente che occupa la scrivania destinataria (ricerca case insensitive in like).
368        			FlgTpObjToGrantIn			IN		VARCHAR2,						-- (obblig.) Indica il tipo degli oggetti da grantare
369        																	-- Valori ammessi:
370        																	--	F	=	Privilegi su Funzionalità del sistema; 
371        																	--	TP	=	Privilegi su Tipi di processi/procedimenti; 
372        																	--	TD	=	Privilegi su Tipi di documenti; 
373        																	--	TF	=	Privilegi su Tipi di folder; 
374        																	--	C	=	Privilegi su Classificazioni; 
375        																	--	TR	=	Privilegi su Tipi di registrazione (protocollo o repertorio o altro);  
376        																	--	MR	=	Privilegi su Modelli di registrazione
377        																	--	GP	=	Gruppi di privilegi (solo se FlgTpObjPrivToIn = UO o SV o UT o PR)
378        			ListaObjToGrantXMLIn		IN		CLOB,							-- Lista con gli estremi degli oggetti di definizione contesto su cui dare privilegi o dei gruppi di privilegi da dare (XML conforme a schema LISTA_STD.xsd)
379        																	-- Ogni tag "Riga" rappresenta un oggetto di definizione del contesto o un gruppo di privilegi e può contenere le seguenti colonne:
380        																	-- 1: Codice identificativo dell'oggetto su cui dare i privilegi (se funzione è la stringa restituita dalla function dmpk_utility.GetCodFunz per quella funzione, se tipo di registrazione è il suo ID_TP_REGISTRAZIONE, non la categoria e sigla)	
381        																	-- 	o del gruppo di privilegi
382        																	-- 2: Descrizione/denominazione dell'oggetto su cui dare i privilegi o del gruppo di privilegi (ricerca case insensitive in like)
383        																	-- 3: (da valorizzare solo se FlgTpObjToGrantIn=C) Stringa con i n.ri livello della classificazione su cui dare i privilegi (tutti o solo alcuni; però se si specifica un livello è obbligatorio indicare tutti i livelli superiori; vanno indicati come appaiono nella GUI, ovvero romani se previsto, 0 o -- se nulli; vanno separati dal separatore dei livelli di classificazione valido per il soggetto produttore/AOO)
384        			ListaPrivilegiIn			IN		VARCHAR2 DEFAULT NULL,				-- Indica i privilegi (se più di uno separati da ;) da aggiungere sugli oggetti di definizione contesto presenti nella lista XML (non va specificato nulla nel caso di oggetti, per esempio certe funzioni, in cui l'oggetto e il destinatario già definiscono il privilegio)
385        																	-- Valori possibili:
386        																	-- 	FC	=	Full control 
387        																	--	I	=	Inserimento (e anche modifica) 
388        																	--	M	=	Modifica
389        																	--	A	=	ad Assegnare/Avviare/registrare/creare 
390        																	--	F	=	a Firmare 
391        																	--  P   =   a Pubblicare
392        																	--	AF	=	ad Aprire Fascicoli 
393        																	--	SP	=	relativamente agli archivi di tutto il soggetto produttore
394        																	--	eSP	=	relativamente agli archivi di tutti i soggetti produttori in banca dati 
395        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
396        																	-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
397        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
398        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
399        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
400        			ErrMsgOut				OUT 		VARCHAR2						-- Messaggio d'errore
401        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine (senza warning), altrimenti 0 (in caso di errore o warning)
402        
403        	/******* Funzione per togliere ad un dato destinatario (Soggetto Produttore/AOO/UO/scrivania/utente/profilo/ruolo/gruppo di privilegi)  	*******/
404        	/******* privilegi su un dato oggetto di definizione del contesto organizzativo,archivistico e procedurale 						*******/
405        	/******* ATTENZIONE: se i privilegi non erano già dati non viene dato errore											*******/
406        	function RevokePrivSuOggDefContesto(
407        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
408        																	-- (obblig). Codice identificativo del token di connessione
409        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
410        			FlgTpObjPrivOnIn			IN		VARCHAR2,						-- (obblig.) Indica il tipo di oggetto su cui si esercitano i privilegi da togliere
411        																	-- Valori ammessi:
412        																	--	F	=	Funzionalità del sistema; 
413        																	--	TP	=	Tipo di processo/procedimento; 
414        																	--	TD	=	Tipo di documento; 
415        																	--	TF	=	Tipo di folder; 
416        																	--	C	=	Classificazione; 
417        																	--	TR	=	Tipo di registrazione (protocollo o repertorio o altro);  
418        																	--	MR	=	Modello di registrazione
419        			CIObjPrivOnIn			IN		DMT_PRIVILEGI.CI_OGG_PRIVILEGIO%type,	-- (obblig.) Codice identificativo dell'oggetto su cui si esercitano i privilegi da togliere (se funzione è la stringa restituita dalla function dmpk_utility.GetCodFunz per quella funzione, se tipo di registrazione è il suo ID_TP_REGISTRAZIONE, non la categoria e sigla)	
420        			DesObjPrivOnIn			IN		VARCHAR2 DEFAULT NULL,				-- Descrizione/denominazione dell'oggetto su cui si esercitano i privilegi da togliere (ricerca case insensitive in like)
421        			LivelliClassifPrivOnIn		IN		VARCHAR2 DEFAULT NULL,				-- (da valorizzare solo se FlgTpObjPrivOnIn=C) Stringa con i n.ri livello della classificazione su cui si esercitano i privilegi da togliere (tutti o solo alcuni; però se si specifica un livello è obbligatorio indicare tutti i livelli superiori; vanno indicati come appaiono nella GUI, ovvero romani se previsto, 0 o -- se nulli; vanno separati dal separatore dei livelli di classificazione valido per il soggetto produttore/AOO)
422        			FlgTpObjPrivToIn			IN		VARCHAR2,						-- (obblig.) Indica il tipo di destinatario a cui togliere privilegi
423        																	-- Valori ammessi: 
424        																	-- 	SA	=	Soggetto produttore/AOO
425        																	--	UO	=	U.O. 
426        																	-- 	SV	=	Scrivania virtuale
427        																	--	UT	=	Utente
428        																	--	PR	=	Profilo
429        																	--	GP	=	Gruppo di privilegi
430        																	--	RA	=	Ruolo amministrativo (consentito solo se si assegna abilitazione a funzione, ovvero se FlgTpObjPrivOnIn=F)
431        			IdObjPrivToIn			IN		INTEGER DEFAULT NULL,				-- Identificativo (ID_SP_AOO o ID_UO o ID_SCRIVANIA o ID_USER o ID_PROFILO o ID_GRUPPO_PRIV o ID_RUOLO_AMM) del destinatario del privilegio da togliere
432        			DesObjPrivToIn			IN		VARCHAR2 DEFAULT NULL,				-- Descrizione/denominazione del destinatario dei privilegi da togliere(ricerca case insensitive in like)
433        			LivelliUOPrivToIn			IN		VARCHAR2 DEFAULT NULL,				-- (da valorizzare solo se FlgTpObjPrivToIn=UO o SV) Stringa con i n.ri livello della UO destinataria o a cui appartiene la scrivania destinataria (tutti o alcuni; però se si specifica un livello è obbligatorio indicare tutti i livelli superiori; vanno specificati come appaiono nella GUI, ovvero romani se previsto, 0 o -- se nulli; sono separati dal separatore dei livelli valido per il soggetto produttore/AOO di appartenenza della UO)
434        			DesUOAppScrivaniaToIn		IN		VARCHAR2 DEFAULT NULL,				-- (da valorizzare solo se FlgTpObjPrivToIn=SV) Denominazione della UO in cui si trova la scrivania destinataria (o suo inizio; ricerca case insensitive in like). Può essere quella semplice o la concatenazione con separatore "|" delle denominazioni delle UO superiori + quella della UO	
435        			DesUserScrivaniaToIn		IN		VARCHAR2 DEFAULT NULL,				-- (da valorizzare solo se FlgTpObjPrivToIn=SV) Denominazione dell'utente che occupa la scrivania destinataria (ricerca case insensitive in like).
436        			ListaPrivilegiIn			IN		VARCHAR2 DEFAULT NULL,				-- Indica i privilegi (se più di uno separati da ;) da togliere. 
437        																	-- ATTENZIONE: Se nulla è specificato si intende che al destinatario va tolto qualsiasi privilegio sul dato oggetto
438        																	-- Valori possibili:
439        																	--	I	=	Inserimento
440        																	--	M	=	Modifica
441        																	-- 	C	=	Cancellazione
442        																	--	A	=	ad Assegnare/Avviare/registrare/creare 
443        																	--	F	=	a Firmare
444        																	--  P   =   a Pubblicare
445        																	--	AF	=	ad Aprire Fascicoli 
446        																	--	SP	=	relativamente agli archivi di tutto il soggetto produttore
447        																	--	eSP	=	relativamente agli archivi di tutti i soggetti produttori in banca dati 
448        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
449        																	-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
450        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
451        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
452        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
453        			ErrMsgOut				OUT 		VARCHAR2						-- Messaggio d'errore
454        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine (senza warning), altrimenti 0 (in caso di errore o warning)
455        
456        	/******* Funzione per togliere ad un dato destinatario (Soggetto Produttore/AOO/UO/scrivania/utente/profilo/ruolo/gruppo di privilegi)  	*******/
457        	/******* privilegi su oggetti di definizione del contesto organizzativo,archivistico e procedurale o gruppi di privilegi			*******/
458        	/******* ATTENZIONE: se i privilegi non erano già dati non viene dato errore											*******/
459        	function RevokePrivSuDefContesto(
460        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
461        																	-- (obblig). Codice identificativo del token di connessione
462        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
463        			FlgTpObjPrivToIn			IN		VARCHAR2,						-- (obblig.) Indica il tipo di destinatario a cui togliere privilegi
464        																	-- Valori ammessi: 
465        																	-- 	SA	=	Soggetto produttore/AOO
466        																	--	UO	=	U.O. 
467        																	-- 	SV	=	Scrivania virtuale
468        																	--	UT	=	Utente
469        																	--	PR	=	Profilo
470        																	--	GP	=	Gruppo di privilegi
471        																	--	RA	=	Ruolo amministrativo (consentito solo se si assegna abilitazione a funzione, ovvero se FlgTpObjPrivOnIn=F)
472        			IdObjPrivToIn			IN		INTEGER DEFAULT NULL,				-- Identificativo (ID_SP_AOO o ID_UO o ID_SCRIVANIA o ID_USER o ID_PROFILO o ID_GRUPPO_PRIV o ID_RUOLO_AMM) del destinatario del privilegio da togliere
473        			DesObjPrivToIn			IN		VARCHAR2 DEFAULT NULL,				-- Descrizione/denominazione del destinatario dei privilegi da togliere(ricerca case insensitive in like)
474        			LivelliUOPrivToIn			IN		VARCHAR2 DEFAULT NULL,				-- (da valorizzare solo se FlgTpObjPrivToIn=UO o SV) Stringa con i n.ri livello della UO destinataria o a cui appartiene la scrivania destinataria (tutti o alcuni; però se si specifica un livello è obbligatorio indicare tutti i livelli superiori; vanno specificati come appaiono nella GUI, ovvero romani se previsto, 0 o -- se nulli; sono separati dal separatore dei livelli valido per il soggetto produttore/AOO di appartenenza della UO)
475        			DesUOAppScrivaniaToIn		IN		VARCHAR2 DEFAULT NULL,				-- (da valorizzare solo se FlgTpObjPrivToIn=SV) Denominazione della UO in cui si trova la scrivania destinataria (o suo inizio; ricerca case insensitive in like). Può essere quella semplice o la concatenazione con separatore "|" delle denominazioni delle UO superiori + quella della UO	
476        			DesUserScrivaniaToIn		IN		VARCHAR2 DEFAULT NULL,				-- (da valorizzare solo se FlgTpObjPrivToIn=SV) Denominazione dell'utente che occupa la scrivania destinataria (ricerca case insensitive in like).
477        			ListaObjToRevokeXMLIn		IN		CLOB,							-- Lista con gli estremi degli oggetti di definizione contesto da cui togliere privilegi e/o dei gruppi di privilegi da togliere (XML conforme a schema LISTA_STD.xsd)
478        																	-- Ogni tag "Riga" rappresenta un oggetto di definizione del contesto da cui togliere privilegi o un gruppo di privilegi e può contenere le seguenti colonne:
479        																	-- 1: (obblig.) Indica il tipo di oggetto rappresentato dalla riga 
480        																		-- Valori ammessi:
481        																		--	F	=	Privilegi su Funzionalità del sistema; 
482        																		--	TP	=	Privilegi su Tipo di processo/procedimento; 
483        																		--	TD	=	Privilegi su Tipo di documento; 
484        																		--	TF	=	Privilegi su Tipo di folder; 
485        																		--	C	=	Privilegi su Classificazione; 
486        																		--	TR	=	Privilegi su Tipo di registrazione (protocollo o repertorio o altro);  
487        																		--	MR	=	Privilegi su Modello di registrazione
488        																		--	GP	=	Gruppo di privilegi
489        																	-- 2: Codice identificativo dell'oggetto su cui si esercitano i privilegi (se funzione è la stringa restituita dalla function dmpk_utility.GetCodFunz per quella funzione) o del gruppo di privilegi	
490        																	-- 3: Descrizione/denominazione dell'oggetto su cui si esercitano i privilegi o del gruppo di privilegi 
491        																	-- 4: (valorizzato solo solo se colonna 1=C) Stringa con i n.ri livello della classificazione su cui si esercitano i privilegi (i livelli sono indicati come appaiono nella GUI, ovvero romani se previsto, 0 o -- se nulli; sono separati dal separatore dei livelli di classificazione valido per il soggetto produttore/AOO)
492        			ListaPrivilegiIn			IN		VARCHAR2 DEFAULT NULL,				-- Indica i privilegi (se più di uno separati da ;) da togliere. 
493        																	-- ATTENZIONE: Se nulla è specificato si intende che al destinatario va tolto qualsiasi privilegio sul dato oggetto o l'intero gruppo di privilegi
494        																	-- Valori possibili:
495        																	--	I	=	Inserimento
496        																	--	M	=	Modifica
497        																	-- 	C	=	Cancellazione
498        																	--	A	=	ad Assegnare/Avviare/registrare/creare 
499        																	--	F	=	a Firmare 
500        																	--  P   =   a Pubblicare
501        																	--	AF	=	ad Aprire Fascicoli 
502        																	--	SP	=	relativamente agli archivi di tutto il soggetto produttore
503        																	--	eSP	=	relativamente agli archivi di tutti i soggetti produttori in banca dati 
504        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
505        																	-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
506        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
507        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
508        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
509        			ErrMsgOut				OUT 		VARCHAR2						-- Messaggio d'errore
510        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine (senza warning), altrimenti 0 (in caso di errore o warning)
511        
512        	/****** 	funzione per ricercare sui gruppi di privilegi		*******/
513        	function TrovaGruppiPrivilegi(
514        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
515        																	-- (obblig). Codice identificativo del token di connessione
516        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
517        			FlgPreimpostaFiltroIn		IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1 i filtri e l'ordinamento vengono settati secondo le impostazioni dell'utente di lavoro, altrimenti restano come passati in input
518        			--------------- inizio filtri di ricerca-------------------
519        			IdGruppoPrivIO			IN OUT	DMT_GRUPPI_PRIVILEGI.ID_GRUPPO_PRIV%TYPE ,		
520        																	-- 1° filtro di ricerca: identificativo del gruppo di privilegi
521        			NomeGruppoPrivIO			IN OUT	DMT_GRUPPI_PRIVILEGI.NOME_GRUPPO_PRIV%TYPE,		
522        																	-- 2° filtro di ricerca: nome del gruppo di privilegi(ricerca case-insensitive in like)
523        			CIProvGruppoPrivIO		IN OUT	DMT_GRUPPI_PRIVILEGI.PROV_CI_GRUPPO%TYPE,	-- 3° filtro di ricerca: codice che identifica il gruppo di privilegi in un eventuale sistema esterno di provenienza (ricerca esatta case-sensitive)  
524        			FlgInclAnnullatiIO		IN OUT	INTEGER,						-- (valori 1/0/NULL) 4° filtro di ricerca: se 1 vengono estratti anche i gruppi logicamente annullati, altrimenti no	
525        			FlgTpObjPrivOnIO			IN OUT	VARCHAR2,						-- 5° filtro di ricerca: Indica il tipo di oggetto su cui si esercitano privilegi che devono essere inclusi nel gruppo
526        																	-- Valori ammessi:
527        																	--	F	=	Funzionalità del sistema; 
528        																	--	TP	=	Tipo di processo/procedimento; 
529        																	--	TD	=	Tipo di documento; 
530        																	--	TF	=	Tipo di folder; 
531        																	--	C	=	Classificazione; 
532        																	--	TR	=	Tipo di registrazione (protocollo o repertorio o altro);  
533        																	--	MR	=	Modello di registrazione
534        			CIObjPrivOnIO			IN OUT	DMT_PRIVILEGI.CI_OGG_PRIVILEGIO%type,	-- 6° filtro di ricerca: Codice identificativo dell'oggetto su cui si esercitano privilegi che devono essere inclusi nel gruppo (se funzione è la stringa restituita dalla function dmpk_utility.GetCodFunz per quella funzione, se tipo di registrazione è il suo ID_TP_REGISTRAZIONE, non la categoria e sigla)(ricerca esatta)	
535        			DesObjPrivOnIO			IN OUT	VARCHAR2,						-- 7° filtro di ricerca: Descrizione/denominazione del/degli oggetti su cui si esercitano privilegi che devono essere inclusi nel gruppo (ricerca case insensitive in like)
536        			LivelliClassifPrivOnIO		IN OUT	VARCHAR2,						-- 8° filtro di ricerca: (da valorizzare solo se FlgTpObjPrivOnIO=C) Stringa con i n.ri livello della/e classificazioni su cui si esercitano privilegi che devono essere inclusi nel gruppo (tutti o solo alcuni livelli; però se si specifica un livello è obbligatorio indicare tutti i livelli superiori; vanno indicati come appaiono nella GUI, ovvero romani se previsto, 0 o -- se nulli; vanno separati dal separatore dei livelli di classificazione valido per il soggetto produttore/AOO)
537        			CodApplOwnerIO			IN OUT	VARCHAR2,						-- 9° filtro di ricerca: Codice dell'applicazione "proprietaria" dei gruppi. Se valorizzata pari a #BY_CONN_TKN e si è connessi da un'applicazione esterna si ricercano solo gruppi di cui è proprietaria quell'applicazione
538        			CodIstApplOwnerIO			IN OUT	VARCHAR2,						-- 10° filtro di ricerca: Codice dell'istanza di applicazione "proprietaria" dei gruppi. Se valorizzata pari a #BY_CONN_TKN e si è connessi da un'applicazione esterna si ricercano solo gruppi di cui è proprietaria l'istanza di applicazione esterna da cui si è connessi
539        			FlgRestrApplOwnerIO		IN OUT	INTEGER,						-- (valori 1/0/NULL) Se 1 vengono estratti solo gruppi di cui è proprietaria l'applicazione proprietaria (ed eventuale istanza) specificata in CodApplOwnerIO; se 0 o NULL e se CodApplOwnerIO è valorizzata vengono estratti solo i gruppi senza applicazione proprietaria o con applicazione proprietria pari a quella specificata
540        			------------- inizio argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
541        			ColOrderByIO			IN OUT	VARCHAR2,						-- Indica il/i numeri della/e colonna dell'XML (CLOB ListaXMLOut) di output per cui ordinare i record nell'XML stesso (si può ordinare solo per le colonne da 1 a 5). Se l'ordinamento è per più colonne queste vanno separate con "," (es: 2; 2,3)
542        																	-- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul tipo di ordinamento una qualche preimpostazione di sistema/utente ecc.
543        																	-- se non valorizzato (neppure in output) la lista di record restituita non è ordinata
544        			FlgDescOrderByIO  		IN OUT	VARCHAR2,						-- E' una stringa di 1 o 0/NULL, tanti quanti le colonne di ordinamento, separati da ",": 1 significa che l'ordinamento per la data colonna deve essere discendente anzichè ascendente (es: 1; 1,0; 1, )
545        																	-- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul verso di ordinamento una qualche preimpostazione di sistema/utente ecc.			
546        			FlgSenzaPaginazioneIn 		IN 		PLS_INTEGER DEFAULT NULL,            	-- (valori 1/0/NULL) Se 1 l'estrazione non è paginata, altrimenti sì
547        			NroPaginaIO      			IN OUT	PLS_INTEGER,                  		-- E' il numero della pagina da estrarre; se NULL e l'estrazione è paginata viene estratta la prima pagina
548           			BachSizeIO				IN OUT	PLS_INTEGER,					-- Indica il massimo n.ro di record da estrarre se l'estrazione non è paginata (FlgSenzaPaginazioneIn=1)  
549        																	-- Indica la dimensione (n.ro di record) della pagina se l'estrazione è paginata (FlgSenzaPaginazioneIn 0 o NULL) e in tal caso se non è valorizzato la dimensione della pagina è quella settata per l'utente di lavoro o è pari al valore del parametro STD_PAGE_NUM_ROW del dominio di lavoro				
550        			OverFlowLimitIn			IN		PLS_INTEGER DEFAULT NULL,			-- E' il n.ro di record soddisfacenti la ricerca superato il quale la funzione deve restituire errore di overflow
551        			FlgSenzaTotIn			IN		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 significa che non è richiesto come output il totale dei record soddisfacenti la ricerca (se la ricerca è paginata per la prima pagina il totale viene calcolato comunque, per le successive no)
552        			NroTotRecOut			OUT		PLS_INTEGER,					-- E' il n.ro di record complessivi trovati (valorizzato solo se FlgSenzaTotIn è 0 o NULL o se si estrae la prima pagina)
553             			NroRecInPaginaOut 		OUT   	PLS_INTEGER,                     		-- E' il numero di record nella pagina (valorizzato solo se l'estrazione è paginata, ovvero se FlgSenzaPaginazioneIn 0 o NULL)
554        			------------- fine argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
555        			ListaXMLOut				OUT		NOCOPY CLOB,					-- Lista dei gruppi di privilegi trovati (XML conforme a schema LISTA_STD.xsd)
556        																	-- Ogni gruppo di privilegi è un tag Riga che contiene le seguenti colonne: 
557        																	-- 1: Identificativo del gruppo di privilegi
558        																	-- 2: Nome del gruppo di privilegi
559        																	-- 3: Codice che identifica il gruppo di privilegi in un eventuale sistema esterno di provenienza
560        																	-- 4: (valori 1/0) Se 1 si tratta di un gruppo di privilegi riservato di sistema e dunque non modificabile/cancellabile da applicativo
561        																	-- 5: (valori 1/0) Se 1 si tratta di un gruppo di privilegi annullato
562        																	-- 6: Note/dettagli sul gruppo
563        																	-- 7:  Flag che indica che il gruppo è "di proprieà" dell'applicazione CodApplOwnerIO ed eventuale sua istanza CodIstApplOwnerIO
564        																	-- 8:  Descrizione dell'applicazione (ed eventuale istanza) proprietaria del gruppo
565        																	-- 9: Timestamp di creazione del gruppo di privilegi (nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP)
566        																	-- 10: Descrizione dell'utente di creazione del gruppo di privilegi 
567        																	-- 11: Timestamp di ultima modifica dei dati del gruppo di privilegi (nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP)
568        																	-- 12: Descrizione dell'utente di ultima modifica dei dati del gruppo di privilegi 																						
569        			FlgAbilInsOut	 		OUT 		PLS_INTEGER ,            			-- (valori 1/0) Se 1 si ha abilitazione a creazione di nuovi gruppo di privilegi 
570        			FlgAbilUpdOut 			OUT 		PLS_INTEGER ,            			-- (valori 1/0) Se 1 si ha abilitazione a modifica di gruppo di privilegi 
571        			FlgAbilDelOut 			OUT 		PLS_INTEGER,            			-- (valori 1/0) Se 1 si ha abilitazione a cancellazione di gruppo di privilegi 
572        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
573        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
574        			ErrMsgOut				OUT 		VARCHAR2,						-- Messaggio d'errore
575        			FlgStatoAssegnIn			IN		PLS_INTEGER default NULL,			-- (valori 1/0/NULL): filtro di ricerca per restringere la ricerca ai soli gruppi di privilegi assegnati (=1) o non assegnati  all'utente/UO/scrivania/profilo ecc specificato nell'argomento IdObjXStatoAssegnIn 
576        			FlgTpDestAssegnIn			IN		VARCHAR2 default NULL,				-- (obblig. e gestito solo se FlgStatoAssegnIn è valorizzato) Indica il tipo di chi (utente o UO ecc) deve avere o non avere i gruppi di privilegi da ricercare
577        																	-- Valori ammessi: 
578        																	--	UO	=	U.O. 
579        																	-- 	SV	=	Scrivania virtuale
580        																	--	UT	=	Utente
581        																	--	PR	=	Profilo
582        			IdDestAssegnIn			IN		INTEGER default NULL,				-- (obblig. e gestito solo se FlgStatoAssegnIn è valorizzato) Identificativo (ID_UO o ID_SCRIVANIA o ID_USER o ID_PROFILO) di chi deve avere o non avere i gruppi di privilegi da ricercare
583        			RigaTagNameIn			IN		VARCHAR2 DEFAULT NULL,				-- (opzionale) Come rinominare il tag Riga dell'XML ListaXMLOut di output
584        			ColTagNameIn			IN		DMVA_STRING DEFAULT NULL			-- (opzionale) Come rinominare i tag delle colonne in alternativa a Colonna Nro=.. nell'XML ListaXMLOut di output
585        			)return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine, altrimenti 0
586        
587        	/*******  funzione per creare o modificare un gruppo di privilegi su oggetti di definizione del contesto organizzativo,archivistico e procedurale  *******/
588        	function IUGruppoPrivilegi(
589        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
590        																	-- (obblig). Codice identificativo del token di connessione
591        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
592        			IdGruppoPrivIO 	  		IN OUT   	DMT_GRUPPI_PRIVILEGI.ID_GRUPPO_PRIV%type, -- Identificativo del gruppo di privilegi da modificare. Se non valorizzato il gruppo di privilegi è da inserire ex-novo
593        																	-- In output, salvo in caso di errore, è sempre valorizzato	
594        			NomeGruppoPrivIn			IN		DMT_GRUPPI_PRIVILEGI.NOME_GRUPPO_PRIV%TYPE DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
595        																	-- (obblig.) Nome del gruppo di privilegi
596        			NoteGruppoPrivIn			IN		DMT_GRUPPI_PRIVILEGI.NOTE%TYPE DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
597        																	-- Note/dettagli sul gruppo di privilegi
598        			CIProvGruppoPrivIn		IN 		DMT_GRUPPI_PRIVILEGI.PROV_CI_GRUPPO%TYPE DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
599        																	-- Codice identificativo del gruppo di privilegi nel sistema di provenienza   
600        			FlgLockedIn				IN		PLS_INTEGER DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),
601        																	-- (valori 1/0/NULL) Indicatore di gruppo di privilegi riservato dal sistema e non modificabile/cancellabile da GUI
602        			FlgModPrivilegiIn			IN		VARCHAR2 DEFAULT 'I',				-- (valori I/C) Indica se i privilegi indicati nell'argomento successivo sono forniti in modo incrementale (=I) (solo quelle da inserire/modificare/cancellare) oppure completo (=C), vale a dire che dovranno soppiantare tutti quelli già appartenenti al gruppo in caso di gruppo di privilegi da aggiornare
603        			XMLPrivilegiIn			IN		CLOB DEFAULT NULL,				-- Lista con i privilegi del gruppo da aggiungere/togliere (XML conforme a schema LISTA_STD.xsd)					
604        																	-- Ogni privilegio/set di privilegi su un dato oggetto è un tag "Riga" che può contenere le seguenti colonne:
605        																	-- 1: (obblig.) Indica il tipo di oggetto su cui si esercitano i privilegi da dare/togliere
606        																		-- Valori ammessi:
607        																		--	F	=	Funzionalità del sistema; 
608        																		--	TP	=	Tipo di processo/procedimento; 
609        																		--	TD	=	Tipo di documento; 
610        																		--	TF	=	Tipo di folder; 
611        																		--	C	=	Classificazione; 
612        																		--	TR	=	Tipo di registrazione (protocollo o repertorio o altro);  
613        																		--	MR	=	Modello di registrazione
614        																	-- 2: Codice identificativo dell'oggetto su cui si esercitano i privilegi da dare/togliere (se funzione è la stringa restituita dalla function dmpk_utility.GetCodFunz per quella funzione, se tipo di registrazione è il suo ID_TP_REGISTRAZIONE, non la categoria e sigla)	
615        																	-- 3: Descrizione/denominazione dell'oggetto su cui si esercitano i privilegi da dare/togliere (ricerca case insensitive in like)
616        																	-- 4: (da valorizzare solo se colonna 1=C) Stringa con i n.ri livello della classificazione cui si esercitano i privilegi (tutti o solo alcuni i livelli; però se si specifica un livello è obbligatorio indicare tutti i livelli superiori; vanno indicati come appaiono nella GUI, ovvero romani se previsto, 0 o -- se nulli; vanno separati dal separatore dei livelli di classificazione valido per il soggetto produttore/AOO)
617        																	-- 5: Indica i privilegi (se più di uno separati da ;) da aggiungere/togliere sull'oggetto (può non essere specificato nulla nel caso di oggetti, per esempio certe funzioni, in cui l'oggetto già definisce il privilegio)
618        																		-- Valori possibili:
619        																		-- 	FC	=	Full control (solo come privilegio da aggiungere)
620        																		--	I	=	Inserimento (e anche modifica) 
621        																		--	M	=	Modifica
622        																		--	C	=	Cancellazione (solo come privilegio da togliere)
623        																		--	A	=	ad Assegnare/Avviare/registrare/creare 
624        																		--	F	=	a Firmare 
625        																		--  P   =   a Pubblicare
626        																		--	AF	=	ad Aprire Fascicoli 
627        																		--	SP	=	relativamente agli archivi di tutto il soggetto produttore
628        																		--	eSP	=	relativamente agli archivi di tutti i soggetti produttori in banca dati 
629        																	-- 6: (valori 1/0/NULL) Se 1 indica che il/i privilegi del record sono da togliere (anzichè da aggiungere)
630        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
631        																	-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
632        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
633        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
634        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
635        			ErrMsgOut				OUT 		VARCHAR2						-- Messaggio d'errore
636        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine (senza warning), altrimenti 0 (in caso di errore o warning)
637        
638        
639        	/*** Funzione di eliminazione di un gruppo di privilegi							***/	
640        	/*** Si può specificare se l'eliminazione deve essere fisica o solo logica (annullamento)		***/
641        	/*** Se non lo si specifica il sistema fa quella fisica se possibile, se no quella logica		***/
642        	function DGruppoPrivilegi(
643        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
644        																	-- (obblig). Codice identificativo del token di connessione
645        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
646        			IdGruppoPrivIn			IN		DMT_GRUPPI_PRIVILEGI.ID_GRUPPO_PRIV%type, -- (obblig. se NomeGruppoPrivIn è nullo) Identificativo del gruppo di privilegi da cancellare
647        			NomeGruppoPrivIn			IN		DMT_GRUPPI_PRIVILEGI.NOME_GRUPPO_PRIV%type, -- (obblig. se IdGruppoPrivIn è nullo) Nome del gruppo di privilegi da cancellare (ricerca case-insensitive in like senza forzare % finale)
648        			FlgCancFisicaIn			IN		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL): Se 1 si richiede la cancellazione fisica; se 0 l'annullamento logico; se non è valorizzato quella possibile delle 2. 		
649        			MotiviIn				IN		DMT_ACTIVITIES.NOTE%type DEFAULT NULL,	-- Motivi della cancellazione/annullamento
650        			FlgIgnoreWarningIn 		IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 0 o NULL significa che in presenza di WARNING la stored si comporta come in caso di errore; se 1 gli WARNING vengono ignorati
651        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
652        																	-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
653        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
654        			WarningMsgOut			OUT		VARCHAR2,						-- Messaggio di warning (valorizzato solo se non c'è errore)
655        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
656        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
657        			ErrMsgOut				OUT 		VARCHAR2						-- Messaggio d'errore
658        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine (senza warning), altrimenti 0 (in caso di errore o warning)
659        
660        
661        	/*******  funzione per ottenere i dati di dettaglio di un gruppo di privilegi *******/
662        	function LoadDettGruppoPrivilegi(
663        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
664        																	-- (obblig). Codice identificativo del token di connessione
665        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
666        			IdGruppoPrivIO			IN OUT	DMT_GRUPPI_PRIVILEGI.ID_GRUPPO_PRIV%type,	-- (obblig se NomeGruppoPrivIO non è valorizzato) Id. del gruppo 
667        																	-- in output, salvo in caso di errore, è sempre valorizzato
668        			NomeGruppoPrivIO			IN OUT	DMT_GRUPPI_PRIVILEGI.NOME_GRUPPO_PRIV%type,-- (obblig se IdGruppoPrivIO non è valorizzato in input) Nome del gruppo (ricerca case-insensitive in like senza forzare il % finale)
669        																	-- in output, salvo in caso di errore, è sempre valorizzato
670        			NoteGruppoPrivOut			OUT		DMT_GRUPPI_PRIVILEGI.NOTE%TYPE,		-- Note/dettagli sul gruppo di privilegi
671        			CIProvGruppoPrivOut		OUT 		DMT_GRUPPI_PRIVILEGI.PROV_CI_GRUPPO%TYPE,	-- Codice identificativo del gruppo di privilegi nel sistema di provenienza   
672        			FlgLockedOut			OUT		PLS_INTEGER,					-- (valori 1/0) Indicatore di gruppo di privilegi riservato dal sistema e non modificabile/cancellabile da GUI
673        			FlgNoListaPrivsIn			IN		PLS_INTEGER,					-- (valori 1/0/NULL) Se 1 la lista dei privilegi contenuti non viene estratta, altrimenti sì
674        			XMLPrivilegiOut			OUT		NOCOPY CLOB,					-- Lista con i privilegi contenuti nel gruppo(XML conforme a schema LISTA_STD.xsd)					
675        																	-- Ogni privilegio/set di privilegi su un dato oggetto è un tag "Riga" che contiene le seguenti colonne:
676        																	-- 1: (obblig.) Indica il tipo di oggetto su cui si esercitano i privilegi 
677        																		-- Valori ammessi:
678        																		--	F	=	Funzionalità del sistema; 
679        																		--	TP	=	Tipo di processo/procedimento; 
680        																		--	TD	=	Tipo di documento; 
681        																		--	TF	=	Tipo di folder; 
682        																		--	C	=	Classificazione; 
683        																		--	TR	=	Tipo di registrazione (protocollo o repertorio o altro);  
684        																		--	MR	=	Modello di registrazione
685        																	-- 2: Codice identificativo dell'oggetto su cui si esercitano i privilegi (se funzione è la stringa restituita dalla function dmpk_utility.GetCodFunz per quella funzione, se tipo di registrazione è il suo ID_TP_REGISTRAZIONE, non la categoria e sigla)	
686        																	-- 3: Descrizione/denominazione dell'oggetto su cui si esercitano i privilegi da dare/togliere 
687        																	-- 4: (valorizzato solo solo se colonna 1=C) Stringa con i n.ri livello della classificazione cui si esercitano i privilegi (i livelli sono indicati come appaiono nella GUI, ovvero romani se previsto, 0 o -- se nulli; sono separati dal separatore dei livelli di classificazione valido per il soggetto produttore/AOO)
688        																	-- 5: Indica i privilegi (se più di uno separati da ;) sull'oggetto (può non essere specificato nulla nel caso di oggetti, per esempio certe funzioni, in cui l'oggetto già definisce il privilegio)
689        																		-- Valori possibili:
690        																		-- 	FC	=	Full control (solo come privilegio da aggiungere)
691        																		--	I	=	Inserimento (e anche modifica) 
692        																		--	M	=	Modifica
693        																		--	A	=	ad Assegnare/Avviare/registrare/creare 
694        																		--	F	=	a Firmare 
695        																		--  P   =   a Pubblicare
696        																		--	AF	=	ad Aprire Fascicoli 
697        																		--	SP	=	relativamente agli archivi di tutto il soggetto produttore
698        																		--	eSP	=	relativamente agli archivi di tutti i soggetti produttori in banca dati 
699        																	-- 6: Descrizione dei privilegi sull'oggetto (è la decodifica della colonna 5)		
700        			BachSizeOut				OUT		PLS_INTEGER,					-- Indica il massimo n.ro di record per ogni pagina da mostrare nella lista dei privilegi
701        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
702        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
703        			ErrMsgOut				OUT 		VARCHAR2						-- Messaggio d'errore
704        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine (senza warning), altrimenti 0 (in caso di errore o warning)
705        
706        	/******* Funzione per ricercare i privilegi e/o gruppi di privilegi su oggetti di definizione del contesto organizzativo,archivistico e procedurale 		******/
707        	/******* che sono dati ad un dato destinatario (Soggetto Produttore/AOO/UO/scrivania/utente/profilo/ruolo/gruppo di privilegi)  					******/
708        	/******* si possono ricercare sia i privilegi/gruppi di privilegi dati anche indirettamente che solo quelli dati direttamente al destinatario indicato	******/
709        	function TrovaPrivSuOggDefContestoPer(
710        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
711        																	-- (obblig). Codice identificativo del token di connessione
712        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
713        			FlgPreimpostaFiltroIn		IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1 i filtri e l'ordinamento vengono settati secondo le impostazioni dell'utente di lavoro, altrimenti restano come passati in input
714        			FlgTpObjPrivToIn			IN		VARCHAR2,						-- (obblig.): Indica il tipo di destinatario dei privilegi e gruppi di privilegi da ricercare
715        																	-- Valori ammessi: 
716        																	-- 	SA	=	Soggetto produttore/AOO
717        																	--	UO	=	U.O. 
718        																	-- 	SV	=	Scrivania virtuale
719        																	--	UT	=	Utente
720        																	--	PR	=	Profilo
721        																	--	GP	=	Gruppo di privilegi
722        																	--	RA	=	Ruolo amministrativo (consentito solo se si assegna abilitazione a funzione, ovvero se FlgTpObjPrivOnIn=F)
723        			IdObjPrivToIn			IN		INTEGER DEFAULT NULL,				-- Identificativo (ID_SP_AOO o ID_UO o ID_SCRIVANIA o ID_USER o ID_PROFILO o ID_GRUPPO_PRIV o ID_RUOLO_AMM) del destinatario dei privilegi
724        			DesObjPrivToIn			IN		VARCHAR2 DEFAULT NULL,				-- Descrizione/denominazione del destinatario dei privilegi (ricerca case insensitive in like)
725        			LivelliUOPrivToIn			IN		VARCHAR2 DEFAULT NULL,				-- (da valorizzare solo se FlgTpObjPrivToIn=UO o SV) Stringa con i n.ri livello della UO destinataria o a cui appartiene la scrivania destinataria (tutti o alcuni; però se si specifica un livello è obbligatorio indicare tutti i livelli superiori; vanno specificati come appaiono nella GUI, ovvero romani se previsto, 0 o -- se nulli; sono separati dal separatore dei livelli valido per il soggetto produttore/AOO di appartenenza della UO)
726        			DesUOAppScrivaniaToIn		IN		VARCHAR2 DEFAULT NULL,				-- (da valorizzare solo se FlgTpObjPrivToIn=SV) Denominazione della UO in cui si trova la scrivania destinataria (o suo inizio; ricerca case insensitive in like). Può essere quella semplice o la concatenazione con separatore "|" delle denominazioni delle UO superiori + quella della UO	
727        			DesUserScrivaniaToIn		IN		VARCHAR2 DEFAULT NULL,				-- (da valorizzare solo se FlgTpObjPrivToIn=SV) Denominazione dell'utente che occupa la scrivania destinataria (ricerca case insensitive in like).
728        			--------------- inizio filtri di ricerca-------------------
729        			FlgTpObjPrivOnIn			IN		VARCHAR2,						-- 1° filtro di ricerca: Indica il tipo degli oggetti da cercare
730        																	-- Valori ammessi:
731        																	--	F	=	Privilegi su Funzionalità del sistema; 
732        																	--	TP	=	Privilegi su Tipo di processo/procedimento; 
733        																	--	TD	=	Privilegi su Tipo di documento; 
734        																	--	TF	=	Privilegi su Tipo di folder; 
735        																	--	C	=	Privilegi su Classificazione; 
736        																	--	TR	=	Privilegi su Tipo di registrazione (protocollo o repertorio o altro);  
737        																	--	MR	=	Privilegi su Modello di registrazione
738        																	--	GP	=	Gruppo di privilegi
739        																	-- può essere anche una lista di più valori tra quelli sopraelencati, separati da ;
740        			FlgSoloPrivilegiDirettiIn	IN		PLS_INTEGER DEFAULT NULL,			-- 2° filtro di ricerca (valori 1/0/NULL): Se 1 indica che si devono ricercare solo i privilegi e/o gruppi di privilegi dati direttamente al destinatario (non derivati ad esempio dalla sua appartenenza a gruppi o UO o i privilegi singoli derivati da gruppi di privilegi ecc)
741        			FlgTpPrivilegioIn			IN		VARCHAR2 DEFAULT NULL,				-- 3° filtro di ricerca: Indica il tipo dei privilegi singoli da cercare
742        																		-- Valori possibili:
743        																		-- 	FC	=	Full control (solo come privilegio da aggiungere)
744        																		--	I	=	Inserimento (e anche modifica) 
745        																		--	M	=	Modifica
746        																		--	C	=	Cancellazione (solo come privilegio da togliere)
747        																		--	A	=	ad Assegnare/Avviare/registrare/creare 
748        																		--	F	=	a Firmare 
749        																		--  P   =   a Pubblicare
750        																		--	AF	=	ad Aprire Fascicoli 
751        																		--	SP	=	relativamente agli archivi di tutto il soggetto produttore
752        																		--	eSP	=	relativamente agli archivi di tutti i soggetti produttori in banca dati 
753        			------------- inizio argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
754        			ColOrderByIO			IN OUT	VARCHAR2,						-- Indica il/i numeri della/e colonna dell'XML (CLOB ListaXMLOut) di output per cui ordinare i record nell'XML stesso (si può ordinare solo per le colonne da 1 a 4). Se l'ordinamento è per più colonne queste vanno separate con "," (es: 2; 2,3)
755        																	-- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul tipo di ordinamento una qualche preimpostazione di sistema/utente ecc.
756        																	-- se non valorizzato (neppure in output) la lista di record restituita non è ordinata
757        			FlgDescOrderByIO  		IN OUT	VARCHAR2,						-- E' una stringa di 1 o 0/NULL, tanti quanti le colonne di ordinamento, separati da ",": 1 significa che l'ordinamento per la data colonna deve essere discendente anzichè ascendente (es: 1; 1,0; 1, )
758        																	-- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul verso di ordinamento una qualche preimpostazione di sistema/utente ecc.			
759        			FlgSenzaPaginazioneIn 		IN 		PLS_INTEGER DEFAULT NULL,            	-- (valori 1/0/NULL) Se 1 l'estrazione non è paginata, altrimenti sì
760        			NroPaginaIO      			IN OUT	PLS_INTEGER,                  		-- E' il numero della pagina da estrarre; se NULL e l'estrazione è paginata viene estratta la prima pagina
761           			BachSizeIO				IN OUT	PLS_INTEGER,					-- Indica il massimo n.ro di record da estrarre se l'estrazione non è paginata (FlgSenzaPaginazioneIn=1)  
762        																	-- Indica la dimensione (n.ro di record) della pagina se l'estrazione è paginata (FlgSenzaPaginazioneIn 0 o NULL) e in tal caso se non è valorizzato la dimensione della pagina è quella settata per l'utente di lavoro o è pari al valore del parametro STD_PAGE_NUM_ROW del dominio di lavoro				
763        			OverFlowLimitIn			IN		PLS_INTEGER DEFAULT NULL,			-- E' il n.ro di record soddisfacenti la ricerca superato il quale la funzione deve restituire errore di overflow
764        			FlgSenzaTotIn			IN		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 significa che non è richiesto come output il totale dei record soddisfacenti la ricerca (se la ricerca è paginata per la prima pagina il totale viene calcolato comunque, per le successive no)
765        			NroTotRecOut			OUT		PLS_INTEGER,					-- E' il n.ro di record complessivi trovati (valorizzato solo se FlgSenzaTotIn è 0 o NULL o se si estrae la prima pagina)
766             			NroRecInPaginaOut 		OUT   	PLS_INTEGER,                     		-- E' il numero di record nella pagina (valorizzato solo se l'estrazione è paginata, ovvero se FlgSenzaPaginazioneIn 0 o NULL)
767        			------------- fine argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
768        			ListaXMLOut				OUT		NOCOPY CLOB,					-- Lista con i privilegi e/o gruppi di privilegi trovati, o meglio, per i privilegi singoli, con gli oggetti su cui insistono i privilegi trovati.  
769        																	-- Ogni privilegio su un dato oggetto o gruppi di privilegi è un tag "Riga" che contiene le seguenti colonne:
770        																	-- 1: (obblig.) Indica il tipo di oggetto rappresentato dalla riga 
771        																		-- Valori ammessi:
772        																		--	F	=	Privilegi su Funzionalità del sistema; 
773        																		--	TP	=	Privilegi su Tipo di processo/procedimento; 
774        																		--	TD	=	Privilegi su Tipo di documento; 
775        																		--	TF	=	Privilegi su Tipo di folder; 
776        																		--	C	=	Privilegi su Classificazione; 
777        																		--	TR	=	Privilegi su Tipo di registrazione (protocollo o repertorio o altro);  
778        																		--	MR	=	Privilegi su Modello di registrazione
779        																		--	GP	=	Gruppo di privilegi
780        																	-- 2: Codice identificativo dell'oggetto su cui si esercitano i privilegi (se funzione è la stringa restituita dalla function dmpk_utility.GetCodFunz per quella funzione) o del gruppo di privilegi	
781        																	-- 3: Descrizione/denominazione dell'oggetto su cui si esercitano i privilegi o del gruppo di privilegi 
782        																	-- 4: (valorizzato solo solo se colonna 1=C) Stringa con i n.ri livello della classificazione cui si esercitano i privilegi (i livelli sono indicati come appaiono nella GUI, ovvero romani se previsto, 0 o -- se nulli; sono separati dal separatore dei livelli di classificazione valido per il soggetto produttore/AOO)
783        																	-- 5: (valorizzata solo se FlgSoloPrivilegiDirettiIn=1) Indica i privilegi (se più di uno separati da ;) sull'oggetto (può non essere specificato nulla nel caso di oggetti, per esempio certe funzioni, in cui l'oggetto già definisce il privilegio)
784        																		-- Valori possibili:
785        																		-- 	FC	=	Full control (solo come privilegio da aggiungere)
786        																		--	I	=	Inserimento (e anche modifica) 
787        																		--	M	=	Modifica
788        																		--	A	=	ad Assegnare/Avviare/registrare/creare 
789        																		--	F	=	a Firmare 
790        																		--  P   =   a Pubblicare
791        																		--	AF	=	ad Aprire Fascicoli 
792        																		--	SP	=	relativamente agli archivi di tutto il soggetto produttore
793        																		--	eSP	=	relativamente agli archivi di tutti i soggetti produttori in banca dati 
794        																	-- 6: (valorizzata solo se FlgSoloPrivilegiDirettiIn=1) Descrizione dei privilegi sull'oggetto (è la decodifica della colonna 5)		
795        																	-- 7: (valorizzata solo se FlgSoloPrivilegiDirettiIn=1) (valori 1/0) Se 1 indica che il privilegio è dato al profilo anzichè direttamente all'utente/UO/scrivania
796        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
797        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
798        			ErrMsgOut				OUT 		VARCHAR2,						-- Messaggio d'errore
799        			RigaTagNameIn			IN		VARCHAR2 DEFAULT NULL,				-- (opzionale) Come rinominare il tag Riga dell'XML ListaXMLOut di output
800        			ColTagNameIn			IN		DMVA_STRING DEFAULT NULL)			-- (opzionale) Come rinominare i tag delle colonne in alternativa a Colonna Nro=.. nell'XML ListaXMLOut di output
801        			return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine, altrimenti 0
802        
803        	/********* funzione per profilare o aggiornare la profilatura (ovvero profilo e gruppi di privilegi assegnati) di un dato utente, scrivania virtuale o UO 	*******/
804        	/********* se si tratta di un utente la profilatura viene fatta/aggiornata nel dominio a cui si è connessi									*******/
805        	/********* Nota: il profilo contiene sia informazioni di abilitazione che in generale di caratterizzazione									*******/
806        	function Profila(
807        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
808        																	-- (obblig). Codice identificativo del token di connessione
809        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
810        			FlgTpSoggDaProfilareIn		IN		VARCHAR2,						-- (obblig.) Indica il tipo di soggetto da profilare/di cui aggiornare il profilo
811        																	-- Valori ammessi: 
812        																	--	UO	=	U.O. 
813        																	-- 	SV	=	Scrivania virtuale
814        																	--	UT	=	Utente
815        			IdSoggettoDaProfilareIn		IN		INTEGER,						-- (obblig.) Identificativo (ID_UO o ID_SCRIVANIA o ID_USER) del soggetto da profilare/di cui aggiornare il profilo
816        			IdProfiloIn				IN		DMT_PROFILI.ID_PROFILO%type DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),
817        																	-- Id. del profilo di DMT_PROFILI (uno di quelli che hanno un nome) da assegnare
818        			NomeProfiloIn			IN		DMT_PROFILI.NOME_PROFILO%type DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
819        																	-- Nome del profilo di DMT_PROFILI da assegnare (ricerca case-insensitive in like)	
820        			XMLDatiProfiloIn			IN		CLOB DEFAULT NULL,				-- XML (conforme a schema SezioneCache.xsd) che contiene tutti gli attributi del profilo (tranne i gruppi di provilegi) da settare/aggiornare
821        																	-- ATTENZIONE: Si intende che gli attributi corrispondenti a tag non presenti restino invariati
822        																	-- Nell'XML possono esserci tag corrispondenti ad attributi di profilatura solo se non si è specificato un profilo predefinito con i due argomenti IdProfiloIn e/o NomeProfiloIn
823        			FlgModGruppiPrivIn		IN		VARCHAR2 DEFAULT 'I',				-- (valori I/C) Indica se i gruppi di privilegi indicati nell'argomento successivo sono forniti in modo incrementale (=I) (solo quelle da inserire/cancellare) oppure completo (=C), vale a dire che dovranno soppiantare tutti quelli già associati al soggetto di cui aggiornare la profilatura
824        			XMLGruppiPrivIn			IN		CLOB DEFAULT NULL,				-- Lista con i gruppi di privilegi assegnati/da assegnare direttamente (ovvero non tramite profilo) al soggetto (XML conforme a schema LISTA_STD.xsd)					
825        																	-- Ogni gruppo è un tag "Riga" che può contenere le seguenti colonne:
826        																	-- 1: Identificativo del gruppo di privilegi
827        																	-- 2: Nome del gruppo di privilegi (ricerca case insesnsitive in like)
828        																	-- 3: (valori 1/0/NULL) Flag di gruppo da eliminare
829        			FlgIgnoreWarningIn 		IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 0 o NULL significa che in presenza di WARNING la stored si comporta come in caso di errore; se 1 gli WARNING vengono ignorati
830        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
831        																	-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
832        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
833        			WarningMsgOut			OUT		VARCHAR2,						-- Messaggio di warning (valorizzato solo se non c'è errore)
834        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
835        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
836        			ErrMsgOut				OUT 		VARCHAR2						-- Messaggio d'errore
837        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine (senza warning), altrimenti 0 (in caso di errore o warning)
838        
839        	/************* funzione per creare o aggiornare un profilo della DMT_PROFILI, sia un profilo con nome, ovvero associabile a più soggetti, sia quello di uno specifico soggetto (anche senza nome) ******/
840        	function IUProfilo(
841        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
842        																	-- (obblig). Codice identificativo del token di connessione
843        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
844        			IdProfiloIO				IN OUT	DMT_PROFILI.ID_PROFILO%type,			-- Id. del profilo di DMT_PROFILI da aggiornare
845        																	-- Se NULL si intende che il profilo sia da creare
846        																	-- In output, salvo in caso di errore, è sempre valorizzato	
847        			NomeProfiloIn			IN		DMT_PROFILI.NOME_PROFILO%type DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
848        																	-- Nome del profilo	
849        			XMLDatiProfiloIn			IN		CLOB DEFAULT NULL,	-- XML (conforme a schema SezioneCache.xsd) che contiene tutti gli attributi del profilo (tranne i gruppi di provilegi) da settare/aggiornare
850        																	-- Contiene le variabili:
851        																	-- LivMaxRiservatezza: massimo livello di riservatezza a cui si è abilitati
852        																	-- FlgVisibTuttiRiservati: (valori 1/0) Se 1 indica che si è abilitati a vedere in chiaro tutti i documenti e fascicoli riservati (se ACL e altre caratteristiche del documento/fascicolo oltre la riservatezza lo consentono)
853        																	-- AccessoDocIndipACL: (valori FC/V/NULL) Se FC significa che si ha accesso full-control ai documenti indipendentemente dalla loro ACL, se V che si ha accesso in sola visualizzazione ai documenti indipendentemente dalla loro ACL
854        																	-- AccessoFolderIndipACL: (valori FC/V/NULL) Se FC significa che si ha accesso full-control ai fascicoli/folder indipendentemente dalla loro ACL, se V che si ha accesso in sola visualizzazione ai folder indipendentemente dalla loro ACL
855        																	-- AccessoWorkspaceIndipACL: (valori FC/V/NULL) Se FC significa che si ha accesso full-control ai workspace indipendentemente dalla loro ACL, se V che si ha accesso in sola visualizzazione ai workspace indipendentemente dalla loro ACL
856        																	-- AccessoDocIndipUserAbil: (valori FC/V/NULL) Se FC significa che si ha accesso full-control ai documenti indipendentemente dalle abilitazioni dell'utente alla tipologia e altre caratterizzazioni del documento, se V che si ha accesso in sola visualizzazione ai documenti indipendentemente dalle loro caratteristiche (tipologia ecc)
857        																	-- AccessoFolderIndipUserAbil: (valori FC/V/NULL) Se FC significa che si ha accesso full-control ai fascicoli/folder indipendentementedalle abilitazioni dell'utente alla tipologia e altre caratterizzazioni del folder (tipo di procedimento collegato ecc), se V che si ha accesso in sola visualizzazione ai folder indipendentemente dalle loro caratteristiche (tipologia ecc)
858        																	-- ATTENZIONE: Si intende che gli attributi corrispondenti a tag non presenti restino invariati
859        			FlgModGruppiPrivIn		IN		VARCHAR2 DEFAULT 'I',				-- (valori I/C) Indica se i gruppi di privilegi indicati nell'argomento successivo sono forniti in modo incrementale (=I) (solo quelle da inserire/cancellare) oppure completo (=C), vale a dire che dovranno soppiantare tutti quelli già associati al profilo
860        			XMLGruppiPrivIn			IN		CLOB DEFAULT NULL,				-- Lista con i gruppi di privilegi assegnati/da assegnare al profilo (XML conforme a schema LISTA_STD.xsd)					
861        																	-- Ogni gruppo è un tag "Riga" che può contenere le seguenti colonne:
862        																	-- 1: Identificativo del gruppo di privilegi
863        																	-- 2: Nome del gruppo di privilegi (ricerca case insesnsitive in like)
864        																	-- 3: (valori 1/0/NULL) Flag di gruppo da eliminare
865        			FlgIgnoreWarningIn 		IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 0 o NULL significa che in presenza di WARNING la stored si comporta come in caso di errore; se 1 gli WARNING vengono ignorati
866        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
867        																	-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
868        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
869        			WarningMsgOut			OUT		VARCHAR2,						-- Messaggio di warning (valorizzato solo se non c'è errore)
870        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
871        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
872        			ErrMsgOut				OUT 		VARCHAR2						-- Messaggio d'errore
873        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine (senza warning), altrimenti 0 (in caso di errore o warning)
874        
875        	/*** Funzione di eliminazione di un profilo della DMT_PROFILI									***/	
876        	/*** Si può specificare se l'eliminazione deve essere fisica o solo logica (annullamento)		***/
877        	/*** Se non lo si specifica il sistema fa quella fisica se possibile, se no quella logica		***/
878        	function DProfilo(
879        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
880        																	-- (obblig). Codice identificativo del token di connessione
881        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
882        			IdProfiloIn				IN 		DMT_PROFILI.ID_PROFILO%type,			-- (obblig. se NomeProfiloIn non è valorizzato) Id. del profilo di DMT_PROFILI da cancellare/annullare
883        			NomeProfiloIn			IN		DMT_PROFILI.NOME_PROFILO%type,			-- (obblig. se IdProfiloIn non è valorizzato) Nome del profilo di DMT_PROFILI da cancellare/annullare
884        			FlgCancFisicaIn			IN		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL): Se 1 si richiede la cancellazione fisica; se 0 l'annullamento logico; se non è valorizzato quella possibile delle 2. 		
885        			MotiviIn				IN		DMT_ACTIVITIES.NOTE%type,			-- Motivi della cancellazione/annullamento
886        			FlgIgnoreWarningIn 		IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 0 o NULL significa che in presenza di WARNING la stored si comporta come in caso di errore; se 1 gli WARNING vengono ignorati
887        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
888        																	-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
889        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
890        			WarningMsgOut			OUT		VARCHAR2,						-- Messaggio di warning (valorizzato solo se non c'è errore)
891        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
892        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
893        			ErrMsgOut				OUT 		VARCHAR2						-- Messaggio d'errore
894        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine (senza warning), altrimenti 0 (in caso di errore o warning)
895        
896        	/******* funzione per ottenere i dati di un profilo *******/
897        	function LoadDettProfilo(
898        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
899        																						-- (obblig). Codice identificativo del token di connessione
900        			IdUserLavoroIn				IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
901        			IdProfiloIO					IN OUT	DMT_PROFILI.ID_PROFILO%type,			-- (obblig se NomeProfiloIO non è valorizzato) Id. del profilo 
902        																						-- in output, salvo in caso di errore, è sempre valorizzato
903        			NomeProfiloIO				IN OUT	DMT_PROFILI.NOME_PROFILO%type,
904        																						-- (obblig se IdProfiloIO non è valorizzato in input) Nome profilo (ricerca case-insensitive in like senza forzare il % finale)
905        																						-- in output, salvo in caso di errore, è sempre valorizzato
906        			XMLDatiProfiloOut			OUT		NOCOPY CLOB,							-- XML (conforme a schema SezioneCache.xsd) con i dati del profilo (tranne i privilegi)
907        																						-- Contiene le variabili:
908        																						-- LivMaxRiservatezza: massimo livello di riservatezza a cui si è abilitati
909        																						-- FlgVisibTuttiRiservati: (valori 1/0) Se 1 indica che si è abilitati a vedere in chiaro tutti i documenti e fascicoli riservati (se ACL e altre caratteristiche del documento/fascicolo oltre la riservatezza lo consentono)
910        																						-- AccessoDocIndipACL: (valori FC/V/NULL) Se FC significa che si ha accesso full-control ai documenti indipendentemente dalla loro ACL, se V che si ha accesso in sola visualizzazione ai documenti indipendentemente dalla loro ACL
911        																						-- AccessoFolderIndipACL: (valori FC/V/NULL) Se FC significa che si ha accesso full-control ai fascicoli/folder indipendentemente dalla loro ACL, se V che si ha accesso in sola visualizzazione ai folder indipendentemente dalla loro ACL
912        																						-- AccessoWorkspaceIndipACL: (valori FC/V/NULL) Se FC significa che si ha accesso full-control ai workspace indipendentemente dalla loro ACL, se V che si ha accesso in sola visualizzazione ai workspace indipendentemente dalla loro ACL
913        																						-- AccessoDocIndipUserAbil: (valori FC/V/NULL) Se FC significa che si ha accesso full-control ai documenti indipendentemente dalle abilitazioni dell'utente alla tipologia e altre caratterizzazioni del documento, se V che si ha accesso in sola visualizzazione ai documenti indipendentemente dalle loro caratteristiche (tipologia ecc)
914        																						-- AccessoFolderIndipUserAbil: (valori FC/V/NULL) Se FC significa che si ha accesso full-control ai fascicoli/folder indipendentementedalle abilitazioni dell'utente alla tipologia e altre caratterizzazioni del folder (tipo di procedimento collegato ecc), se V che si ha accesso in sola visualizzazione ai folder indipendentemente dalle loro caratteristiche (tipologia ecc)
915        																						-- PresentiPrivSuFunzioni (valori 1/0): Se 1 significa che sono presenti abilitazioni a funzioni
916        			ErrContextOut				OUT		VARCHAR2,								-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
917        			ErrCodeOut					OUT		PLS_INTEGER,							-- N.ro errore di uscita
918        			ErrMsgOut					OUT 	VARCHAR2								-- Messaggio d'errore
919        			) return PLS_INTEGER;														-- Vale 1 se tutto è andato a buon fine (senza warning), altrimenti 0 (in caso di errore o warning)
920        
921        	/**** Funzione per ricercare i gruppi di utenti/UO/scrivanie 													*****/
922        	/**** permette anche di ricercare i gruppi cui appartiene un certo utente/UO/scrivania (anche indirettamete, attraverso gruppi innestati) *****/
923        	FUNCTION TrovaGruppiSoggInt(
924        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
925        																	-- (obblig). Codice identificativo del token di connessione
926        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
927        			FlgPreimpostaFiltroIn		IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1 i filtri e l'ordinamento vengono settati secondo le impostazioni dell'utente di lavoro, altrimenti restano come passati in input
928        			--------------- inizio filtri di ricerca-------------------
929        			IdGruppoIO				IN OUT	DMT_GRUPPI.ID_GRUPPO%type,			-- 1° filtro di ricerca: id. del gruppo da ricercare
930        			NomeIO				IN OUT	DMT_GRUPPI.NOME_GRUPPO%type, 			-- 2° filtro di ricerca: stringa contenuta nel nome del gruppo (ricerca case-insensitive in like)
931        			FlgDiDefInACLIO			IN OUT	PLS_INTEGER,					-- (valori 1/0/NULL) 3° filtro di ricerca: 1 = Solo gruppi che di default sono messi nell'ACL di oggetti della repository; 0 = Solo gruppi che di default NON sono messi nell'ACL di oggetti della repository; NULL = nessun filtro
932        			CIProvGruppoIO			IN OUT	DMT_GRUPPI.PROV_CI_GRUPPO%TYPE,		-- 4° filtro di ricerca: Codice identificativo del gruppo nel sistema di provenienza: ricerca esatta case-sensitive  
933        			FlgIncludiNonVldIO 		IN OUT 	INTEGER, 						-- (valori 1/0/NULL) 5° filtro di ricerca: Se 1 indica se si devono estrarre anche i gruppi non validi alla data odierna, altrimenti solo quelli validi
934        			TsVldIO				IN OUT	VARCHAR2,						-- 6° filtro di ricerca: Stinga con il timestamp (nel formato GG/MM/AAAA HH24:MI:SS) a cui devono essere validi i gruppi da estrarre
935        			CodApplOwnerIO			IN OUT	VARCHAR2,						-- 7° filtro di ricerca: Codice dell'applicazione "proprietaria" dei gruppi. Se valorizzata pari a #BY_CONN_TKN e si è connessi da un'applicazione esterna si ricercano solo gruppi di cui è proprietaria quell'applicazione
936        			CodIstApplOwnerIO			IN OUT	VARCHAR2,						-- 8° filtro di ricerca: Codice dell'istanza di applicazione "proprietaria" dei gruppi. Se valorizzata pari a #BY_CONN_TKN e si è connessi da un'applicazione esterna si ricercano solo gruppi di cui è proprietaria l'istanza di applicazione esterna da cui si è connessi
937        			FlgRestrApplOwnerIO		IN OUT	INTEGER,						-- (valori 1/0/NULL) Se 1 vengono estratti solo gruppi di cui è proprietaria l'applicazione proprietaria (ed eventuale istanza) specificata in CodApplOwnerIO; se 0 o NULL e se CodApplOwnerIO è valorizzata vengono estratti solo i gruppi senza applicazione proprietaria o con applicazione proprietria pari a quella specificata
938        			FlgTpObjAppartenenteIO		IN OUT	VARCHAR2,						-- Indica il tipo di soggetto interno che si vuole appartenga al gruppo.
939        																	-- Valori ammessi: 
940        																	--	UO	=	U.O. 
941        																	-- 	SV	=	Scrivania virtuale
942        																	--	UT	=	Utente
943        																	--	G	=	Gruppo di soggetti interni														
944        			IdObjAppartenenteIO		IN OUT	INTEGER,						-- 9° filtro di ricerca: identificativo (ID_UO o ID_SCRIVANIA o ID_USER o ID_GRUPPO) del soggetto interno che deve appartenere ai gruppi da trovare
945        			DesObjAppartenenteIO		IN OUT	VARCHAR2,						-- 10° filtro di ricerca: descrizione/denominazione del soggetto interno che deve appartenere ai gruppi da trovare (ricerca case insensitive in like senza forzare il % finale)
946        			LivelliUOAppartenenteIO		IN OUT	VARCHAR2,						-- 11° filtro di ricerca: (da valorizzare solo se FlgTpObjAppartenenteIO=UO o SV) Stringa con i n.ri livello della UO appartenente ai gruppi da trovare o a cui appartiene la scrivania appartenente ai gruppi da trovare (tutti o alcuni; però se si specifica un livello è obbligatorio indicare tutti i livelli superiori; vanno specificati come appaiono nella GUI, ovvero romani se previsto, 0 o -- se nulli; sono separati dal separatore dei livelli valido per il soggetto produttore/AOO di appartenenza della UO)
947        			DesUOAppScrivaniaToIO		IN OUT	VARCHAR2,						-- 12° filtro di ricerca: (da valorizzare solo se FlgTpObjAppartenenteIO=SV) Denominazione della UO in cui si trova la scrivania appartenente ai gruppi da trovare (o suo inizio; ricerca case insensitive in like senza forzare il % finale). Può essere quella semplice o la concatenazione con separatore "|" delle denominazioni delle UO superiori + quella della UO	
948        			DesUserScrivaniaToIO		IN OUT	VARCHAR2,						-- 13° filtro di ricerca: (da valorizzare solo se FlgTpObjAppartenenteIO=SV) Denominazione dell'utente che occupa la scrivania appartenente ai gruppi da trovare (ricerca case insensitive in like senza forzare il % finale).
949        			FlgAncheAppartIndirettaIO	IN OUT	PLS_INTEGER,					-- (valori 1/0/NULL) Se 1 vengono trovati anche gruppi a cui il soggetto interno individuato dagli argomenti precedenti appartiene indirettamente (cioè attraverso innestamento di gruppi e gerarchia di UO), altrmenti solo quelli cui appartiene direttamente 
950        			AltriCriteriIO			IN OUT 	NOCOPY CLOB,					-- Altri criteri di ricerca sugli attributi addizionali (XML conforme a schema LISTA_STD.xsd). Se più di uno vengono applicati in AND.
951        																	-- Ogni criterio è un tag Riga che può contenere le seguenti colonne:
952        																	--	1) Nome (ATTR_NAME) dell'attributo cui è relativo il criterio
953        																	--	2) (obblig.) Operatore logico. Valori possibili:
954        																	--		"uguale" (ricerca esatta) 
955        																	--		"simile a (case-sensitive)" (ricerca case-sensitive in like)
956        																	--		"simile a (case-insensitive)" (ricerca case-insensitive in like e che ignora i caratteri quali spazi, ., ecc)
957        																	--		"maggiore" (se attributo numerico o data)
958        																	--		"maggiore o uguale" (se attributo numerico o data)
959        																	--		"minore" (se attributo numerico o data)
960        																	--		"minore o uguale" (se attributo numerico o data)
961        																	--		"tra" (se attributo numerico o data)
962        																	--		"non valorizzato"
963        																	--		"valorizzato"
964        																	--		"spuntato" (se attributo di tipo casella di spunta)
965        																	--		"non spuntato" (se attributo di tipo casella di spunta)
966        																	--	3) 1° valore di confronto (obblig. e gestito solo se l'operatore non ha uno dei seguenti valori: valorizzato, non valorizzato, spuntato, non spuntato) (se l'attributo è numerico deve avere la virgola come separatore dei decimali, se è di tipo data deve essere in uno dei formato dati dai parametri di conf. FMT_STD_DATA e FMT_STD_TIMESTAMP)
967        																	--	4) 2° valore di confronto (obblig. e gestito solo se l'operatore è "tra") (se l'attributo è numerico deve avere la virgola come separatore dei decimali, se è di tipo data deve essere in uno dei formato dati dai parametri di conf. FMT_STD_DATA e FMT_STD_TIMESTAMP)
968        																	--	5) Label dell''attributo cui è relativo il criterio (se sotto-attributo di complesso <label del complesso> - <label del sotto-attributo>
969        			------------- inizio argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
970        			ColOrderByIO			IN OUT	VARCHAR2,						-- Indica il/i numeri della/e colonna dell'XML (CLOB ListaXMLOut) di output per cui ordinare i record nell'XML stesso (si può ordinare solo per le colonne da 1 a 6). Se l'ordinamento è per più colonne queste vanno separate con "," (es: 2; 2,3)
971        																	-- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul tipo di ordinamento una qualche preimpostazione di sistema/utente ecc.
972        																	-- se non valorizzato (neppure in output) la lista di record restituita non è ordinata
973        			FlgDescOrderByIO  		IN OUT	VARCHAR2,						-- E' una stringa di 1 o 0/NULL, tanti quanti le colonne di ordinamento, separati da ",": 1 significa che l'ordinamento per la data colonna deve essere discendente anzichè ascendente (es: 1; 1,0; 1, )
974        																	-- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul verso di ordinamento una qualche preimpostazione di sistema/utente ecc.			
975        			FlgSenzaPaginazioneIn 		IN 		PLS_INTEGER DEFAULT NULL,            	-- (valori 1/0/NULL) Se 1 l'estrazione non è paginata, altrimenti sì
976        			NroPaginaIO      			IN OUT	PLS_INTEGER,                  		-- E' il numero della pagina da estrarre; se NULL e l'estrazione è paginata viene estratta la prima pagina
977           			BachSizeIO				IN OUT	PLS_INTEGER,					-- Indica il massimo n.ro di record da estrarre se l'estrazione non è paginata (FlgSenzaPaginazioneIn=1)  
978        																	-- Indica la dimensione (n.ro di record) della pagina se l'estrazione è paginata (FlgSenzaPaginazioneIn 0 o NULL) e in tal caso se non è valorizzato la dimensione della pagina è quella settata per l'utente di lavoro o è pari al valore del parametro STD_PAGE_NUM_ROW del dominio di lavoro				
979        			OverFlowLimitIn			IN		PLS_INTEGER DEFAULT NULL,			-- E' il n.ro di record soddisfacenti la ricerca superato il quale la funzione deve restituire errore di overflow
980        			FlgSenzaTotIn			IN		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 significa che non è richiesto come output il totale dei record soddisfacenti la ricerca (se la ricerca è paginata per la prima pagina il totale viene calcolato comunque, per le successive no)
981        			NroTotRecOut			OUT		PLS_INTEGER,					-- E' il n.ro di record complessivi trovati (valorizzato solo se FlgSenzaTotIn è 0 o NULL o se si estrae la prima pagina)
982             			NroRecInPaginaOut 		OUT   	PLS_INTEGER,                     		-- E' il numero di record nella pagina (valorizzato solo se l'estrazione è paginata, ovvero se FlgSenzaPaginazioneIn 0 o NULL)
983        			------------- fine argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
984        			ListaXMLOut				OUT		NOCOPY CLOB,					-- Lista dei tipi gruppi trovati (XML conforme a schema LISTA_STD.xsd)
985        																	-- Ogni gruppo è un tag Riga che può contenere le seguenti colonne: 
986        																	-- 1:  Identificativo del gruppo
987        																	-- 2:  Nome del gruppo
988        																	-- 3:  Data di inizio validità (nel formato dato dal parametro FMT_STD_DATA)
989        																	-- 4:  Data di fine validità (nel formato dato dal parametro FMT_STD_DATA)
990        																	-- 5:  (valori 1/0) Flag che indica se il gruppo viene messo di defaul nell'ACL degli oggetti caricati nella repository documentale
991        																	-- 6:  Cod. identificativo del gruppo nel sistema di provenienza
992        																	-- 7:  Flag che indica che il gruppo è "di proprieà" dell'applicazione CodApplOwnerIO ed eventuale sua istanza CodIstApplOwnerIO
993        																	-- 8:  Descrizione dell'applicazione (ed eventuale istanza) proprietaria del gruppo
994        																	-- 9:  Timestamp di creazione del gruppo (nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP)
995        																	-- 10: Descrizione dell'utente di creazione del gruppo 
996        																	-- 11: Timestamp di ultima modifica dei dati del gruppo (nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP)
997        																	-- 12: Descrizione dell'utente di ultima modifica dei dati del del gruppo 																						
998        																	-- 13: (valori 1/0) Indicatore di gruppo riservato dal sistema e non modificabile da applicativo
999        																	-- 14: (valori 1/0) Indicatore di gruppo attualmente valido
1000        			FlgAbilInsOut	 		OUT 		PLS_INTEGER ,            			-- (valori 1/0) Se 1 si ha abilitazione a inserimento di gruppi
1001        			FlgAbilUpdOut 			OUT 		PLS_INTEGER ,            			-- (valori 1/0) Se 1 si ha abilitazione a modifica di gruppi
1002        			FlgAbilDelOut 			OUT 		PLS_INTEGER,            			-- (valori 1/0) Se 1 si ha abilitazione a cancellazione di gruppi
1003        			FlgMostraAltriAttrOut		OUT		PLS_INTEGER,					-- (valori 1/0) Se 1 nella GUI vanno mostrati gli attributi addizionali per un nuovo gruppo (ce ne sono di visibile all'utente), se 0 no
1004        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
1005        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
1006        			ErrMsgOut				OUT 		VARCHAR2,						-- Messaggio d'errore
1007        			RigaTagNameIn			IN		VARCHAR2 DEFAULT NULL,				-- (opzionale) Come rinominare il tag Riga dell'XML ListaXMLOut di output
1008        			ColTagNameIn			IN		DMVA_STRING DEFAULT NULL)			-- (opzionale) Come rinominare i tag delle colonne in alternativa a Colonna Nro=.. nell'XML ListaXMLOut di output
1009        			return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine, altrimenti 0
1010        
1011        	/********* funzione per caricare i dati di dettaglio di un gruppo di soggetti interni, inclusi i suoi membri 	**********/
1012        	/********* ATTENZIONE: come membri vengono mostrati solo quelli direttamente appartenenti al gruppo 			**********/ 
1013        	function LoadDettGruppoSoggInt(
1014        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
1015        																	-- (obblig). Codice identificativo del token di connessione
1016        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
1017        			IdGruppoIO				IN OUT	DMT_GRUPPI.ID_GRUPPO%type,			-- (obblig se NomeGruppoIO non è valorizzato) Id. del gruppo 
1018        																	-- in output, salvo in caso di errore, è sempre valorizzato
1019        			NomeGruppoIO			IN OUT	DMT_GRUPPI.NOME_GRUPPO%type, 			-- (obblig se IdGruppoIO non è valorizzato in input) Nome del gruppo (ricerca case-insensitive in like se	nza forzare il % finale)
1020        																	-- in output, salvo in caso di errore, è sempre valorizzato
1021        			FlgDiDefaultInACLOut		OUT		PLS_INTEGER,					-- (valori 1/0) Se 1 è un gruppo che di default viene messo nell'ACL di oggetti della repository
1022        			DtInizioVldOut			OUT		VARCHAR2,						-- Data di inizio validità (nel formato dato dal parametro di conf. FMT_STD_DATA).
1023        			DtFineVldOut			OUT		VARCHAR2,						-- Data di fine validità (nel formato dato dal parametro di conf. FMT_STD_DATA).
1024        			CIProvGruppoOut			OUT 		DMT_GRUPPI.PROV_CI_GRUPPO%TYPE,		-- Codice identificativo del gruppo nel sistema di provenienza   
1025        			FlgLockedOut			OUT		PLS_INTEGER,					-- (valori 1/0) Indicatore di gruppo riservato dal sistema e non modificabile/cancellabile da GUI
1026        			RowidOut				OUT		VARCHAR2,						-- Rowid del record del gruppo
1027        			XMLMembriOut			OUT		NOCOPY CLOB,					-- Lista dei membri del gruppo (XML conforme a schema LISTA_STD.xsd)					
1028        																	-- Ogni membro è tag "Riga" che contiene le seguenti colonne:
1029        																	-- 1: Indicatore del tipo di membro: 
1030        																	-- Valori ammessi:
1031        																	--	UO	=	U.O. 
1032        																	-- 	SV	=	Scrivania virtuale
1033        																	--	UT	=	Utente
1034        																	--	G	=	Gruppo di soggetti interni
1035        																	-- 2: identificativo (ID_UO o ID_SCRIVANIA o ID_USER o ID_GRUPPO) del membro
1036        																	-- 3: descrizione/denominazione del membro 
1037        																	-- 4: (solo se colonna 1 = UO o SV) Stringa con i n.ri livello della UO membro o a cui appartiene la scrivania membro (sono specificati come appaiono nella GUI, ovvero romani se previsto, 0 o -- se nulli; sono separati dal separatore dei livelli valido per il soggetto produttore/AOO di appartenenza della UO)
1038        																	-- 5: (solo se colonna 1 = SV) Denominazione della UO in cui si trova la scrivania membro 
1039        																	-- 6: (solo se colonna 1 = SV) Denominazione dell'utente che occupa la scrivania membro 
1040        																	-- 7: (valori 1/0/NULL; valorizzata solo se colonna 1 = UO) Se 1 le sotto-UO sono incluse ne gruppo
1041        																	-- 8: (valori 1/0/NULL; valorizzata solo se colonna 1 = UO) Se 1 le scrivanie della UO (e sue sotto-UO se a lro volta incluse) sono incluse nel gruppo 
1042        			AttributiAddOut			OUT		NOCOPY CLOB,					-- Lista degli eventuali ulteriori attributi con cui caratterizzare il gruppo (XML conforme a schema LISTA_STD.xsd)
1043        																	-- Ogni attributo è un tag "Riga" che contiene le seguenti colonne:
1044        																	-- 1: N.ro (valori da 1 a n) del riquadro (fieldset) in cui mostrare l'attributo
1045        																	-- 2: Nome identificativo dell'attributo (ATTR_NAME)
1046        																	-- 3: Label del campo con cui rappresentare l'attributo 
1047        																	-- 4: Tipo di attributo. Valori: DATE, DATETIME, TEXT, TEXT-AREA, CHECK, INTEGER, EURO, DECIMAL, COMBO-BOX, LISTA
1048        																	-- 5: N.ro massimo di caratteri/cifre
1049        																	-- 6: Larghezza del campo con cui rappresentare l'attributo (size)
1050        																	-- 7: Valore dell'attributo
1051        																	-- 8: Label del riquadro (fieldset) in cui mostrare l'attributo
1052        																	-- 9: (valori 1/0) 1 indica che l'attributo è obbligatorio, 0 che è facoltativo
1053        																	-- 10: Altezza (in nro righe) del campo con cui rappresentare l'attributo (se TEXT-AREA)
1054        																	-- 11:(valori 1/0) 1 indica se l'attributo è modificabile, 0 che è in sola visualizzazione   
1055        			BachSizeOut				OUT		PLS_INTEGER,					-- Indica il massimo n.ro di record per ogni pagina da mostrare nella lista dei membri
1056        			FlgMostraAltriAttrOut		OUT		PLS_INTEGER,					-- (valori 1/0) Se 1 nella GUI vanno mostrati gli attributi addizionali (ce ne sono di visibile all'utente), se 0 no
1057        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
1058        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
1059        			ErrMsgOut				OUT 		VARCHAR2)						-- Messaggio d'errore
1060        			return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine, altrimenti 0
1061        
1062        	/********* funzione per creare o modificare un gruppo di soggetti interni, inclusi i suoi membri 	**********/
1063        	function IUGruppoSoggInt(
1064        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
1065        																	-- (obblig). Codice identificativo del token di connessione
1066        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
1067        			IdGruppoIO				IN OUT	DMT_GRUPPI.ID_GRUPPO%type,			-- Id. del gruppo da modificare. Se NULL si intende che il gruppo è da creare ex-novo
1068        																	-- in output, salvo in caso di errore, è sempre valorizzato
1069        			NomeGruppoIn			IN 		DMT_GRUPPI.NOME_GRUPPO%type DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
1070        																	-- (obblig.) Nome del gruppo
1071        			FlgDiDefaultInACLIn		IN		PLS_INTEGER DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),
1072        																	-- (valori 1/0/NULL) Se 1 è un gruppo che di default viene messo nell'ACL di oggetti della repository
1073        			DtInizioVldIn			IN		VARCHAR2 DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'DATE_VAL_NO_UPD'),
1074        																	-- Data di inizio validità (nel formato dato dal parametro di conf. FMT_STD_DATA).
1075        			DtFineVldIn				IN		VARCHAR2 DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'DATE_VAL_NO_UPD'),
1076        																	-- Data di fine validità (nel formato dato dal parametro di conf. FMT_STD_DATA).
1077        			CIProvGruppoIn			IN 		DMT_GRUPPI.PROV_CI_GRUPPO%TYPE DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
1078        																	-- Codice identificativo del gruppo nel sistema di provenienza   
1079        			FlgLockedIn				IN		PLS_INTEGER DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),
1080        																	-- (valori 1/0/NULL) Indicatore di gruppo riservato dal sistema e non modificabile/cancellabile da GUI
1081        			RowidOut				OUT		VARCHAR2,						-- Rowid del record del gruppo
1082        			FlgModMembriIn			IN		VARCHAR2 DEFAULT 'I',				-- (valori I/C) Indica se i membri del gruppo indicati nell'argomento successivo sono forniti in modo incrementale (=I) (solo quelli da aggiungere o cancellare) oppure completo (=C), vale a dire che dovranno soppiantare tutti quelli già specificati (e relativi al dominio di lavoro) in caso di gruppo da aggiornare
1083        			XMLMembriIn				IN		CLOB DEFAULT NULL,				-- Lista dei membri del gruppo da aggiornare (XML conforme a schema LISTA_STD.xsd)					
1084        																	-- Ogni membro è tag "Riga" che contiene le seguenti colonne:
1085        																	-- 1: (obblig) Indicatore del tipo di membro: 
1086        																	-- Valori ammessi:
1087        																	--	UO	=	U.O. 
1088        																	-- 	SV	=	Scrivania virtuale
1089        																	--	UT	=	Utente
1090        																	--	G	=	Gruppo di soggetti interni
1091        																	-- 2: identificativo (ID_UO o ID_SCRIVANIA o ID_USER o ID_GRUPPO) del soggetto interno
1092        																	-- 3: descrizione/denominazione del soggetto interno (ricerca case insensitive in like senza forzare il % finale)
1093        																	-- 4: (da valorizzare solo se colonna 1 = UO o SV) Stringa con i n.ri livello della UO o a cui appartiene la scrivania (tutti o alcuni; però se si specifica un livello è obbligatorio indicare tutti i livelli superiori; vanno specificati come appaiono nella GUI, ovvero romani se previsto, 0 o -- se nulli; sono separati dal separatore dei livelli valido per il soggetto produttore/AOO di appartenenza della UO)
1094        																	-- 5: (da valorizzare solo se colonna 1 = UO o SV) Denominazione della UO in cui si trova la scrivania (o suo inizio; ricerca case insensitive in like senza forzare il % finale). Può essere quella semplice o la concatenazione con separatore "|" delle denominazioni delle UO superiori + quella della UO	
1095        																	-- 6: (da valorizzare solo se colonna 1 = UO o SV) Denominazione dell'utente che occupa la scrivania (ricerca case insensitive in like senza forzare il % finale).
1096        																	-- 7: (valori 1/0/NULL; da valorizzare a 1 solo se colonna 1 = UO) Se 1 le sotto-UO sono incluse ne gruppo
1097        																	-- 8: (valori 1/0/NULL; da valorizzare a 1 solo se colonna 1 = UO) Se 1 le scrivanie della UO (e sue sotto-UO se a lro volta incluse) sono incluse nel gruppo 
1098        																	-- 9: (valori 1/0/NULL) Flag di record da eliminare
1099        			AttributiAddIn			IN		CLOB DEFAULT NULL,				-- XML contenente nomi e valori degli attributi dinamici da aggiornare (conforme allo schema SezioneCache.xsd) 
1100        																	-- Gli attributi già presenti in DB e per i quali non c'è corrispondente nell'XML restano invariati
1101        																	-- Per tutti gli attributi vale quanto segue:
1102        																	-- Un attributo da settare è un tag "Variabile" dell'XML il cui tag "Nome" contiene il nome identificativo dell'attributo (ATTR_NAME di DMT_ATTRIBUTES_DEF)
1103        																	-- Un attributo da settare è una variabile con tag "ValoreSemplice" se è un attributo a singolo valore e non strutturato (cioè con tipo diverso da COMPLEX)
1104        																	-- altrimenti è una variabile con tag "Lista" che ha un'unica colonna con "Nro" pari a 1 se l'attributo non è strutturato, che ha invece tante colonne quanti gli attributi componenti (ordinate in base al loro NRO_ORD_IN_SUP) se l'attributo è complesso 
1105        																	-- Nel caso di variabili con tag "Lista" i valori specificati nell'XML si aggiungono o sostituiscono quelli già presenti in DB a seconda che nell'XML sia presente o meno una variabile con tag "Nome" pari a #Append_<Nome attributo> e tag "ValoreSemplice" pari a 1  
1106        																	-- In particolare se non sono specificati valori nell'XML (tag Lista vuoto) e se i valori non sono da aggiungere significa che tutti i valori dell'attributo già presenti in DB vanno rimossi
1107        			FlgIgnoreWarningIn 		IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 0 o NULL significa che in presenza di WARNING la stored si comporta come in caso di errore; se 1 gli WARNING vengono ignorati
1108        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
1109        																	-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
1110        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
1111        			WarningMsgOut			OUT		VARCHAR2,						-- Messaggio di warning (valorizzato solo se non c'è errore)
1112        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
1113        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
1114        			ErrMsgOut				OUT 		VARCHAR2						-- Messaggio d'errore
1115        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine (senza warning), altrimenti 0 (in caso di errore o warning)
1116        
1117        	/*** Funzione di eliminazione (fisica) di un gruppo di soggetti inerni (UO, scrivanie, utenti)		***/	
1118        	function DGruppoSoggInt(
1119        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
1120        																	-- (obblig). Codice identificativo del token di connessione
1121        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
1122        			IdGruppoIn				IN 		DMT_GRUPPI.ID_GRUPPO%type DEFAULT NULL,	-- (obblig. se NomeGruppoIn non è valorizzato) Id. del gruppo da eliminare.
1123        			NomeGruppoIn			IN 		DMT_GRUPPI.NOME_GRUPPO%type DEFAULT NULL,	-- (obblig. se IdGruppoIn non è valorizzato) Nome del gruppo da eliminare.
1124        			MotiviIn				IN		DMT_PROCESS_TYPES.MOTIVI_ANN%type,		-- Motivi della cancellazione
1125        			FlgIgnoreWarningIn 		IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 0 o NULL significa che in presenza di WARNING la stored si comporta come in caso di errore; se 1 gli WARNING vengono ignorati
1126        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
1127        																	-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
1128        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
1129        			WarningMsgOut			OUT		VARCHAR2,						-- Messaggio di warning (valorizzato solo se non c'è errore)
1130        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
1131        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
1132        			ErrMsgOut				OUT 		VARCHAR2						-- Messaggio d'errore
1133        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine (senza warning), altrimenti 0 (in caso di errore o warning)
1134        
1135        	/********* funzione per assegnare uno o più soggetti interni omogenei (utenti, UO, scrivanie, gruppi) ad un dato gruppo di soggetti interni 							*********/
1136        	/********* se alcuni dei soggetti da assegnare sono già nel gruppo non viene dato errore, ma viene aggiornata la vecchia appartenenza con le opzioni specificate in input 		*********/
1137        	function AssegnaAGruppoSoggInt(
1138        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
1139        																	-- (obblig). Codice identificativo del token di connessione
1140        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
1141        			IdGruppoIO				IN OUT	DMT_GRUPPI.ID_GRUPPO%type,			-- (obblig se NomeGruppoIn non è valorizzato) Id. del gruppo cui assegnare membri
1142        																	-- in output, salvo in caso di errore, è sempre valorizzato
1143        			NomeGruppoIn			IN 		DMT_GRUPPI.NOME_GRUPPO%type DEFAULT NULL, -- (obblig se IdGruppoIO non è valorizzato in input) Nome del gruppo cui assegnare membri (ricerca case-insensitive in like senza forzare il % finale)
1144        			FlgTipoMembriDaAggiungereIn	IN		VARCHAR2,						-- (obblig.) Indica cosa sono i soggetti interno da assegnare al gruppo
1145        																	-- Valori ammessi:
1146        																	--	UO	=	U.O. 
1147        																	-- 	SV	=	Scrivania virtuale
1148        																	--	UT	=	Utente
1149        																	--	G	=	Gruppo di soggetti interni
1150        			MembriDaAggiungereXMLIn		IN		CLOB,							-- Lista con gli estremi dei soggetti da assegnare al gruppo (XML conforme a schema LISTA_STD.xsd)
1151        																	-- Ogni tag "Riga" rappresenta un soggetto da assegnare al gruppo e può contenere le seguenti colonne:
1152        																	-- 1: identificativo (ID_UO o ID_SCRIVANIA o ID_USER o ID_GRUPPO) del soggetto interno
1153        																	-- 2: descrizione/denominazione del soggetto interno (ricerca case insensitive in like senza forzare il % finale)
1154        																	-- 3: (da valorizzare solo se FlgTipoMembriDaAggiungereIn=UO o SV) Stringa con i n.ri livello della UO o a cui appartiene la scrivania (tutti o alcuni; però se si specifica un livello è obbligatorio indicare tutti i livelli superiori; vanno specificati come appaiono nella GUI, ovvero romani se previsto, 0 o -- se nulli; sono separati dal separatore dei livelli valido per il soggetto produttore/AOO di appartenenza della UO)
1155        																	-- 4: (da valorizzare solo se FlgTipoMembriDaAggiungereIn=SV) Denominazione della UO in cui si trova la scrivania (o suo inizio; ricerca case insensitive in like senza forzare il % finale). Può essere quella semplice o la concatenazione con separatore "|" delle denominazioni delle UO superiori + quella della UO	
1156        																	-- 5: (da valorizzare solo se FlgTipoMembriDaAggiungereIn=SV) Denominazione dell'utente che occupa la scrivania (ricerca case insensitive in like senza forzare il % finale).
1157        			FlgInclSottoUOIn			IN		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL; da valorizzare solo se FlgTipoMembriDaAggiungereIn=UO) Se 1 indica che anche le sotto-UO delle UO da assegnare al gruppo ricadranno nel gruppo
1158        			FlgInclScrivanieIn		IN		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL; da valorizzare solo se FlgTipoMembriDaAggiungereIn=UO) Se 1 indica che anche le scrivanie delle UO (e delle loro eventuali sotto-UO, se anch'esse incluse) da assegnare al gruppo ricadranno nel gruppo
1159        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
1160        																	-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
1161        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
1162        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
1163        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
1164        			ErrMsgOut				OUT 		VARCHAR2						-- Messaggio d'errore
1165        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine, altrimenti 0 (in caso di errore)
1166        
1167        	/********* funzione per assegnare un soggetto interno (utente, UO, scrivania, gruppo) ad un dato gruppo di soggetti interni o per modificare le opzioni di un'assegnazione già esistente	*********/
1168        	/********* Infatti se l''assegnazione già esiste non viene dato errore, ma viene aggiornata la vecchia assegnazione con le opzioni specificate in input 						*********/
1169        	function IUMembroGruppoSoggInt(
1170        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
1171        																	-- (obblig). Codice identificativo del token di connessione
1172        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
1173        			IdGruppoIO				IN OUT	DMT_GRUPPI.ID_GRUPPO%type,			-- (obblig se NomeGruppoIn non è valorizzato) Id. del gruppo cui assegnare il membro
1174        																	-- in output, salvo in caso di errore, è sempre valorizzato
1175        			NomeGruppoIn			IN 		DMT_GRUPPI.NOME_GRUPPO%type DEFAULT NULL, -- (obblig se IdGruppoIO non è valorizzato in input) Nome del gruppo cui assegnare il membro (ricerca case-insensitive in like senza forzare il % finale)
1176        			FlgTpObjAppartenenteIn		IN		VARCHAR2,						-- (obblig.) Indica cosa è il soggetto interno da assegnare al gruppo
1177        																	-- Valori ammessi:
1178        																	--	UO	=	U.O. 
1179        																	-- 	SV	=	Scrivania virtuale
1180        																	--	UT	=	Utente
1181        																	--	G	=	Gruppo di soggetti interni
1182        			IdObjAppartenenteIn		IN 		INTEGER DEFAULT NULL,				-- Identificativo (ID_UO o ID_SCRIVANIA o ID_USER o ID_GRUPPO) del soggetto interno da assegnare al gruppo
1183        			DesObjAppartenenteIn		IN 		VARCHAR2 DEFAULT NULL,				-- Descrizione/denominazione del soggetto interno da assegnare al gruppo (ricerca case insensitive in like senza forzare il % finale)
1184        			LivelliUOAppartenenteIn		IN 		VARCHAR2 DEFAULT NULL,				-- (da valorizzare solo se FlgTpObjAppartenenteIn=UO o SV) Stringa con i n.ri livello della UO o a cui appartiene la scrivania da assegnare al gruppo (tutti o alcuni; però se si specifica un livello è obbligatorio indicare tutti i livelli superiori; vanno specificati come appaiono nella GUI, ovvero romani se previsto, 0 o -- se nulli; sono separati dal separatore dei livelli valido per il soggetto produttore/AOO di appartenenza della UO)
1185        			DesUOAppScrivaniaToIn		IN 		VARCHAR2 DEFAULT NULL,				-- (da valorizzare solo se FlgTpObjAppartenenteIn=SV) Denominazione della UO in cui si trova la scrivania da assegnare al gruppo (o suo inizio; ricerca case insensitive in like senza forzare il % finale). Può essere quella semplice o la concatenazione con separatore "|" delle denominazioni delle UO superiori + quella della UO	
1186        			DesUserScrivaniaToIn		IN		VARCHAR2 DEFAULT NULL,				-- (da valorizzare solo se FlgTpObjAppartenenteIn=SV) Denominazione dell'utente che occupa la scrivania da assegnare al gruppo (ricerca case insensitive in like senza forzare il % finale).
1187        			FlgInclSottoUOIn			IN		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL; da valorizzare solo se FlgTpObjAppartenenteIn=UO) Se 1 indica che anche le sotto-UO della UO da assegnare al gruppo ricadranno nel gruppo
1188        			FlgInclScrivanieIn		IN		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL; da valorizzare solo se FlgTpObjAppartenenteIn=UO) Se 1 indica che anche le scrivanie della UO (e delle sue eventuali sotto-UO, se anch'esse incluse) da assegnare al gruppo ricadranno nel gruppo
1189        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
1190        																	-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
1191        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
1192        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
1193        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
1194        			ErrMsgOut				OUT 		VARCHAR2						-- Messaggio d'errore
1195        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine, altrimenti 0 (in caso di errore)
1196        
1197        	/********* funzione per togliere uno o più soggetti interni (utenti, UO, scrivanie, sotto-gruppi) da un dato gruppo di soggetti interni 							*********/
1198        	function TogliDaGruppoSoggInt(
1199        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
1200        																	-- (obblig). Codice identificativo del token di connessione
1201        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
1202        			IdGruppoIO				IN OUT	DMT_GRUPPI.ID_GRUPPO%type,			-- (obblig se NomeGruppoIn non è valorizzato) Id. del gruppo da cui togliere membri
1203        																	-- in output, salvo in caso di errore, è sempre valorizzato
1204        			NomeGruppoIn			IN 		DMT_GRUPPI.NOME_GRUPPO%type DEFAULT NULL, -- (obblig se IdGruppoIO non è valorizzato in input) Nome del gruppo da cui togliere membri (ricerca case-insensitive in like senza forzare il % finale)
1205        			MembriDaTogliereXMLIn		IN		CLOB,							-- Lista con gli estremi dei soggetti da togliere dal gruppo (XML conforme a schema LISTA_STD.xsd)
1206        																	-- Ogni tag "Riga" rappresenta un soggetto da togliere e può contenere le seguenti colonne:
1207        																	-- 1: (obblig.) Indica il tipo del soggetto membro:
1208        																	-- Valori ammessi:
1209        																	--	UO	=	U.O. 
1210        																	-- 	SV	=	Scrivania virtuale
1211        																	--	UT	=	Utente
1212        																	--	G	=	Gruppo di soggetti interni
1213        																	-- 2: Identificativo (ID_UO o ID_SCRIVANIA o ID_USER o ID_GRUPPO) del soggetto interno
1214        																	-- 3: Descrizione/denominazione del soggetto interno (ricerca case insensitive in like senza forzare il % finale)
1215        																	-- 4: (da valorizzare solo se tipo = UO o SV) Stringa con i n.ri livello della UO o a cui appartiene la scrivania (tutti o alcuni; però se si specifica un livello è obbligatorio indicare tutti i livelli superiori; vanno specificati come appaiono nella GUI, ovvero romani se previsto, 0 o -- se nulli; sono separati dal separatore dei livelli valido per il soggetto produttore/AOO di appartenenza della UO)
1216        																	-- 5: (da valorizzare solo se tipo = SV) Denominazione della UO in cui si trova la scrivania (o suo inizio; ricerca case insensitive in like senza forzare il % finale). Può essere quella semplice o la concatenazione con separatore "|" delle denominazioni delle UO superiori + quella della UO	
1217        																	-- 6: (da valorizzare solo se tipo = SV) Denominazione dell'utente che occupa la scrivania (ricerca case insensitive in like senza forzare il % finale).
1218        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
1219        																	-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
1220        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
1221        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
1222        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
1223        			ErrMsgOut				OUT 		VARCHAR2						-- Messaggio d'errore
1224        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine, altrimenti 0 (in caso di errore)
1225        
1226        	/********* funzione per togliere un singolo soggetto interno (utente, UO, scrivania, gruppo) da un dato gruppo di soggetti interni *********/
1227        	function DMembroGruppoSoggInt(
1228        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
1229        																	-- (obblig). Codice identificativo del token di connessione
1230        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
1231        			IdGruppoIO				IN OUT	DMT_GRUPPI.ID_GRUPPO%type,			-- (obblig se NomeGruppoIn non è valorizzato) Id. del gruppo da cui togliere il membro
1232        																	-- in output, salvo in caso di errore, è sempre valorizzato
1233        			NomeGruppoIn			IN 		DMT_GRUPPI.NOME_GRUPPO%type DEFAULT NULL, -- (obblig se IdGruppoIO non è valorizzato in input) Nome del gruppo da cui togliere il membro (ricerca case-insensitive in like senza forzare il % finale)
1234        			FlgTpObjAppartenenteIn		IN		VARCHAR2,						-- (obblig.) Indica cosa è il soggetto interno da togliere dal gruppo
1235        																	-- Valori ammessi:
1236        																	--	UO	=	U.O. 
1237        																	-- 	SV	=	Scrivania virtuale
1238        																	--	UT	=	Utente
1239        																	--	G	=	Gruppo di soggetti interni
1240        			IdObjAppartenenteIn		IN 		INTEGER DEFAULT NULL,				-- Identificativo (ID_UO o ID_SCRIVANIA o ID_USER o ID_GRUPPO) del soggetto interno da togliere dal gruppo
1241        			DesObjAppartenenteIn		IN 		VARCHAR2 DEFAULT NULL,				-- Descrizione/denominazione del soggetto interno da togliere dal gruppo(ricerca case insensitive in like senza forzare il % finale)
1242        			LivelliUOAppartenenteIn		IN 		VARCHAR2 DEFAULT NULL,				-- (da valorizzare solo se FlgTpObjAppartenenteIn=UO o SV) Stringa con i n.ri livello della UO o a cui appartiene la scrivania da togliere dal gruppo (tutti o alcuni; però se si specifica un livello è obbligatorio indicare tutti i livelli superiori; vanno specificati come appaiono nella GUI, ovvero romani se previsto, 0 o -- se nulli; sono separati dal separatore dei livelli valido per il soggetto produttore/AOO di appartenenza della UO)
1243        			DesUOAppScrivaniaToIn		IN 		VARCHAR2 DEFAULT NULL,				-- (da valorizzare solo se FlgTpObjAppartenenteIn=SV) Denominazione della UO in cui si trova la scrivania da togliere dal gruppo (o suo inizio; ricerca case insensitive in like senza forzare il % finale). Può essere quella semplice o la concatenazione con separatore "|" delle denominazioni delle UO superiori + quella della UO	
1244        			DesUserScrivaniaToIn		IN		VARCHAR2 DEFAULT NULL,				-- (da valorizzare solo se FlgTpObjAppartenenteIn=SV) Denominazione dell'utente che occupa la scrivania da togliere dal gruppo (ricerca case insensitive in like senza forzare il % finale).
1245        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
1246        																	-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
1247        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
1248        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
1249        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
1250        			ErrMsgOut				OUT 		VARCHAR2						-- Messaggio d'errore
1251        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine, altrimenti 0 (in caso di errore)
1252        
1253        	/****** 	serve a ricercare gli utenti del sistema (accreditati o meno nel dominio di lavoro) *******/
1254        	function TrovaUsers(
1255        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
1256        																	-- (obblig). Codice identificativo del token di connessione
1257        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
1258        			FlgPreimpostaFiltroIn		IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1 i filtri e l'ordinamento vengono settati secondo le impostazioni dell'utente di lavoro, altrimenti restano come passati in input
1259        			IdUserIO				IN OUT	DMT_USERS.USERNAME%type,			-- 1° filtro di ricerca: Identificativo interno al sistema dell'utente da trovare
1260        			UsernameIO				IN OUT	DMT_USERS.USERNAME%type,			-- 2° filtro di ricerca: Username interna al sistema (Ricerca case-insensitive in like)	
1261        			DescrizioneIO			IN OUT	DMT_USERS.DES_USER%type,			-- 3° filtro di ricerca: Descrizione dell'utente o suo inizio (ricerca case-insensitive in like)	
1262        			QualificaIO				IN OUT	DMT_USERS.QUALIFICA%type,			-- 4° filtro di ricerca: Qualifica dell'utente o suo inizio (ricerca case-insensitive in like)	
1263        			MatricolaIO				IN OUT	DMT_USERS.NRO_MATRICOLA%type,			-- 5° filtro di ricerca: N.ro di matricola dell'utente o suo inizio (ricerca case-insensitive in like)	
1264        			CIProvUserIO			IN OUT	VARCHAR2,						-- 6° filtro di ricerca: Codice che identifica l'utente in un eventuale sistema di provenienza (ricerca case-senstive esatta)
1265        			FlgAccreditatiInDomIO		IN OUT	PLS_INTEGER,					-- 7° filtro di ricerca (valori 1/0/NULL) Se 1 indica che vanno ricercati solo utenti attualmente accreditati nel dominio di lavoro a cui si è connessi, se 0 solo utenti non attualmente accreditati nel dominio medesimo
1266        			CodApplAccredIO			IN OUT	VARCHAR2,						-- 8° filtro di ricerca: Codice dell'applicazione in cui devono essere accreditati gli utenti da ricercare. Se valorizzata pari a #BY_CONN_TKN e si è connessi da un'applicazione esterna si ricercano solo utenti accreditati in quell'applicazione
1267        			CodIstApplAccredIO		IN OUT	VARCHAR2,						-- 9° filtro di ricerca: Codice dell'istanza di applicazione in cui devono essere accreditati gli utenti da ricercare. Se valorizzata pari a #BY_CONN_TKN e si è connessi da un'applicazione esterna si ricercano solo utenti accreditati nell'istanza di applicazione esterna da cui si è connessi
1268        			CodApplNoAccredIO			IN OUT	VARCHAR2,						-- 10° filtro di ricerca: Codice dell'applicazione in cui NON devono essere accreditati gli utenti da ricercare. Se valorizzata pari a #BY_CONN_TKN e si è connessi da un'applicazione esterna si ricercano solo utenti NON accreditati in quell'applicazione
1269        			CodIstApplNoAccredIO		IN OUT	VARCHAR2,						-- 11° filtro di ricerca: Codice dell'istanza di applicazione in cui NON devono essere accreditati gli utenti da ricercare. Se valorizzata pari a #BY_CONN_TKN e si è connessi da un'applicazione esterna si ricercano solo utenti NON accreditati nell'istanza di applicazione esterna da cui si è connessi
1270        			IdRuoloAmmIO			IN OUT	DMT_RUOLI_AMM.ID_RUOLO_AMM%type,		-- 12° filtro di ricerca: Id. di un ruolo amminisrativo che deve essere attualmente ricoperto dagli utenti da ricercare (anche non direttamente, ovvero ricomprendo ruoli in cui ricade quello indicato)
1271        																	-- Viene considerato e gestito solo se è valorizzato l'argomento successivo; se non congruente con questo l'id. viene ignorato
1272        			DesRuoloAmmIO			IN OUT	DMT_RUOLI_AMM.DES_RUOLO_AMM%type,		-- 13° filtro di ricerca: Descrizione di un ruolo amminisrativo che deve essere attualmente ricoperto dagli utenti da ricercare (anche non direttamente, ovvero ricomprendo ruoli in cui ricade quello indicato) 
1273        			IdUOConRelVsUserIO		IN OUT	DMT_STRUTTURA_ORG.ID_UO%type,			-- 14° filtro di ricerca: Identificativo di una UO con cui gli utenti da trovare devono essere attualmente in relazione (di appartenenza e/o a lavorare per e/o di delega) (il ruolo deve essere individuato univoacmente attraverso una ricerca case insensitive in like che non forza il % finale)
1274        																	-- Viene considerato e gestito solo se è valorizzato uno dei 2 argomenti successivo; se non congruente con questi l'id. viene ignorato
1275        			LivelliUOConRelVsUserIO		IN OUT	VARCHAR2,						-- 15° filtro di ricerca: Stringa con i n.ri livello di una UO con cui gli utenti da trovare devono essere attualmente in relazione (di appartenenza e/o a lavorare per e/o di delega)
1276        																	-- 	(tutti o solo alcuni; però se si specifica un livello è obbligatorio indicare tutti i livelli superiori; vanno indicati come appaiono nella GUI, ovvero romani se previsto, 0 o -- se nulli; vanno separati dal separatore dei livelli di UO valido per il soggetto produttore/AOO di appartenenza della UO)
1277        			DesUOConRelVsUserIO		IN OUT	VARCHAR2,						-- 16° filtro di ricerca: Denominazione di una UO con cui gli utenti da trovare devono essere attualmente in relazione (di appartenenza e/o a lavorare per e/o di delega) (ricerca case insensitive in like). Può essere quella semplice o la concatenazione con separatore "|" delle denominazioni delle UO superiori + quella della UO
1278        																	-- 	ATTENZIONE: mentre la ricerca sulla denominazione semplice intende sempre che il valore in input sia un possibile inizio (aggiunge in automatico un % finale al valore quando fa la ricerca in like), quella sulla concatenzione no (il % finale non viene aggiunto in automatico, altrimenti le UO con sotto-UO non sarebbero mai individuabili univocamente attraverso il solo filtro sulla denominazione)
1279        			FlgTipoRelConUOIO			IN OUT	VARCHAR2,						-- (valori possiili: A, L, D o una loro concatenazione con ; come separatore) Dettaglio sul tipo di realzione che gli utenti da trovare devono avere con la UO specificata negi argomenti precedenti (A = Appartenenza, L = a Lavorare per, D = Delega)				
1280        			FlgInclSottoUOIO			IN OUT	PLS_INTEGER,					-- (valori 1/0/NULL) Se 1 indica che gli utenti da trovare possono appartenere anche a sotto-UO della UO specificata negi argomenti precedenti 
1281        			IdGruppoAppIO			IN OUT	DMT_GRUPPI.ID_GRUPPO%type,			-- 17° filtro di ricerca: Id. di un gruppo a cui devono appartenere gli utenti da ricercare (anche non direttamente, ovvero perchè appartengono a gruppi ricompresi in quello indicato; però un utente non viene dato come appartenente al gruppo solo perchè nel gruppo ricade una UO o scrivania cui è collegato)
1282        																	-- Viene considerato e gestito solo se è valorizzato l'argomento successivo; se non congruente con questo l'id. viene ignorato
1283        			NomeGruppoAppIO			IN OUT	DMT_GRUPPI.NOME_GRUPPO%type,			-- 18° filtro di ricerca: Nome di un di un gruppo a cui devono appartenere gli utenti da ricercare (anche non direttamente, ovvero perchè appartengono a gruppi ricompresi in quello indicato; però un utente non viene dato come appartenente al gruppo solo perchè nel gruppo ricade una UO o scrivania cui è collegato) (il gruppo deve essere individuato univocamente attraverso una ricerca case insensitive in like che non forza il % finale)
1284        			FlgSoloVldIO 			IN OUT 	INTEGER, 						-- 19° filtro di ricerca (valori 1/0/NULL): Se 1 indica se si devono estrarre solo gli utenti validi alla data odierna
1285        			TsVldIO				IN OUT	VARCHAR2,						-- 20° filtro di ricerca: Stinga con il timestamp (nel formato GG/MM/AAAA HH24:MI:SS) a cui devono essere validi gli utenti da estrarre
1286        			FlgConAccessoAlSistemaIO	IN OUT	PLS_INTEGER,					-- 21° filtro di ricerca (valori 1/0/NULL): Se 1 si cercano solo utenti con diritto di accesso al sistema, se 0 solo quelli senza diritto di accesso
1287        			AltriCriteriIO			IN OUT 	NOCOPY CLOB,					-- Altri criteri di ricerca sugli attributi addizionali (XML conforme a schema LISTA_STD.xsd). Se più di uno vengono applicati in AND.
1288        																	-- Ogni criterio è un tag Riga che può contenere le seguenti colonne:
1289        																	--	1) Nome (ATTR_NAME) dell'attributo cui è relativo il criterio
1290        																	--	2) (obblig.) Operatore logico. Valori possibili:
1291        																	--		"uguale" (ricerca esatta) 
1292        																	--		"simile a (case-sensitive)" (ricerca case-sensitive in like)
1293        																	--		"simile a (case-insensitive)" (ricerca case-insensitive in like e che ignora i caratteri quali spazi, ., ecc)
1294        																	--		"maggiore" (se attributo numerico o data)
1295        																	--		"maggiore o uguale" (se attributo numerico o data)
1296        																	--		"minore" (se attributo numerico o data)
1297        																	--		"minore o uguale" (se attributo numerico o data)
1298        																	--		"tra" (se attributo numerico o data)
1299        																	--		"non valorizzato"
1300        																	--		"valorizzato"
1301        																	--		"spuntato" (se attributo di tipo casella di spunta)
1302        																	--		"non spuntato" (se attributo di tipo casella di spunta)
1303        																	--	3) 1° valore di confronto (obblig. e gestito solo se l'operatore non ha uno dei seguenti valori: valorizzato, non valorizzato, spuntato, non spuntato) (se l'attributo è numerico deve avere la virgola come separatore dei decimali, se è di tipo data deve essere in uno dei formato dati dai parametri di conf. FMT_STD_DATA e FMT_STD_TIMESTAMP)
1304        																	--	4) 2° valore di confronto (obblig. e gestito solo se l'operatore è "tra") (se l'attributo è numerico deve avere la virgola come separatore dei decimali, se è di tipo data deve essere in uno dei formato dati dai parametri di conf. FMT_STD_DATA e FMT_STD_TIMESTAMP)
1305        																	--	5) Label dell''attributo cui è relativo il criterio (se sotto-attributo di complesso <label del complesso> - <label del sotto-attributo>
1306        
1307        			------------- inizio argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
1308        			ColOrderByIO			IN OUT	VARCHAR2,						-- Indica il/i numeri della/e colonna dell'XML (CLOB ListaXMLOut) di output per cui ordinare i record nell'XML stesso (si può ordinare solo per le colonne da 1 a 10). Se l'ordinamento è per più colonne queste vanno separate con "," (es: 2; 2,3)
1309        																	-- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul tipo di ordinamento una qualche preimpostazione di sistema/utente ecc.
1310        																	-- se non valorizzato (neppure in output) la lista di record restituita non è ordinata
1311        			FlgDescOrderByIO  		IN OUT	VARCHAR2,						-- E' una stringa di 1 o 0/NULL, tanti quanti le colonne di ordinamento, separati da ",": 1 significa che l'ordinamento per la data colonna deve essere discendente anzichè ascendente (es: 1; 1,0; 1, )
1312        																	-- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul verso di ordinamento una qualche preimpostazione di sistema/utente ecc.			
1313        			FlgSenzaPaginazioneIn 		IN 		PLS_INTEGER DEFAULT NULL,            	-- (valori 1/0/NULL) Se 1 l'estrazione non è paginata, altrimenti sì
1314        			NroPaginaIO      			IN OUT	PLS_INTEGER,                  		-- E' il numero della pagina da estrarre; se NULL e l'estrazione è paginata viene estratta la prima pagina
1315           			BachSizeIO				IN OUT	PLS_INTEGER,					-- Indica il massimo n.ro di record da estrarre se l'estrazione non è paginata (FlgSenzaPaginazioneIn=1)  
1316        																	-- Indica la dimensione (n.ro di record) della pagina se l'estrazione è paginata (FlgSenzaPaginazioneIn 0 o NULL) e in tal caso se non è valorizzato la dimensione della pagina è quella settata per l'utente di lavoro o è pari al valore del parametro STD_PAGE_NUM_ROW del dominio di lavoro				
1317        			OverFlowLimitIn			IN		PLS_INTEGER DEFAULT NULL,			-- E' il n.ro di record soddisfacenti la ricerca superato il quale la funzione deve restituire errore di overflow
1318        			FlgSenzaTotIn			IN		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 significa che non è richiesto come output il totale dei record soddisfacenti la ricerca (se la ricerca è paginata per la prima pagina il totale viene calcolato comunque, per le successive no)
1319        			NroTotRecOut			OUT		PLS_INTEGER,					-- E' il n.ro di record complessivi trovati (valorizzato solo se FlgSenzaTotIn è 0 o NULL o se si estrae la prima pagina)
1320             			NroRecInPaginaOut 		OUT   	PLS_INTEGER,                     		-- E' il numero di record nella pagina (valorizzato solo se l'estrazione è paginata, ovvero se FlgSenzaPaginazioneIn 0 o NULL)
1321        			------------- fine argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
1322        			ListaXMLOut				OUT		NOCOPY CLOB,					-- Lista degli utenti trovati (XML conforme a schema LISTA_STD.xsd)
1323        																	-- Ogni utente è un tag Riga che contiene le seguenti colonne: 
1324        																	-- 1: Id. univoco dell'utente (ID_USER)
1325        																	-- 2: Cognome e nome / descrizione (DES_USER)
1326        																	-- 3: Username (interna al sistema)
1327        																	-- 4: N° matricola
1328        																	-- 5: Qualifica
1329        																	-- 6: Titolo
1330        																	-- 7: e-Mail
1331        																	-- 8: Inizio validità (nel formato dato dal parametro di cof. FMT_STD_DATA).
1332        																	-- 9: Fine validità (nel formato dato dal parametro di cof. FMT_STD_DATA)
1333        																	-- 10: Id. del soggetto di rubrica corrispondente all''utente
1334        																	-- 11: (valori 1/0) Flag di utente senza accesso al sistema
1335        																	-- 12: (valori 1/0) Flag di utente valido e attualmente accreditato nel dominio da cui si è connessi
1336        																	-- 13: Domini in cui è/è stato accreditato
1337        																	-- 14: (valori 1/0) Flag di utente accreditato nell'eventuale applicazione esterna da cui si è connessi
1338        																	-- 15: Cod. identificativo dell'utente nell'applicazione CodApplAccredIO e sua eventuale istanza CodIstApplAccredIO
1339        																	-- 16: Username nell'applicazione CodApplAccredIO e sua eventuale istanza CodIstApplAccredIO
1340        																	-- 17: UO di appartenenza e ruoli in esse ricoperti
1341        																	-- 18: UO per cui può lavorare e ruoli ricoperti
1342        																	-- 19: UO verso cui ha delega
1343        																	-- 20: Utenti verso cui ha delega  
1344        																	-- 21: Cod. identificativo dell'utente nel sistema di provenienza
1345        																	-- 22: Timestamp di creazione dell'utente (nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP)
1346        																	-- 23: Descrizione dell'utente di creazione dell'utente 
1347        																	-- 24: Timestamp di ultima modifica dei dati dell'utente (nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP)
1348        																	-- 25: Descrizione dell'utente di ultima modifica dei dati dell'utente 																						
1349        																	-- 26: (valori 1/0) Indicatore di utente riservato dal sistema e non modificabile da applicativo
1350        																	-- 27: (valori 1/0) Flag di utente valido 
1351        																	-- 28: (valori 1/0) Flag di utente attualmente accreditato nel dominio da cui si è connessi
1352        																	-- 29: Profilo dell'utente nel dominio cui si è collegati(decodifica)
1353        																	-- 30: Indirizzo/i dell'utente
1354        																	-- 31: Id. destinatario documenti cui è associato l'utente
1355        																	-- 32: Nome destinatario documenti cui è associato l'utente
1356        																	-- 33: Codice rapido
1357        																	-- 34: Timestamp di ultimo accesso dell'utente (nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP)
1358        																	-- 35: Cod. / Livelli della UO di appartenenza attuale nel dominio
1359        																	-- 36: Denominazione della UO di appartenenza attuale nel dominio
1360        																	-- 37: (valori 1/0) Indica se utenza bloccata per superamento n.ro tentativi errati di login
1361        																	-- 38: Dettagli sul blocco utenza (valorizzato se colonna 37 = 1)
1362        			FlgAbilInsOut	 		OUT 		PLS_INTEGER ,            			-- (valori 1/0) Se 1 si ha abilitazione a inserimento di utenti
1363        			FlgAbilUpdOut 			OUT 		PLS_INTEGER ,            			-- (valori 1/0) Se 1 si ha abilitazione a modifica di utenti
1364        			FlgAbilDelOut 			OUT 		PLS_INTEGER,            			-- (valori 1/0) Se 1 si ha abilitazione a cancellazione di utenti
1365        			FlgMostraAltriAttrOut		OUT		PLS_INTEGER,					-- (valori 1/0) Se 1 nella GUI vanno mostrati gli attributi addizionali per un nuovo utente (ce ne sono di visibile all'utente), se 0 no
1366        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
1367        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
1368        			ErrMsgOut				OUT 		VARCHAR2,						-- Messaggio d'errore
1369        			EmailIn					IN		VARCHAR2 DEFAULT NULL,				-- Filtro sull'indirizzo e-mail (ricerca case-insensitive senza forzare il % finale)
1370        			IdProfiloIn				IN		PLS_INTEGER DEFAULT NULL,			-- Filtro per profilo (id.) dell'utente
1371        			RigaTagNameIn			IN		VARCHAR2 DEFAULT NULL,				-- (opzionale) Come rinominare il tag Riga dell'XML ListaXMLOut di output
1372        			ColTagNameIn			IN		DMVA_STRING DEFAULT NULL)			-- (opzionale) Come rinominare i tag delle colonne in alternativa a Colonna Nro=.. nell'XML ListaXMLOut di output
1373        			return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine, altrimenti 0
1374        
1375        	/********* funzione per caricare i dati di dettaglio di un utente del sistema, tranne le sue abilitazioni su singoli oggetti di definizione contesto 	**********/
1376        	/********* carica anche i dati dei clienti associati all'utente DatiClientiOut																			**********/
1377        	function LoadDettUserEstesa(
1378        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
1379        																	-- (obblig). Codice identificativo del token di connessione
1380        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
1381        			IdUserIO				IN OUT	DMT_USERS.ID_USER%type,				-- (obblig se DesUserIO e UsernameIO non sono valorizzati in input) Id. dell'utente 
1382        																	-- in output, salvo in caso di errore, è sempre valorizzato
1383        			DesUserIO				IN OUT	DMT_USERS.DES_USER%type,			-- (obblig se IdUserIO e UsernameIO non sono valorizzati in input) Cognome e nome /descrizione dell'utente
1384        																	-- in output, salvo in caso di errore, è sempre valorizzato
1385        			UsernameIO				IN OUT	DMT_USERS.USERNAME%type,			-- (obblig se IdUserIO e DesUserIO non sono valorizzati in input) Username (interna al sistema) dell'utente
1386        																	-- in output, salvo in caso di errore, è sempre valorizzato
1387        			DtInizioVldOut			OUT		VARCHAR2,						-- Data di inizio validità (nel formato dato dal parametro di conf. FMT_STD_DATA).
1388        			DtFineVldOut			OUT		VARCHAR2,						-- Data di fine validità (nel formato dato dal parametro di conf. FMT_STD_DATA).
1389        			DtInizioAccredInDomOut		OUT		VARCHAR2,						-- Data di inizio accreditamento nel dominio da cui si è connessi (nel formato dato dal parametro di conf. FMT_STD_DATA).
1390        			DtFineAccredInDomOut		OUT		VARCHAR2 ,						-- Data di fine accreditamento nel dominio da cui si è connessi (nel formato dato dal parametro di conf. FMT_STD_DATA).
1391        			IdProfiloOut			OUT		DMT_PROFILI.ID_PROFILO%type ,			-- Id. del profilo di DMT_PROFILI assegnato all'utente nel dominio da cui si è connessi
1392        			NomeProfiloOut			OUT		DMT_PROFILI.NOME_PROFILO%type,		-- Nome del profilo di DMT_PROFILI assegnato all'utente nel dominio da cui si è connessi	
1393        			XMLDatiProfiloOut			OUT		NOCOPY CLOB,					-- XML (conforme a schema SezioneCache.xsd) che contiene tutti gli attributi del profilo (tranne i gruppi di provilegi) 
1394        			XMLGruppiPrivOut			OUT		NOCOPY CLOB,					-- Lista con i gruppi di privilegi assegnati (ovvero non tramite profilo) all'utente (XML conforme a schema LISTA_STD.xsd)					
1395        																				-- Ogni gruppo è un tag "Riga" che può contenere le seguenti colonne:
1396        																				-- 1: Identificativo del gruppo di privilegi
1397        																				-- 2: Nome del gruppo di privilegi 
1398        																				-- 3: Valore fisso 1: indica gruppo di privilegi assegnato
1399        			IdSoggRubricaOut			OUT		DMT_USERS.ID_USER_IN_RUBRICA%type,		-- Id. del soggetto della rubrica soggetti (ID_SOGG_RUBRICA) che rappresenta l'utente
1400        			TitoloOut				OUT		DMT_USERS.TITOLO%type,				-- Titolo (dott., ing, ecc)
1401        			QualificaOut			OUT		DMT_USERS.QUALIFICA%type,			-- Qualifica
1402        			NroMatricolaOut			OUT		DMT_USERS.NRO_MATRICOLA%type ,		-- N.ro di matricola
1403        			EmailOut				OUT		DMT_USERS.E_MAIL%type,				-- Indirizzo e-Mail
1404        			FlgSenzaAccessoAlSistemaOut	OUT		PLS_INTEGER,					-- (valori 1/0) Se 1 è un utente che on può accedere al sistema
1405        			CIProvUserOut			OUT		DMT_USERS.PROV_CI_USER%TYPE,			-- Codice identificativo dell'utente nel sistema di provenienza   
1406        			FlgLockedOut			OUT		PLS_INTEGER,					-- (valori 1/0) Indicatore di utente riservato dal sistema e non modificabile/cancellabile da GUI
1407        			RowidOut				OUT		VARCHAR2,						-- Rowid del record dell'Utente
1408        			XMLApplEstAccredOut		OUT		NOCOPY CLOB,					-- Lista con le applicazioni esterne o loro istanze in cui è accreditato l'utente (XML conforme a schema LISTA_STD.xsd)					
1409        																	-- Ogni applicazione esterna o sua stanza è un tag "Riga" che contiene le seguenti colonne:
1410        																	-- 1: Cod. applicazione esterna
1411        																	-- 2: Codice istanza applicazione
1412        																	-- 3: Descrizione applicazione esterna  
1413        																	-- 4: Codice identificativo dell'utente nell'applicazione esterna / sua istanza
1414        																	-- 5: Username dell'utente nell'applicazione esterna / sua istanza
1415        																	-- 7: Id. della UO da usare come UO di registrazione quand l'utente lavora dall'applicazione esterna
1416        																	-- 8: Nri livelli della UO da usare come UO di registrazione quand l'utente lavora dall'applicazione esterna
1417        																	-- 9: Denominazione della UO da usare come UO di registrazione quand l'utente lavora dall'applicazione esterna
1418        																	-- 10: (flag 1/0) Se 1 indica se è un applicazione che usa credenziali diverse da quelle usate da Auriga
1419        			XMLRelConUOOut			OUT		NOCOPY CLOB,			-- Lista delle relazioni con la struttura organizzativa (XML conforme a schema LISTA_STD.xsd)					
1420        																	-- Ogni relazione è un tag "Riga" che contiene le seguenti colonne:
1421        																	-- 1: Rowid che indica il record di relazione utente-UO 
1422        																	-- 2: Indicatore del tipo di relazione: 
1423        																	-- Valoripossibili:
1424        																	--	A	=	Appartenenza
1425        																	-- 	L	=	a Lavorare per
1426        																	--  D	=	delega
1427        																	-- 3: Identificativo (ID_UO) della UO
1428        																	-- 4: Denominazione della UO 
1429        																	-- 5: Stringa con i n.ri livello della UO (sono specificati come appaiono nella GUI, ovvero romani se previsto, 0 o -- se nulli; sono separati dal separatore dei livelli valido per il soggetto produttore/AOO di appartenenza della UO)
1430        																	-- 6: Data di inizio validità della relazione (nel formato dato dal parametro di config. FMT_STD_DATA). Se NULL si intende valida dall'istituzione della UO	
1431        																	-- 7: Data di fine validità della relazione (nel formato dato dal parametro di config. FMT_STD_DATA). Se NULL si intende valida illimitatamente.
1432        																	-- 8: Id. del ruolo ricoperto  
1433        																	-- 9: Descrizione del ruolo ricoperto
1434        																	-- 10: (1/0) Indica se l'utente con il dato ruolo è il primario degli utenti con lo stesso ruolo (eventualmente nella UO)
1435        																	-- 			 Diventato flag di abilitazione alla documentazione riservata assegnata/in conoscenza alla UO
1436        																	-- 11: Indicatore di relazione con scrivania (2) o senza scrivania (0 o NULL)
1437        																	-- 12: Id. della scrivania occupata dall'utente nella relazione
1438        																	-- 13: Descrizione della scrivania occupata dall'utente nella relazione 
1439        																	-- 14: (valori 1/0): Se 1 significa che la relazione è anche con tutte le sotto-UO della UO indicata (possibile solo se è una relazione "a lavorare per") 
1440        																	-- 15: (valori 1/0/NULL): Se 1 significa che la relazione è anche con tutte le scrivanie virtuali della UO indicata (e sue eventuali sotto-UO se incluse a loro volta) (possibile solo se è una relazione "a lavorare per") 
1441        																	-- 17: Esclusioni delle UO collegate al Punto di Protocollo vs cui è definita la relazione: sono le UO collegate al punto di protocollo vs le quali l'utente non deve acquisire relazione di tipo L come altrimenti accade
1442        																	-- 	   E' una lista di ID_UO separati da ;
1443        																	-- 18: (valori 1/0): Se 1 significa che la relazione è vs una UO che è un punto di protocollo 
1444        																	-- 19: Flag 1/0/NULL che indica se c'è almeno un documento o fascicolo assegnato alla scrivania (=1) o nessuno
1445        																	-- 20: (valori UO/SV) Tipo - UO o SV (=scrivania) - del destinatario a cui a cui spostare documenti e fascicoli assegnati alla scrivania
1446        																	-- 21: Id. della UO o scrivania a cui spostare documenti e fascicoli assegnati alla scrivania (in genere impostata in caso di cessazione della UO)	
1447        																	-- 22: Livelli della UO a cui spostare documenti e fascicoli assegnati alla scrivania (in genere impostata in caso di cessazione della UO)	
1448        																	-- 23: Denominazione della UO o scrivania a cui spostare documenti e fascicoli assegnati alla scrivania (in genere impostata in caso di cessazione della UO)
1449        																	-- 24: Indica lo stato dello spostamento di documenti e fascicoli dalla scrivania ad altra UO o scrivania indicata: da avviare, in corso, completato
1450        																	-- 25: Data e ora (prevista o effettiva) di inizio spostamento di documenti e fascicoli nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP
1451        																	-- 26: Data e ora di fine spostamento di documenti e fascicoli nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP
1452        																	-- 27:  N.ro di documenti ancora assegnati alla scrivania
1453        																	-- 28: Data e ora di rilevamento - nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP - del n.ro di documenti assegnati alla scrivania indicato in NroDocAssOut														
1454        																	-- 29: N.ro di fascicoli ancora assegnati alla scrivania
1455        																	-- 30: Data e ora di rilevamento - nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP - del n.ro di fascicoli assegnati alla scrivania indicato in NroDocFascOut																
1456        																	-- 31: (valori 1/0) Flag di accesso limitato alla documentazione della postazione utente
1457        																	-- 32: (valori 1/0) Flag di abilitazione a protocollare/registrare in entrata
1458        																	-- 33: (valori 1/0 Flag di abilitazione a protocollare/registrare in uscita/tra uffici
1459        																	-- 34: (valori 1/0) Flag di abilitazione ad avviare/gestire atti
1460        																	-- 35: (valori 1/0) Flag di abilitazione a visualizzare atti/proposte della U.O.
1461        																	-- 36) flag 1/0 per "avvio/gestione di tutti i tipi di atti"
1462        																	-- 37) lista degli ID tipi atti abilitati in avvio/gestione separati da ;
1463        																	-- 38) flag 1/0 per "visualizzazione di tutti i tipi di atti"
1464        																	-- 39) lista degli ID tipi atti abilitati in visualizzazione separati da ;
1465        			VisDocAssInvAUOXmlOut	OUT		CLOB ,					-- Lista delle strutture dei cui documenti e fascicoli assegnati o inviati in conoscenza l'utente ha visibilità (XML conforme a schema LISTA_STD.xsd).
1466        																	-- Ogni riga della lista contiene:
1467        																	-- 1) ID_UO della UO
1468        																	-- 2) Nri livello della UO
1469        																	-- 3) Denominazione della UO
1470        																	-- 4) (valori 1/0) flag di visibilità estesa alle sotto-UO
1471        																	-- 5) (valori 1/0) flag di visibilità estesa alle postazioni utente (anche delle sotto-UO se colonna 4 è 1)
1472        																	-- 6) (valori 1/0) flag di visibilità estesa ai documenti e fascicoli riservati
1473        			ModDocAssAUOXmlOut		OUT		CLOB,					-- Lista delle strutture dei cui documenti e fascicoli assegnati l'utente ha permesso di modifica/gestione (XML conforme a schema LISTA_STD.xsd).
1474        																	-- Ogni riga della lista contiene:
1475        																	-- 1) ID_UO della UO
1476        																	-- 2) Nri livello della UO
1477        																	-- 3) Denominazione della UO
1478        																	-- 4) (valori 1/0) flag di gestione estesa alle sotto-UO
1479        																	-- 5) (valori 1/0) flag di gestione estesa alle postazioni utente (anche delle sotto-UO se colonna 4 è 1)
1480        																	-- 6) (valori 1/0) flag di gestione estesa ai documenti e fascicoli riservati
1481        			XMLUOCaselleEmailVisbOut OUT		NOCOPY CLOB,		-- Lista con le UO sulle cui caselle collegate l'utente ha visibilità di tutte le mail (XML conforme a schema LISTA_STD.xsd)					
1482        																	-- Ogni UO è un tag "Riga" che contiene le seguenti colonne:
1483        																	-- 1: ID_UO
1484        																	-- 2: (valori 1/0): Se 1 significa che la relazione è anche con tutte le sotto-UO della UO indicata
1485        																	-- 3: Denominazione della UO
1486        																	-- 4: Stringa con i n.ri livello della UO (sono specificati come appaiono nella GUI, ovvero romani se previsto, 0 o -- se nulli; sono separati dal separatore dei livelli valido per il soggetto produttore/AOO di appartenenza della UO)
1487        			XMLDelegheOut			OUT		NOCOPY CLOB,			-- Lista delle deleghe verso UO, scrivanie e utenti (XML conforme a schema LISTA_STD.xsd)					
1488        																	-- Ogni delega è un tag "Riga" che contiene le seguenti colonne:
1489        																	-- 1: Rowid che indica il record di delega
1490        																	-- 2: Indicatore del tipo di oggetto verso cui si ha delega: 
1491        																	-- Valori ammessi:
1492        																	--	UO	=	Unità operativa
1493        																	-- 	UT	=	Utente
1494        																	--	SV	=	Scrivania
1495        																	-- 3: Identificativo (ID_UO o ID_USER o ID_SCRIVANIA) della UO/Utente/scrivania
1496        																	-- 4: Denominazione/descrizione della UO/Utente/scrivania 
1497        																	-- 5: Stringa con i n.ri livello della UO (sono specificati come appaiono nella GUI, ovvero romani se previsto, 0 o -- se nulli; sono separati dal separatore dei livelli valido per il soggetto produttore/AOO di appartenenza della UO)
1498        																	--    o con la username dell'utente
1499        																	-- 6: Data di inizio validità della delega (nel formato dato dal parametro di config. FMT_STD_DATA). Se NULL si intende valida da tempo illimitato	
1500        																	-- 7: Data di fine validità della delega (nel formato dato dal parametro di config. FMT_STD_DATA). Se NULL si intende valida illimitatamente.
1501        																	-- 8: (valori 1/0/NULL): Se 1 significa che la delega è anche verso tutte le sotto-UO della UO indicata (possibile solo per delega vs UO) 
1502        																	-- 9: (valori 1/0/NULL): Se 1 significa che la delega è anche verso tutte le scrivanie virtuali della UO indicata (e sue eventuali sotto-UO se incluse a loro volta) (possibile solo per delega vs UO) 
1503        																	-- 10: Natura/motivi della delega
1504        			XMLGruppiAppOut			OUT		NOCOPY CLOB,			-- Lista con i gruppi cui appartiene l'utente (relativi al dominio da cui si è connessi)
1505        																	-- Ogni gruppo di appartenenza è un tag "Riga" con le colonne:
1506        																	-- 1: Id. del gruppo
1507        																	-- 2: Nome del gruppo
1508        			IndirizziOut		OUT		NOCOPY CLOB,				-- Lista degli indirizzi dell'utente (XML conforme a schema LISTA_STD.xsd)
1509        																	-- Ogni indirizzo è un tag Riga che può contenere le seguenti colonne: 
1510        																	-- 1: Identificativo dell'indirizzo/luogo (rowid)
1511        																	-- 2: Codice del tipo di indirizzo/luogo 
1512        																	-- 3: Tipo di indirizzo/luogo 
1513        																	-- 4: Dettaglio del tipo
1514        																	-- 5: Cardinalità del tipo di indirizzo (basata sulla rilevanza del tipo: residenza /sede legale sono i primi)
1515        																	-- 6: Descrizione completa dell'indirizzo/luogo
1516        																	-- 7: Data di inzio validità dell'indirizzo/luogo (nel formato dato dal parametro di conf. FMT_STD_DATA)
1517        																	-- 8: Data di fine validità dell'indirizzo/luogo (nel formato dato dal parametro di conf. FMT_STD_DATA)
1518        																	-- 9: Codice identificativo toponomastico (se indirizzo censito nella toponomastica del sistema; viene considerato solo se è valorizzata anche la colonna successiva)
1519        																	-- 10: Indirizzo (senza civico) (alternativo o ridondante rispetto al campo precedente) e senza tipo toponimo se questo è separato in colonna 24 (che quindi è valorizzata)
1520        																	-- 11: N.° civico (senza eventuali appendici)
1521        																	-- 12: Interno
1522        																	-- 13: Scala
1523        																	-- 14: Piano 
1524        																	-- 15: CAP 
1525        																	-- 16: Frazione 
1526        																	-- 17: Codice ISTAT del comune italiano (viene considerato solo se è valorizzata anche la colonna successiva)
1527        																	-- 18: Nome del comune italiano o della città (se estera)
1528        																	-- 19: Codice ISTAT dello stato (viene considerato solo se è valorizzata anche la colonna successiva)
1529        																	-- 20: Nome dello stato 
1530        																	-- 21: Targa provincia
1531        																	-- 22: Zona dell'indirizzo
1532        																	-- 23: Complemento dell'indirizzo
1533        																	-- 24: Tipo toponimo (i.e. via, piazza ecc) dell'indirizzo
1534        																	-- 25: Appendici (esponente, bis/ter, colore ecc) del N.ro civico
1535        			AttributiAddOut			OUT		NOCOPY CLOB,			-- Lista degli eventuali ulteriori attributi con cui caratterizzare l'utente(XML conforme a schema LISTA_STD.xsd)
1536        																	-- Ogni attributo è un tag "Riga" che contiene le seguenti colonne:
1537        																	-- 1: N.ro (valori da 1 a n) del riquadro (fieldset) in cui mostrare l'attributo
1538        																	-- 2: Nome identificativo dell'attributo (ATTR_NAME)
1539        																	-- 3: Label del campo con cui rappresentare l'attributo 
1540        																	-- 4: Tipo di attributo. Valori: DATE, DATETIME, TEXT, TEXT-AREA, CHECK, INTEGER, EURO, DECIMAL, COMBO-BOX, LISTA
1541        																	-- 5: N.ro massimo di caratteri/cifre
1542        																	-- 6: Larghezza del campo con cui rappresentare l'attributo (size)
1543        																	-- 7: Valore dell'attributo
1544        																	-- 8: Label del riquadro (fieldset) in cui mostrare l'attributo
1545        																	-- 9: (valori 1/0) 1 indica che l'attributo è obbligatorio, 0 che è facoltativo
1546        																	-- 10: Altezza (in nro righe) del campo con cui rappresentare l'attributo (se TEXT-AREA)
1547        																	-- 11:(valori 1/0) 1 indica se l'attributo è modificabile, 0 che è in sola visualizzazione   
1548        			DatiClientiOut			OUT		NOCOPY CLOB,			-- Lista con i dati dei clienti e BA associati all'utente
1549        																	-- Ogni relazione società-cliente e suo BA è un tag "Riga" con le colonne:
1550        																	-- 1: Denominazione società cui è legato il cliente
1551        																	-- 2: Denominazione cliente
1552        																	-- 3: CF o P. IVA del cliente
1553        																	-- 4: CID del cliente
1554        																	-- 5: Gruppo di riferimento
1555        																	-- 6: ID_CLIENTE
1556        			BachSizeOut				OUT		PLS_INTEGER,			-- Indica il massimo n.ro di record per ogni pagina da mostrare nelle liste del dettaglio
1557        			FlgMostraAltriAttrOut		OUT		PLS_INTEGER,		-- (valori 1/0) Se 1 nella GUI vanno mostrati gli attributi addizionali (ce ne sono di visibile all'utente), se 0 no
1558        			ErrContextOut			OUT		VARCHAR2,				-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
1559        			ErrCodeOut				OUT		PLS_INTEGER,			-- N.ro errore di uscita
1560        			ErrMsgOut				OUT 		VARCHAR2,			-- Messaggio d'errore,
1561        			CodRapidoOut			OUT			VARCHAR2,			-- Codice rapido
1562        			CodFiscaleOut			OUT			VARCHAR2,			-- Codice fiscale
1563        			AccountDefLockedOut		OUT			PLS_INTEGER)		-- Se 1 indica che l'account è definitamente bloccato e può essere sbloccato solo da amministratore con operazioni di sblocco o reset password
1564        			return PLS_INTEGER;										-- Vale 1 se tutto è andato a buon fine, altrimenti 0
1565        
1566        	/********* funzione per caricare i dati di dettaglio di un utente del sistema, tranne le sue abilitazioni su singoli oggetti di definizione contesto 	**********/
1567        	function LoadDettUser(
1568        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
1569        																	-- (obblig). Codice identificativo del token di connessione
1570        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
1571        			IdUserIO				IN OUT	DMT_USERS.ID_USER%type,				-- (obblig se DesUserIO e UsernameIO non sono valorizzati in input) Id. dell'utente 
1572        																	-- in output, salvo in caso di errore, è sempre valorizzato
1573        			DesUserIO				IN OUT	DMT_USERS.DES_USER%type,			-- (obblig se IdUserIO e UsernameIO non sono valorizzati in input) Cognome e nome /descrizione dell'utente
1574        																	-- in output, salvo in caso di errore, è sempre valorizzato
1575        			UsernameIO				IN OUT	DMT_USERS.USERNAME%type,			-- (obblig se IdUserIO e DesUserIO non sono valorizzati in input) Username (interna al sistema) dell'utente
1576        																	-- in output, salvo in caso di errore, è sempre valorizzato
1577        			DtInizioVldOut			OUT		VARCHAR2,						-- Data di inizio validità (nel formato dato dal parametro di conf. FMT_STD_DATA).
1578        			DtFineVldOut			OUT		VARCHAR2,						-- Data di fine validità (nel formato dato dal parametro di conf. FMT_STD_DATA).
1579        			DtInizioAccredInDomOut		OUT		VARCHAR2,						-- Data di inizio accreditamento nel dominio da cui si è connessi (nel formato dato dal parametro di conf. FMT_STD_DATA).
1580        			DtFineAccredInDomOut		OUT		VARCHAR2 ,						-- Data di fine accreditamento nel dominio da cui si è connessi (nel formato dato dal parametro di conf. FMT_STD_DATA).
1581        			IdProfiloOut			OUT		DMT_PROFILI.ID_PROFILO%type ,			-- Id. del profilo di DMT_PROFILI assegnato all'utente nel dominio da cui si è connessi
1582        			NomeProfiloOut			OUT		DMT_PROFILI.NOME_PROFILO%type,		-- Nome del profilo di DMT_PROFILI assegnato all'utente nel dominio da cui si è connessi	
1583        			XMLDatiProfiloOut			OUT		NOCOPY CLOB,					-- XML (conforme a schema SezioneCache.xsd) che contiene tutti gli attributi del profilo (tranne i gruppi di provilegi) 
1584        			XMLGruppiPrivOut			OUT		NOCOPY CLOB,					-- Lista con i gruppi di privilegi assegnati o assegnabili (ovvero non tramite profilo) all'utente (XML conforme a schema LISTA_STD.xsd)					
1585        																				-- Ogni gruppo è un tag "Riga" che può contenere le seguenti colonne:
1586        																				-- 1: Identificativo del gruppo di privilegi
1587        																				-- 2: Nome del gruppo di privilegi 
1588        																				-- 3: (flag 1/0) Se 1 indica gruppo di privilegi assegnato, se 0 "da assegnare"
1589        			IdSoggRubricaOut			OUT		DMT_USERS.ID_USER_IN_RUBRICA%type,		-- Id. del soggetto della rubrica soggetti (ID_SOGG_RUBRICA) che rappresenta l'utente
1590        			TitoloOut				OUT		DMT_USERS.TITOLO%type,				-- Titolo (dott., ing, ecc)
1591        			QualificaOut			OUT		DMT_USERS.QUALIFICA%type,			-- Qualifica
1592        			NroMatricolaOut			OUT		DMT_USERS.NRO_MATRICOLA%type ,		-- N.ro di matricola
1593        			EmailOut				OUT		DMT_USERS.E_MAIL%type,				-- Indirizzo e-Mail
1594        			FlgSenzaAccessoAlSistemaOut	OUT		PLS_INTEGER,					-- (valori 1/0) Se 1 è un utente che on può accedere al sistema
1595        			CIProvUserOut			OUT		DMT_USERS.PROV_CI_USER%TYPE,			-- Codice identificativo dell'utente nel sistema di provenienza   
1596        			FlgLockedOut			OUT		PLS_INTEGER,					-- (valori 1/0) Indicatore di utente riservato dal sistema e non modificabile/cancellabile da GUI
1597        			RowidOut				OUT		VARCHAR2,						-- Rowid del record dell'Utente
1598        			XMLApplEstAccredOut		OUT		NOCOPY CLOB,					-- Lista con le applicazioni esterne o loro istanze in cui è accreditato l'utente (XML conforme a schema LISTA_STD.xsd)					
1599        																	-- Ogni applicazione esterna o sua stanza è un tag "Riga" che contiene le seguenti colonne:
1600        																	-- 1: Cod. applicazione esterna
1601        																	-- 2: Codice istanza applicazione
1602        																	-- 3: Descrizione applicazione esterna  
1603        																	-- 4: Codice identificativo dell'utente nell'applicazione esterna / sua istanza
1604        																	-- 5: Username dell'utente nell'applicazione esterna / sua istanza
1605        																	-- 7: Id. della UO da usare come UO di registrazione quand l'utente lavora dall'applicazione esterna
1606        																	-- 8: Nri livelli della UO da usare come UO di registrazione quand l'utente lavora dall'applicazione esterna
1607        																	-- 9: Denominazione della UO da usare come UO di registrazione quand l'utente lavora dall'applicazione esterna
1608        																	-- 10: (flag 1/0) Se 1 indica se è un applicazione che usa credenziali diverse da quelle usate da Auriga
1609        			XMLRelConUOOut			OUT		NOCOPY CLOB,			-- Lista delle relazioni con la struttura organizzativa (XML conforme a schema LISTA_STD.xsd)					
1610        																	-- Ogni relazione è un tag "Riga" che contiene le seguenti colonne:
1611        																	-- 1: Rowid che indica il record di relazione utente-UO 
1612        																	-- 2: Indicatore del tipo di relazione: 
1613        																	-- Valoripossibili:
1614        																	--	A	=	Appartenenza
1615        																	-- 	L	=	a Lavorare per
1616        																	--  D	=	delega
1617        																	-- 3: Identificativo (ID_UO) della UO
1618        																	-- 4: Denominazione della UO 
1619        																	-- 5: Stringa con i n.ri livello della UO (sono specificati come appaiono nella GUI, ovvero romani se previsto, 0 o -- se nulli; sono separati dal separatore dei livelli valido per il soggetto produttore/AOO di appartenenza della UO)
1620        																	-- 6: Data di inizio validità della relazione (nel formato dato dal parametro di config. FMT_STD_DATA). Se NULL si intende valida dall'istituzione della UO	
1621        																	-- 7: Data di fine validità della relazione (nel formato dato dal parametro di config. FMT_STD_DATA). Se NULL si intende valida illimitatamente.
1622        																	-- 8: Id. del ruolo ricoperto  
1623        																	-- 9: Descrizione del ruolo ricoperto
1624        																	-- 10: (1/0) Indica se l'utente con il dato ruolo è il primario degli utenti con lo stesso ruolo (eventualmente nella UO)
1625        																	-- 			 Diventato flag di abilitazione alla documentazione riservata assegnata/in conoscenza alla UO
1626        																	-- 11: Indicatore di relazione con scrivania (2) o senza scrivania (0 o NULL)
1627        																	-- 12: Id. della scrivania occupata dall'utente nella relazione
1628        																	-- 13: Descrizione della scrivania occupata dall'utente nella relazione 
1629        																	-- 14: (valori 1/0): Se 1 significa che la relazione è anche con tutte le sotto-UO della UO indicata (possibile solo se è una relazione "a lavorare per") 
1630        																	-- 15: (valori 1/0/NULL): Se 1 significa che la relazione è anche con tutte le scrivanie virtuali della UO indicata (e sue eventuali sotto-UO se incluse a loro volta) (possibile solo se è una relazione "a lavorare per") 
1631        																	-- 17: Esclusioni delle UO collegate al Punto di Protocollo vs cui è definita la relazione: sono le UO collegate al punto di protocollo vs le quali l'utente non deve acquisire relazione di tipo L come altrimenti accade
1632        																	-- 	   E' una lista di ID_UO separati da ;
1633        																	-- 18: (valori 1/0): Se 1 significa che la relazione è vs una UO che è un punto di protocollo 
1634        																	-- 19: Flag 1/0/NULL che indica se c'è almeno un documento o fascicolo assegnato alla scrivania (=1) o nessuno
1635        																	-- 20: (valori UO/SV) Tipo - UO o SV (=scrivania) - del destinatario a cui a cui spostare documenti e fascicoli assegnati alla scrivania
1636        																	-- 21: Id. della UO o scrivania a cui spostare documenti e fascicoli assegnati alla scrivania (in genere impostata in caso di cessazione della UO)	
1637        																	-- 22: Livelli della UO a cui spostare documenti e fascicoli assegnati alla scrivania (in genere impostata in caso di cessazione della UO)	
1638        																	-- 23: Denominazione della UO o scrivania a cui spostare documenti e fascicoli assegnati alla scrivania (in genere impostata in caso di cessazione della UO)
1639        																	-- 24: Indica lo stato dello spostamento di documenti e fascicoli dalla scrivania ad altra UO o scrivania indicata: da avviare, in corso, completato
1640        																	-- 25: Data e ora (prevista o effettiva) di inizio spostamento di documenti e fascicoli nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP
1641        																	-- 26: Data e ora di fine spostamento di documenti e fascicoli nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP
1642        																	-- 27:  N.ro di documenti ancora assegnati alla scrivania
1643        																	-- 28: Data e ora di rilevamento - nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP - del n.ro di documenti assegnati alla scrivania indicato in NroDocAssOut														
1644        																	-- 29: N.ro di fascicoli ancora assegnati alla scrivania
1645        																	-- 30: Data e ora di rilevamento - nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP - del n.ro di fascicoli assegnati alla scrivania indicato in NroDocFascOut																
1646        																	-- 31: (valori 1/0) Flag di accesso limitato alla documentazione della postazione utente
1647        																	-- 32: (valori 1/0) Flag di abilitazione a protocollare/registrare in entrata
1648        																	-- 33: (valori 1/0 Flag di abilitazione a protocollare/registrare in uscita/tra uffici
1649        																	-- 34: (valori 1/0) Flag di abilitazione ad avviare/gestire atti
1650        																	-- 35: (valori 1/0) Flag di abilitazione a visualizzare atti/proposte della U.O.
1651        																	-- 36) flag 1/0 per "avvio/gestione di tutti i tipi di atti"
1652        																	-- 37) lista degli ID tipi atti abilitati in avvio/gestione separati da ;
1653        																	-- 38) flag 1/0 per "visualizzazione di tutti i tipi di atti"
1654        																	-- 39) lista degli ID tipi atti abilitati in visualizzazione separati da ;
1655        			VisDocAssInvAUOXmlOut	OUT		CLOB ,					-- Lista delle strutture dei cui documenti e fascicoli assegnati o inviati in conoscenza l'utente ha visibilità (XML conforme a schema LISTA_STD.xsd).
1656        																	-- Ogni riga della lista contiene:
1657        																	-- 1) ID_UO della UO
1658        																	-- 2) Nri livello della UO
1659        																	-- 3) Denominazione della UO
1660        																	-- 4) (valori 1/0) flag di visibilità estesa alle sotto-UO
1661        																	-- 5) (valori 1/0) flag di visibilità estesa alle postazioni utente (anche delle sotto-UO se colonna 4 è 1)
1662        																	-- 6) (valori 1/0) flag di visibilità estesa ai documenti e fascicoli riservati
1663        			ModDocAssAUOXmlOut		OUT		CLOB,					-- Lista delle strutture dei cui documenti e fascicoli assegnati l'utente ha permesso di modifica/gestione (XML conforme a schema LISTA_STD.xsd).
1664        																	-- Ogni riga della lista contiene:
1665        																	-- 1) ID_UO della UO
1666        																	-- 2) Nri livello della UO
1667        																	-- 3) Denominazione della UO
1668        																	-- 4) (valori 1/0) flag di gestione estesa alle sotto-UO
1669        																	-- 5) (valori 1/0) flag di gestione estesa alle postazioni utente (anche delle sotto-UO se colonna 4 è 1)
1670        																	-- 6) (valori 1/0) flag di gestione estesa ai documenti e fascicoli riservati
1671        			XMLUOCaselleEmailVisbOut OUT		NOCOPY CLOB,		-- Lista con le UO sulle cui caselle collegate l'utente ha visibilità di tutte le mail (XML conforme a schema LISTA_STD.xsd)					
1672        																	-- Ogni UO è un tag "Riga" che contiene le seguenti colonne:
1673        																	-- 1: ID_UO
1674        																	-- 2: (valori 1/0): Se 1 significa che la relazione è anche con tutte le sotto-UO della UO indicata
1675        																	-- 3: Denominazione della UO
1676        																	-- 4: Stringa con i n.ri livello della UO (sono specificati come appaiono nella GUI, ovvero romani se previsto, 0 o -- se nulli; sono separati dal separatore dei livelli valido per il soggetto produttore/AOO di appartenenza della UO)
1677        			XMLDelegheOut			OUT		NOCOPY CLOB,			-- Lista delle deleghe verso UO, scrivanie e utenti (XML conforme a schema LISTA_STD.xsd)					
1678        																	-- Ogni delega è un tag "Riga" che contiene le seguenti colonne:
1679        																	-- 1: Rowid che indica il record di delega
1680        																	-- 2: Indicatore del tipo di oggetto verso cui si ha delega: 
1681        																	-- Valori ammessi:
1682        																	--	UO	=	Unità operativa
1683        																	-- 	UT	=	Utente
1684        																	--	SV	=	Scrivania
1685        																	-- 3: Identificativo (ID_UO o ID_USER o ID_SCRIVANIA) della UO/Utente/scrivania
1686        																	-- 4: Denominazione/descrizione della UO/Utente/scrivania 
1687        																	-- 5: Stringa con i n.ri livello della UO (sono specificati come appaiono nella GUI, ovvero romani se previsto, 0 o -- se nulli; sono separati dal separatore dei livelli valido per il soggetto produttore/AOO di appartenenza della UO)
1688        																	--    o con la username dell'utente
1689        																	-- 6: Data di inizio validità della delega (nel formato dato dal parametro di config. FMT_STD_DATA). Se NULL si intende valida da tempo illimitato	
1690        																	-- 7: Data di fine validità della delega (nel formato dato dal parametro di config. FMT_STD_DATA). Se NULL si intende valida illimitatamente.
1691        																	-- 8: (valori 1/0/NULL): Se 1 significa che la delega è anche verso tutte le sotto-UO della UO indicata (possibile solo per delega vs UO) 
1692        																	-- 9: (valori 1/0/NULL): Se 1 significa che la delega è anche verso tutte le scrivanie virtuali della UO indicata (e sue eventuali sotto-UO se incluse a loro volta) (possibile solo per delega vs UO) 
1693        																	-- 10: Natura/motivi della delega
1694        			XMLGruppiAppOut			OUT		NOCOPY CLOB,			-- Lista con i gruppi cui appartiene l'utente (relativi al dominio da cui si è connessi)
1695        																	-- Ogni gruppo di appartenenza è un tag "Riga" con le colonne:
1696        																	-- 1: Id. del gruppo
1697        																	-- 2: Nome del gruppo
1698        			IndirizziOut		OUT		NOCOPY CLOB,				-- Lista degli indirizzi dell'utente (XML conforme a schema LISTA_STD.xsd)
1699        																	-- Ogni indirizzo è un tag Riga che può contenere le seguenti colonne: 
1700        																	-- 1: Identificativo dell'indirizzo/luogo (rowid)
1701        																	-- 2: Codice del tipo di indirizzo/luogo 
1702        																	-- 3: Tipo di indirizzo/luogo 
1703        																	-- 4: Dettaglio del tipo
1704        																	-- 5: Cardinalità del tipo di indirizzo (basata sulla rilevanza del tipo: residenza /sede legale sono i primi)
1705        																	-- 6: Descrizione completa dell'indirizzo/luogo
1706        																	-- 7: Data di inzio validità dell'indirizzo/luogo (nel formato dato dal parametro di conf. FMT_STD_DATA)
1707        																	-- 8: Data di fine validità dell'indirizzo/luogo (nel formato dato dal parametro di conf. FMT_STD_DATA)
1708        																	-- 9: Codice identificativo toponomastico (se indirizzo censito nella toponomastica del sistema; viene considerato solo se è valorizzata anche la colonna successiva)
1709        																	-- 10: Indirizzo (senza civico) (alternativo o ridondante rispetto al campo precedente) e senza tipo toponimo se questo è separato in colonna 24 (che quindi è valorizzata)
1710        																	-- 11: N.° civico (senza eventuali appendici)
1711        																	-- 12: Interno
1712        																	-- 13: Scala
1713        																	-- 14: Piano 
1714        																	-- 15: CAP 
1715        																	-- 16: Frazione 
1716        																	-- 17: Codice ISTAT del comune italiano (viene considerato solo se è valorizzata anche la colonna successiva)
1717        																	-- 18: Nome del comune italiano o della città (se estera)
1718        																	-- 19: Codice ISTAT dello stato (viene considerato solo se è valorizzata anche la colonna successiva)
1719        																	-- 20: Nome dello stato 
1720        																	-- 21: Targa provincia
1721        																	-- 22: Zona dell'indirizzo
1722        																	-- 23: Complemento dell'indirizzo
1723        																	-- 24: Tipo toponimo (i.e. via, piazza ecc) dell'indirizzo
1724        																	-- 25: Appendici (esponente, bis/ter, colore ecc) del N.ro civico
1725        			AttributiAddOut			OUT		NOCOPY CLOB,			-- Lista degli eventuali ulteriori attributi con cui caratterizzare l'utente(XML conforme a schema LISTA_STD.xsd)
1726        																	-- Ogni attributo è un tag "Riga" che contiene le seguenti colonne:
1727        																	-- 1: N.ro (valori da 1 a n) del riquadro (fieldset) in cui mostrare l'attributo
1728        																	-- 2: Nome identificativo dell'attributo (ATTR_NAME)
1729        																	-- 3: Label del campo con cui rappresentare l'attributo 
1730        																	-- 4: Tipo di attributo. Valori: DATE, DATETIME, TEXT, TEXT-AREA, CHECK, INTEGER, EURO, DECIMAL, COMBO-BOX, LISTA
1731        																	-- 5: N.ro massimo di caratteri/cifre
1732        																	-- 6: Larghezza del campo con cui rappresentare l'attributo (size)
1733        																	-- 7: Valore dell'attributo
1734        																	-- 8: Label del riquadro (fieldset) in cui mostrare l'attributo
1735        																	-- 9: (valori 1/0) 1 indica che l'attributo è obbligatorio, 0 che è facoltativo
1736        																	-- 10: Altezza (in nro righe) del campo con cui rappresentare l'attributo (se TEXT-AREA)
1737        																	-- 11:(valori 1/0) 1 indica se l'attributo è modificabile, 0 che è in sola visualizzazione   
1738        			BachSizeOut				OUT			PLS_INTEGER,		-- Indica il massimo n.ro di record per ogni pagina da mostrare nelle liste del dettaglio
1739        			FlgMostraAltriAttrOut	OUT			PLS_INTEGER,		-- (valori 1/0) Se 1 nella GUI vanno mostrati gli attributi addizionali (ce ne sono di visibile all'utente), se 0 no
1740        			ErrContextOut			OUT			VARCHAR2,			--Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
1741        			ErrCodeOut				OUT			PLS_INTEGER,		-- N.ro errore di uscita
1742        			ErrMsgOut				OUT 		VARCHAR2,			-- Messaggio d'errore,
1743        			CodRapidoOut			OUT			VARCHAR2,			-- Codice rapido
1744        			CodFiscaleOut			OUT			VARCHAR2,			-- Codice fiscale
1745        			AccountDefLockedOut		OUT			PLS_INTEGER)		-- Se 1 indica che l'account è definitamente bloccato e può essere sbloccato solo da amministratore con operazioni di sblocco o reset password
1746        			return PLS_INTEGER;										-- Vale 1 se tutto è andato a buon fine, altrimenti 0
1747        
1748        	/*** Funzione di creazione/aggiornamento di un utente del sistema									***/	
1749        	/*** prevede la gestione di: accreditamento e profilatura nel dominio da cui si è connessi				***/
1750        	/*** 				     applicazioni esterne in cui è accreditato								***/	
1751        	/***				     sue relazioni con la struttura organizzativa; 							***/
1752        	/***				     deleghe verso altri utenti o scrivanie;								***/
1753        	/***				     gruppi di appartenenza											***/
1754        	/*** Non prevede la gestione dei privilegi su singoli oggetti di definizione del contesto					***/
1755        	function IUUser(
1756        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
1757        																	-- (obblig). Codice identificativo del token di connessione
1758        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
1759        			IdUserIO				IN OUT	DMT_USERS.ID_USER%type,				-- Id. dell'utente da modificare. Se NULL si intende che l'utente è da creare ex-novo
1760        																	-- in output, salvo in caso di errore, è sempre valorizzato
1761        			DesUserIn				IN 		DMT_USERS.DES_USER%type DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
1762        																	-- (obblig.) Cognome e nome dell'utente (prima cognome e poi nome, separati da |)
1763        			UsernameIn				IN		DMT_USERS.USERNAME%type DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
1764        																	-- (obblig.) Username (interna al sistema) dell'utente
1765        			PasswordIn				IN		DMT_USERS.PASSWORD%type DEFAULT NULL,	-- (viene gestita solo se l'utente è da creare) Password (interna al sistema) dell'utente
1766        			ConfermaPasswordIn		IN		DMT_USERS.PASSWORD%type DEFAULT NULL,	-- (viene gestita solo se l'utente è da creare) Conferma della password 
1767        			DtInizioVldIn			IN		VARCHAR2 DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'DATE_VAL_NO_UPD'),
1768        																	-- Data di inizio validità (nel formato dato dal parametro di conf. FMT_STD_DATA).
1769        			DtFineVldIn				IN		VARCHAR2 DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'DATE_VAL_NO_UPD'),
1770        																	-- Data di fine validità (nel formato dato dal parametro di conf. FMT_STD_DATA).
1771        			DtInizioAccredInDomIn		IN		VARCHAR2 DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'DATE_VAL_NO_UPD'),
1772        																	-- Data di inizio accreditamento nel dominio da cui si è connessi (nel formato dato dal parametro di conf. FMT_STD_DATA).
1773        																	-- Se l'utente è da creare o comunque non è ancora accreditato nel dominio vi viene accreditato con decorrenza dalla data qui specificata
1774        			DtFineAccredInDomIn		IN		VARCHAR2 DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'DATE_VAL_NO_UPD'),
1775        																	-- Data di fine accreditamento nel dominio da cui si è connessi (nel formato dato dal parametro di conf. FMT_STD_DATA).
1776        																	-- Se l'utente è da creare o comunque non è ancora accreditato nel dominio vi viene accreditato con termine fino alla data qui specificata
1777        			IdProfiloIn				IN		DMT_PROFILI.ID_PROFILO%type DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),
1778        																	-- Id. del profilo di DMT_PROFILI (uno di quelli che hanno un nome) da assegnare all'utente nel dominio da cui si è connessi
1779        			NomeProfiloIn			IN		DMT_PROFILI.NOME_PROFILO%type DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
1780        																	-- Nome del profilo di DMT_PROFILI da assegnare all'utente nel dominio da cui si è connessi (ricerca case-insensitive in like)	
1781        			XMLDatiProfiloIn			IN		CLOB DEFAULT NULL,				-- XML (conforme a schema SezioneCache.xsd) che contiene tutti gli attributi del profilo (tranne i gruppi di provilegi) da settare/aggiornare
1782        																	-- ATTENZIONE: Si intende che gli attributi corrispondenti a tag non presenti restino invariati
1783        																	-- Nell'XML possono esserci tag corrispondenti ad attributi di profilatura solo se non si è specificato un profilo predefinito con i due argomenti IdProfiloIn e/o NomeProfiloIn
1784        			FlgModGruppiPrivIn		IN		VARCHAR2 DEFAULT 'I',				-- (valori I/C) Indica se i gruppi di privilegi indicati nell'argomento successivo sono forniti in modo incrementale (=I) (solo quelle da inserire/cancellare) oppure completo (=C), vale a dire che dovranno soppiantare tutti quelli già associati al soggetto di cui aggiornare la profilatura
1785        			XMLGruppiPrivIn			IN		CLOB DEFAULT NULL,				-- Lista con i gruppi di privilegi assegnati/da assegnare direttamente (ovvero non tramite profilo) all'utente (XML conforme a schema LISTA_STD.xsd)					
1786        																	-- Ogni gruppo è un tag "Riga" che può contenere le seguenti colonne:
1787        																	-- 1: Identificativo del gruppo di privilegi
1788        																	-- 2: Nome del gruppo di privilegi (ricerca case insesnsitive in like)
1789        																	-- 3: (valori 1/0/NULL) Flag di gruppo da eliminare
1790        			IdSoggRubricaIn			IN		DMT_USERS.ID_USER_IN_RUBRICA%type DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),
1791        																	-- Id. del soggetto della rubrica soggetti (ID_SOGG_RUBRICA) che rappresenta l'utente
1792        			TitoloIn				IN		DMT_USERS.TITOLO%type DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
1793        																	-- Titolo (dott., ing, ecc)
1794        			QualificaIn				IN		DMT_USERS.QUALIFICA%type DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
1795        																	-- Qualifica
1796        			NroMatricolaIn			IN		DMT_USERS.NRO_MATRICOLA%type DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
1797        																	-- N.ro di matricola
1798        			EmailIn				IN		DMT_USERS.E_MAIL%type DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
1799        																	-- Indirizzo e-Mail
1800        			FlgSenzaAccessoAlSistemaIn	IN		PLS_INTEGER DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),
1801        																	-- (valori 1/0/NULL) Se 1 è un utente che on può accedere al sistema
1802        			CIProvUserIn			IN 		DMT_USERS.PROV_CI_USER%TYPE DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
1803        																	-- Codice identificativo dell'utente nel sistema di provenienza   
1804        			FlgLockedIn				IN		PLS_INTEGER DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),
1805        																	-- (valori 1/0/NULL) Indicatore di utente riservato dal sistema e non modificabile/cancellabile da GUI
1806        			FlgModApplEstAccredIn		IN		VARCHAR2 DEFAULT 'I',				-- (valori I/C) Indica se le applicazioni esterne o loro istanze in cui è accreditato l'utente e che sono indicate nell'argomento successivo sono fornite in modo incrementale (=I) (solo quelle da aggiungere o cancellare) oppure completo (=C), vale a dire che dovranno soppiantare tutti quelle già specificate (e relative al dominio da cui si è connessi) in caso di utente da aggiornare
1807        			XMLApplEstAccredIn		IN		CLOB DEFAULT NULL,				-- Lista con le applicazioni esterne o loro istanze in cui è accreditato l'utente (XML conforme a schema LISTA_STD.xsd)					
1808        																	-- Ogni applicazione esterna o sua stanza è un tag "Riga" che contiene le seguenti colonne:
1809        																	-- 1: Cod. applicazione esterna
1810        																	-- 2: Codice istanza applicazione
1811        																	-- 3: Codice identificativo dell'utente nell'applicazione esterna / sua istanza
1812        																	-- 4: Username dell'utente nell'applicazione esterna / sua istanza
1813        																	-- 5: Password dell'utente nell'applicazione esterna / sua istanza
1814        																	-- 6: (valori 1/0) Flag di record da eliminare
1815        																	-- 7: Id. della UO da usare come UO di registrazione quand l'utente lavora dall'applicazione esterna
1816        																	-- ATTENZIONE: a prescindere dal contenuto della lista l'utente viene comunque accreditato nell'applicazione esterna e sua istanza da cui si è connessi qualora non lo sia già
1817        			FlgModRelConUOIn			IN		VARCHAR2 DEFAULT 'I',		-- (valori I/C) Indica se le relazioni (solo di appartenenza o a lavorare per) con la struttura organizzativa indicate nell'argomento successivo sono fornite in modo incrementale (=I) (solo quelle da aggiungere o cancellare) oppure completo (=C), vale a dire che dovranno soppiantare tutte quelle già specificate (e relativi alla struttura organizzativa del dominio di lavoro) in caso di utente da aggiornare
1818        			XMLRelConUOIn			IN		CLOB DEFAULT NULL,		-- Lista delle relazioni con la struttura organizzativa da aggiornare (XML conforme a schema LISTA_STD.xsd)					
1819        																	-- Ogni relazione è un tag "Riga" che contiene le seguenti colonne:
1820        																	-- 1: Rowid che indica il record di relazione utente-UO da aggiornare/eliminare
1821        																	-- 2: Indicatore del tipo di relazione:
1822        																	-- Valori ammessi:
1823        																	-- 		A = appartenenza gerarchica
1824        																	-- 		D = funzionale, ovvero "delega" 
1825        																	-- 		L = a gestire documentazione della UO anche se quest'ultima è cessata
1826        																	-- 3: Identificativo (ID_UO) della UO
1827        																	-- 4: Denominazione della UO (o suo inizio; ricerca case insensitive in like senza forzare il % finale). Può essere quella semplice o la concatenazione con separatore "|" delle denominazioni delle UO superiori + quella della UO
1828        																	-- 5: Stringa con i n.ri livello della UO (tutti o alcuni; però se si specifica un livello è obbligatorio indicare tutti i livelli superiori; vanno specificati come appaiono nella GUI, ovvero romani se previsto, 0 o -- se nulli; sono separati dal separatore dei livelli valido per il soggetto produttore/AOO di appartenenza della UO)
1829        																	-- 6: Data di inizio validità della relazione (nel formato dato dal parametro di config. FMT_STD_DATA). Se NULL si intende valida dall'istituzione della UO
1830        																	-- 7: Data di fine validità della relazione (nel formato dato dal parametro di config. FMT_STD_DATA). Se NULL si intende valida illimitatamente.
1831        																	-- 8: Id. del ruolo ricoperto
1832        																	-- 9: Descrizione del ruolo ricoperto (ricerca case-insensitive in like senza forzare % finale)
1833        																	-- 10: (1/0/NULL) Indica se l'utente con il dato ruolo è il primario degli utenti con lo stesso ruolo (eventualmente nella UO)
1834        																	-- 			 Diventato flag di abilitazione alla documentazione riservata assegnata/in conoscenza alla UO
1835        																	-- 11: Indicatore di relazione: con scrivania da creare ex-novo (1), con scrivania scelta tra una disponibile di quelle già esistenti (2), senza scrivania (0 o NULL)
1836        																	-- 12: Id. della scrivania già esistente occupata dall'utente nella relazione (viene considerato solo se la colonna precedente è 2 e la successiva è valorizzata)
1837        																	-- 13: Descrizione della scrivania occupata dall'utente nella relazione (se la colonna 10 vale 2 la ricerca della scrivania è case insensitive in like senza forzare % finale; se la colonna 10 vale 1 è la descrizione da dare alla nuova scrivania in luogo di quella che le verrebbe data in automatico)
1838        																	-- 14: (valori 1/0/NULL): Se 1 significa che la relazione è anche con tutte le sotto-UO della UO indicata (possibile solo se è una relazione "a lavorare per")
1839        																	-- 15: (valori 1/0/NULL): Se 1 significa che la relazione è anche con tutte le scrivanie virtuali della UO indicata (e sue eventuali sotto-UO se incluse a loro volta) (possibile solo se è una relazione "a lavorare per")
1840        																	-- 16: (valori 1/0/NULL) Flag di record da eliminare
1841        																	-- 17: Esclusioni delle UO collegate al Punto di Protocollo vs cui è definita la relazione: sono le UO collegate al punto di protocollo vs le quali l'utente non deve acquisire relazione di tipo L come altrimenti accade
1842        																	-- 	   E' una lista di ID_UO separati da ;
1843        																	-- 18: (valori UO/SV) Tipo - UO o SV (=scrivania) - del destinatario a cui a cui spostare documenti e fascicoli assegnati alla scrivania
1844        																	-- 19: Id. della UO o scrivania a cui spostare documenti e fascicoli assegnati alla scrivania (in genere impostata in caso di cessazione della scrivania)	
1845        																	-- 20: (valori 1/0/NULL) Flag di accesso limitato alla documentazione della postazione utente
1846        																	-- 21: (valori 1/0/NULL) Flag di abilitazione a protocollare/registrare in entrata
1847        																	-- 22: (valori 1/0/NULL) Flag di abilitazione a protocollare/registrare in uscita/tra uffici
1848        																	-- 23: (valori 1/0/NULL) Flag di abilitazione ad avviare/gestire atti
1849        																	-- 24: (valori 1/0/NULL) Flag di abilitazione a visualizzare atti/proposte della U.O.
1850        																	-- 36) flag 1/0 per "avvio/gestione di tutti i tipi di atti"
1851        																	-- 37) lista degli ID tipi atti abilitati in avvio/gestione separati da ;
1852        																	-- 38) flag 1/0 per "visualizzazione di tutti i tipi di atti"
1853        																	-- 39) lista degli ID tipi atti abilitati in visualizzazione separati da ;
1854        			FlgModUOVisDocAssInvIn	IN		VARCHAR2 DEFAULT 'I',	-- (valori I/C) Indica se le UO indicate nell'argomento successivo sono fornite in modo incrementale (=I) (solo quelle da aggiungere o cancellare) oppure completo (=C), vale a dire che dovranno soppiantare tutte quelle già specificate (e relative alla struttura organizzativa del dominio di lavoro) in caso di utente da aggiornare
1855        			VisDocAssInvAUOXmlIn	IN		CLOB DEFAULT NULL,		-- Lista delle strutture dei cui documenti e fascicoli assegnati o inviati in conoscenza l'utente ha visibilità (XML conforme a schema LISTA_STD.xsd).
1856        																	-- Devono essere stutture del dominio di lavoro, non necessariamente attive
1857        																	-- Ogni riga della lista contiene:
1858        																	-- 1) ID_UO della UO
1859        																	-- 2) Nri livello della UO
1860        																	-- 3) Denominazione della UO
1861        																	-- 4) (valori 1/0) flag di visibilità estesa alle sotto-UO
1862        																	-- 5) (valori 1/0) flag di visibilità estesa alle postazioni utente (anche delle sotto-UO se colonna 4 è 1)
1863        																	-- 6) (valori 1/0) flag di visibilità estesa ai documenti e fascicoli riservati
1864        																	-- 7) (valori 1/0) flag di UO da eliminare
1865        			FlgModUOModDocAssIn		IN		VARCHAR2 DEFAULT 'I',	-- (valori I/C) Indica se le UO indicate nell'argomento successivo sono fornite in modo incrementale (=I) (solo quelle da aggiungere o cancellare) oppure completo (=C), vale a dire che dovranno soppiantare tutte quelle già specificate (e relative alla struttura organizzativa del dominio di lavoro) in caso di utente da aggiornare
1866        			ModDocAssAUOXmlIn		IN		CLOB DEFAULT NULL,		-- Lista delle strutture dei cui documenti e fascicoli assegnati l'utente ha permesso di modifica/gestione (XML conforme a schema LISTA_STD.xsd).
1867        																	-- Devono essere stutture del dominio di lavoro, non necessariamente attive
1868        																	-- Ogni riga della lista contiene:
1869        																	-- 1) ID_UO della UO
1870        																	-- 2) Nri livello della UO
1871        																	-- 3) Denominazione della UO
1872        																	-- 4) (valori 1/0) flag di gestione estesa alle sotto-UO
1873        																	-- 5) (valori 1/0) flag di gestione estesa alle postazioni utente (anche delle sotto-UO se colonna 4 è 1)
1874        																	-- 6) (valori 1/0) flag di gestione estesa ai documenti e fascicoli riservati
1875        																	-- 7) (valori 1/0) flag di UO da eliminare
1876        			FlgModDelegheIn			IN		VARCHAR2 DEFAULT 'I',	-- (valori I/C) Indica se le deleghe (verso UO, scrivanie e utenti) indicate nell'argomento successivo sono fornite in modo incrementale (=I) (solo quelle da aggiungere o cancellare) oppure completo (=C), vale a dire che dovranno soppiantare tutte quelle già specificate (e relative alla struttura organizzativa del dominio di lavoro) in caso di utente da aggiornare
1877        			XMLDelegheIn			IN		CLOB DEFAULT NULL,		-- Lista delle deleghe (verso scrivanie e utenti) da aggiornare (XML conforme a schema LISTA_STD.xsd)					
1878        																	-- AD OGGI NON E' GESTITA ANCORA
1879        																	-- Ogni delega è un tag "Riga" che contiene le seguenti colonne:
1880        																	-- 1: Rowid che indica il record di delega da aggiornare/eliminare
1881        																	-- 2: Indicatore del tipo di oggetto verso cui si ha delega: 
1882        																	-- Valori ammessi:
1883        																	-- 	UT	=	Utente
1884        																	--	SV	=	Scrivania
1885        																	-- 3: Identificativo (ID_UO o ID_USER o ID_SCRIVANIA) della UO/Utente/scrivania (viene considerato solo se una delle 2 colonne successive e valorizzata e se non è congruente con quelle viene ignorato)
1886        																	-- 4: Denominazione/descrizione della UO/Utente/scrivania  (o suo inizio; ricerca case insensitive in like senza forzare il % finale). Nel caso di UO può essere quella semplice o la concatenazione con separatore "|" delle denominazioni delle UO superiori + quella della UO
1887        																	-- 5: Stringa con i n.ri livello della UO (tutti o alcuni; però se si specifica un livello è obbligatorio indicare tutti i livelli superiori; vanno specificati come appaiono nella GUI, ovvero romani se previsto, 0 o -- se nulli; sono separati dal separatore dei livelli valido per il soggetto produttore/AOO di appartenenza della UO)
1888        																	-- 6: Data di inizio validità della delega (nel formato dato dal parametro di config. FMT_STD_DATA). Se NULL si intende valida da tempo illimitato	
1889        																	-- 7: Data di fine validità della delega (nel formato dato dal parametro di config. FMT_STD_DATA). Se NULL si intende valida illimitatamente.
1890        																	-- 8: (valori 1/0/NULL): Se 1 significa che la delega è anche verso tutte le sotto-UO della UO indicata (possibile solo per delega vs UO) 
1891        																	-- 9: (valori 1/0/NULL): Se 1 significa che la delega è anche verso tutte le scrivanie virtuali della UO indicata (e sue eventuali sotto-UO se incluse a loro volta) (possibile solo per delega vs UO) 
1892        																	-- 10: (valori 1/0/NULL) Flag di record da eliminare
1893        			FlgModGruppiAppIn			IN		VARCHAR2 DEFAULT 'I',				-- (valori I/C) Indica i gruppi cui appartiene l'utente (relativi al dominio da cui si è connessi) indicati nell'argomento successivo sono forniti in modo incrementale (=I) (solo quelle da aggiungere o cancellare) oppure completo (=C), vale a dire che dovranno soppiantare tutte quelle già specificati (e relativi al dominio di lavoro) in caso di utente da aggiornare
1894        			XMLGruppiAppIn			IN		CLOB DEFAULT NULL,				-- Lista con i gruppi cui appartiene l'utente (relativi al dominio da cui si è connessi)
1895        																	-- Ogni gruppo di appartenenza è un tag "Riga" con le colonne:
1896        																	-- 1: Id. del gruppo (viene considerato solo se la colonna successiva è valorizzata)
1897        																	-- 2: Nome del gruppo
1898        																	-- 3: (valori 1/0) Flag di appartenenza a gruppo da eliminare
1899        			RowidOut				OUT		VARCHAR2,				-- Rowid del record dell'Utente
1900        			AttributiAddIn			IN		CLOB DEFAULT NULL,		-- XML contenente nomi e valori degli attributi dinamici da aggiornare (conforme allo schema SezioneCache.xsd) 
1901        																	-- Gli attributi già presenti in DB e per i quali non c'è corrispondente nell'XML restano invariati
1902        																	-- Per tutti gli attributi vale quanto segue:
1903        																	-- Un attributo da settare è un tag "Variabile" dell'XML il cui tag "Nome" contiene il nome identificativo dell'attributo (ATTR_NAME di DMT_ATTRIBUTES_DEF)
1904        																	-- Un attributo da settare è una variabile con tag "ValoreSemplice" se è un attributo a singolo valore e non strutturato (cioè con tipo diverso da COMPLEX)
1905        																	-- altrimenti è una variabile con tag "Lista" che ha un'unica colonna con "Nro" pari a 1 se l'attributo non è strutturato, che ha invece tante colonne quanti gli attributi componenti (ordinate in base al loro NRO_ORD_IN_SUP) se l'attributo è complesso 
1906        																	-- Nel caso di variabili con tag "Lista" i valori specificati nell'XML si aggiungono o sostituiscono quelli già presenti in DB a seconda che nell'XML sia presente o meno una variabile con tag "Nome" pari a #Append_<Nome attributo> e tag "ValoreSemplice" pari a 1  
1907        																	-- In particolare se non sono specificati valori nell'XML (tag Lista vuoto) e se i valori non sono da aggiungere significa che tutti i valori dell'attributo già presenti in DB vanno rimossi
1908        			FlgIgnoreWarningIn 		IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 0 o NULL significa che in presenza di WARNING la stored si comporta come in caso di errore; se 1 gli WARNING vengono ignorati
1909        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
1910        																	-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
1911        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
1912        			WarningMsgOut			OUT		VARCHAR2,						-- Messaggio di warning (valorizzato solo se non c'è errore)
1913        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
1914        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
1915        			ErrMsgOut				OUT 		VARCHAR2,						-- Messaggio d'errore
1916        			CodRapidoIn				IN		DMT_USERS.COD_RAPIDO%type DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),		-- Codice rapido dell'utente
1917        			CodFiscaleIn			IN		DMT_RUBRICA_SOGGETTI.CF%type DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),				-- Codice fiscale (viene registrato in rubrica soggetti)
1918        			FlgModIndirizziIn		IN		VARCHAR2 DEFAULT 'I',			-- (valori I/C) Indica se gli indirizzi indicate nell'argomento successivo sono forniti in modo incrementale (=I) (solo quelle da inserire/modificare/cancellare) oppure completo (=C), vale a dire che dovranno soppiantare tutti gli indirizzi NON storici già specificati in caso di soggetto da aggiornare
1919        			XMLIndirizziIn			IN		CLOB DEFAULT NULL				-- Lista degli indirizzi (tranne quelli cessati) del soggetto (XML conforme a schema LISTA_STD.xsd)
1920        																			-- Ogni indirizzo è un tag Riga che può contenere le seguenti colonne: 
1921        																			-- 1: Identificativo dell'indirizzo/luogo (rowid)
1922        																			-- 2: Codice del tipo di indirizzo/luogo 
1923        																			-- 3: Tipo di indirizzo/luogo 
1924        																			-- 4: Dettaglio del tipo
1925        																			-- 5: <non utilizzata>
1926        																			-- 6: <non utilizzata>
1927        																			-- 7: Data di inzio validità dell'indirizzo/luogo (nel formato dato dal parametro di conf. FMT_STD_DATA)
1928        																			-- 8: Data di fine validità dell'indirizzo/luogo (nel formato dato dal parametro di conf. FMT_STD_DATA)
1929        																			-- 9: Codice identificativo toponomastico (se indirizzo censito nella toponomastica del sistema; viene considerato solo se è valorizzata anche la colonna successiva)
1930        																			-- 10: Indirizzo (senza civico) (alternativo o ridondante rispetto al campo precedente) e senza tipo toponimo se questo è separato in colonna 24 (che quindi è valorizzata)
1931        																			-- 11: N.° civico (senza eventuali appendici)
1932        																			-- 12: Interno
1933        																			-- 13: Scala
1934        																			-- 14: Piano 
1935        																			-- 15: CAP 
1936        																			-- 16: Frazione 
1937        																			-- 17: Codice ISTAT del comune italiano (viene considerato solo se è valorizzata anche la colonna successiva)
1938        																			-- 18: Nome del comune italiano o della città (se estera)
1939        																			-- 19: Codice ISTAT dello stato (viene considerato solo se è valorizzata anche la colonna successiva)
1940        																			-- 20: Nome dello stato 
1941        																			-- 21: Targa provincia
1942        																			-- 22: Zona dell'indirizzo
1943        																			-- 23: Complemento dell'indirizzo
1944        																			-- 24: Tipo toponimo (i.e. via, piazza ecc) dell'indirizzo
1945        																			-- 25: Appendici (esponente, bis/ter, colore ecc) del N.ro civico
1946        																			-- 26: (valori 1/0/NULL) Flag di indirizzo da eliminare
1947        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine (senza warning), altrimenti 0 (in caso di errore o warning)
1948        
1949        	/****** funzione per accreditare un utente nel dominio a cui si è connessi 												*******/
1950        	/****** Se l'utente è già accreditato non viene dato errore ed eventualmente vengono aggiornati gli estremi del periodo di accreditamento 	*******/
1951        	function AccreditaUserInDominioLogon(
1952        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
1953        																	-- (obblig). Codice identificativo del token di connessione
1954        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
1955        			IdUserIn				IN 		DMT_USERS.ID_USER%type DEFAULT NULL,	-- (obblig. se UsernameIn e DesUserIn non sono valorizzati) Id. dell'utente da accreditare.
1956        			UsernameIn				IN		DMT_USERS.USERNAME%type DEFAULT NULL,	-- (obblig. se IdUserIn e DesUserIn non sono valorizzati) Username (interna al sistema) dell'utente da accreditare
1957        			DesUserIn				IN 		DMT_USERS.DES_USER%type DEFAULT NULL,	-- (obblig. se IdUserIn e UsernameIn non sono valorizzati) Cognome e nome/descrizione dell'utente (ricerca case insensitive in like senza forzare il % finale)
1958        			DtInizioAccredInDomIn		IN		VARCHAR2 DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'DATE_VAL_NO_UPD'),
1959        																	-- Data di inizio accreditamento nel dominio da cui si è connessi (nel formato dato dal parametro di conf. FMT_STD_DATA).
1960        			DtFineAccredInDomIn		IN		VARCHAR2 DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'DATE_VAL_NO_UPD'),
1961        																	-- Data di fine accreditamento nel dominio da cui si è connessi (nel formato dato dal parametro di conf. FMT_STD_DATA).
1962        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
1963        																	-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
1964        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
1965        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
1966        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
1967        			ErrMsgOut				OUT 		VARCHAR2						-- Messaggio d'errore
1968        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine, altrimenti 0 (in caso di errore o warning)
1969        
1970        	/****** funzione per accreditare un utente in una data applicazione esterna o sua istanza (se non specificata quella da cui si è connessi) 						******/
1971        	/****** Se l'utente è già accreditato non viene dato errore ed eventualmente vengono aggiornati credenziali e cod. id. dell'utente nell'applicazione esterna o sua istanza 	******/
1972        	function AccreditaUserInApplEst(
1973        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
1974        																	-- (obblig). Codice identificativo del token di connessione
1975        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
1976        			IdUserIn				IN 		DMT_USERS.ID_USER%type DEFAULT NULL,	-- (obblig. se UsernameIn e DesUserIn non sono valorizzati) Id. dell'utente da accreditare.
1977        			UsernameIn				IN		DMT_USERS.USERNAME%type DEFAULT NULL,	-- (obblig. se IdUserIn e DesUserIn non sono valorizzati) Username (interna al sistema) dell'utente da accreditare
1978        			DesUserIn				IN 		DMT_USERS.DES_USER%type DEFAULT NULL,	-- (obblig. se IdUserIn e UsernameIn non sono valorizzati) Cognome e nome/descrizione dell'utente (ricerca case insensitive in like senza forzare il % finale)
1979        			CodApplicazioneEsternaIn	IN		DMT_APPLICAZIONI_ESTERNE.CI_APPLICAZIONE%type DEFAULT NULL,
1980        																	-- Codice dell'applicazione esterna in cui accreditare
1981        																	-- Se non valorizzato è quella da cui si è connessi
1982        			CodIstApplicazioneEsternaIn	IN		DMT_APPLICAZIONI_ESTERNE.CI_ISTANZA_APPLICAZIONE%type DEFAULT NULL,
1983        																	-- Codice dell'istanza di applicazione esterna in cui accreditare
1984        																	-- Se CodApplicazioneEsternaIn non è valorizzato è l'istanza di applicazione esterna da cui si è connessi
1985        			UsernameInApplEstIn		IN		VARCHAR2 DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
1986        																	-- Username dell'utente nell'applicazione esterna (o sua istanza) in cui accreditare
1987        			PasswordInApplEstIn		IN		VARCHAR2 DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
1988        																	-- Password dell'utente nell'applicazione esterna (o sua istanza) in cui accreditare
1989        			CIUserInApplEstIn			IN		VARCHAR2 DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
1990        																	-- Cod. identificativo dell'utente nell'applicazione esterna (o sua istanza) in cui accreditare
1991        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
1992        																	-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
1993        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
1994        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
1995        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
1996        			ErrMsgOut				OUT 		VARCHAR2,						-- Messaggio d'errore
1997        			IdUORegDefaultIn		IN		INTEGER	DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD')			
1998        																			-- Id. della UO da usare come UO di registrazione quando l'utente effettua una registrazione a protocollo o altra numerazione dall'applicazione esterna
1999        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine, altrimenti 0 (in caso di errore o warning)
2000        
2001        	/****** funzione per togliere l'accreditamento in una data applicazione esterna o sua istanza (se non specificata quella da cui si è connessi) ad una lista di utenti 	******/
2002        	/****** Se un utente della lista non è già accreditato non viene dato errore 																******/
2003        	function TogliAccredUsersInApplEst(
2004        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
2005        																	-- (obblig). Codice identificativo del token di connessione
2006        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
2007        			CodApplicazioneEsternaIn	IN		DMT_APPLICAZIONI_ESTERNE.CI_APPLICAZIONE%type DEFAULT NULL,
2008        																	-- Codice dell'applicazione esterna da cui togliere l'accreditamento
2009        																	-- Se non valorizzato è quella da cui si è connessi
2010        			CodIstApplicazioneEsternaIn	IN		DMT_APPLICAZIONI_ESTERNE.CI_ISTANZA_APPLICAZIONE%type DEFAULT NULL,
2011        																	-- Codice dell'istanza di applicazione esterna da cui togliere l'accreditamento
2012        																	-- Se CodApplicazioneEsternaIn non è valorizzato è l'istanza di applicazione esterna da cui si è connessi
2013        			ListaUtentiXmlIn			IN		CLOB,							-- Lista con gli estremi degli utenti a cui togliere l'accreditamento (XML conforme a schema LISTA_STD.xsd)
2014        																	-- Ogni utente è un tag riga che può contenere le colonne:
2015        																	-- 1: Id. dell'utente (quello interno ad AURIGA)
2016        																	-- 2: Descrizione dell'utente
2017        																	-- 3: Username dell'utente (quello di AURIGA)
2018        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
2019        																	-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
2020        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
2021        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
2022        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
2023        			ErrMsgOut				OUT 		VARCHAR2						-- Messaggio d'errore
2024        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine, altrimenti 0 (in caso di errore o warning)
2025        
2026        	/*** Funzione di eliminazione (fisica) di un utente del sistema	***/	
2027        	function DUser(
2028        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
2029        																	-- (obblig). Codice identificativo del token di connessione
2030        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
2031        			IdUserIn				IN 		DMT_USERS.ID_USER%type DEFAULT NULL,	-- (obblig. se UsernameIn e DesUserIn non sono valorizzati) Id. dell'utente da eliminare.
2032        			UsernameIn				IN		DMT_USERS.USERNAME%type DEFAULT NULL,	-- (obblig. se IdUserIn e DesUserIn non sono valorizzati) Username (interna al sistema) dell'utente da eliminare
2033        			DesUserIn				IN 		DMT_USERS.DES_USER%type DEFAULT NULL,	-- (obblig. se IdUserIn e UsernameIn non sono valorizzati) Cognome e nome/descrizione dell'utente (ricerca case insensitive in like senza forzare il % finale)
2034        			MotiviIn				IN		DMT_PROCESS_TYPES.MOTIVI_ANN%type,		-- Motivi della cancellazione
2035        			FlgIgnoreWarningIn 		IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 0 o NULL significa che in presenza di WARNING la stored si comporta come in caso di errore; se 1 gli WARNING vengono ignorati
2036        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
2037        																	-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
2038        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
2039        			WarningMsgOut			OUT		VARCHAR2,						-- Messaggio di warning (valorizzato solo se non c'è errore)
2040        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
2041        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
2042        			ErrMsgOut				OUT 		VARCHAR2						-- Messaggio d'errore
2043        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine (senza warning), altrimenti 0 (in caso di errore o warning)
2044        
2045        	/*** Funzione con cui modificare la password di un utente (anche senza specificare la vecchia password se l'utente di lavoro è abilitato alla gestione degli utenti) ***/	
2046        	function CambioPassword(
2047        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
2048        																	-- (obblig). Codice identificativo del token di connessione
2049        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
2050        			IdUserIn				IN 		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente di cui cambiare la password
2051        			UsernameIn				IN		DMT_USERS.USERNAME%type DEFAULT NULL,	-- Username (interna al sistema) dell'utente di cui cambiare la password
2052        			DesUserIn				IN 		DMT_USERS.DES_USER%type DEFAULT NULL,	-- Cognome e nome/descrizione dell'utente (ricerca case insensitive in like senza forzare il % finale) di cui cambiare la password
2053        																	-- ATTENZIONE: Se nessuno dei 3 argomenti precedenti è valorizzato si intende che l'utente di cui modificare al password sia quello connesso
2054        			FlgNoVerifyOldPwdIn		IN		PLS_INTEGER DEFAULT NULL,			-- (1/0/NULL) Se 1 la vecchia password non viene verificata per consentire la modifica.
2055        																	-- Può essere valorizzato a 1 solo se l'utente di lavoro è abilitato alla modifica utenti
2056        			OldPasswordIn			IN		DMT_USERS.PASSWORD%type,			-- Vecchia password
2057        			NewPasswordIn			IN		DMT_USERS.PASSWORD%type,			-- Nuova password
2058        			ConfNewPasswordIn			IN		DMT_USERS.PASSWORD%type,			-- Conferma nuova password
2059        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
2060        																	-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
2061        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
2062        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore; se NULL è la funzione stessa
2063        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
2064        			ErrMsgOut				OUT 		VARCHAR2)						-- Messaggio d'errore
2065        			return PLS_INTEGER;											-- vale 1 in caso di successo, altrimenti 0
2066        
2067        	/*** Funzione per sbloccare utenza loccata a causa di troppi tentativi di login falliti ***/	
2068        	function UnlockUser(
2069        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
2070        																	-- (obblig). Codice identificativo del token di connessione
2071        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
2072        			IdUserIn				IN 		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente da sbloccare
2073        			UsernameIn				IN		DMT_USERS.USERNAME%type DEFAULT NULL,	-- Username (interna al sistema) dell'utente da sbloccare
2074        			DesUserIn				IN 		DMT_USERS.DES_USER%type DEFAULT NULL,	-- Cognome e nome/descrizione dell'utente (ricerca case insensitive in like senza forzare il % finale) di cui cambiare la password
2075        																					-- ATTENZIONE: Almeno uno dei tre argomenti sopra deve essere valorizzato
2076        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
2077        																					-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
2078        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,				-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
2079        			ErrContextOut			OUT		VARCHAR2,								-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore; se NULL è la funzione stessa
2080        			ErrCodeOut				OUT		PLS_INTEGER,							-- N.ro errore di uscita
2081        			ErrMsgOut				OUT 		VARCHAR2)							-- Messaggio d'errore
2082        			return PLS_INTEGER;														-- vale 1 in caso di successo, altrimenti 0
2083        
2084        	/************* Funzione attraverso cui registrarsi come utente della community di AURIGA **************/
2085        	function RegistrazioneUtenteCommunity(
2086        			DesUserIn				IN		VARCHAR2,						-- (obblig.) Descrizione/cognome e nome dell'utente
2087        			eMailIn				IN		VARCHAR2 DEFAULT NULL,				-- Indirizzo e-mail dell'utente
2088        			UsernameIn				IN		VARCHAR2,						-- (obblig.) Username di autenticazione alla community
2089        			PasswordIn				IN		VARCHAR2,						-- (obblig.) Password di autenticazione alla community		
2090        			ConfermaPasswordIn		IN		VARCHAR2,						-- (obblig.) Conferma della password di autenticazione alla community
2091        			IdUserOut				OUT		DMT_USERS.ID_USER%type,				-- Id. dell'utenza creata 
2092        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
2093        																	-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
2094        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
2095        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
2096        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
2097        			ErrMsgOut				OUT 		VARCHAR2						-- Messaggio d'errore
2098        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine, altrimenti 0 (in caso di errore o warning)
2099        
2100        	/************* funzione per onvertire i NRI_LIVELLI di una UO dalla forma in cui appaiono in tabella a quella con cui vanno renderizzati nella GUI *************/
2101        	function ConvertNriLivelliUOXGUI(
2102        			NriLivelliUOInTableIn		IN		DMT_STRUTTURA_ORG.NRI_LIVELLI%type,		-- (obblig.) Campo NRI_LIVELLI della UO come compare in atbella
2103        			DefLivelliSOTabIn			IN		DMTO_LIV_GERARCHIA_ESTESA,			-- (obblig.)Definizione di quali sono i livelli della struttura organizzativa cui appartiene la UO
2104        			SepLivelliIn			IN		VARCHAR2,						-- (obblig.)Separatore dei livelli da usare nell GUI
2105        			FlgPaddingLivUOIn			IN		PLS_INTEGER,					-- (valori 1/0/NULL) Se 1 significa che per il livelli numerici va fatto il riempimento con 0 fino alla max lunghezza di un n.ro livello (LengthNroLivelloIn)
2106        			LengthNroLivelloIn		IN		PLS_INTEGER						-- (obblig.)Max lunghezza (come n.ro di cifre o caratterri) di ciascun n.ro livello
2107        			) return VARCHAR2;											-- N.ri livello della UO come devono essere renderizzati nella GUI
2108        
2109        	------- funzione per testare se un UD cartacea (creata o in creazione, nel caso con IdUdIn NULL) può essere assegnata da un determinato utente ad una determinata UO assegnataria
2110        	function TestAssUDConRestrCartaceo(
2111        			IdDominioIn			IN		INTEGER,								-- Id. dominio di lavoro
2112        			IdUserLavoroIn		IN		DMT_USERS.ID_USER%type,					-- Id. dell'utente che assegna
2113        			IdUDIn				IN		VARCHAR2,								-- Id dell'unità doc. da assegnare. Se IdUDIn NULL è un'UD in creazione
2114        			IdUOAssIn			IN		INTEGER,								-- Id. della  UO di nuova assegnatazione da verificare
2115        			FlgUOAssPPIn		IN		PLS_INTEGER,							-- Se 1 indica che la UO di assegnazione è un punto di protocollo
2116        			IdPPUserTabIn		IN		DMTO_ID,								-- Tabella con ID_UO dei punti di protocollo cui è associato utente di lavoro
2117        			IdPPUOUserTabIn		IN		DMTO_ID,								-- Tabella con ID_UO dei punti di protocollo delle UO cui è associato utente di lavoro
2118        			IdPPUDTabIn			IN		DMTO_ID									-- Tabella con ID_UO dei punti di protocollo associati all'assegnatario preesistente dell'unità documentaria
2119        			) return PLS_INTEGER;												-- restituise:
2120        																				-- 1 se l'assegnazione è consentita
2121        																				-- 0 se l'assegnazione NON è consentita
2122        																				-- valori negativi in caso di verifica impossibile a causa di errori
2123        
2124        	/******* funzione per ricercare unità operative e/o scrivanie virtuali/utenti ad essa collegati  ********/
2125        	function TrovaStruttOrgObj(
2126        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
2127        																	-- (obblig). Codice identificativo del token di connessione
2128        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
2129        			FlgPreimpostaFiltroIn		IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1 i filtri e l'ordinamento vengono settati secondo le impostazioni dell'utente di lavoro, altrimenti restano come passati in input
2130        			MatchByIndexerIn			IN		CLOB DEFAULT NULL,				-- Lista delle unità operative, scrivanie viruali e utenti associati alla struttura organizzativa che sono stati trovati dal searcher di Lucene (XML conforme a schema LISTA_STD.xsd)
2131        																	-- Ogni oggetto di Lucene trovato è un tag Riga che contiene le seguenti colonne: 
2132        																	-- 1: identificativo dell’oggetto
2133        																	-- 2: non utilizzata
2134        																	-- 3: flag 1/0 che indica se il match dell'oggetto richiede attributi "protetti", ovvero che possono contenere dati riservati
2135        																	-- 4: score restituito da Lucene
2136        			FlgIndexerOverflowIn		IN		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 significa che il searcher di Lucene ha trovato un numero di oggetti superiore ad un limite massimo consentito.
2137        																	-- Nel caso il flag valga 1 l’argomento precedente può essere vuoto o se non lo è il suo contenuto viene comunque ignorato
2138        			Flg2ndCallIn			IN		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 indica che si tratta della seconda chiamata alla stored che viene fatta a seguito di una ricerca sottomessa. 
2139        																	-- Può essere 1 solo se MatchByIndexerIn contiene degli oggetti.
2140        																	-- E' un flag che serve per velocizzare la ricerca: infatti quando è 1 i filtri vengono ignorati in quanto si considera che il set restituito dall'indicizzatore sia già fatto di oggetti soddisfacenti tutti i filtri; la chiamata alla stored serve solo per verificare l'accesso agli oggetti restituiti dall'indicizzatore, ordinare ed eventualmente paginare il risultato e calcolare tutti i dati degli oggetti da restituire.
2141        			FlgObjTypeIO			IN OUT	VARCHAR2,						-- 1° filtro di ricerca: indica se la ricerca va ristretta alle sole unità operative (UO) o solo utenti con scrivania virtuale (SV) o utenti senza scrivania collegati alla struttura organizzativa(UT) 
2142        																	-- Può essere una concatenazione dei valori ammessi separti da ";". 
2143        																	-- Se non valorizzato si intende che la ricerca sia su UO e utenti con o senza scrivania
2144        			CercaInUOIO				IN OUT	DMT_STRUTTURA_ORG.ID_UO%type,			-- 2° filtro di ricerca: id. della U.O. in cui effettuare la ricerca. Se non specificato si cerca in tutta la struttura organizzativa
2145        			FlgCercaInSubUOIO			IN OUT	PLS_INTEGER,					-- 3° filtro di ricerca (valori 1/0/NULL): 1 indica che la ricerca va estesa alle sotto-UO della UO CercaInUOIO 
2146        																	-- ATTENZIONE: non può essere 1 se CercaInUOIO non è valorizzato 
2147        																	--		   Se CercaInUOIO non è valorizzato (ricerca in tutta la struttura organizzativa) solo se il flag è 0 si intende che non si debba ricercare nelle sotto-UO e si mostrano solo le UO di 1° livello gerarchico
2148        			TsRifIn				IN		VARCHAR2 DEFAULT NULL,				-- (nel formato DD/MM/RRRR HH24:MI:SS) Definisce l'istante in cui va presa la "fotografia" della struttura organizzativa in cui si vuole ricercare. 
2149        																	-- Se non valorizzato si intende che si vuole ricercare nell'attuale struttura organizzativa	
2150        			CriteriAvanzatiIO			IN OUT	NOCOPY CLOB,					-- XML contenente nomi e valori dei filtri su unità operative, scrivanie e utenti (conforme allo schema SezioneCache.xsd). 
2151        																	-- Ogni filtro è un tag "Variabile" dell'XML
2152        																	-- I filtri che sono liste hanno nomi (tag Variabile/Nome) che iniziano con @.
2153        																	-- I nomi dei filtri possibili sono:
2154        																	-- IdOrganigramma			Id. dell'organigramma in cui restringere la ricerca
2155        																	--							Se non valorizzato e non ricavabile dalla CercaInUOIO si intende di dover cercare nell'organigramma in vigore - attualmente o alla data specificata in TsRifIn - per l'Ente/AOO collegato: se non si riesce a determinare l'organigramma in cui cercare viene dato errore
2156        																	--  FlgCercaInUOSup			Se 1 e se CercaInUOIO è valorizzato considera/cerca anche nelle UO superiori della UO indicata in CercaInUOIO
2157        																	--	FlgCercaInUOSorelle		Se 1 e se CercaInUOIO è valorizzato considera/cerca ancha nelle UO sorelle della UO indicata in CercaInUOIO
2158        																	--  Descrizione				Stringa contenuta nella descrizione delle UO/scrivanie o nel cognome e nome degli utenti da cercare (ricerca case-insensitive in like senza forzare % finale)
2159        																	--	DescrizioneRFT			Parola/e contenuta/e nella descrizione delle UO/scrivanie o nel cognome e nome degli utenti da cercare (ricerca di tipo contains con indici context)
2160        																	--	FlgCercaAnchePerDesUO	Se 1 la ricerca per descrizione, sulle relazioni utente UO cerca anche sulla denominazione delle UO, per cui quanto ricercato può essere sia nel Cognome e Nome/Nome scrivania che nel nome della UO
2161        																	--							Se 1, anche se non spceificato filtro per descrizione, per le relazioni utente- UO le colonne 3 e 8 contengono sia la denominazione UO che quella della relazione utente-UO
2162        																	--	CodTipoUO				Codice che indica il tipo di UO da ricercare (ricerca case-sensitive esatta)
2163        																	--  DesTipoUO				Descrizione del tipo di UO da ricercare (ricerca case-insensitive in like senza forzare % finale)
2164        																	--  LivelloGerarchicoUO		N.ro di livello gerarchico delle UO da ricercare
2165        																	-- 	@CodLivelloUO			Codici che identificano i livelli della UO. Ciscuna riga della lista può contenere una sola colonna:
2166        																	--							1: Codice che identifica la struttura di livello gerarchico i-esimo (dove i è il n.ro di riga) tra quelle che ricadono nella stessa struttura padre (va espresso come si vede nella GUI, ovvero romano se previsto, 0 o -- per indicare che è assente la struttura superiore di livello i-esimo)					
2167        																	--	UsernameUtenteCollegatoUO Username a cui devono essere collegate le UO da estrarre
2168        																	--  FlgSoloPuntiProtocollo (valori 1/0) Se 1 l'estrazione estare solo le UO che sono Punti di Protocollo
2169        																	--  FlgSoloUOAttive			(valori 1/0) Se 1 si devono ricercare solo le UO attive al timestamp TsRifIn, se 0 solo quelle cessate al timestamp indicato
2170        																	--	FlgSoloRelUserUOAttive		(valori 1/0) Se 1 si devono ricercare solo le relazioni utente-UO attive al timestamp TsRifIn, se 0 solo quelle cessate al timestamp indicato
2171        																	--	TipoRelUtentiConUO		Indica il/i tipi di relazione che gli utenti da ricercare devono avere all'istante TsRifIn con le UO:
2172        																	--							E' una concatenazione con ; come separatore dei valori:
2173        																	--							A = Appartenenza gerarchica; D = Funzionale, P = Protocollista, L = gestione documentazione assegnata/inviata (NON protocollista)
2174        																	--	IdRuoli					Id. del ruolo/i ricoperti dagli utenti nelle relazioni utente-UO da ricercare
2175        																	--							Possono essere indicati più Id Ruolo separati da , o ;
2176        																	--  Qualifiche				Qualifica/e degli utenti da ricercare. Se indicato anche IdRuoli i 2 filtri vanno in OR
2177        																	--							Possono essere indicate più qualifiche separate da ;
2178        																	--	IdGruppoAppartenenza		Id. di un gruppo cui devono appartenere (anche non direttamente) le UO/utenti/scrivanie da ricercare
2179        																	-- 	NomeGruppoAppartenenza		Nome di un gruppo cui devono appartenere (anche non direttamente) le UO/utenti/scrivanie da ricercare (ricerca case-insensitive in like senza forzare % finale; il gruppo deve essere individuabile univocamente)
2180        																	--	DataIstituzioneUODa		Inizio intervallo di ricerca sulla data di istituzione delle UO (nel formato del parametro di config. FMT_STD_DATA)
2181        																	--	DataIstituzioneUOA		Fine intervallo di ricerca sulla data di istituzione delle UO (nel formato del parametro di config. FMT_STD_DATA)
2182        																	--	DataSoppressioneUODa		Inizio intervallo di ricerca sulla data di soppressione delle UO (nel formato del parametro di config. FMT_STD_DATA)
2183        																	--	DataSoppressioneUOA		Fine intervallo di ricerca sulla data di soppressione delle UO (nel formato del parametro di config. FMT_STD_DATA)
2184        																	--	Email					Indirizzo email delle UO/utenti da ricercare (ricerca case-insensitive in like)
2185        																	--  ProvCIUo				Ricerca per codice di provenienza (da sistema esterno) della UO (ricerca case-sensitive in like)
2186        																	--  FlgSoloUODichIPA			(valori 1/0) Se 1 si devono ricercare solo le UO che al timestamp TsRifIn risultano dichiarate all'Indice PA
2187        																	--	IdObjToForce			Va valorizzato con Flag UO/SV + id. di una UO/scrivania che deve essere messo comunque nella lista di output		
2188        																	--							Può essere una lista di UO/scrivanie separate da , o ;
2189        																	--  IdUOPP					Id. del Punto di Protocollo cui devono essere collegate le UO da estrarre
2190        																	--  IdUOFirst				Id. della UO di cui devono essere mostrate per prime le scrivanie/utenti
2191        																	--  IdObjToFilter			Va valorizzato con Flag UO/SV + id. di una UO/scrivania che deve essere filtrata
2192        			CriteriPersonalizzatiIO		IN OUT 	NOCOPY CLOB,		-- Criteri di ricerca sugli attributi custom di unità operative, utenti e scrivanie (XML conforme a schema LISTA_STD.xsd). Se più di uno vengono applicati in AND.
2193        																	-- Ogni criterio è un tag Riga che può contenere le seguenti colonne:
2194        																	--	1) Nome (ATTR_NAME) dell'attributo cui è relativo il criterio
2195        																	--	2) (obblig.) Operatore logico. Valori possibili:
2196        																	--		"uguale" (ricerca esatta) 
2197        																	--		"simile a (case-sensitive)" (ricerca case-sensitive in like)
2198        																	--		"simile a (case-insensitive)" (ricerca case-insensitive in like e che ignora i caratteri quali spazi, ., ecc)
2199        																	--		"maggiore" (se attributo numerico o data)
2200        																	--		"maggiore o uguale" (se attributo numerico o data)
2201        																	--		"minore" (se attributo numerico o data)
2202        																	--		"minore o uguale" (se attributo numerico o data)
2203        																	--		"tra" (se attributo numerico o data)
2204        																	--		"non valorizzato"
2205        																	--		"valorizzato"
2206        																	--		"spuntato" (se attributo di tipo casella di spunta)
2207        																	--		"non spuntato" (se attributo di tipo casella di spunta)
2208        																	--	3) 1° valore di confronto (obblig. e gestito solo se l'operatore non ha uno dei seguenti valori: valorizzato, non valorizzato, spuntato, non spuntato) (se l'attributo è numerico deve avere la virgola come separatore dei decimali, se è di tipo data deve essere in uno dei formato dati dai parametri di conf. FMT_STD_DATA e FMT_STD_TIMESTAMP)
2209        																	--	4) 2° valore di confronto (obblig. e gestito solo se l'operatore è "tra") (se l'attributo è numerico deve avere la virgola come separatore dei decimali, se è di tipo data deve essere in uno dei formato dati dai parametri di conf. FMT_STD_DATA e FMT_STD_TIMESTAMP)
2210        																	--	5) Label dell''attributo cui è relativo il criterio (se sotto-attributo di complesso <label del complesso> - <label del sotto-attributo>
2211        			------------- inizio argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
2212        			ColOrderByIO			IN OUT	VARCHAR2,						-- Indica il/i numeri della/e colonna dell'XML (CLOB ResultOut) di output per cui ordinare i record nell'XML stesso (si può ordinare solo per le colonne da 1 a 24 + 39 + 40 +41). Se l'ordinamento è per più colonne queste vanno separate con "," (es: 2; 2,3)
2213        																	-- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul tipo di ordinamento una qualche preimpostazione di sistema/utente ecc.
2214        																	-- se non valorizzato (neppure in output) la lista di record restituita non è ordinata
2215        			FlgDescOrderByIO  		IN OUT	VARCHAR2,						-- E' una stringa di 1 o 0/NULL, tanti quanti le colonne di ordinamento, separati da ",": 1 significa che l'ordinamento per la data colonna deve essere discendente anzichè ascendente (es: 1; 1,0; 1, )
2216        																	-- in output può essere diverso che in input solo se in input è NULL: in tal caso significa che esiste sul verso di ordinamento una qualche preimpostazione di sistema/utente ecc.			
2217        			FlgSenzaPaginazioneIn 		IN 		PLS_INTEGER DEFAULT NULL,            	-- (valori 1/0/NULL) Se 1 l'estrazione non è paginata, altrimenti sì
2218        			NroPaginaIO      			IN OUT	PLS_INTEGER,                  		-- E' il numero della pagina da estrarre; se NULL e l'estrazione è paginata viene estratta la prima pagina
2219           			BachSizeIO				IN OUT	PLS_INTEGER,					-- Indica il massimo n.ro di record da estrarre se l'estrazione non è paginata (FlgSenzaPaginazioneIn=1)  
2220        																	-- Indica la dimensione (n.ro di record) della pagina se l'estrazione è paginata (FlgSenzaPaginazioneIn 0 o NULL) e in tal caso se non è valorizzato la dimensione della pagina è quella settata per l'utente di lavoro o è pari al valore del parametro STD_PAGE_NUM_ROW del dominio di lavoro				
2221        			OverFlowLimitIn			IN		PLS_INTEGER DEFAULT NULL,			-- E' il n.ro di record soddisfacenti la ricerca superato il quale la funzione deve restituire errore di overflow
2222        			FlgSenzaTotIn			IN		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 significa che non è richiesto come output il totale dei record soddisfacenti la ricerca (se la ricerca è paginata per la prima pagina il totale viene calcolato comunque, per le successive no)
2223        			NroTotRecOut			OUT		PLS_INTEGER,					-- E' il n.ro di record complessivi trovati (valorizzato solo se FlgSenzaTotIn è 0 o NULL o se si estrae la prima pagina)
2224             		NroRecInPaginaOut 		OUT   	PLS_INTEGER,                     		-- E' il numero di record nella pagina (valorizzato solo se l'estrazione è paginata, ovvero se FlgSenzaPaginazioneIn 0 o NULL)
2225        			------------- fine argomenti standard di tutte le funzioni di ricerca che devono restituire una lista --------------
2226        			FlgBatchSearchIn			IN		PLS_INTEGER DEFAULT NULL,					-- (valori 1/0/NULL) Se 1 significa che la stored è utilizzata da un processo batch, altrimenti da un processo online.
2227        																	-- Serve affinchè in caso l'input OverFlowLimitIn non sia valorizzato vengano applicati i limiti di overflow per processo batch o online che sono parametri di configurazione del sistema. 
2228        			ColToReturnIn			IN		VARCHAR2 DEFAULT NULL,				-- Stringa con i n.ri delle colonne dell'XML di output ResultOut che si vuole siano presenti.
2229        																	-- Se la stringa è vuota saranno presenti tutte le colonne.
2230        																	-- Le colonne 1 e 7 saranno presenti comunque.
2231        																	-- I n.ri delle varie colonne vanno separati con , o ; e se si vuole indicare un intervallo di colonne gli estremi dell'intervallo vanno separati con - (es: "1-5;7;10" significa colonne da 1 a 5 più le colonne 7 e 10)
2232        			ResultOut				OUT		NOCOPY CLOB, 					-- Lista delle UO/scrivanie/utenti trovati (XML conforme a schema LISTA_STD.xsd)
2233        																	-- Ogni soggetto trovato è un tag Riga che può contenere le seguenti colonne: 
2234        																	-- 1:  Flag UO/UT/SV che indica se si tratta di unità operativa (UO), utente senza scrivania (UT), scrivania occupata da utente (SV)
2235        																	-- 2:  Flag UO/UT che indica se si tratta di unità operativa (UO) o utente (UT) con o senza scrivania
2236        																	-- 3:  Denominazione della UO (se colonna 1=UO) o intestazione della scrivania virtuale + descrizione dell'utente e ruolo ricoperto (se colonna 1 = SV) o descrizione dell'utente e ruolo ricoperto (se colonna 1 = UT)
2237        																	-- 4: (valorizzata se colonna 1 = UO) N.ro che indica il livello gerarchico della UO
2238        																	-- 5: (valorizzata se colonna 1 = UO) Codice che indica il tipo della UO o, se il tipo non è valorizzato, n.ro che indica il livello gerarchico della UO
2239        																	-- 6: (valorizzata se colonna 1 = UO) Descrizione del tipo della UO o, se il tipo non è valorizzato, descrizione del livello gerarchico 
2240        																	-- 7:  Identificativo della UO (se colonna 1=UO) o della scrivania virtuale (se colonna 1 = SV) o dell'utente (se colonna 1 = UT)
2241        																	-- 8:  Denominazione estesa (cioè incluse le denominazioni delle UO superiori) dell'unità operativa (nel caso di utente o scrivania quella della UO cui è legato l'utente/scrivania seguita da nome della scrivania/utente)
2242        																	-- 9:  Identificativo dell’unità operativa (nel caso di utente o scrivania è quella cui è legato l'utente/scrivania)
2243        																	-- 10: Identificativo dell'utente (se colonna 1 = UT o SV) 
2244        																	-- 11: Data di istituzione della UO (se colonna 1 = UO) o di inizio associazione dell'utente alla UO (nel formato dato dal parametro di config. FMT_STD_DATA) 
2245        																	-- 12: Data di soppressione della UO (se colonna 1 = UO) o di fine associazione dell'utente alla UO (nel formato dato dal parametro di config. FMT_STD_DATA) 
2246        																	-- 13: Cod. che identifica la UO (se colonna 1 = UO) o l'utente (se colonna 1 = UT o SV) in un sistema esterno di provenienza
2247        																	-- 14: N.ri livello della UO (nel caso di utente o scrivania quelli della UO cui è legato l'utente/scrivania)
2248        																	-- 15: Descrizione della UO (quella cui è collegto l'utente/scrivania se il nodo rappresenta un utente con o senza scrivania)
2249        																	-- 16: Descrizione dell'utente (se utente con o senza scrivania)
2250        																	-- 17: Descrizione della scrivania (solo se trattasi di scrivania)
2251        																	-- 18: Identificativo del ruolo ricoperto dall'utente nella UO (se colonna 1 = UT o SV)
2252        																	-- 19: Descrizione del ruolo ricoperto dall'utente nella UO (se colonna 1 = UT o SV)
2253        																	-- 20: (se colonna 1 = UT o SV) Username dell'utente
2254        																	-- 21: (se colonna 1 = UT o SV) Titolo dell'utente
2255        																	-- 22: (se colonna 1 = UT o SV) Qualifica dell'utente
2256        																	-- 23: (valorizzata se colonna 1 = UO) Competenze della UO
2257        																	-- 24: (valorizzata se colonna 1 = UO) Storia della UO
2258        																	-- 25: (valorizzata se colonna 1 = UO) (1/0) Se 1 indica che la UO è dichiarata all'indice PA
2259        																	-- 26: (valorizzata se colonna 1 = UO)  Data in cui la UO è stata dichiarata all'indice PA (nel formato dato dal parametro di config. FMT_STD_DATA)
2260        																	-- 27: (valorizzata se colonna 1 = UO) Indirizzo della UO
2261        																	-- 28: Riferimenti telefonici della UO/utente
2262        																	-- 29: Indirizzo/i email della UO/utente
2263        																	-- 30: N.ro/i fax della UO/utente
2264        																	-- 31: Tipo di relazione dell'utente con la UO (se colonna 1 = UT o SV). Valori possibili: A = Appartenenza, L = a Lavorare per, D = Delega
2265        																	-- 32: (valori 1/0) Indica se la relazione dell'utente è anche verso le sotto-UO (se colonna 1 = UT o SV)
2266        																	-- 33: (valori 1/0) Indica se la relazione dell'utente è anche verso le altre scrivanie virtuali della UO (se colonna 1 = UT o SV)
2267        																	-- 34: (valori 1/0) Indica se l'utente è il primario tra quelli che ricoprono il suo ruolo nella UO 
2268        																	-- 			 Diventato flag di abilitazione alla documentazione riservata assegnata/in conoscenza alla UO
2269        																	-- 35: (1/0) Se 1 indica che il record è selezionabile per la finalità indicata in FinalitaIn, se 0 che non è selezionabile
2270        																	-- 36: Id. della UO padre (x le UO) o della UO di afferenza (per gli utenti/scrivanie) 
2271        																	-- 37: Azioni possibili sulla UO / relazione utente-UO. E' una stringa di 1(=consentita) o 0(=non consentita) in cui ogni posizione corrisponde ad un'azione:
2272        																	--	 1:  Creazione di un nuova sotto-uo
2273        																	--	 2:  Creazione di nuova associazione UO-utente
2274        																	--	 3:  Spostamento in altra UO
2275        																	--	 4:  Incolla di una sotto-UO già esistente
2276        																	--	 5:  Incolla di una associazione UO-utente già esistente
2277        																	--	 6:  Modifica
2278        																	--	 7:  Cancellazione
2279        																	--	 8: Selezione (per la finalità FinalitaIn)
2280        																	-- 38: Denominazione della UO padre (x le UO)  o della UO di afferenza (per gli utenti/scrivanie)
2281        																	-- 39: Score del record restituito dall'indicizzatore (valori interi da 1 a 5) (valorizzato solo se effettuata ricerca full-text)
2282        																	-- 40: Codice rapido dell'utente (se utente con o senza scrivania)
2283        																	-- 41: N.ri livello della UO in modo da ordinare per gerarchia
2284        																	-- 42: Cod. fiscale dell'utente
2285        																	-- 43: Id. della UO o utente in rubrica (se presente)
2286        																	-- 44: Flag 1/0 che indica (se 1) se è consentita l'assegnazione alla UO
2287        																	-- 45: Flag 1/0 che indica (se 1) se è consentito l'invio per conoscenza/notifica alla UO
2288        																	-- 46: Profilo dell'utente (se utente con o senza scrivania)
2289        																	-- 47: Flag 1/0 che indica se il record rappresenta una UO che è un punto di protocollo
2290        																	-- 48: Codice della UO (ultima parte, ovvero campo NRO_LIVELLO)
2291        																	-- 49: N.ro posizione della UO tra le UO sotto lo stesso padre
2292        																	-- 50: Vecchia denominazione della postazione
2293        																	-- 51: (flag 1/0) Indica se la UO/scrivania/utente è un destinatario preferito dell'utente di lavoro
2294        																	-- 52: (flag 1/0) Indica se UO/scrivania/utente che può essere anche assegnataria di cartaceo oltre che di digitale
2295        																	--				  La colonna viene calcolata solo se FinalitaIn in (MITT_DEST_CARTACEO, MITT_DEST_NO_CARTACEO, MITT_DEST, DESTINATARI, DESTINATARI_ENTRATA)
2296        																	--				  E' questo il flag che viene valutato per preimpostare l'assegnazione su un mittente/destinatario interno
2297        																	-- 53: Cognome dell'utente
2298        																	-- 54: Nome dell'utente
2299        																	-- 55: (flag 1/0) Se 1 significa che l'utente è legato alla U.O. anche o solo in quanto protocollista di punto di protocollo cui la UO afferisce
2300        																	-- 56: Livelli e denominazione del/i Punto/i di Protocollo associati alla UO
2301        																	-- 57: Flag 1/0 che indica (se 1) se è consentita l'assegnazione di e-mail alla UO
2302        																	-- 58: Flag 1/0 che indica se il record rappresenta una UO che è un punto di raccolta e-mail
2303        																	-- 59: Flag 1/0 che indica se il record rappresenta una UO che è una centrale unica appalti/ufficio gare
2304        																	-- 60: CdR/CdC della struttura (se ne ha più di prende il primo)
2305        																	-- 61: Sub-profili dell'utente
2306        																	-- 62: (1/0) flag di struttura/scrivania "abilitata alla protocollazione in entrata"
2307        																	-- 63: (1/0) flag di struttura/scrivania "abilitata alla protocollazione in uscita"
2308        																	-- 64: (1/0) flag di struttura/scrivania "abilitata alla protocollazione in uscita con qualsiasi mezzo"
2309        																	-- 65: (1/0) flag di struttura/scrivania "abilitata alla registrazione multe"
2310        																	-- 66: (1/0) flag di struttura/scrivania "abilitata alla registrazione contratti"
2311        																	-- 67: Data di cessazione proposta da sistema HR (nel formato FMT_STD_DATA)
2312        																	-- 68: (1/0) flag di struttura/scrivania di struttura "abilitata ad assegnare riservatezza"
2313        																	-- 69: Origine delle relazione utente-UO. Valori ammessi: HR = da sistema HR, M (Manuale)
2314        																	-- 70: Nro di matricola dell'utente
2315        																	-- ATTENZIONE: Se FlgIndexerOverflowIn è pari a 1, qualora la stored non vada a sua volta in overflow, dato che il resultset trovato dalla stored dovrà essere ripassato al searcher di Lucene esso non è paginato indipendentemente dal fatto che l’apposito input lo richieda. 
2316        																	--		   Inoltre nel caso di FlgIndexerOverflowIn pari a 1 dato che dopo il nuovo passaggio per il searcher di Lucene si renderà necessaria una nuova chiamata alla stored solo le colonne 1 e 7 del clob sono valorizzate sicuramente
2317        			PercorsoRicercaXMLOut		OUT	NOCOPY CLOB,						-- Lista con nomi e id. (da quella di livello più alto in giù) delle UO che compongono il percorso in cui si cerca ora (ovvero CercaInUOIO).
2318        																	-- Ogni UO nel percorso corrisponde ad un tag "Riga" con le seguenti colonne:
2319        																	-- 1: Id. della UO
2320        																	-- 2: Denominazione della UO
2321        			DettagliCercaInUOOut	OUT		NOCOPY CLOB,						-- XML contenente attributi e dati della UO CercaInUOIO (XML conforme a schema LISTA_STD.xsd). 
2322        																	-- Ogni attributo-dato è una colonna dell'unico tag Riga presente. Gli attributi-colonne sono:
2323        																	-- 1:	Valore fisso 1
2324        																	-- 2:	Identificativo univoco del nodo dell'allbero della struttura organizzativa che rappresenta la UO:
2325        																	--    / se è l'intera AOO o soggetto produttore
2326        																	--	ID_UO se è una UO
2327        																	-- 3:	Descrizione del nodo dell'allbero della struttura organizzativa che rappresenta la UO
2328        																	-- 4: Codice che indica il tipo di nodo dell'allbero della struttura organizzativa che rappresenta la UO (da utilizzare per l'imagine del nodo):
2329        																		-- SP															se è l'intero Ente/Sogg. produttore;
2330        																		-- AOO 														se è un'AOO
2331        																		-- UO_<codice del tipo di UO> 										se è una U.O.; 
2332        																	-- 5: Dettagli sul nodo dell'albero della struttura organizzativa che rappresenta la UO (da mostrare come alt dell'immagine del nodo)
2333        																	-- 6: non utilizzata
2334        																	-- 7: Id. della UO
2335        																	-- 8:(valori 1/0) Se 1 indica che la UO root è selezionabile (quando la lista della struttura organizzativa viene richiamato come lista di scelta), se 0 no
2336        																	-- 9: Id. della UO
2337        																	-- 10: non utilizzata
2338        																	-- 11: N.ro di sotto-UO direttamente contenute
2339        																	-- 12: N.ro di utenti direttamente appartenenti
2340        																	-- 13: N.ro di utenti che hanno scrivanie direttamente agganciate
2341        																	-- 14: N.ri livello della UO
2342        																	-- 15: Descrizione della UO 
2343        																	-- 16: non utilizzata
2344        																	-- 17: non utilizzata
2345        																	-- 18: Flag SP/AOO/UO che indica se si tratta di intero ente/sogg. produttore (SP), intera AOO (AOO), unità operativa (UO)
2346        																	-- 19: N.ro di livello gerarchico della UO 
2347        																	-- 20: Data di istituzione (se UO) 
2348        																	-- 21: Data di soppressione (se UO) 
2349        																	-- 22: Id. della UO padre 
2350        																	-- 23: Azioni possibili sulla UO. E' una stringa di 1(=consentita) o 0(=non consentita) in cui ogni posizione corrisponde ad un'azione:
2351        																	--	 1:  Creazione di un nuova sotto-uo
2352        																	--	 2:  Creazione di nuova associazione UO-utente
2353        																	--	 3:  Spostamento in altra UO
2354        																	--	 4:  Incolla di una sotto-UO già esistente
2355        																	--	 5:  Incolla di una associazione UO-utente già esistente
2356        																	--	 6:  Modifica
2357        																	--	 7:  Cancellazione
2358        																	--	 8: Selezione (per la finalità FinalitaIn)
2359        																	-- 25: Flag 1/0/NULL che (se 1) indica che il numero di oggetti contenuti supera il massimo consentito per esplodere la UO come nodo dell'albero della struttura organizzativa 														
2360        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
2361        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
2362        			ErrMsgOut				OUT 		VARCHAR2,						-- Messaggio d'errore
2363        			FinalitaIn				IN		VARCHAR2 DEFAULT NULL,				-- Motivo per cui viene chiamata la pagina con l'albero popolato attraverso questa funzione. Valori ammessi:
2364        																				-- ASSEGNAZIONE = Per selezionare la UO/utente/scrivania cui assegnare un documento/folder (se documento in uscita/interno) 
2365        																				-- ASSEGNAZIONE_ENTRATA = Per selezionare la UO/utente cui assegnare un documento in entrata (in questo caso l'albero mostra solo UO attive)
2366        																				-- ASS_CARTACEO = Per selezionare la UO/utente/scrivania cui assegnare documantazione cartacea
2367        																				-- ASS_NO_CARTACEO = Per selezionare la UO/utente/scrivania cui assegnare documantazione senza restrizioni del cartaceo
2368        																				-- ASS_EMAIL = Assegnazione di una mail
2369        																				-- DESTINATARI = Per selezionare la UO/utente/scrivania destinatario di documento in uscita/interno
2370        																				-- DESTINATARI_ENTRATA = Per selezionare la UO/utente/scrivania destinatario di documento in entrata
2371        																				-- MITT_DEST_CARTACEO = Per selezionare la UO/utente/scrivania mittente o destinatario di documantazione cartacea
2372        																				-- MITT_DEST_NO_CARTACEO = Per selezionare la UO/utente/scrivania mittente o destinatario di documantazione NON cartacea
2373        																				-- MITT_DEST = Per selezionare la UO/utente/scrivania mittente o destinatario di documantazione			
2374        																				-- INVIO_CC_NOTIFICA = Per selezionare la UO/utente cui inviare per conoscenza/con cui condividere/mandare osservazione su un documento/folder  (se documento in uscita/interno)
2375        																				-- INVIO_CC_NOTIFICA_ENTRATA = Per selezionare la UO/utente cui inviare per conoscenza/con cui condividere/mandare osservazione su un documento in entrata 
2376        																				-- ACL = Per selezionare UO/utenti/scrivanie da mettere in un'ACL
2377        																				-- SEL_SV = Selezione di una scrivania per assegnarla ad altro utente/UO
2378        																				-- SEL_UP = Selezione di unità di personale (utenti con o senza scrivania)
2379        																				-- SEL_PUNTI_PROT = selezione di punti di protocollo
2380        																				-- MITTENTE_REG = Mittente di registrazione (a protocollo, repertorio ecc) interna o in uscita: filtra solo i mittenti possibili
2381        																				-- SEL_RICH_PUBBL = Selezione UO mittente di un atto da pubblicare/pubblicato
2382        																				-- ALTRO = Qualsiasi altra finalità (ad esempio per selezionare UO/utenti da mettere in un gruppo)
2383        			TyObjxFinalitaIn		IN		VARCHAR2 DEFAULT NULL,				-- Dettaglia il tipo di oggetto (F = Folder, U = Unita doc, E= Email, P = Processo) cui si riferisce la finalità
2384        			IdObjxFinalitaIn		IN		VARCHAR2 DEFAULT NULL,				-- Id dell'oggetto (ID_FOLDER, ID_UD, ID_EMAIL, ID_PROCESS) cui si riferisce la finalità
2385        			RigaTagNameIn			IN		VARCHAR2 DEFAULT NULL,				-- (opzionale) Come rinominare il tag Riga dell'XML ResultOut di output
2386        			ColTagNameIn			IN		DMVA_STRING DEFAULT NULL)			-- (opzionale) Come rinominare i tag delle colonne in alternativa a Colonna Nro=.. nell'XML ResultOut di output
2387        			return PLS_INTEGER;													-- Vale 1 se tutto è andato a buon fine, altrimenti 0
2388        
2389            /******* RETROCOMPATIBILE CON ALBO ************/
2390            /******* funzione per renderizzare la struttura organizzativa o una sua porzione in una struttura ad albero     *******/
2391            /******* Ogni UO e utente collegato ad UO  è un nodo dell'albero.                                 *******/
2392            /******* Ogni nodo ha un identificativo univoco in tutta l'albero                                    *******/
2393            /******* Infatti l'identificativo di un nodo non contiene solo indicazione dell'oggetto che                 *******/
2394            /******* rappresenta ma anche del percorso di navigazione con cui vi si è arrivati                        *******/
2395            /******* La parte dell'identificativo successiva all'ultimo / è l'id. della UO/utente                     *******/
2396            /******* rappresentata dal nodo (preceduto da UT nel caso di utente)                                *******/
2397            /******* Il root node è quello di cui si rappresenta l'alberatura sottostante:                         *******/
2398            /********        se pari a / si intende l'intera struttura organizzativa dell'AOO/Soggetto produttore         *******/
2399            function NavigaStrutturaOrgTree(
2400                    CodIdConnectionTokenIn        IN        DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%type,
2401                                                                            -- (obblig). Codice identificativo del token di connessione
2402                    IdUserLavoroIn            IN        DMT_USERS.ID_USER%type DEFAULT NULL,    -- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
2403                    FlgIncludiUtentiIn        IN        PLS_INTEGER DEFAULT NULL,            -- (valori 2/1/0/NULL): se 2 indica che nell'albero vanno mostrare sia le UO e tutti gli utenti collegati (con o senza scrivania), se 1 che vanno mostrate le UO e gli utenti con scrivania, se 0 o NULL solo le UO
2404                    TipoRelUtentiConUOIn        IN        VARCHAR2 DEFAULT NULL,                -- (viene considerato solo se FlgIncludiUtentiIn>0) Indica il/i tipi di relazione che gli utenti da mostrare devono avere all'istante TsRifIn con le UO:
2405                                                                            --  Valori ammessi:
2406                                                                            --  A = Appartenenza;
2407                                                                            --  L = a Lavorare per;
2408                                                                            --  D = Delega
2409                                                                            -- o una loro cancatenazione con ";" come separatore
2410                                                                            -- Se non valorizzato è come se contenesse tutti i valori previsti
2411                    TsRifIn                IN        VARCHAR2 DEFAULT NULL,                -- (nel formato DD/MM/RRRR HH24:MI:SS) Definisce l'istante in cui va presa la "fotografia" della struttura organizzativa da rappresentare tramite l'albero.
2412                                                                            -- Se non valorizzato si intende che si vuole la fotografia attuale della struttura organizzativa
2413                    FlgSoloAttiveIn            IN        PLS_INTEGER DEFAULT 1,                -- (valori 1/0/NULL) Se 1 vengono estratte solo le UO e relazioni utente-UO valide al timestamp TsRifIn
2414                    IdRootNodeIO            IN OUT    VARCHAR2,                        -- Identificativo del nodo root.
2415                                                                            -- Se in input non è valorizzato si intende pari al nodo root definito nelle impostazioni personali dell'utente e se anche questo non è valorizzato si intende pari all'intera struttura organizzativa (ovvero /).
2416                                                                            -- Valori particolari sono:
2417                                                                            -- /         = Intera struttura organizzativa
2418                    IdNodeToExplImplIn        IN         VARCHAR2 DEFAULT NULL,                -- Identificativo del nodo (sottostante il root) da esplodere o chiudere
2419                    FlgExplodeNodeIn             IN        PLS_INTEGER DEFAULT 1,                --(valori 1/0/NULL) se 1 significa che il nodo IdNodeToExplImplIn va esploso, se 0 o NULL il nodo IdNodeToExplImplIn va chiuso
2420                    TreeXMLOut                OUT        NOCOPY CLOB,                    -- Lista con i nodi dell'albero che rappresenta la struttura-organizzativa o una sua porzione-ramo (XML conforme a schema LISTA_STD.xsd)
2421                                                                            -- Ogni folder o unità documentarie è un nodo è un tag Riga che contiene le seguenti colonne:
2422                                                                            -- 1:    Indica il livello del nodo (valori da 1 a n)
2423                                                                            -- 2:    Identificativo univoco del nodo:
2424                                                                            --    / se è l'intera AOO o soggetto produttore
2425                                                                            --    ID_UO se è una UO
2426                                                                            --    <ID_UO>.<ID_USER>.<flag del tipo di relazione (A/L/D)>.<inizio validità relazione nel formato DD/MM/RRRR>.<ID_RUOLO_AMM> se relazione UO-UTENTE
2427                                                                            -- 3:    Descrizione del nodo
2428                                                                            -- 4: Codice che indica il tipo di nodo (da utilizzare per l'imagine del nodo):
2429                                                                                -- SP                                                            se è l'intero Ente/Sogg. produttore;
2430                                                                                -- AOO                                                         se è un'AOO
2431                                                                                -- UO_<codice del tipo di UO>                                         se è una U.O.;
2432                                                                                -- SV_<flag (A/L/D) che indica il tipo di relazione dell'utente con la UO>             se è un utente con scrivania
2433                                                                                -- UT_<flag (L/D) che indica il tipo di relazione dell'utente con la UO>            se è un utente senza scrivania;
2434                                                                            -- 5: Dettagli sul nodo da mostrare come alt della descrizione del nodo
2435                                                                            -- 6:(valori 2/1/-1/0) Indica se il nodo va mostrato esploso (=2), se è esplodibile (ha "figli" in n.ro inferiore ad un limite stabilito) ma non va esploso (=1), se ha "figli" ma non è esplodibile in quanto questi superano il limite stabilito (=-1), se non è esplodibile (=0)
2436                                                                            -- 7: ID_UO o ID_SCRIVANIA o ID_USER della UO, scrivania o utente senza scrivania rappresentato dal nodo
2437                                                                            -- 8:(valori 1/0) Se 1 indica che il nodo è selezionabile (quando l'albero viene richiamato come lista di scelta), se 0 no
2438                                                                            -- 9: ID_UO della UO (quella cui è collegto l'utente/scrivania se il nodo rappresenta un utente con o senza scrivania)
2439                                                                            -- 10: ID_USER dell'utente (se il nodo rappresenta un utente con o senza scrivania)
2440                                                                            -- 11: N.ro di sotto-UO direttamente contenute nel nodo-UO
2441                                                                            -- 12: N.ro di utenti direttamente appartenenti al nodo-UO
2442                                                                            -- 13: N.ro di utenti che hanno scrivanie direttamente agganciate al nodo-UO
2443                                                                            -- 14: N.ri livello della UO (quella cui è collegto l'utente/scrivania se il nodo rappresenta un utente con o senza scrivania)
2444                                                                            -- 15: Descrizione della UO (quella cui è collegto l'utente/scrivania se il nodo rappresenta un utente con o senza scrivania)
2445                                                                            -- 16: Descrizione dell'utente (se utente con o senza scrivania)
2446                                                                            -- 17: Descrizione della scrivania (solo se trattasi di scrivania)
2447                                                                            -- 18:  Flag SP/AOO/UO/UT/SV che indica se si tratta di intero ente/sogg. produttore (SP), intera AOO (AOO), unità operativa (UO), utente senza scrivania (UT), scrivania occupata da utente (SV)
2448                                                                            -- 19: N.ro di livello gerarchico della UO
2449                                                                            -- 20: Data di istituzione (se UO) o di inizio validità relazione utente-UO(se utente con o senza scrivania)
2450                                                                            -- 21: Data di soppressione (se UO) o di fine validità relazione utente-UO(se utente con o senza scrivania)
2451                                                                            -- 22: Id. della UO padre
2452                                                                            -- 23: Azioni possibili sul nodo. E' una stringa di 1(=consentita) o 0(=non consentita) in cui ogni posizione corrisponde ad un'azione:
2453                                                                            --     1:  Creazione di un nuova sotto-uo
2454                                                                            --     2:  Creazione di nuova associazione UO-utente
2455                                                                            --     3:  Spostamento in altra UO
2456                                                                            --     4:  Incolla di una sotto-UO già esistente
2457                                                                            --     5:  Incolla di una associazione UO-utente già esistente
2458                                                                            --     6:  Modifica
2459                                                                            --     7:  Cancellazione
2460                                                                            --     8: Selezione (per la finalità FinalitaIn)
2461                                                                            -- 24: Descrizione del tipo di nodo (da usare x l'alt dell'immagine)
2462        																	-- 25: Cod. rapido dell'utente (se il nodo rappresenta un utente con o senza scrivania)
2463        																	-- 26: Cod. fiscale del utente
2464        																	-- 27: Id. dell'utente o UO in rubrica soggetti (se presente)
2465        																	-- 28: Flag 1/0 che indica (se 1) se è consentita l'assegnazione  documantazione alla UO
2466        																	-- 29: Flag 1/0 che indica (se 1) se è consentito l'invio per conoscenza/notifica alla UO
2467        																	-- 30: Flag 1/0 che indica se il nodo rappresenta una UO che è un punto di protocollo
2468        																	-- 31: Username dell'utente (se il nodo rappresenta un utente con o senza scrivania)
2469        																	-- 32: (flag 1/0) Indica se è un destinatario preferito dell'utente di lavoro
2470        																	-- 33: (flag 1/0) Indica se UO/scrivania/utente che può essere anche assegnataria di cartaceo oltre che di digitale
2471        																	--				  La colonna viene calcolata solo se FinalitaIn in (MITT_DEST_CARTACEO, MITT_DEST_NO_CARTACEO, MITT_DEST, DESTINATARI, DESTINATARI_ENTRATA)
2472        																	--				  E' questo il flag che viene valutato per preimpostare l'assegnazione su un mittente/destinatario interno
2473        																	-- 34: (flag 1/0) Se 1 significa che l'utente è legato alla U.O. anche o solo in quanto protocollista di punto di protocollo cui la UO afferisce
2474        																	-- 35: (flag 1/0) Se 1 è una UO che è un punto di raccolta mail
2475        																	-- 36: Flag 1/0 che indica (se 1) se è consentita l'assegnazione di email alla UO
2476        																	-- 37: (flag 1/0) Se 1 è una UO che è abilitata alla protocollazione in entrata
2477        																	-- 38: (flag 1/0) Se 1 è una UO che è abilitata alla protocollazione in uscita
2478                    PercorsoRootNodeXMLOut        OUT        NOCOPY CLOB,                    -- Lista con nomi e id. (da quella di livello più alto in giù) dei nodi che portano all'attuale root-node (lui incluso).
2479                                                                            -- Ogni nodo corrisponde ad un tag "Riga" con le seguenti colonne:
2480                                                                            -- 1: Id. del nodo
2481                                                                            -- 2: Descrizione del nodo
2482                                                                            -- 3: (valori 1/0) Se 1 è un nodo non esplodibile perchè ha troppi nodi figli
2483                    DettagliRootNodeOut        OUT        NOCOPY CLOB,                    -- XML contenente attributi e dati del root node da mostrare nel dettaglio sopra l'albero (XML conforme a schema LISTA_STD.xsd).
2484                                                                            -- Ogni attributo-dato è una colonna dell'unico tag Riga presente. Gli attributi-colonne sono:
2485                                                                            -- 1:    Valore fisso 1
2486                                                                            -- 2:    Identificativo univoco del nodo:
2487                                                                            --    / se è l'intera AOO o soggetto produttore
2488                                                                            --    ID_UO se è una UO
2489                                                                            --    ID_UO/rowid del record di realzione utente-UO se utente con o senza scrivania
2490                                                                            -- 3:    Descrizione del nodo
2491                                                                            -- 4: Codice che indica il tipo di nodo (da utilizzare per l'imagine del nodo):
2492                                                                                -- SP                                                            se è l'intero Ente/Sogg. produttore;
2493                                                                                -- AOO                                                         se è un'AOO
2494                                                                                -- UO_<codice del tipo di UO>                                         se è una U.O.;
2495                                                                                -- SV_<flag (A/L/D) che indica il tipo di relazione dell'utente con la UO>             se è un utente con scrivania
2496                                                                                -- UT_<flag (L/D) che indica il tipo di relazione dell'utente con la UO>            se è un utente senza scrivania;
2497                                                                            -- 5: Dettagli sul nodo da mostrare come alt della descrizione del nodo
2498                                                                            -- 6:(valori 2/1/-1/0) Indica se il nodo va mostrato esploso (=2), se è esplodibile (ha "figli" in n.ro inferiore ad un limite stabilito) ma non va esploso (=1), se ha "figli" ma non è esplodibile in quanto questi superano il limite stabilito (=-1), se non è esplodibile (=0)
2499                                                                            -- 7: ID_UO o ID_SCRIVANIA o ID_USER della UO, scrivania o utente senza scrivania rappresentato dal nodo
2500                                                                            -- 8:(valori 1/0) Se 1 indica che il nodo è selezionabile (quando l'albero viene richiamato come lista di scelta), se 0 no
2501                                                                            -- 9: ID_UO della UO (quella cui è collegto l'utente/scrivania se il nodo rappresenta un utente con o senza scrivania)
2502                                                                            -- 10: ID_USER dell'utente (se il nodo rappresenta un utente con o senza scrivania)
2503                                                                            -- 11: N.ro di sotto-UO direttamente contenute nel nodo-UO
2504                                                                            -- 12: N.ro di utenti direttamente appartenenti al nodo-UO
2505                                                                            -- 13: N.ro di utenti che hanno scrivanie direttamente agganciate al nodo-UO
2506                                                                            -- 14: N.ri livello della UO (quella cui è collegto l'utente/scrivania se il nodo rappresenta un utente con o senza scrivania)
2507                                                                            -- 15: Descrizione della UO (quella cui è collegto l'utente/scrivania se il nodo rappresenta un utente con o senza scrivania)
2508                                                                            -- 16: Descrizione dell'utente (se utente con o senza scrivania)
2509                                                                            -- 17: Descrizione della scrivania (solo se trattasi di scrivania)
2510                                                                            -- 18: Flag SP/AOO/UO/UT/SV che indica se si tratta di intero ente/sogg. produttore (SP), intera AOO (AOO), unità operativa (UO), utente senza scrivania (UT), scrivania occupata da utente (SV)
2511                                                                            -- 19: N.ro di livello gerarchico della UO
2512                                                                            -- 20: Data di istituzione (se UO) o di inizio validità relazione utente-UO(se utente con o senza scrivania)
2513                                                                            -- 21: Data di soppressione (se UO) o di fine validità relazione utente-UO(se utente con o senza scrivania)
2514                                                                            -- 22: Id. della UO padre
2515                                                                            -- 23: Azioni possibili sul nodo. E' una stringa di 1(=consentita) o 0(=non consentita) in cui ogni posizione corrisponde ad un'azione:
2516                                                                            --     1:  Creazione di un nuova sotto-uo
2517                                                                            --     2:  Creazione di nuova associazione UO-utente
2518                                                                            --     3:  Spostamento in altra UO
2519                                                                            --     4:  Incolla di una sotto-UO già esistente
2520                                                                            --     5:  Incolla di una associazione UO-utente già esistente
2521                                                                            --     6:  Modifica
2522                                                                            --     7:  Cancellazione
2523                                                                            --     8: Selezione (per la finalità FinalitaIn)
2524                                                                            -- 24: Descrizione del tipo di nodo (da usare x l'alt dell'immagine)
2525                                                                            -- 25: Flag 1/0 che (se 1) indica che il numero di oggetti contenuti supera il massimo consentito per esplodere il nodo
2526                    ErrContextOut            OUT        VARCHAR2,                        -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
2527                    ErrCodeOut                OUT        PLS_INTEGER,                    -- N.ro errore di uscita
2528                    ErrMsgOut                OUT         VARCHAR2,                        -- Messaggio d'errore
2529                    FinalitaIn                IN        VARCHAR2 DEFAULT NULL)                -- Motivo per cui viene chiamata la pagina con l'albero popolato attraverso questa funzione. Valori ammessi:
2530                                                                            -- ASSEGNAZIONE = Per selezionare la UO/utente cui assegnare un documento/folder (in questo caso l'albero mostra solo UO attive)
2531                                                                            -- ACL = Per selezionare UO/utenti da mettere in un'ACL
2532                                                                            -- SEL_SV = Selezione di una scrivania per assegnarla ad altro utente/UO
2533        																	-- SEL_RICH_PUBBL = Selezione UO mittente di un atto da pubblicare/pubblicato
2534                                                                            -- ALTRO = Qualsiasi altra finalità (ad esempio per selezionare UO/utenti da mettere in un gruppo)
2535                    return PLS_INTEGER;                                            -- Vale 1 se tutto è andato a buon fine, altrimenti 0
2536        
2537        
2538        	/******* funzione per renderizzare un'organigramma o una sua porzione in una struttura ad albero 	*******/
2539        	/******* Ogni UO e utente collegato ad UO  è un nodo dell'albero. 								*******/
2540        	/******* Ogni nodo ha un identificativo univoco in tutto l'albero								*******/
2541        	/******* L'identificativo di un nodo non contiene solo indicazione dell'oggetto che 			*******/ 
2542        	/******* rappresenta ma anche del percorso di navigazione con cui vi si è arrivati				*******/
2543        	/******* La parte dell'identificativo successiva all'ultimo / è l'id. della UO/utente 			*******/
2544        	/******* rappresentata dal nodo (preceduto da UT nel caso di utente)							*******/
2545        	/******* Il root node è quello di cui si rappresenta l'alberatura sottostante: 					*******/
2546        	/********		se pari a / si intende l'intero organigramma dell'AOO/Soggetto produttore 		*******/
2547        	function NavigaStrutturaOrgTree(
2548        			CodIdConnectionTokenIn		IN		DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%type,	
2549        																	-- (obblig). Codice identificativo del token di connessione
2550        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
2551        			FlgIncludiUtentiIn		IN		PLS_INTEGER DEFAULT NULL,			-- (valori 2/1/0/NULL): se 2 indica che nell'albero vanno mostrare sia le UO e tutti gli utenti collegati (con o senza scrivania), se 1 che vanno mostrate le UO e gli utenti con scrivania, se 0 o NULL solo le UO
2552        			TipoRelUtentiConUOIn		IN		VARCHAR2 DEFAULT NULL,				-- (viene considerato solo se FlgIncludiUtentiIn>0) Indica il/i tipi di relazione che gli utenti da mostrare devono avere all'istante TsRifIn con le UO:
2553        																	--  Valori ammessi:
2554        																	--  A = Appartenenza gerarchica; 
2555        																	--  D = Funzionale, 
2556        																	--  P = Protocollista, 
2557        																	--  L = gestione documentazione assegnata/inviata (NON protocollista)
2558        																	-- o una loro cancatenazione con ";" come separatore
2559        																	-- Se non valorizzato è come se contenesse tutti i valori previsti
2560        			TsRifIn				IN		VARCHAR2 DEFAULT NULL,				-- (nel formato DD/MM/RRRR HH24:MI:SS) Definisce l'istante in cui va presa la "fotografia" della struttura organizzativa da rappresentare tramite l'albero. 
2561        																	-- Se non valorizzato si intende che si vuole la fotografia attuale della struttura organizzativa	
2562        			FlgSoloAttiveIn			IN		PLS_INTEGER DEFAULT 1,				-- (valori 1/0/NULL) Se 1 vengono estratte solo le UO e relazioni utente-UO valide al timestamp TsRifIn 
2563        			IdRootNodeIO			IN OUT	VARCHAR2,				-- Identificativo del nodo root. 
2564        																	-- Se in input non è valorizzato si intende pari al nodo root definito nelle impostazioni personali dell'utente e se anche questo non è valorizzato si intende pari all'intera struttura organizzativa (ovvero /).
2565        																	-- Valori particolari sono: 
2566        																	-- / 		= Intero organigramma
2567        			IdOrganigrammaIO		IN OUT	DMT_ORGANIGRAMMI.ID_ORGANIGRAMMA%type,
2568        																	-- IN INPUT: Id. dell'organigramma di cui mostrare i nodi
2569        																	-- può non essere specificato se IdRootNodeIO è valorizzato in input e diverso da /
2570        																	-- Se non specificato e non ricavabile da IdRootNodeIO l'organigramma che si carica è quello in vigore - attualmente o alla data specificata in TsRifIn - per l'Ente/AOO cui si è collegati (e se questo non è determinabile viene dato errore)
2571        																	-- IN OUTPUT è l'ID dell'organigramma rapparesentato dall'albero
2572        			IdNodeToExplImplIn		IN 		VARCHAR2 DEFAULT NULL,				-- Identificativo del nodo (sottostante il root) da esplodere o chiudere 
2573        			FlgExplodeNodeIn 			IN		PLS_INTEGER DEFAULT 1,				--(valori 1/0/NULL) se 1 significa che il nodo IdNodeToExplImplIn va esploso, se 0 o NULL il nodo IdNodeToExplImplIn va chiuso
2574        			TreeXMLOut				OUT		NOCOPY CLOB,					-- Lista con i nodi dell'albero che rappresenta la struttura-organizzativa o una sua porzione-ramo (XML conforme a schema LISTA_STD.xsd)
2575        																	-- Ogni nodo è un tag Riga che contiene le seguenti colonne:
2576        																	-- 1:	Indica il livello del nodo (valori da 1 a n)
2577        																	-- 2:	Identificativo univoco del nodo:
2578        																	--  / se è l'intero organigramma dell'AOO o del soggetto produttore
2579        																	--	se è una UO: ID_UO preceduto dagli ID_UO delle UO gerarchicamente superiori (tutti gli ID_UO precedeuti da /)
2580        																	--	se è una scrivania/utente: <ID_NODO della UO>.<ID_USER>.<flag del tipo di relazione (A/L/D)>.<inizio validità relazione nel formato DD/MM/RRRR>.<ID_RUOLO_AMM> se relazione UO-UTENTE
2581        																	-- 3:	Descrizione del nodo
2582        																	-- 4: Codice che indica il tipo di nodo (da utilizzare per l'imagine del nodo):
2583        																		-- SP															se è l'intero Ente/Sogg. produttore;
2584        																		-- AOO 														se è un'AOO
2585        																		-- UO_<codice del tipo di UO> 										se è una U.O.; 
2586        																		-- SV_<flag (A/L/D) che indica il tipo di relazione dell'utente con la UO> 			se è un utente con scrivania
2587        																		-- UT_<flag (L/D) che indica il tipo di relazione dell'utente con la UO>			se è un utente senza scrivania;
2588        																	-- 5: Dettagli sul nodo da mostrare come alt della descrizione del nodo
2589        																	-- 6:(valori 2/1/-1/0) Indica se il nodo va mostrato esploso (=2), se è esplodibile (ha "figli" in n.ro inferiore ad un limite stabilito) ma non va esploso (=1), se ha "figli" ma non è esplodibile in quanto questi superano il limite stabilito (=-1), se non è esplodibile (=0)
2590        																	-- 7: ID_UO o ID_SCRIVANIA o ID_USER della UO, scrivania o utente senza scrivania rappresentato dal nodo
2591        																	-- 8:(valori 1/0) Se 1 indica che il nodo è selezionabile (quando l'albero viene richiamato come lista di scelta), se 0 no
2592        																	-- 9: ID_UO della UO (quella cui è collegto l'utente/scrivania se il nodo rappresenta un utente con o senza scrivania)
2593        																	-- 10: ID_USER dell'utente (se il nodo rappresenta un utente con o senza scrivania)
2594        																	-- 11: N.ro di sotto-UO direttamente contenute nel nodo-UO
2595        																	-- 12: N.ro di utenti direttamente appartenenti al nodo-UO
2596        																	-- 13: N.ro di utenti che hanno scrivanie direttamente agganciate al nodo-UO
2597        																	-- 14: N.ri livello della UO (quella cui è collegto l'utente/scrivania se il nodo rappresenta un utente con o senza scrivania)
2598        																	-- 15: Descrizione della UO (quella cui è collegto l'utente/scrivania se il nodo rappresenta un utente con o senza scrivania)
2599        																	-- 16: Descrizione dell'utente (se utente con o senza scrivania)
2600        																	-- 17: Descrizione della scrivania (solo se trattasi di scrivania)
2601        																	-- 18:  Flag SP/AOO/UO/UT/SV che indica se si tratta di intero ente/sogg. produttore (SP), intera AOO (AOO), unità operativa (UO), utente senza scrivania (UT), scrivania occupata da utente (SV)
2602        																	-- 19: N.ro di livello gerarchico della UO 
2603        																	-- 20: Data di istituzione (se UO) o di inizio validità relazione utente-UO(se utente con o senza scrivania)
2604        																	-- 21: Data di soppressione (se UO) o di fine validità relazione utente-UO(se utente con o senza scrivania)
2605        																	-- 22: Id. della UO padre 
2606        																	-- 23: Azioni possibili sul nodo. E' una stringa di 1(=consentita) o 0(=non consentita) in cui ogni posizione corrisponde ad un'azione:
2607        																	--	 1:  Creazione di un nuova sotto-uo
2608        																	--	 2:  Creazione di nuova associazione UO-utente
2609        																	--	 3:  Spostamento in altra UO
2610        																	--	 4:  Incolla di una sotto-UO già esistente
2611        																	--	 5:  Incolla di una associazione UO-utente già esistente
2612        																	--	 6:  Modifica
2613        																	--	 7:  Cancellazione
2614        																	--	 8: Selezione (per la finalità FinalitaIn)	
2615        																	-- 24: Descrizione del tipo di nodo (da usare x l'alt dell'immagine)
2616        																	-- 25: Cod. rapido dell'utente (se il nodo rappresenta un utente con o senza scrivania)
2617        																	-- 26: Cod. fiscale del utente
2618        																	-- 27: Id. dell'utente o UO in rubrica soggetti (se presente)
2619        																	-- 28: Flag 1/0 che indica (se 1) se è consentita l'assegnazione di documantazione alla UO
2620        																	-- 29: Flag 1/0 che indica (se 1) se è consentito l'invio per conoscenza/notifica alla UO
2621        																	-- 30: Flag 1/0 che indica se il nodo rappresenta una UO che è un punto di protocollo
2622        																	-- 31: Username dell'utente (se il nodo rappresenta un utente con o senza scrivania)
2623        																	-- 32: (flag 1/0) Indica se è un destinatario preferito dell'utente di lavoro
2624        																	-- 33: (flag 1/0) Indica se UO/scrivania/utente che può essere anche assegnataria di cartaceo
2625        																	--				La colonna viene calcolata solo se FinalitaIn in (MITT_DEST_CARTACEO, MITT_DEST_NO_CARTACEO, MITT_DEST)
2626        																	-- 34: (flag 1/0) Se 1 significa che l'utente è legato alla U.O. anche o solo in quanto protocollista di punto di protocollo cui la UO afferisce
2627        																	-- 35: (flag 1/0) Se 1 è una UO che è un punto di raccolta mail
2628        																	-- 36: Flag 1/0 che indica (se 1) se è consentita l'assegnazione di email alla UO
2629        			PercorsoRootNodeXMLOut		OUT		NOCOPY CLOB,		-- Lista con nomi e id. (da quella di livello più alto in giù) dei nodi che portano all'attuale root-node (lui incluso).
2630        																	-- Ogni nodo corrisponde ad un tag "Riga" con le seguenti colonne:
2631        																	-- 1: Id. del nodo
2632        																	-- 2: Nome del nodo
2633        																	-- 3: Id. della UO che il nodo rappresenta
2634        																	-- 4: (valori 1/0) Se 1 è un nodo non esplodibile perchè ha troppi nodi figli
2635        			                                                        -- 5: N.ri livello della UO (quella cui è collegto l'utente/scrivania se il nodo rappresenta un utente con o senza scrivania)
2636        			DettagliRootNodeOut		OUT		NOCOPY CLOB,			-- XML contenente attributi e dati del root node da mostrare nel dettaglio sopra l'albero (XML conforme a schema LISTA_STD.xsd). 
2637        																	-- viene restituito SOLO se il parametro compatibilty_level<=2
2638        																	-- Ogni attributo-dato è una colonna dell'unico tag Riga presente. Gli attributi-colonne sono:
2639        																	-- 1:	Valore fisso 1
2640        																	-- 2:	Identificativo univoco del nodo:
2641        																	--    / se è l'intera AOO o soggetto produttore
2642        																	--	ID_UO se è una UO
2643        																	--	ID_UO/rowid del record di realzione utente-UO se utente con o senza scrivania
2644        																	-- 3:	Descrizione del nodo
2645        																	-- 4: Codice che indica il tipo di nodo (da utilizzare per l'imagine del nodo):
2646        																		-- SP															se è l'intero Ente/Sogg. produttore;
2647        																		-- AOO 														se è un'AOO
2648        																		-- UO_<codice del tipo di UO> 										se è una U.O.; 
2649        																		-- SV_<flag (A/L/D) che indica il tipo di relazione dell'utente con la UO> 			se è un utente con scrivania
2650        																		-- UT_<flag (L/D) che indica il tipo di relazione dell'utente con la UO>			se è un utente senza scrivania;
2651        																	-- 5: Dettagli sul nodo da mostrare come alt della descrizione del nodo
2652        																	-- 6:(valori 2/1/-1/0) Indica se il nodo va mostrato esploso (=2), se è esplodibile (ha "figli" in n.ro inferiore ad un limite stabilito) ma non va esploso (=1), se ha "figli" ma non è esplodibile in quanto questi superano il limite stabilito (=-1), se non è esplodibile (=0)
2653        																	-- 7: ID_UO o ID_SCRIVANIA o ID_USER della UO, scrivania o utente senza scrivania rappresentato dal nodo
2654        																	-- 8:(valori 1/0) Se 1 indica che il nodo è selezionabile (quando l'albero viene richiamato come lista di scelta), se 0 no
2655        																	-- 9: ID_UO della UO (quella cui è collegto l'utente/scrivania se il nodo rappresenta un utente con o senza scrivania)
2656        																	-- 10: ID_USER dell'utente (se il nodo rappresenta un utente con o senza scrivania)
2657        																	-- 11: N.ro di sotto-UO direttamente contenute nel nodo-UO
2658        																	-- 12: N.ro di utenti direttamente appartenenti al nodo-UO
2659        																	-- 13: N.ro di utenti che hanno scrivanie direttamente agganciate al nodo-UO
2660        																	-- 14: N.ri livello della UO (quella cui è collegto l'utente/scrivania se il nodo rappresenta un utente con o senza scrivania)
2661        																	-- 15: Descrizione della UO (quella cui è collegto l'utente/scrivania se il nodo rappresenta un utente con o senza scrivania)
2662        																	-- 16: Descrizione dell'utente (se utente con o senza scrivania)
2663        																	-- 17: Descrizione della scrivania (solo se trattasi di scrivania)
2664        																	-- 18: Flag SP/AOO/UO/UT/SV che indica se si tratta di intero ente/sogg. produttore (SP), intera AOO (AOO), unità operativa (UO), utente senza scrivania (UT), scrivania occupata da utente (SV)
2665        																	-- 19: N.ro di livello gerarchico della UO 
2666        																	-- 20: Data di istituzione (se UO) o di inizio validità relazione utente-UO(se utente con o senza scrivania)
2667        																	-- 21: Data di soppressione (se UO) o di fine validità relazione utente-UO(se utente con o senza scrivania)
2668        																	-- 22: Id. della UO padre 
2669        																	-- 23: Azioni possibili sul nodo. E' una stringa di 1(=consentita) o 0(=non consentita) in cui ogni posizione corrisponde ad un'azione:
2670        																	--	 1:  Creazione di un nuova sotto-uo
2671        																	--	 2:  Creazione di nuova associazione UO-utente
2672        																	--	 3:  Spostamento in altra UO
2673        																	--	 4:  Incolla di una sotto-UO già esistente
2674        																	--	 5:  Incolla di una associazione UO-utente già esistente
2675        																	--	 6:  Modifica
2676        																	--	 7:  Cancellazione
2677        																	--	 8: Selezione (per la finalità FinalitaIn)
2678        																	-- 24: Descrizione del tipo di nodo (da usare x l'alt dell'immagine) 
2679        																	-- 25: Flag 1/0 che (se 1) indica che il numero di oggetti contenuti supera il massimo consentito per esplodere il nodo
2680        			ErrContextOut			OUT		VARCHAR2,				-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
2681        			ErrCodeOut				OUT		PLS_INTEGER,			-- N.ro errore di uscita
2682        			ErrMsgOut				OUT 		VARCHAR2,			-- Messaggio d'errore
2683        			FinalitaIn				IN		VARCHAR2 DEFAULT NULL,	-- Motivo per cui viene chiamata la pagina con l'albero popolato attraverso questa funzione. Valori ammessi:
2684        																	-- ASSEGNAZIONE = Per selezionare la UO/utente cui assegnare un documento/folder (se documento in uscita/interno) (in questo caso l'albero mostra solo UO attive)
2685        																	-- ASSEGNAZIONE_ENTRATA = Per selezionare la UO/utente cui assegnare un documento in entrata (in questo caso l'albero mostra solo UO attive)
2686        																	-- ASS_CARTACEO = Per selezionare la UO/utente/scrivania cui assegnare documantazione cartacea
2687        																	-- ASS_NO_CARTACEO = Per selezionare la UO/utente/scrivania cui assegnare documantazione senza restrizioni del cartaceo
2688        																	-- ASS_EMAIL = Assegnazione di una mail
2689        																	-- DESTINATARI = Per selezionare la UO/utente/scrivania destinatario di documento in uscita/interno
2690        																	-- DESTINATARI_ENTRATA = Per selezionare la UO/utente/scrivania destinatario di documento in entrata
2691        																	-- MITT_DEST_CARTACEO = Per selezionare la UO/utente/scrivania mittente o destinatario di documantazione cartacea
2692        																	-- MITT_DEST_NO_CARTACEO = Per selezionare la UO/utente/scrivania mittente o destinatario di documantazione NON cartacea
2693        																	-- MITT_DEST = Per selezionare la UO/utente/scrivania mittente o destinatario di documantazione			
2694        																	-- INVIO_CC_NOTIFICA = Per selezionare la UO/utente cui inviare per conoscenza/con cui condividere/mandare osservazione su un documento/folder  (se documento in uscita/interno)
2695        																	-- INVIO_CC_NOTIFICA_ENTRATA = Per selezionare la UO/utente cui inviare per conoscenza/con cui condividere/mandare osservazione su un documento in entrata 
2696        																	-- ACL = Per selezionare UO/utenti da mettere in un'ACL
2697        																	-- SEL_SV = Selezione di una scrivania per assegnarla ad altro utente/UO
2698        																	-- SEL_UP = Selezione di unità di personale (utenti con o senza scrivania)
2699        																	-- SEL_PUNTI_PROT = selezione di punti di protocollo
2700        																	-- SEL_RICH_PUBBL = Selezione UO mittente di un atto da pubblicare/pubblicato
2701        																	-- ALTRO = Qualsiasi altra finalità (ad esempio per selezionare UO/utenti da mettere in un gruppo)
2702        			FlgNoDatiRootNodeIn			IN	PLS_INTEGER DEFAULT NULL,
2703        																	-- (valori 1/0/NULL) Se 1 indica che non serve che siano calcolati e restituiti in output PercorsoRootNodeXMLOut e DettagliRootNodeOut
2704        			TyObjxFinalitaIn		IN		VARCHAR2 DEFAULT NULL,	-- Dettaglia il tipo di oggetto (F = Folder, U = Unita doc, E = Email, P = Processo) cui si riferisce la finalità
2705        			IdObjxFinalitaIn		IN		VARCHAR2 DEFAULT NULL	-- Id dell'oggetto (ID_FOLDER, ID_UD, ID_EMAIL, ID_PROCESS) cui si riferisce la finalità
2706        			)
2707        			return PLS_INTEGER;										-- Vale 1 se tutto è andato a buon fine, altrimenti 0
2708        
2709        	/******* funzione per renderizzare i nodi figli di un nodo dell'albero del organigramma che abbia figli (i.e. una UO/struttura)	*******/
2710        	function ExplodeTreeNode(
2711        			CodIdConnectionTokenIn	IN		DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%type,	
2712        																	-- (obblig). Codice identificativo del token di connessione
2713        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	
2714        																	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
2715        			FlgIncludiUtentiIn		IN		PLS_INTEGER DEFAULT NULL,			-- (valori 2/1/0/NULL): se 2 indica che nell'albero vanno mostrare sia le UO e tutti gli utenti collegati (con o senza scrivania), se 1 che vanno mostrate le UO e gli utenti con scrivania, se 0 o NULL solo le UO
2716        			TipoRelUtentiConUOIn		IN		VARCHAR2 DEFAULT NULL,				-- (viene considerato solo se FlgIncludiUtentiIn>0) Indica il/i tipi di relazione che gli utenti da mostrare devono avere all'istante TsRifIn con le UO:
2717        																	--  Valori ammessi:
2718        																	--  A = Appartenenza gerarchica; 
2719        																	--  D = Funzionale, 
2720        																	--  P = Protocollista, 
2721        																	--  L = gestione documentazione assegnata/inviata (NON protocollista)
2722        																	-- o una loro cancatenazione con ";" come separatore
2723        																	-- Se non valorizzato è come se contenesse tutti i valori previsti
2724        			TsRifIn				IN		VARCHAR2 DEFAULT NULL,		-- (nel formato DD/MM/RRRR HH24:MI:SS) Definisce l'istante in cui va presa la "fotografia" della struttura organizzativa da rappresentare tramite l'albero. 
2725        																	-- Se non valorizzato si intende che si vuole la fotografia attuale della struttura organizzativa	
2726        			FlgSoloAttiveIn			IN		PLS_INTEGER DEFAULT 1,	-- (valori 1/0/NULL) Se 1 vengono estratte solo le UO e relazioni utente-UO valide al timestamp TsRifIn 
2727        			IdOrganigrammaIn		IN		DMT_ORGANIGRAMMI.ID_ORGANIGRAMMA%type,
2728        																	-- (obblig.) Identificativo dell'organigramma di cui esplodere il nodo
2729        			IdNodeToExplodeIn		IN 		VARCHAR2 DEFAULT NULL,	-- (obblig.) Identificativo del nodo da esplodere
2730        			TreeXMLOut				OUT		NOCOPY CLOB,			-- Lista con i nodi figli del nodo da esplodere (XML conforme a schema LISTA_STD.xsd)
2731        																	-- Ogni nodo è un tag Riga che contiene le seguenti colonne:
2732        																	-- 1:	Indica il livello del nodo (valori da 1 a n)
2733        																	-- 2:	Identificativo univoco del nodo:
2734        																	--  / se è l'intero organigramma dell'AOO o del soggetto produttore
2735        																	--	se è una UO: ID_UO preceduto dagli ID_UO delle UO gerarchicamente superiori (tutti gli ID_UO precedeuti da /)
2736        																	--	se è una scrivania/utente: <ID_NODO della UO>.<ID_USER>.<flag del tipo di relazione (A/L/D)>.<inizio validità relazione nel formato DD/MM/RRRR>.<ID_RUOLO_AMM> se relazione UO-UTENTE
2737        																	-- 3:	Descrizione del nodo
2738        																	-- 4: Codice che indica il tipo di nodo (da utilizzare per l'imagine del nodo):
2739        																		-- UO_<codice del tipo di UO> 										se è una U.O.; 
2740        																		-- SV_<flag (A/L/D) che indica il tipo di relazione dell'utente con la UO> 			se è un utente con scrivania
2741        																		-- UT_<flag (L/D) che indica il tipo di relazione dell'utente con la UO>			se è un utente senza scrivania;
2742        																	-- 5: Dettagli sul nodo da mostrare come alt della descrizione del nodo
2743        																	-- 6:(valori 2/1/-1/0) Indica se il nodo va mostrato esploso (=2), se è esplodibile (ha "figli" in n.ro inferiore ad un limite stabilito) ma non va esploso (=1), se ha "figli" ma non è esplodibile in quanto questi superano il limite stabilito (=-1), se non è esplodibile (=0)
2744        																	-- 7: ID_UO o ID_SCRIVANIA o ID_USER della UO, scrivania o utente senza scrivania rappresentato dal nodo
2745        																	-- 8:(valori 1/0) Se 1 indica che il nodo è selezionabile (quando l'albero viene richiamato come lista di scelta), se 0 no
2746        																	-- 9: ID_UO della UO (quella cui è collegto l'utente/scrivania se il nodo rappresenta un utente con o senza scrivania)
2747        																	-- 10: ID_USER dell'utente (se il nodo rappresenta un utente con o senza scrivania)
2748        																	-- 11: N.ro di sotto-UO direttamente contenute nel nodo-UO
2749        																	-- 12: N.ro di utenti direttamente appartenenti al nodo-UO
2750        																	-- 13: N.ro di utenti che hanno scrivanie direttamente agganciate al nodo-UO
2751        																	-- 14: N.ri livello della UO (quella cui è collegto l'utente/scrivania se il nodo rappresenta un utente con o senza scrivania)
2752        																	-- 15: Descrizione della UO (quella cui è collegto l'utente/scrivania se il nodo rappresenta un utente con o senza scrivania)
2753        																	-- 16: Descrizione dell'utente (se utente con o senza scrivania)
2754        																	-- 17: Descrizione della scrivania (solo se trattasi di scrivania)
2755        																	-- 18:  Flag SP/AOO/UO/UT/SV che indica se si tratta di intero ente/sogg. produttore (SP), intera AOO (AOO), unità operativa (UO), utente senza scrivania (UT), scrivania occupata da utente (SV)
2756        																	-- 19: N.ro di livello gerarchico della UO 
2757        																	-- 20: Data di istituzione (se UO) o di inizio validità relazione utente-UO(se utente con o senza scrivania)
2758        																	-- 21: Data di soppressione (se UO) o di fine validità relazione utente-UO(se utente con o senza scrivania)
2759        																	-- 22: Id. della UO padre 
2760        																	-- 23: Azioni possibili sul nodo. E' una stringa di 1(=consentita) o 0(=non consentita) in cui ogni posizione corrisponde ad un'azione:
2761        																	--	 1:  Creazione di un nuova sotto-uo
2762        																	--	 2:  Creazione di nuova associazione UO-utente
2763        																	--	 3:  Spostamento in altra UO
2764        																	--	 4:  Incolla di una sotto-UO già esistente
2765        																	--	 5:  Incolla di una associazione UO-utente già esistente
2766        																	--	 6:  Modifica
2767        																	--	 7:  Cancellazione
2768        																	--	 8: Selezione (per la finalità FinalitaIn)	
2769        																	-- 24: Descrizione del tipo di nodo (da usare x l'alt dell'immagine)
2770        																	-- 25: Cod. rapido dell'utente (se il nodo rappresenta un utente con o senza scrivania)
2771        																	-- 26: Cod. fiscale del utente
2772        																	-- 27: Id. dell'utente o UO in rubrica soggetti (se presente)
2773        																	-- 28: Flag 1/0 che indica (se 1) se è consentita l'assegnazione di documantazione alla UO
2774        																	-- 29: Flag 1/0 che indica (se 1) se è consentito l'invio per conoscenza/notifica alla UO
2775        																	-- 30: Flag 1/0 che indica se il nodo rappresenta una UO che è un punto di protocollo
2776        																	-- 31: Username dell'utente (se il nodo rappresenta un utente con o senza scrivania)
2777        																	-- 32: (flag 1/0) Indica se è un destinatario preferito dell'utente di lavoro
2778        																	-- 33: (flag 1/0) Indica se UO/scrivania/utente che può essere anche assegnataria di cartaceo
2779        																	--				La colonna viene calcolata solo se FinalitaIn in (MITT_DEST_CARTACEO, MITT_DEST_NO_CARTACEO, MITT_DEST)
2780        																	-- 34: (flag 1/0) Se 1 significa che l'utente è legato alla U.O. anche o solo in quanto protocollista di punto di protocollo cui la UO afferisce
2781        																	-- 35: (flag 1/0) Se 1 è una UO che è un punto di raccolta mail
2782        																	-- 36: Flag 1/0 che indica (se 1) se è consentita l'assegnazione di email alla UO
2783        			ErrContextOut			OUT		VARCHAR2,				-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
2784        			ErrCodeOut				OUT		PLS_INTEGER,			-- N.ro errore di uscita
2785        			ErrMsgOut				OUT 		VARCHAR2,			-- Messaggio d'errore
2786        			FinalitaIn				IN		VARCHAR2 DEFAULT NULL,	-- Motivo per cui viene chiamata la pagina con l'albero dell'organigramma. Valori ammessi:
2787        																	-- ASSEGNAZIONE = Per selezionare la UO/utente cui assegnare un documento/folder (in questo caso l'albero mostra solo UO attive)
2788        																	-- ASS_CARTACEO = Per selezionare la UO/utente/scrivania cui assegnare documantazione cartacea
2789        																	-- ASS_NO_CARTACEO = Per selezionare la UO/utente/scrivania cui assegnare documantazione senza restrizioni del cartaceo
2790        																	-- ASS_EMAIL = Assegnazione di una mail
2791        																	-- MITT_DEST_CARTACEO = Per selezionare la UO/utente/scrivania mittente o destinatario di documantazione cartacea
2792        																	-- MITT_DEST_NO_CARTACEO = Per selezionare la UO/utente/scrivania mittente o destinatario di documantazione NON cartacea
2793        																	-- MITT_DEST = Per selezionare la UO/utente/scrivania mittente o destinatario di documantazione
2794        																	-- INVIO_CC_NOTIFICA = Per selezionare la UO/utente cui inviare per conoscenza/con cui condividere/mandare osservazione su un documento/folder (in questo caso l'albero mostra solo UO attive)
2795        																	-- ACL = Per selezionare UO/utenti da mettere in un'ACL
2796        																	-- SEL_SV = Selezione di una scrivania per assegnarla ad altro utente/UO
2797        																	-- SEL_UP = Selezione di unità di personale (utenti con o senza scrivania)
2798        																	-- SEL_PUNTI_PROT = selezione di punti di protocollo
2799        																	-- SEL_RICH_PUBBL = Selezione UO mittente di un atto da pubblicare/pubblicato
2800        																	-- ALTRO = Qualsiasi altra finalità (ad esempio per selezionare UO/utenti da mettere in un gruppo)
2801        			TyObjxFinalitaIn		IN		VARCHAR2 DEFAULT NULL,	-- Dettaglia il tipo di oggetto (F = Folder, U = Unita doc, E= Email, P = Processo) cui si riferisce la finalità
2802        			IdObjxFinalitaIn		IN		VARCHAR2 DEFAULT NULL	-- Id dell'oggetto (ID_FOLDER, ID_UD, ID_EMAIL, ID_PROCESS) cui si riferisce la finalità
2803        			) return PLS_INTEGER;									-- Vale 1 se tutto è andato a buon fine, altrimenti 0
2804        
2805        	/****** funzione per ottenere l'ID_NODO del nodo che rappresenta una certa struttura/UO nell'albero che rappresenta l'organigramma cui la UO/struttura appartiene	****/
2806        	function GetIdNodo (
2807        			CodIdConnectionTokenIn	IN		DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%type,	
2808        																			-- (obblig). Codice identificativo del token di connessione
2809        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	
2810        																			-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
2811        			IdUOIn 					IN		DMT_STRUTTURA_ORG.ID_UO%type,	-- Id. della UO/struttura
2812        			IdOrganigrammaIn		IN		DMT_ORGANIGRAMMI.ID_ORGANIGRAMMA%type,
2813        																			-- (obblig.) Id. dell'organigramma
2814        			IdNodoOut				OUT		VARCHAR2,						-- Id. nodo corrispondente alla UO/struttura
2815        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
2816        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
2817        			ErrMsgOut				OUT 	VARCHAR2						-- Messaggio d'errore
2818        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine, altrimenti 0
2819        
2820        	/******	funzione per sapere se i contenuti di un certo folder-UO (quelli "direttamente" innestati nel folder) si possono listare tutti, 			*****/
2821        	/*****	senza effettuare prima una ricerca, nella lista a destra della finestra di "esplora risorse" con cui si esplora il titolario				*****/
2822        	/****** folder particolari: IdUOIn = NULL => "folder" dell'intero organigramma il cui ID è IdPOrganigrammaIn in input								*****/
2823        	function TestShowFolderContentAllowed(
2824        			CodIdConnectionTokenIn	IN		DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%type,	
2825        																			-- (obblig). Codice identificativo del token di connessione
2826        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	
2827        																			-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
2828        			IdOrganigrammaIn		IN 		DMT_ORGANIGRAMMI.ID_ORGANIGRAMMA%type DEFAULT NULL,
2829        																			-- (obblig.) Id. dell'organigrmma in cui effettuare la verifica
2830        			IdUOIn 					IN		DMT_STRUTTURA_ORG.ID_UO%type,	-- ID_UO del folder-UO 
2831        																			-- se NON è valorizzato si intende l'intero organigramma che ha come Id. il valore specificato in IdOrganigrammaIn
2832        			FlgShowContentAllowedOut OUT	PLS_INTEGER,					-- (valori 1/0) Se 1 significa che per il folder-UO IdUOIn si possono mostrare come lista i contenuti
2833        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
2834        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
2835        			ErrMsgOut				OUT 	VARCHAR2,						-- Messaggio d'errore
2836        			FlgIncludiUtentiIn		IN		PLS_INTEGER DEFAULT NULL,		-- (valori 2/1/0/NULL): se 2 indica che per la verifica vengono conteggiate sia le UO che tutti gli utenti collegati (con o senza scrivania), se 1 che vanno conteggiate le UO e gli utenti con scrivania, se 0 o NULL solo le UO
2837        			TipoRelUtentiConUOIn		IN		VARCHAR2 DEFAULT NULL,		-- (viene considerato solo se FlgIncludiUtentiIn>0) Indica il/i tipi di relazione da conteggiare per la verifica:
2838        																			--  Valori ammessi:
2839        																			--  A = Appartenenza; 
2840        																			--  L = a Lavorare per; 
2841        																			--  D = Delega
2842        																			-- o una loro cancatenazione con ";" come separatore
2843        																			-- Se non valorizzato è come se contenesse tutti i valori previsti
2844        			TsRifIn					IN		VARCHAR2 DEFAULT NULL,			-- (nel formato DD/MM/RRRR HH24:MI:SS) Definisce l'istante in cui va presa la "fotografia" dell'organigramma su cui effettuare la verifica
2845        																			-- Se non valorizzato si intende la situazione attuale dell'organigramma	
2846        			FlgSoloAttiveIn			IN		PLS_INTEGER DEFAULT 1,			-- (valori 1/0/NULL) Se 1 per la verifica vengono conteggiate solo le UO e relazioni utente-UO valide al timestamp TsRifIn 
2847        			FinalitaIn				IN		VARCHAR2 DEFAULT NULL			-- Motivo per cui si sta navigando/ricercando nella pagina con l'albero dell'organigramma. Valori ammessi:
2848        																			-- ASSEGNAZIONE = Per selezionare la UO/utente cui assegnare un documento/folder (in questo caso l'albero mostra solo UO attive)
2849        																			-- ASS_CARTACEO = Per selezionare la UO/utente/scrivania cui assegnare documantazione cartacea
2850        																			-- ASS_NO_CARTACEO = Per selezionare la UO/utente/scrivania cui assegnare documantazione senza restrizioni del cartaceo
2851        																			-- ASS_EMAIL = Assegnazione di una mail
2852        																			-- INVIO_CC_NOTIFICA = Per selezionare la UO/utente cui inviare per conoscenza/con cui condividere/mandare osservazione su un documento/folder 
2853        																			-- ACL = Per selezionare UO/utenti da mettere in un'ACL
2854        																			-- SEL_SV = Selezione di una scrivania per assegnarla ad altro utente/UO
2855        																			-- SEL_UP = Selezione di unità di personale (utenti con o senza scrivania)
2856        																			-- ALTRO = Qualsiasi altra finalità (ad esempio per selezionare UO/utenti da mettere in un gruppo)
2857        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine, altrimenti 0
2858        
2859        	/****** funzione per ottenere i dati - come xml- dei livelli di un percorso che corrisponde ad una certa UO (il cui ID è fornito in input)			*****/
2860        	/****** se l'ID in input, IdUOIn, è NULL si intende l'intero piano di classificazione il cui ID è IdOrganigrammaIn in input							*****/
2861        	function GetLivPathExUO(
2862        			CodIdConnectionTokenIn	IN		DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%type,	
2863        																			-- (obblig). Codice identificativo del token di connessione
2864        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	
2865        																			-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
2866        			IdOrganigrammaIn		IN 		DMT_ORGANIGRAMMI.ID_ORGANIGRAMMA%type DEFAULT NULL,
2867        																			-- (obblig.) Id. dell'organigramma cui appartiene il folder-UO
2868        			IdUOIn 					IN		DMT_STRUTTURA_ORG.ID_UO%type,	-- ID_UO della UO/struttura di cui determinare i livelli del percorso corrispondente
2869        																			-- se NULL si intende l'intero organigramma
2870        			PercorsoXMLOut			OUT	NOCOPY CLOB,						-- Lista con i dati dei livelli del percorso corrispondente alla UO 
2871        																			-- Ogni cartella/UO nel percorso corrisponde ad un tag "Riga" con le seguenti colonne:
2872        																			-- 1: Id. della UO (se il livello è l'organigramma è NULL)
2873        																			-- 2: Nome
2874        																			-- 3: (valori 1/0) Se 1 nell'albero dell'archivio la UO è un nodo di cui NON si possono mostrare tutti contenuti
2875        			                                                                -- 4: NULL
2876                                                                                    -- 5: N.ri livello della UO (quella cui è collegto l'utente/scrivania se il nodo rappresenta un utente con o senza scrivania)
2877        			FlgShowContentAllowedOut OUT	PLS_INTEGER,					-- (valori 1/0) Se 1 significa che per il folder IdUOIn si possono mostrare come lista i contenuti
2878        																			-- concide sempre con la colonna 3 dell'ultima riga di PercorsoXMLOut	 
2879        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
2880        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
2881        			ErrMsgOut				OUT 	VARCHAR2,						-- Messaggio d'errore
2882        			FlgIncludiUtentiIn		IN		PLS_INTEGER DEFAULT NULL,		-- (valori 2/1/0/NULL): se 2 indica che per determinare la colonna 3 dei livelli del percorso restituiti in PercorsoXMLOut vengono conteggiate sia le UO che tutti gli utenti collegati (con o senza scrivania), se 1 che vanno conteggiate le UO e gli utenti con scrivania, se 0 o NULL solo le UO
2883        			TipoRelUtentiConUOIn		IN		VARCHAR2 DEFAULT NULL,		-- (viene considerato solo se FlgIncludiUtentiIn>0) Indica il/i tipi di relazione da conteggiare per determinare la colonna 3 dei livelli del percorso restituiti in PercorsoXMLOut 
2884        																			--  Valori ammessi:
2885        																			--  A = Appartenenza; 
2886        																			--  L = a Lavorare per; 
2887        																			--  D = Delega
2888        																			-- o una loro cancatenazione con ";" come separatore
2889        																			-- Se non valorizzato è come se contenesse tutti i valori previsti
2890        			TsRifIn					IN		VARCHAR2 DEFAULT NULL,			-- (nel formato DD/MM/RRRR HH24:MI:SS) Definisce l'istante in cui va presa la "fotografia" dell'organigramma 
2891        																			-- Se non valorizzato si intende la situazione attuale dell'organigramma 	
2892        																			-- serve per determinare la colonna 3 dei livelli del percorso restituiti in PercorsoXMLOut
2893        			FlgSoloAttiveIn			IN		PLS_INTEGER DEFAULT 1,			-- (valori 1/0/NULL) Se 1 per determinare la colonna 3 dei livelli del percorso restituiti in PercorsoXMLOut vengono conteggiate solo le UO e relazioni utente-UO valide al timestamp TsRifIn																
2894        			FinalitaIn				IN		VARCHAR2 DEFAULT NULL			-- Motivo per cui si stanno navigando/ricercando le classifiche. Valori ammessi:
2895        																			-- ASSEGNAZIONE = Per selezionare la classificazione da assegnare ad un documento 
2896        																			-- ASS_CARTACEO = Per selezionare la UO/utente/scrivania cui assegnare documantazione cartacea
2897        																			-- ASS_NO_CARTACEO = Per selezionare la UO/utente/scrivania cui assegnare documantazione senza restrizioni del cartaceo
2898        																			-- ASS_EMAIL = Assegnazione di una mail
2899        																			-- INVIO_CC_NOTIFICA = Per selezionare la UO/utente cui inviare per conoscenza/con cui condividere/mandare osservazione su un documento/folder 
2900        																			-- APERTURA_FASC = Per selezionare la classifica in cui aprire un fascicolo
2901        																			-- RICERCA = Per selezionare le classifiche cui si è abilitati (per la trattazione)
2902        																			-- serve per determinare la colonna 3 dei livelli del percorso restituiti in PercorsoXMLOut
2903        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine, altrimenti 0
2904        
2905        
2906        	/*** Funzione di creazione/aggiornamento di una unità operativa							***/	
2907        	/*** prevede la gestione di: profilatura 												***/
2908        	/***				     gruppi di appartenenza											***/
2909        	/*** Non prevede la gestione dei privilegi su singoli oggetti di definizione del contesto					***/
2910        	function IUUO(
2911        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
2912        																	-- (obblig). Codice identificativo del token di connessione
2913        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
2914        			IdUOIO				IN OUT	DMT_STRUTTURA_ORG.ID_UO%type ,		-- Id. della UO da modificare. Se NULL si intende che la UO è da creare ex-novo
2915        																	-- in output, salvo in caso di errore, è sempre valorizzato
2916        			IdUOSupIn				IN		DMT_STRUTTURA_ORG.ID_UO%type DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),
2917        																	-- Id.della UO superiore. Se non valorizzato (e non lo è neppure NriLivelliUOSupIn) significa che è una U.O. di primo livello
2918        			NriLivelliUOSupIn			IN		VARCHAR2 DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
2919        																	-- N.ri livelli della UO superiore. Se non valorizzato (e non lo è neppure IdUOSupIn) significa che è una U.O. di primo livello
2920        																	-- I nri vanno indicati così come appaiono nella GUI e con il saparatore previsto nella GUI per i livelli UO
2921        			CodTipoIn				IN		DMT_STRUTTURA_ORG.COD_TIPO%type DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
2922        																	-- Codice del tipo di UO. 
2923        																	-- E' obbligatorio se ci sono più tipi di UO che possono occupare i livelli gerarchicamente inferiori a quello di IdUOSupIn 
2924        																	--	o se IdUOSupIn non è valorizzato e se ci sono più tipi di UO legati al primo livello gerarchico
2925        			NroLivelloIn			IN 		VARCHAR2 DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
2926        																	-- (obblig.) N.ro livello (come appare nella GUI, ovvero romano se previsto) che identifica la UO tra quelle dello stesso livello gerarchico (sottostanti la stessa IdUOSupIn se specificata)
2927        			DenominazioneIn			IN		DMT_STRUTTURA_ORG.DENOMINAZIONE%type DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
2928        																	-- (obblig.) Denominazione della UO 
2929        			DtIstituzioneIn			IN		VARCHAR2 DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'DATE_VAL_NO_UPD'),
2930        																	-- (obblig.) Data di istituzione (nel formato dato dal parametro di conf. FMT_STD_DATA).
2931        			DtSoppressioneIn			IN		VARCHAR2 DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'DATE_VAL_NO_UPD'),
2932        																	-- Data di soppressione / cessazione (nel formato dato dal parametro di conf. FMT_STD_DATA).
2933        			NroPosizioneIn			IN		DMT_STRUTTURA_ORG.NRO_POSIZIONE%type DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),
2934        																	-- N.ro che indica la posizione della UO all'interno della struttura organizzativa (per avere un ordinamento alternativo rispetto a quello con i livelli)
2935        			CompetenzeIn			IN		DMT_STRUTTURA_ORG.COMPETENZE%type DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
2936        																	-- Competenze della UO
2937        			StoriaIn				IN		DMT_STRUTTURA_ORG.STORIA%type DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
2938        																	-- Storia della UO
2939        			IdProfiloIn				IN		DMT_PROFILI.ID_PROFILO%type DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),
2940        																	-- Id. del profilo di DMT_PROFILI (uno di quelli che hanno un nome) da assegnare alla UO
2941        			NomeProfiloIn			IN		DMT_PROFILI.NOME_PROFILO%type DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
2942        																	-- Nome del profilo di DMT_PROFILI da assegnare alla UO (ricerca case-insensitive in like)	
2943        			XMLDatiProfiloIn			IN		CLOB DEFAULT NULL,				-- XML (conforme a schema SezioneCache.xsd) che contiene tutti gli attributi del profilo (tranne i gruppi di privilegi) da settare/aggiornare
2944        																	-- ATTENZIONE: Si intende che gli attributi corrispondenti a tag non presenti restino invariati
2945        																	-- Nell'XML possono esserci tag corrispondenti ad attributi di profilatura solo se non si è specificato un profilo predefinito con i due argomenti IdProfiloIn e/o NomeProfiloIn
2946        			FlgModGruppiPrivIn		IN		VARCHAR2 DEFAULT 'I',				-- (valori I/C) Indica se i gruppi di privilegi indicati nell'argomento successivo sono forniti in modo incrementale (=I) (solo quelle da inserire/cancellare) oppure completo (=C), vale a dire che dovranno soppiantare tutti quelli già associati alla UO
2947        			XMLGruppiPrivIn			IN		CLOB DEFAULT NULL,				-- Lista con i gruppi di privilegi assegnati/da assegnare direttamente (ovvero non tramite profilo) alla UO (XML conforme a schema LISTA_STD.xsd)					
2948        																	-- Ogni gruppo è un tag "Riga" che può contenere le seguenti colonne:
2949        																	-- 1: Identificativo del gruppo di privilegi
2950        																	-- 2: Nome del gruppo di privilegi (ricerca case insesnsitive in like)
2951        																	-- 3: (valori 1/0/NULL) Flag di gruppo da eliminare
2952        			FlgDichIPAIn			IN		PLS_INTEGER DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),
2953        																	-- (valori 1/0/NULL) Se 1 è una UO dichiarata all'Indice PA
2954        			DtDichIPAIn				IN		VARCHAR2 DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'DATE_VAL_NO_UPD'),
2955        																	-- Data di dichiarazione della UO all'indice PA (nel formato dato dal parametro di conf. FMT_STD_DATA).
2956        			CIProvUOIn				IN 		DMT_STRUTTURA_ORG.PROV_CI_UO%TYPE DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
2957        																	-- Codice identificativo della UO nel sistema di provenienza   
2958        			FlgLockedIn				IN		PLS_INTEGER DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),
2959        																	-- (valori 1/0/NULL) Indicatore di UO riservata dal sistema e non modificabile/cancellabile da GUI
2960        			FlgModGruppiAppIn			IN		VARCHAR2 DEFAULT 'I',				-- (valori I/C) Indica i gruppi cui appartiene l'utente (relativi al dominio da cui si è connessi) indicati nell'argomento successivo sono forniti in modo incrementale (=I) (solo quelle da aggiungere o cancellare) oppure completo (=C), vale a dire che dovranno soppiantare tutte quelle già specificati (e relativi al dominio di lavoro) in caso di utente da aggiornare
2961        			XMLGruppiAppIn			IN		CLOB DEFAULT NULL,				-- Lista con i gruppi cui appartiene la UO 
2962        																	-- Ogni gruppo di appartenenza è un tag "Riga" con le colonne:
2963        																	-- 1: Id. del gruppo
2964        																	-- 2: Nome del gruppo
2965        																	-- 3: flag 1/0 che indica se nel gruppo sono incluse le sotto-UO
2966        																	-- 4: flag 1/0 che indica se nel gruppo sono incluse le scrivanie
2967        																	-- 5: (valori 1/0) Flag di appartenenza a gruppo da eliminare
2968        			FlgModContattiIn			IN		VARCHAR2 DEFAULT 'I',				-- (valori I/C) Indica se i contatti (rif. telefonici, fax, e-mail) del soggetto indicati nell'argomento successivo sono forniti in modo incrementale (=I) (solo quelli da inserire/modificare/cancellare) oppure completo (=C), vale a dire che dovranno soppiantare tutti quelli già specificati in caso di soggetto da aggiornare
2969        			XMLContattiIn			IN		CLOB DEFAULT NULL,				-- Lista con i contatti (rif. telefonici, fax, e-mail) della UO (XML conforme a schema LISTA_STD.xsd)					
2970        																	-- Ogni contatto è tag "Riga" che può contenere le seguenti colonne:
2971        																	-- 1: Identificativo (ROWID preceduto da Tipo - T/F/E) con cui il contatto è già stata registrato in banca dati
2972        																	-- 2: (obblig.) Flag che indica il tipo di contatto. Valori possibili: T=Telefono; F=Fax; E=e-Mail
2973        																	-- 3: N.ro di telefono/fax o indirizzo e-mail
2974        																	-- 4: Tipo di numero di telefono (abitazione, ufficio, cell. ecc.) Valori da apposita dictionary entry
2975        																	-- 5: (valori 1/0/NULL) Flag di indirizzo e-mail di Posta Elettronica Certificata
2976        																	-- 6: (valori 1/0/NULL) Flag di indirizzo e-mail dichiarato all'Indice PA
2977        																	-- 7: (valori 1/0/NULL) Flag di indirizzo e-mail che è Casella Istituzionale di una PA
2978        																	-- 8: Estremi del gestore della casella se è di Posta Elettronica Certificata
2979        																	-- 9: (valori 1/0/NULL) Flag di contatto da eliminare
2980        			RowidOut				OUT		VARCHAR2,						-- Rowid del record della UO
2981        			AttributiAddIn			IN		CLOB DEFAULT NULL,				-- XML contenente nomi e valori degli attributi dinamici da aggiornare (conforme allo schema SezioneCache.xsd) 
2982        																	-- Gli attributi già presenti in DB e per i quali non c'è corrispondente nell'XML restano invariati
2983        																	-- Per tutti gli attributi vale quanto segue:
2984        																	-- Un attributo da settare è un tag "Variabile" dell'XML il cui tag "Nome" contiene il nome identificativo dell'attributo (ATTR_NAME di DMT_ATTRIBUTES_DEF)
2985        																	-- Un attributo da settare è una variabile con tag "ValoreSemplice" se è un attributo a singolo valore e non strutturato (cioè con tipo diverso da COMPLEX)
2986        																	-- altrimenti è una variabile con tag "Lista" che ha un'unica colonna con "Nro" pari a 1 se l'attributo non è strutturato, che ha invece tante colonne quanti gli attributi componenti (ordinate in base al loro NRO_ORD_IN_SUP) se l'attributo è complesso 
2987        																	-- Nel caso di variabili con tag "Lista" i valori specificati nell'XML si aggiungono o sostituiscono quelli già presenti in DB a seconda che nell'XML sia presente o meno una variabile con tag "Nome" pari a #Append_<Nome attributo> e tag "ValoreSemplice" pari a 1  
2988        																	-- In particolare se non sono specificati valori nell'XML (tag Lista vuoto) e se i valori non sono da aggiungere significa che tutti i valori dell'attributo già presenti in DB vanno rimossi
2989        			FlgStoricizzaDatiIn		IN		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 i dati variati veranno storicizzati
2990        			TsVariazioneDatiIn		IN		VARCHAR2 DEFAULT NULL,				-- (gestito solo se FlgStoricizzaDatiIn=1) Timestamp a cui risale la variazione dei dati (nel formato dato dal parametro di configurazione FMT_STD_TIMESTAMP).
2991        																	-- Se non valorizzato e se FlgStoricizzaDatiIn si intende che la variazione decorra da data e ora corrente
2992        			MotiviVariazioneIn		IN		VARCHAR2 DEFAULT NULL,				-- Motivo della variazione dei dati
2993        			CodCategAttoVariazioneIn	IN		VARCHAR2 DEFAULT NULL,				-- (gestito solo se FlgStoricizzaDatiIn=1) Codice della categoria di registrazione/numerazione (valori da dizionario) dell'atto che ha sancito il cambiamento dei dati da storicizzare	
2994        			SiglaAttoVariazioneIn		IN		VARCHAR2 DEFAULT NULL,				-- (gestito solo se FlgStoricizzaDatiIn=1) Sigla che indica il registro in cui è stato registrato l'atto che ha sancito il cambiamento dei dati da storicizzare	
2995        			AnnoAttoVariazioneIn		IN		PLS_INTEGER DEFAULT NULL,			-- (gestito solo se FlgStoricizzaDatiIn=1) Anno di registrazione/numerazione dell'atto che ha sancito il cambiamento dei dati da storicizzare	
2996        			NroAttoVariazioneIn		IN		PLS_INTEGER DEFAULT NULL,			-- (gestito solo se FlgStoricizzaDatiIn=1) N.ro di registrazione/numerazione dell'atto che ha sancito il cambiamento dei dati da storicizzare	
2997        			TsAttoVariazioneIn		IN		VARCHAR2 DEFAULT NULL,				-- (gestito solo se FlgStoricizzaDatiIn=1) Data e ora di registrazione/numerazione dell'atto che ha sancito il cambiamento dei dati da storicizzare (nel formato dato dal parametro di configurazione FMT_STD_TIMESTAMP).
2998        			FlgIgnoreWarningIn 		IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 0 o NULL significa che in presenza di WARNING la stored si comporta come in caso di errore; se 1 gli WARNING vengono ignorati
2999        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
3000        																	-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
3001        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
3002        			WarningMsgOut			OUT		VARCHAR2,						-- Messaggio di warning (valorizzato solo se non c'è errore)
3003        			FlgDatiDaStoricizzareOut	OUT		PLS_INTEGER,					-- (valori 1/NULL) Se FlgStoricizzaDatiIn non è valorizzato e se si sono modificati dati che è previsto storicizzare viene restituito pari a 1
3004        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
3005        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
3006        			ErrMsgOut				OUT 		VARCHAR2,						-- Messaggio d'errore
3007        			IdOrganigrammaIn		IN			DMT_ORGANIGRAMMI.ID_ORGANIGRAMMA%type DEFAULT NULL,
3008        																			-- Id. dell'organigramma in cui creare/modificare la UO. Se non specificato è l'ID dell'unico organigramma in cui compare la UO (se individuabile e se si sta modificando una UO), altrimenti è l'ID dell'organigramma in vigore
3009        			DesBreveAcronimoIn		IN		VARCHAR2 DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
3010        																			-- Denominazione breve o acronimo della UO
3011        			XMLPuntiProtocolloIn	IN		CLOB DEFAULT TO_CLOB(dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD')),				-- Lista con i dati dei punti di protocollo associati (attributo custom lista)
3012        																			-- Considera solo la colonna 2 con l'ID_UO del punto di protocollo
3013        			XMLPrececessoriIn		IN		CLOB DEFAULT TO_CLOB(dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD')), 				-- Lista XML con i dati delle UO predecessori
3014        																			-- Ogni riga è una UO predecessore e contiene le colonne
3015        																			-- 1) Tipo di azione che lega al predecessore: accorpamento, split
3016        																			-- 2) Id. UO del precedessore															
3017        			XMLSuccessoriIn			IN		CLOB DEFAULT TO_CLOB(dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD')), 				-- Lista XML con i dati delle UO successori
3018        																			-- Ogni riga è una UO successore e contiene le colonne
3019        																			-- 1) Tipo di azione che lega al successore: accorpamento, split
3020        																			-- 2) Id. UO del successore	
3021        			IdUODestMailIn			IN		INTEGER DEFAULT NULL,			-- Id. della UO a cui spostare le mail assegnate alla UO (in genere impostata in caso di cessazione della UO)	
3022        			IdUODestDocIn			IN		INTEGER DEFAULT NULL,			-- Id. della UO a cui spostare documenti e fascicoli assegnati alla UO (in genere impostata in caso di cessazione della UO)	
3023        			FlgAssInvioUPIn			IN		PLS_INTEGER DEFAULT NULL,	-- Flag che indica a quando è consentita assegnazione alla unità di personale agganciate alla UO
3024        																			-- valori ammessi:
3025        																			-- 		3: sempre 
3026        																			-- 		2: solo da parte di persone della struttura o delle strutture sovraordinate
3027        																			--		1: solo da parte di persone della struttura
3028        																			--		0: mai
3029        			FlgPropagaAssInvioUPIn	IN		PLS_INTEGER DEFAULT NULL		-- (valori 1/0): Indica se il flag sopra è valido per tutte le UO subordinate (tutto il cono gerarchico sotto)	
3030        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine (senza warning), altrimenti 0 (in caso di errore o warning)
3031        
3032        	/********** funzione per estrarre i dati di dettaglio di una UO *************/
3033        	function LoadDettUO(
3034        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
3035        																	-- (obblig). Codice identificativo del token di connessione
3036        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
3037        			IdUOIO				IN OUT	DMT_STRUTTURA_ORG.ID_UO%type ,		-- Id. della UO
3038        																	-- in output, salvo in caso di errore, è sempre valorizzato
3039        			NriLivelliUOIO			IN OUT	VARCHAR2,						-- N.ri dei livelli (come appaiono nella GUI) della UO
3040        																	-- in output, salvo in caso di errore, è sempre valorizzato
3041        			DenominazioneIO			IN OUT	VARCHAR2,						-- Denominazione della UO
3042        																	-- in input può essere sia la denominazione semplice che la concatenazione con separatore "|" delle denominazioni delle UO superiori + quella della UO
3043        																	-- in output è sempre la denominazione semplice
3044        			TsRifIn				IN		VARCHAR2 default TO_CHAR(sysdate, 'DD/MM/RRRR HH24:MI:SS'),
3045        																	-- Stringa con il timestamp (nel formato GG/MM/AAAA HH24:MI:SS) di riferimento al quale la UO deve avere gli estremi specificati in input e al quale si riferiscono gli altri dati restituiti in output
3046        			IdUOSupOut				OUT		DMT_STRUTTURA_ORG.ID_UO%type,			-- Id.della UO superiore. Se non valorizzato significa che è una U.O. di primo livello
3047        			NroLivelloGerarchicoUOSupOut	OUT		DMT_STRUTTURA_ORG.LIVELLO_GERARCHICO%type,-- N.ro che indica il livello gerarchico della UO superiore. Se non valorizzato significa che è una U.O. di primo livello
3048        			NroLivelloGerarchicoOut		OUT		DMT_STRUTTURA_ORG.LIVELLO_GERARCHICO%type,-- N.ro che indica il livello gerarchico della UO 
3049        			CodTipoOut				OUT		DMT_STRUTTURA_ORG.COD_TIPO%type,		-- Codice del tipo della UO. 
3050        			DesTipoOut				OUT		VARCHAR2,						-- Descrizione del tipo della UO
3051        			DtIstituzioneOut			OUT		VARCHAR2,						-- Data di istituzione (nel formato dato dal parametro di conf. FMT_STD_DATA).
3052        			DtSoppressioneOut			OUT		VARCHAR2,						-- Data di soppressione / cessazione (nel formato dato dal parametro di conf. FMT_STD_DATA).
3053        			NroPosizioneOut			OUT		DMT_STRUTTURA_ORG.NRO_POSIZIONE%type,	-- N.ro che indica la posizione della UO all'interno della struttura organizzativa (per avere un ordinamento alternativo rispetto a quello con i livelli)
3054        			CompetenzeOut			OUT		DMT_STRUTTURA_ORG.COMPETENZE%type,		-- Competenze della UO
3055        			StoriaOut				OUT		DMT_STRUTTURA_ORG.STORIA%type,		-- Storia della UO
3056        			IdProfiloOut			OUT		DMT_PROFILI.ID_PROFILO%type ,			-- Id. del profilo di DMT_PROFILI assegnato alla UO
3057        			NomeProfiloOut			OUT		DMT_PROFILI.NOME_PROFILO%type,		-- Nome del profilo di DMT_PROFILI assegnato alla UO	
3058        			XMLDatiProfiloOut			OUT		NOCOPY CLOB,					-- XML (conforme a schema SezioneCache.xsd) che contiene tutti gli attributi del profilo (tranne i gruppi di provilegi) 
3059        			XMLGruppiPrivOut			OUT		NOCOPY CLOB,					-- Lista con i gruppi di privilegi assegnati direttamente (ovvero non tramite profilo) alla UO (XML conforme a schema LISTA_STD.xsd)					
3060        																	-- Ogni gruppo è un tag "Riga" che può contenere le seguenti colonne:
3061        																	-- 1: Identificativo del gruppo di privilegi
3062        																	-- 2: Nome del gruppo di privilegi 
3063        			FlgDichIPAOut			OUT		PLS_INTEGER,					-- (valori 1/0) Se 1 è una UO dichiarata all'Indice PA
3064        			DtDichIPAOut			OUT		VARCHAR2,						-- Data di dichiarazione della UO all'indice PA (nel formato dato dal parametro di conf. FMT_STD_DATA).
3065        			CIProvUOOut				OUT 		DMT_STRUTTURA_ORG.PROV_CI_UO%TYPE,		-- Codice identificativo della UO nel sistema di provenienza   
3066        			FlgLockedOut			OUT		PLS_INTEGER,					-- (valori 1/0) Indicatore di UO riservata dal sistema e non modificabile/cancellabile da GUI
3067        			XMLGruppiAppOut			OUT		NOCOPY CLOB,					-- Lista con i gruppi cui appartiene la UO
3068        																			-- Ogni gruppo di appartenenza è un tag "Riga" con le colonne:
3069        																			-- 1: Id. del gruppo
3070        																			-- 2: Nome del gruppo
3071        																			-- 3: flag 1/0 che indica se nel gruppo sono incluse le sotto-UO
3072        																			-- 4: flag 1/0 che indica se nel gruppo sono incluse le scrivanie
3073        			XMLContattiOut			OUT		NOCOPY CLOB,					-- Lista con i contatti (rif. telefonici, fax, e-mail) della UO (XML conforme a schema LISTA_STD.xsd)					
3074        																			-- Ogni contatto è tag "Riga" che può contenere le seguenti colonne:
3075        																			-- 1: Identificativo (ROWID preceduto da Tipo - T/F/E) con cui il contatto è già stata registrato in banca dati
3076        																			-- 2: (obblig.) Flag che indica il tipo di contatto. Valori possibili: T=Telefono; F=Fax; E=e-Mail
3077        																			-- 3: N.ro di telefono/fax o indirizzo e-mail
3078        																			-- 4: Tipo di numero di telefono (abitazione, ufficio, cell. ecc.) Valori da apposita dictionary entry
3079        																			-- 5: (valori 1/0/NULL) Flag di indirizzo e-mail di Posta Elettronica Certificata
3080        																			-- 6: (valori 1/0/NULL) Flag di indirizzo e-mail dichiarato all'Indice PA
3081        																			-- 7: (valori 1/0/NULL) Flag di indirizzo e-mail che è Casella Istituzionale di una PA
3082        																			-- 8: Estremi del gestore della casella se è di Posta Elettronica Certificata
3083        			RowidOut				OUT		VARCHAR2,						-- Rowid del record della UO
3084        			AttributiAddOut			OUT		NOCOPY CLOB,					-- Lista degli eventuali ulteriori attributi con cui caratterizzare la UO (XML conforme a schema LISTA_STD.xsd)
3085        																			-- Ogni attributo è un tag "Riga" che contiene le seguenti colonne:
3086        																			-- 1: N.ro (valori da 1 a n) del riquadro (fieldset) in cui mostrare l'attributo
3087        																			-- 2: Nome identificativo dell'attributo (ATTR_NAME)
3088        																			-- 3: Label del campo con cui rappresentare l'attributo 
3089        																			-- 4: Tipo di attributo. Valori: DATE, DATETIME, TEXT, TEXT-AREA, CHECK, INTEGER, EURO, DECIMAL, COMBO-BOX, LISTA
3090        																			-- 5: N.ro massimo di caratteri/cifre
3091        																			-- 6: Larghezza del campo con cui rappresentare l'attributo (size)
3092        																			-- 7: Valore dell'attributo
3093        																			-- 8: Label del riquadro (fieldset) in cui mostrare l'attributo
3094        																			-- 9: (valori 1/0) 1 indica che l'attributo è obbligatorio, 0 che è facoltativo
3095        																			-- 10: Altezza (in nro righe) del campo con cui rappresentare l'attributo (se TEXT-AREA)
3096        																			-- 11:(valori 1/0) 1 indica se l'attributo è modificabile, 0 che è in sola visualizzazione   
3097        			BachSizeOut				OUT		PLS_INTEGER,					-- Indica il massimo n.ro di record per ogni pagina da mostrare nelle liste del dettaglio
3098        			FlgMostraAltriAttrOut		OUT		PLS_INTEGER,				-- (valori 1/0) Se 1 nella GUI vanno mostrati gli attributi addizionali (ce ne sono di visibile all'utente), se 0 no
3099        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
3100        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
3101                    ErrMsgOut                OUT         VARCHAR2                   -- Messaggio d'errore
3102                    ) return PLS_INTEGER;                                           -- Vale 1 se tutto è andato a buon fine , altrimenti 0 (in caso di errore o warning)
3103        
3104        
3105            /********** funzione per estrarre i dati di dettaglio di una UO *************/
3106            function LoadDettUO(
3107                    CodIdConnectionTokenIn        IN            DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
3108                                                                            -- (obblig). Codice identificativo del token di connessione
3109                    IdUserLavoroIn            IN        DMT_USERS.ID_USER%type DEFAULT NULL,    -- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
3110                    IdUOIO                IN OUT    DMT_STRUTTURA_ORG.ID_UO%type ,        -- Id. della UO
3111                                                                            -- in output, salvo in caso di errore, è sempre valorizzato
3112                    NriLivelliUOIO            IN OUT    VARCHAR2,                        -- N.ri dei livelli (come appaiono nella GUI) della UO
3113                                                                            -- in output, salvo in caso di errore, è sempre valorizzato
3114                    DenominazioneIO            IN OUT    VARCHAR2,                        -- Denominazione della UO
3115                                                                            -- in input può essere sia la denominazione semplice che la concatenazione con separatore "|" delle denominazioni delle UO superiori + quella della UO
3116                                                                            -- in output è sempre la denominazione semplice
3117                    TsRifIn                IN        VARCHAR2 default TO_CHAR(sysdate, 'DD/MM/RRRR HH24:MI:SS'),
3118                                                                            -- Stringa con il timestamp (nel formato GG/MM/AAAA HH24:MI:SS) di riferimento al quale la UO deve avere gli estremi specificati in input e al quale si riferiscono gli altri dati restituiti in output
3119                    IdUOSupOut                OUT        DMT_STRUTTURA_ORG.ID_UO%type,            -- Id.della UO superiore. Se non valorizzato significa che è una U.O. di primo livello
3120                    NroLivelloGerarchicoUOSupOut    OUT        DMT_STRUTTURA_ORG.LIVELLO_GERARCHICO%type,-- N.ro che indica il livello gerarchico della UO superiore. Se non valorizzato significa che è una U.O. di primo livello
3121                    NroLivelloGerarchicoOut        OUT        DMT_STRUTTURA_ORG.LIVELLO_GERARCHICO%type,-- N.ro che indica il livello gerarchico della UO
3122                    CodTipoOut                OUT        DMT_STRUTTURA_ORG.COD_TIPO%type,        -- Codice del tipo della UO.
3123                    DesTipoOut                OUT        VARCHAR2,                        -- Descrizione del tipo della UO
3124                    DtIstituzioneOut            OUT        VARCHAR2,                        -- Data di istituzione (nel formato dato dal parametro di conf. FMT_STD_DATA).
3125                    DtSoppressioneOut            OUT        VARCHAR2,                        -- Data di soppressione / cessazione (nel formato dato dal parametro di conf. FMT_STD_DATA).
3126                    NroPosizioneOut            OUT        DMT_STRUTTURA_ORG.NRO_POSIZIONE%type,    -- N.ro che indica la posizione della UO all'interno della struttura organizzativa (per avere un ordinamento alternativo rispetto a quello con i livelli)
3127                    CompetenzeOut            OUT        DMT_STRUTTURA_ORG.COMPETENZE%type,        -- Competenze della UO
3128                    StoriaOut                OUT        DMT_STRUTTURA_ORG.STORIA%type,        -- Storia della UO
3129                    IdProfiloOut            OUT        DMT_PROFILI.ID_PROFILO%type ,            -- Id. del profilo di DMT_PROFILI assegnato alla UO
3130                    NomeProfiloOut            OUT        DMT_PROFILI.NOME_PROFILO%type,        -- Nome del profilo di DMT_PROFILI assegnato alla UO
3131                    XMLDatiProfiloOut            OUT        NOCOPY CLOB,                    -- XML (conforme a schema SezioneCache.xsd) che contiene tutti gli attributi del profilo (tranne i gruppi di provilegi)
3132                    XMLGruppiPrivOut            OUT        NOCOPY CLOB,                    -- Lista con i gruppi di privilegi assegnati direttamente (ovvero non tramite profilo) alla UO (XML conforme a schema LISTA_STD.xsd)
3133                                                                            -- Ogni gruppo è un tag "Riga" che può contenere le seguenti colonne:
3134                                                                            -- 1: Identificativo del gruppo di privilegi
3135                                                                            -- 2: Nome del gruppo di privilegi
3136                    FlgDichIPAOut            OUT        PLS_INTEGER,                    -- (valori 1/0) Se 1 è una UO dichiarata all'Indice PA
3137                    DtDichIPAOut            OUT        VARCHAR2,                        -- Data di dichiarazione della UO all'indice PA (nel formato dato dal parametro di conf. FMT_STD_DATA).
3138                    CIProvUOOut                OUT         DMT_STRUTTURA_ORG.PROV_CI_UO%TYPE,        -- Codice identificativo della UO nel sistema di provenienza
3139                    FlgLockedOut            OUT        PLS_INTEGER,                    -- (valori 1/0) Indicatore di UO riservata dal sistema e non modificabile/cancellabile da GUI
3140                    XMLGruppiAppOut            OUT        NOCOPY CLOB,                    -- Lista con i gruppi cui appartiene la UO
3141                                                                            -- Ogni gruppo di appartenenza è un tag "Riga" con le colonne:
3142                                                                            -- 1: Id. del gruppo
3143                                                                            -- 2: Nome del gruppo
3144                                                                            -- 3: flag 1/0 che indica se nel gruppo sono incluse le sotto-UO
3145                                                                            -- 4: flag 1/0 che indica se nel gruppo sono incluse le scrivanie
3146                    XMLContattiOut            OUT        NOCOPY CLOB,                    -- Lista con i contatti (rif. telefonici, fax, e-mail) della UO (XML conforme a schema LISTA_STD.xsd)
3147                                                                            -- Ogni contatto è tag "Riga" che può contenere le seguenti colonne:
3148                                                                            -- 1: Identificativo (ROWID preceduto da Tipo - T/F/E) con cui il contatto è già stata registrato in banca dati
3149                                                                            -- 2: (obblig.) Flag che indica il tipo di contatto. Valori possibili: T=Telefono; F=Fax; E=e-Mail
3150                                                                            -- 3: N.ro di telefono/fax o indirizzo e-mail
3151                                                                            -- 4: Tipo di numero di telefono (abitazione, ufficio, cell. ecc.) Valori da apposita dictionary entry
3152                                                                            -- 5: (valori 1/0/NULL) Flag di indirizzo e-mail di Posta Elettronica Certificata
3153                                                                            -- 6: (valori 1/0/NULL) Flag di indirizzo e-mail dichiarato all'Indice PA
3154                                                                            -- 7: (valori 1/0/NULL) Flag di indirizzo e-mail che è Casella Istituzionale di una PA
3155                                                                            -- 8: Estremi del gestore della casella se è di Posta Elettronica Certificata
3156                    RowidOut                OUT        VARCHAR2,                        -- Rowid del record della UO
3157                    AttributiAddOut            OUT        NOCOPY CLOB,                    -- Lista degli eventuali ulteriori attributi con cui caratterizzare la UO (XML conforme a schema LISTA_STD.xsd)
3158                                                                            -- Ogni attributo è un tag "Riga" che contiene le seguenti colonne:
3159                                                                            -- 1: N.ro (valori da 1 a n) del riquadro (fieldset) in cui mostrare l'attributo
3160                                                                            -- 2: Nome identificativo dell'attributo (ATTR_NAME)
3161                                                                            -- 3: Label del campo con cui rappresentare l'attributo
3162                                                                            -- 4: Tipo di attributo. Valori: DATE, DATETIME, TEXT, TEXT-AREA, CHECK, INTEGER, EURO, DECIMAL, COMBO-BOX, LISTA
3163                                                                            -- 5: N.ro massimo di caratteri/cifre
3164                                                                            -- 6: Larghezza del campo con cui rappresentare l'attributo (size)
3165                                                                            -- 7: Valore dell'attributo
3166                                                                            -- 8: Label del riquadro (fieldset) in cui mostrare l'attributo
3167                                                                            -- 9: (valori 1/0) 1 indica che l'attributo è obbligatorio, 0 che è facoltativo
3168                                                                            -- 10: Altezza (in nro righe) del campo con cui rappresentare l'attributo (se TEXT-AREA)
3169                                                                            -- 11:(valori 1/0) 1 indica se l'attributo è modificabile, 0 che è in sola visualizzazione
3170                    BachSizeOut                OUT        PLS_INTEGER,                    -- Indica il massimo n.ro di record per ogni pagina da mostrare nelle liste del dettaglio
3171                    FlgMostraAltriAttrOut        OUT        PLS_INTEGER,                    -- (valori 1/0) Se 1 nella GUI vanno mostrati gli attributi addizionali (ce ne sono di visibile all'utente), se 0 no
3172                    ErrContextOut            OUT        VARCHAR2,                        -- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
3173                    ErrCodeOut                OUT        PLS_INTEGER,                    -- N.ro errore di uscita
3174        			ErrMsgOut				OUT 		VARCHAR2,						-- Messaggio d'errore
3175        			IdOrganigrammaIn		IN			DMT_ORGANIGRAMMI.ID_ORGANIGRAMMA%type DEFAULT NULL,
3176        																			-- Id. dell'organigramma in cui reperire i dati della UO. Se non specificato è l'ID dell'unico organigramma in cui compare la UO (se individuabile)
3177        			XMLPuntiProtocolloOut	OUT		NOCOPY CLOB 					-- Lista XML con i dati dei punti di protocollo associati
3178        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine , altrimenti 0 (in caso di errore o warning)
3179        
3180        	/********** funzione per estrarre i dati di dettaglio di una UO *************/
3181        	/********** analoga alla funzione precedente con in più gli output con dati della/e UO predecessori e successori da cui la UO è derivata o in cui è confluita/è stata splittata***/
3182        	function LoadDettUOEstesa(
3183        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
3184        																	-- (obblig). Codice identificativo del token di connessione
3185        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
3186        			IdUOIO				IN OUT	DMT_STRUTTURA_ORG.ID_UO%type ,		-- Id. della UO
3187        																	-- in output, salvo in caso di errore, è sempre valorizzato
3188        			NriLivelliUOIO			IN OUT	VARCHAR2,						-- N.ri dei livelli (come appaiono nella GUI) della UO
3189        																	-- in output, salvo in caso di errore, è sempre valorizzato
3190        			DenominazioneIO			IN OUT	VARCHAR2,						-- Denominazione della UO
3191        																	-- in input può essere sia la denominazione semplice che la concatenazione con separatore "|" delle denominazioni delle UO superiori + quella della UO
3192        																	-- in output è sempre la denominazione semplice
3193        			TsRifIn				IN		VARCHAR2 default TO_CHAR(sysdate, 'DD/MM/RRRR HH24:MI:SS'),
3194        																	-- Stringa con il timestamp (nel formato GG/MM/AAAA HH24:MI:SS) di riferimento al quale la UO deve avere gli estremi specificati in input e al quale si riferiscono gli altri dati restituiti in output
3195        			IdUOSupOut				OUT		DMT_STRUTTURA_ORG.ID_UO%type,			-- Id.della UO superiore. Se non valorizzato significa che è una U.O. di primo livello
3196        			NroLivelloGerarchicoUOSupOut	OUT		DMT_STRUTTURA_ORG.LIVELLO_GERARCHICO%type,-- N.ro che indica il livello gerarchico della UO superiore. Se non valorizzato significa che è una U.O. di primo livello
3197        			NroLivelloGerarchicoOut		OUT		DMT_STRUTTURA_ORG.LIVELLO_GERARCHICO%type,-- N.ro che indica il livello gerarchico della UO 
3198        			CodTipoOut				OUT		DMT_STRUTTURA_ORG.COD_TIPO%type,		-- Codice del tipo della UO. 
3199        			DesTipoOut				OUT		VARCHAR2,						-- Descrizione del tipo della UO
3200        			DtIstituzioneOut			OUT		VARCHAR2,						-- Data di istituzione (nel formato dato dal parametro di conf. FMT_STD_DATA).
3201        			DtSoppressioneOut			OUT		VARCHAR2,						-- Data di soppressione / cessazione (nel formato dato dal parametro di conf. FMT_STD_DATA).
3202        			NroPosizioneOut			OUT		DMT_STRUTTURA_ORG.NRO_POSIZIONE%type,	-- N.ro che indica la posizione della UO all'interno della struttura organizzativa (per avere un ordinamento alternativo rispetto a quello con i livelli)
3203        			CompetenzeOut			OUT		DMT_STRUTTURA_ORG.COMPETENZE%type,		-- Competenze della UO
3204        			StoriaOut				OUT		DMT_STRUTTURA_ORG.STORIA%type,		-- Storia della UO
3205        			IdProfiloOut			OUT		DMT_PROFILI.ID_PROFILO%type ,			-- Id. del profilo di DMT_PROFILI assegnato alla UO
3206        			NomeProfiloOut			OUT		DMT_PROFILI.NOME_PROFILO%type,		-- Nome del profilo di DMT_PROFILI assegnato alla UO	
3207        			XMLDatiProfiloOut			OUT		NOCOPY CLOB,					-- XML (conforme a schema SezioneCache.xsd) che contiene tutti gli attributi del profilo (tranne i gruppi di provilegi) 
3208        			XMLGruppiPrivOut			OUT		NOCOPY CLOB,					-- Lista con i gruppi di privilegi assegnati direttamente (ovvero non tramite profilo) alla UO (XML conforme a schema LISTA_STD.xsd)					
3209        																	-- Ogni gruppo è un tag "Riga" che può contenere le seguenti colonne:
3210        																	-- 1: Identificativo del gruppo di privilegi
3211        																	-- 2: Nome del gruppo di privilegi 
3212        			FlgDichIPAOut			OUT		PLS_INTEGER,					-- (valori 1/0) Se 1 è una UO dichiarata all'Indice PA
3213        			DtDichIPAOut			OUT		VARCHAR2,						-- Data di dichiarazione della UO all'indice PA (nel formato dato dal parametro di conf. FMT_STD_DATA).
3214        			CIProvUOOut				OUT 		DMT_STRUTTURA_ORG.PROV_CI_UO%TYPE,		-- Codice identificativo della UO nel sistema di provenienza   
3215        			FlgLockedOut			OUT		PLS_INTEGER,					-- (valori 1/0) Indicatore di UO riservata dal sistema e non modificabile/cancellabile da GUI
3216        			XMLGruppiAppOut			OUT		NOCOPY CLOB,					-- Lista con i gruppi cui appartiene la UO
3217        																	-- Ogni gruppo di appartenenza è un tag "Riga" con le colonne:
3218        																	-- 1: Id. del gruppo
3219        																	-- 2: Nome del gruppo
3220        																	-- 3: flag 1/0 che indica se nel gruppo sono incluse le sotto-UO
3221        																	-- 4: flag 1/0 che indica se nel gruppo sono incluse le scrivanie
3222        			XMLContattiOut			OUT		NOCOPY CLOB,					-- Lista con i contatti (rif. telefonici, fax, e-mail) della UO (XML conforme a schema LISTA_STD.xsd)					
3223        																	-- Ogni contatto è tag "Riga" che può contenere le seguenti colonne:
3224        																	-- 1: Identificativo (ROWID preceduto da Tipo - T/F/E) con cui il contatto è già stata registrato in banca dati
3225        																	-- 2: (obblig.) Flag che indica il tipo di contatto. Valori possibili: T=Telefono; F=Fax; E=e-Mail
3226        																	-- 3: N.ro di telefono/fax o indirizzo e-mail
3227        																	-- 4: Tipo di numero di telefono (abitazione, ufficio, cell. ecc.) Valori da apposita dictionary entry
3228        																	-- 5: (valori 1/0/NULL) Flag di indirizzo e-mail di Posta Elettronica Certificata
3229        																	-- 6: (valori 1/0/NULL) Flag di indirizzo e-mail dichiarato all'Indice PA
3230        																	-- 7: (valori 1/0/NULL) Flag di indirizzo e-mail che è Casella Istituzionale di una PA
3231        																	-- 8: Estremi del gestore della casella se è di Posta Elettronica Certificata
3232        			RowidOut				OUT		VARCHAR2,						-- Rowid del record della UO
3233        			AttributiAddOut			OUT		NOCOPY CLOB,					-- Lista degli eventuali ulteriori attributi con cui caratterizzare la UO (XML conforme a schema LISTA_STD.xsd)
3234        																	-- Ogni attributo è un tag "Riga" che contiene le seguenti colonne:
3235        																	-- 1: N.ro (valori da 1 a n) del riquadro (fieldset) in cui mostrare l'attributo
3236        																	-- 2: Nome identificativo dell'attributo (ATTR_NAME)
3237        																	-- 3: Label del campo con cui rappresentare l'attributo 
3238        																	-- 4: Tipo di attributo. Valori: DATE, DATETIME, TEXT, TEXT-AREA, CHECK, INTEGER, EURO, DECIMAL, COMBO-BOX, LISTA
3239        																	-- 5: N.ro massimo di caratteri/cifre
3240        																	-- 6: Larghezza del campo con cui rappresentare l'attributo (size)
3241        																	-- 7: Valore dell'attributo
3242        																	-- 8: Label del riquadro (fieldset) in cui mostrare l'attributo
3243        																	-- 9: (valori 1/0) 1 indica che l'attributo è obbligatorio, 0 che è facoltativo
3244        																	-- 10: Altezza (in nro righe) del campo con cui rappresentare l'attributo (se TEXT-AREA)
3245        																	-- 11:(valori 1/0) 1 indica se l'attributo è modificabile, 0 che è in sola visualizzazione   
3246        			BachSizeOut				OUT		PLS_INTEGER,					-- Indica il massimo n.ro di record per ogni pagina da mostrare nelle liste del dettaglio
3247        			FlgMostraAltriAttrOut		OUT		PLS_INTEGER,					-- (valori 1/0) Se 1 nella GUI vanno mostrati gli attributi addizionali (ce ne sono di visibile all'utente), se 0 no
3248        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
3249        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
3250        			ErrMsgOut				OUT 		VARCHAR2,						-- Messaggio d'errore
3251        			IdOrganigrammaIn		IN			DMT_ORGANIGRAMMI.ID_ORGANIGRAMMA%type DEFAULT NULL,
3252        																			-- Id. dell'organigramma in cui reperire i dati della UO. Se non specificato è l'ID dell'unico organigramma in cui compare la UO (se individuabile)
3253        			XMLPuntiProtocolloOut	OUT		NOCOPY CLOB, 					-- Lista XML con i dati dei punti di protocollo associati
3254        			XMLPrececessoriOut		OUT		NOCOPY CLOB, 					-- Lista XML con i dati delle UO predecessori
3255        																			-- Ogni riga è una UO predecessore e contiene le colonne
3256        																			-- 1) Tipo di azione che lega al predecessore: accorpamento, split
3257        																			-- 2) Id. UO del precedessore
3258        																			-- 3) Codice/livelli del predecessore
3259        																			-- 4) Denominazione del predecessore
3260        			XMLSuccessoriOut		OUT		NOCOPY CLOB, 					-- Lista XML con i dati delle UO successori
3261        																			-- Ogni riga è una UO successore e contiene le colonne
3262        																			-- 1) Tipo di azione che lega al successore: accorpamento, split
3263        																			-- 2) Id. UO del successore
3264        																			-- 3) Codice/livelli del successore
3265        																			-- 4) Denominazione del successore	
3266        			FlgPresentiMailOut		OUT		PLS_INTEGER,					-- Flag 1/0/NULL che indica se c'è almeno una mail assegnata alla UO (=1) o nessuna
3267        			IdUODestMailOut			OUT		INTEGER,						-- Id. della UO a cui spostare le mail assegnate alla UO (in genere impostata in caso di cessazione della UO)	
3268        			LivelliUODestMailOut	OUT		VARCHAR2,						-- Livelli della UO a cui spostare le mail assegnate alla UO (in genere impostata in caso di cessazione della UO)	
3269        			DesUODestMailOut		OUT		VARCHAR2,						-- Denominazione della UO a cui spostare le mail assegnate alla UO (in genere impostata in caso di cessazione della UO)
3270        			StatoSpostMailOut		OUT		VARCHAR2,						-- Indica lo stato dello spostamento delle mail dalla UO ad altra indicata: da avviare, in corso, completato
3271        			TsInizioSpostMailOut	OUT		VARCHAR2,						-- Data e ora (prevista o effettiva) di inizio spostamento delle mail nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP
3272        			TsFineSpostMailOut		OUT		VARCHAR2,						-- Data e ora di fine spostamento delle mail nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP
3273        			NroMailAssOut			OUT		INTEGER,						-- N.ro di mail ancora assegnate alla UO
3274        			TsRilevNroMailAssOut	OUT		VARCHAR2,						-- Data e ora di rilevamento - nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP - del n.ro di mail assegnate alla UO indicato in NroMailAssOut
3275        			FlgPresentiDocFascOut	OUT		PLS_INTEGER,					-- Flag 1/0/NULL che indica se c'è almeno un documento o fascicolo assegnato alla UO (=1) o nessuno
3276        			IdUODestDocFascOut		OUT		INTEGER,						-- Id. della UO a cui spostare documenti e fascicoli assegnati alla UO (in genere impostata in caso di cessazione della UO)	
3277        			LivelliUODestDocFascOut	OUT		VARCHAR2,						-- Livelli della UO a cui spostare documenti e fascicoli assegnati alla UO (in genere impostata in caso di cessazione della UO)	
3278        			DesUODestDocFascOut		OUT		VARCHAR2,						-- Denominazione della UO a cui spostare documenti e fascicoli assegnati alla UO (in genere impostata in caso di cessazione della UO)
3279        			StatoSpostDocFascOut	OUT		VARCHAR2,						-- Indica lo stato dello spostamento di documenti e fascicoli dalla UO ad altra indicata: da avviare, in corso, completato
3280        			TsInizioSpostDocFascOut	OUT		VARCHAR2,						-- Data e ora (prevista o effettiva) di inizio spostamento di documenti e fascicoli nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP
3281        			TsFineSpostDocFascOut	OUT		VARCHAR2,						-- Data e ora di fine spostamento di documenti e fascicoli nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP
3282        			NroDocAssOut			OUT		INTEGER,						-- N.ro di documenti ancora assegnati alla UO
3283        			TsRilevNroDocAssOut		OUT		VARCHAR2,						-- Data e ora di rilevamento - nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP - del n.ro di documenti assegnati alla UO indicato in NroDocAssOut														
3284        			NroFascAssOut			OUT		INTEGER,						-- N.ro di fascicoli ancora assegnati alla UO
3285        			TsRilevNroFascAssOut	OUT		VARCHAR2,						-- Data e ora di rilevamento - nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP - del n.ro di fascicoli assegnati alla UO indicato in NroDocFascOut														
3286        			FlgAssInvioUPOut		OUT		PLS_INTEGER,					-- Flag che indica a quando è consentita assegnazione alla unità di personale agganciate alla UO
3287        																			-- valori previsti:
3288        																			-- 		3: sempre 
3289        																			-- 		2: solo da parte di persone della struttura o delle strutture sovraordinate
3290        																			--		1: solo da parte di persone della struttura
3291        																			--		0: mai
3292        			FlgPropagaAssInvioUPOut	OUT		PLS_INTEGER,					-- (valori 1/0): Indica se il flag sopra è valido per tutte le UO subordinate (tutto il cono gerarchico sotto)	
3293        			FlgEreditaAssInvioUPOut	OUT		PLS_INTEGER						-- (valori 1/0): Indica se FlgAssInvioUPOut è ereditato da struttura superiore
3294        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine , altrimenti 0 (in caso di errore o warning)
3295        
3296        	/*********** funzione per cancellare fisicamente una UO ****************/
3297        	function DUO(
3298        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
3299        																	-- (obblig). Codice identificativo del token di connessione
3300        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
3301        			IdUOIn				IN 		DMT_STRUTTURA_ORG.ID_UO%type ,		-- Id. della UO da eliminare
3302        			NriLivelliUOIn			IN		VARCHAR2,						-- N.ri livelli della UO da eliminare
3303        																	-- I nri vanno indicati così come appaiono nella GUI e con il saparatore previsto nella GUI per i livelli UO
3304        			DenominazioneIn			IN		DMT_STRUTTURA_ORG.DENOMINAZIONE%type,	-- Denominazione della UO da eliminare (ricerca case insensitiive in like senza forzare % finale)
3305        			MotiviIn				IN		DMT_ACTIVITIES.NOTE%type,			-- Motivi della cancellazione/annullamento
3306        			FlgIgnoreWarningIn 		IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 0 o NULL significa che in presenza di WARNING la stored si comporta come in caso di errore; se 1 gli WARNING vengono ignorati
3307        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
3308        																	-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
3309        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
3310        			WarningMsgOut			OUT		VARCHAR2,						-- Messaggio di warning (valorizzato solo se non c'è errore)
3311        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
3312        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
3313        			ErrMsgOut				OUT 		VARCHAR2,						-- Messaggio d'errore
3314        			IdOrganigrammaIn		IN			DMT_ORGANIGRAMMI.ID_ORGANIGRAMMA%type DEFAULT NULL
3315        																			-- Id. dell'organigramma da cui eliminare la UO. Se non specificato è l'ID dell'unico organigramma in cui compare la UO (se individuabile)
3316        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine (senza warning), altrimenti 0 (in caso di errore o warning)
3317        
3318        	/****** funzione per creare o modificare relazioni di un utente con la struttura organizzativa ******/
3319        	function IURelUOUser(
3320        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
3321        																	-- (obblig). Codice identificativo del token di connessione
3322        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
3323        			CIRelUserUOIO			IN OUT	VARCHAR2,						-- Codice identificativo della relazione UO-utente da modificare. Se NULL si intende che la relazione è da creare ex-novo
3324        																	-- E' dato da <ID_UO>.<ID_USER>.<flag del tipo di relazione (A/L/D)>.<inizio validità relazione nel formato DD/MM/RRRR>.<ID_RUOLO_AMM>
3325        			IdUOIn				IN		DMT_STRUTTURA_ORG.ID_UO%type DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),
3326        																	-- Id.della UO a cui collegare l'utente. 
3327        			NriLivelliUOIn			IN		VARCHAR2 DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
3328        																	-- N.ri livelli della UO a cui collegare l'utente.
3329        																	-- I nri vanno indicati così come appaiono nella GUI e con il saparatore previsto nella GUI per i livelli UO
3330        			DenominazioneUOIn			IN		VARCHAR2 DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
3331        																	-- Denominazione della UO a cui collegare l'utente.
3332        																	-- Può essere la denominazione semplice o la concatenazione con separatore "|" delle denominazioni delle UO gerarchicamente superiori + quella della UO
3333        			IdUserIn				IN		DMT_USERS.ID_USER%type DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),
3334        																	-- Id.dell'utente da collegare alla U.O.
3335        																	-- Viene considerato solo se i 2 argomenti successivi sono valorizzati e in caso non congruente con essi viene ignorato
3336        			DesUserIn				IN		DMT_USERS.DES_USER%type DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
3337        																	-- Descrizione dell'utenza da collegare alla U.O.
3338        			UsernameIn				IN		DMT_USERS.USERNAME%type DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
3339        																	-- Username dell'utenza da collegare alla U.O.
3340        			DtInizioVldIn			IN		VARCHAR2 DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'DATE_VAL_NO_UPD'),
3341        																	-- (obblig.) Data di inizio validità della relazione (nel formato dato dal parametro di conf. FMT_STD_DATA).
3342        			DtFineVldIn				IN		VARCHAR2 DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'DATE_VAL_NO_UPD'),
3343        																	-- Data di fine validità della relazione (nel formato dato dal parametro di conf. FMT_STD_DATA).
3344        			FlgTipoRelIn			IN		VARCHAR2 DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
3345        																	-- (obblig.) Tipo della relazione utente - U.O.. Valori possibili:
3346        																	-- A = appartenenza gerarchica
3347        																	-- D = funzionale, ovvero "delega" 
3348        																	-- L = a gestire documentazione della UO anche se quest'ultima è cessata
3349        			FlgInclSottoUOIn			IN		PLS_INTEGER DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),
3350        																	-- (valori 1/0; viene considerato solo se la relazione è di tipo L o D) Indica se la relazione dell'utente è anche verso le sotto-UO della U.O. indicata 
3351        			FlgInclScrivVirtIn		IN		PLS_INTEGER DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),
3352        																	-- (valori 1/0; viene considerato solo se la relazione è di tipo L o D) Indica se la relazione dell'utente è anche verso le scrivanie virtuali della U.O. indicata (e delle sue sotto-UO se anch'esse sono incluse nella relazione)
3353        			FlgXScrivaniaIn			IN		VARCHAR2 DEFAULT 'V',				-- (valori N/V/NULL) Indica se in corrispondenza dell'associazione utente-UO deve esserci scrvania virtuale o meno e se questa deve essere creata ex-novo o meno. Valori ammessi:
3354        																	-- N = relazione con scrivania, da creare ex-novo
3355        																	-- V = relazione con scrivania, scelta tra una già esistente
3356        																	-- NULL = relazione senza scrivania (scelta possibile solo se il tipo di relazione è L o D)
3357        			IdScrivaniaIO			IN OUT	DMT_SCRIVANIE_VIRTUALI.ID_SCRIVANIA%type,	-- (in input è considerato solo se FlgXScrivaniaIn=V) Id. della scrivania già esistente da dare all'utente nella relazione
3358        																	-- In output è l'id. della scrivania (preesistente o appena creata) occupata dall'utente nella relazione
3359        			IntestazioneScrivaniaIn		IN		DMT_SCRIVANIE_VIRTUALI.INTESTAZIONE%type DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
3360        																	-- Intestazione della scrivania già esistente da dare all'utente nella relazione
3361        			NuovaIntestazioneScrivaniaIO	IN OUT	DMT_SCRIVANIE_VIRTUALI.INTESTAZIONE%type,	-- Nuova intestazione della scrivania già esistente o da creare/creata ex-novo che è occupata dall'utente nella relazione
3362        																	-- Se in input non è valorizzata o è valorizzata a <COMPOSIZIONE AUTOMATICA> e c'è la scrivania, la sua intestazione verrà creata o aggiornata in automatico e restituita in output
3363        			IdRuoloAmmIn			IN		DMT_RUOLI_AMM.ID_RUOLO_AMM%type DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),
3364        																	-- Id. del ruolo ricoperto dall'utente nella sua relazione con la UO
3365        			DesRuoloAmmIn			IN		DMT_RUOLI_AMM.DES_RUOLO_AMM%type DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
3366        																	-- Descrizione del ruolo ricoperto dall'utente nella sua relazione con la UO
3367        			ListaEsclusioniUOPPIn	IN			VARCHAR2 DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
3368        																	-- Esclusioni delle UO collegate al Punto di Protocollo vs cui è definita la relazione: sono le UO collegate al punto di protocollo vs le quali l'utente non deve acquisire relazione di tipo L come altrimenti accade
3369        																	-- E' una lista di ID_UO separati da ; o ,
3370        			FlgPrimarioConRuoloIn		IN		PLS_INTEGER DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),
3371        																	--(1/0/NULL) Indica se l'utente è il primario degli utenti con lo stesso ruolo (eventualmente nella UO)		
3372        																	-- 			 Diventato flag di abilitazione alla documentazione riservata assegnata/in conoscenza alla UO
3373        			IdProfiloIn				IN		DMT_PROFILI.ID_PROFILO%type DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),
3374        																	-- Id. del profilo di DMT_PROFILI (uno di quelli che hanno un nome) da assegnare alla scrivania occupata dall'utente
3375        			NomeProfiloIn			IN		DMT_PROFILI.NOME_PROFILO%type DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
3376        																	-- Nome del profilo di DMT_PROFILI da assegnare alla scrivania occupata dall'utente (ricerca case-insensitive in like)	
3377        			XMLDatiProfiloIn			IN		CLOB DEFAULT NULL,				-- XML (conforme a schema SezioneCache.xsd) che contiene tutti gli attributi del profilo della scrivania occupata dall'utente (tranne i gruppi di privilegi) da settare/aggiornare
3378        																	-- ATTENZIONE: Si intende che gli attributi corrispondenti a tag non presenti restino invariati
3379        																	-- Nell'XML possono esserci tag corrispondenti ad attributi di profilatura solo se non si è specificato un profilo predefinito con i due argomenti IdProfiloIn e/o NomeProfiloIn
3380        			FlgModGruppiPrivIn		IN		VARCHAR2 DEFAULT 'I',				-- (valori I/C) Indica se i gruppi di privilegi indicati nell'argomento successivo sono forniti in modo incrementale (=I) (solo quelle da inserire/cancellare) oppure completo (=C), vale a dire che dovranno soppiantare tutti quelli già associati alla scivania occupata dall'utente 
3381        			XMLGruppiPrivIn			IN		CLOB DEFAULT NULL,				-- Lista con i gruppi di privilegi assegnati/da assegnare direttamente (ovvero non tramite profilo) alla scrivania occupata dall'utente  (XML conforme a schema LISTA_STD.xsd)					
3382        																	-- Ogni gruppo è un tag "Riga" che può contenere le seguenti colonne:
3383        																	-- 1: Identificativo del gruppo di privilegi
3384        																	-- 2: Nome del gruppo di privilegi (ricerca case insesnsitive in like)
3385        																	-- 3: (valori 1/0/NULL) Flag di gruppo da eliminare
3386        			FlgModGruppiAppIn			IN		VARCHAR2 DEFAULT 'I',				-- (valori I/C) Indica se i gruppi cui appartiene la scrivania occupata dall'utente indicati nell'argomento successivo sono forniti in modo incrementale (=I) (solo quelle da aggiungere o cancellare) oppure completo (=C), vale a dire che dovranno soppiantare tutte quelle già specificati (e relativi al dominio di lavoro) in caso di scrivania già esistente
3387        			XMLGruppiAppIn			IN		CLOB DEFAULT NULL,				-- Lista con i gruppi cui appartiene la scrivania occupata dall'utente
3388        																	-- Ogni gruppo di appartenenza è un tag "Riga" con le colonne:
3389        																	-- 1: Id. del gruppo
3390        																	-- 2: Nome del gruppo
3391        																	-- 3: (valori 1/0) Flag di appartenenza a gruppo da eliminare
3392        			RowidScrivaniaOut			OUT		VARCHAR2,						-- Rowid del record della scrivania occupata dall'utente
3393        			AttributiAddIn			IN		CLOB DEFAULT NULL,				-- XML contenente nomi e valori degli attributi dinamici della scrivania da aggiornare (conforme allo schema SezioneCache.xsd) 
3394        																	-- Gli attributi già presenti in DB e per i quali non c'è corrispondente nell'XML restano invariati
3395        																	-- Per tutti gli attributi vale quanto segue:
3396        																	-- Un attributo da settare è un tag "Variabile" dell'XML il cui tag "Nome" contiene il nome identificativo dell'attributo (ATTR_NAME di DMT_ATTRIBUTES_DEF)
3397        																	-- Un attributo da settare è una variabile con tag "ValoreSemplice" se è un attributo a singolo valore e non strutturato (cioè con tipo diverso da COMPLEX)
3398        																	-- altrimenti è una variabile con tag "Lista" che ha un'unica colonna con "Nro" pari a 1 se l'attributo non è strutturato, che ha invece tante colonne quanti gli attributi componenti (ordinate in base al loro NRO_ORD_IN_SUP) se l'attributo è complesso 
3399        																	-- Nel caso di variabili con tag "Lista" i valori specificati nell'XML si aggiungono o sostituiscono quelli già presenti in DB a seconda che nell'XML sia presente o meno una variabile con tag "Nome" pari a #Append_<Nome attributo> e tag "ValoreSemplice" pari a 1  
3400        																	-- In particolare se non sono specificati valori nell'XML (tag Lista vuoto) e se i valori non sono da aggiungere significa che tutti i valori dell'attributo già presenti in DB vanno rimossi
3401        			FlgStoricizzaDatiIn		IN		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0) Se 1 i veranno storicizzati: cambio di UO; cambio di utenza; intestazione della scrivania
3402        			FlgIgnoreWarningIn 		IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 0 o NULL significa che in presenza di WARNING la stored si comporta come in caso di errore; se 1 gli WARNING vengono ignorati
3403        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
3404        																	-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
3405        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
3406        			WarningMsgOut			OUT		VARCHAR2,						-- Messaggio di warning (valorizzato solo se non c'è errore)
3407        			FlgDatiDaStoricizzareOut	OUT		PLS_INTEGER,					-- (valori 1/NULL) Se FlgStoricizzaDatiIn non è valorizzato e se si sono modificati dati che è previsto storicizzare viene restituito pari a 1
3408        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
3409        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
3410        			ErrMsgOut				OUT 	VARCHAR2,						-- Messaggio d'errore
3411        			FlgIgnoreSingolaAppIn	IN		PLS_INTEGER	DEFAULT NULL,		-- Se 1 salta il controllo che l'utente abbia in un certo momento una sola relazione di appartenenza gerarchica
3412        			FlgTipoDestDocIn		IN		VARCHAR2 DEFAULT NULL,			-- (valori UO/SV) Tipo - UO o SV (=scrivania) - del destinatario a cui a cui spostare documenti e fascicoli assegnati alla scrivania
3413        			IdUOSVDestDocIn			IN		INTEGER DEFAULT NULL,			-- Id. della UO o scrivania a cui spostare documenti e fascicoli assegnati alla scrivania (in genere impostata in caso di cessazione della UO)	
3414        			CallingFuncIn			IN		VARCHAR2 DEFAULT NULL,			-- Funzione chiamante
3415        			FlgAccessoDocLimSVIn	IN		PLS_INTEGER DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),
3416        																			-- (valori 1/0) Se 1 l'utente ha accesso solo ai documenti della sua scrivania e non della UO
3417        			FlgRegistrazioneEIn		IN		PLS_INTEGER DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),
3418        																			-- (valori 1/0) Se 1 l'utente può protocollare/registrare in entrata per la struttura
3419        			FlgRegistrazioneUIIn	IN		PLS_INTEGER DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),		
3420        																			-- (valori 1/0) Se 1 l'utente può protocollare/registrare in uscita/interno per la struttura (e creare bozze con mittente la struttura) 
3421        			FlgGestAttiIn			IN		PLS_INTEGER DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),
3422        																			-- (valori 1/0) Se 1 l'utente può avviare atti/gestire atti con la struttura come proponente
3423        			FlgVisPropAttiInIterIn	IN		PLS_INTEGER DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),
3424        																			-- (valori 1/0) Se 1 l'utente può visualizzare proposte di atti ancora in iter e non adottati che abbiano la struttura come proponente
3425        			FlgGestAttiAllIn		IN		PLS_INTEGER DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),
3426        																			-- (valori 1/0) Se 1 l'utente può avviare atti/gestire atti di tutti i tipi per la struttura
3427        			ListaIdProcTyGestAttiIn	IN		VARCHAR2 DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
3428        																			-- Lista con ID dei tipi processi degli atti a cui l'utente è abilitato in avvio/gestione per la data struttura (separati da ;)
3429        			FlgVisPropAttiAllIn		IN		PLS_INTEGER DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),
3430        																			-- (valori 1/0) Se 1 l'utente per la data struttura può visualizzare proposte di atti ancora in iter e non adottati di tutti i tipi
3431        			ListaIdProcTyVisPropAttiIn	IN		VARCHAR2 DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD')
3432        																			-- Lista con ID dei tipi processi degli atti a cui l'utente è abilitato in visualizzazione per la data struttura (separati da ;)
3433        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine (senza warning), altrimenti 0 (in caso di errore o warning)
3434        
3435        	/*********** funzione per cancellare fisicamente una relazione UO-utente ****************/
3436        	function DRelUOUser(
3437        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
3438        																	-- (obblig). Codice identificativo del token di connessione
3439        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
3440        			IdUOIn				IN		DMT_STRUTTURA_ORG.ID_UO%type DEFAULT NULL,
3441        																	-- Id.della UO della relazione 
3442        			NriLivelliUOIn			IN		VARCHAR2 DEFAULT NULL,				-- N.ri livelli della UO della relazione 
3443        																	-- I nri vanno indicati così come appaiono nella GUI e con il saparatore previsto nella GUI per i livelli UO
3444        			DenominazioneUOIn			IN		VARCHAR2 DEFAULT NULL,				-- Denominazione della UO della relazione.
3445        																	-- Può essere la denominazione semplice o la concatenazione con separatore "|" delle denominazioni delle UO gerarchicamente superiori + quella della UO
3446        			IdUserIn				IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id.dell'utente della relazione 
3447        			DesUserIn				IN		DMT_USERS.DES_USER%type DEFAULT NULL,	-- Descrizione dell'utenza della relazione 
3448        			UsernameIn				IN		DMT_USERS.USERNAME%type DEFAULT NULL,	-- Username dell'utenza della relazione 
3449        			FlgTipoRelIn			IN		VARCHAR2 DEFAULT NULL,				-- Tipo della relazione utente - U.O.. Valori possibili:
3450        																				-- A = appartenenza gerarchica
3451        																				-- D = funzionale, ovvero "delega" 
3452        																				-- L = a gestire documentazione della UO anche se quest'ultima è cessata
3453        			DtInizioVldIn			IN		VARCHAR2 DEFAULT NULL,				-- Data di inizio validità della relazione (nel formato dato dal parametro di conf. FMT_STD_DATA).
3454        			IdRuoloAmmIn			IN		VARCHAR2 DEFAULT NULL,				-- Id. del ruolo ricoperto
3455        			DesRuoloAmmIn			IN		VARCHAR2 DEFAULT NULL,				-- Descrizione del ruolo ricoperto
3456        			MotiviIn				IN		DMT_ACTIVITIES.NOTE%type DEFAULT NULL,	-- Motivi della cancellazione
3457        			FlgIgnoreWarningIn 		IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 0 o NULL significa che in presenza di WARNING la stored si comporta come in caso di errore; se 1 gli WARNING vengono ignorati
3458        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
3459        																	-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
3460        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
3461        			WarningMsgOut			OUT		VARCHAR2,						-- Messaggio di warning (valorizzato solo se non c'è errore)
3462        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
3463        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
3464        			ErrMsgOut				OUT 	VARCHAR2,						-- Messaggio d'errore
3465        			CallingFuncIn			IN		VARCHAR2 DEFAULT NULL			-- Funzione chiamante
3466        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine (senza warning), altrimenti 0 (in caso di errore o warning)
3467        
3468        	/******** funzione per estrarre i dati di dettaglio di una scrivania di cui siano noti id. e/o intestazione **********/
3469        	function LoadDettScrivania(
3470        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
3471        																	-- (obblig). Codice identificativo del token di connessione
3472        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
3473        			IdScrivaniaIO			IN OUT	DMT_SCRIVANIE_VIRTUALI.ID_SCRIVANIA%type,	-- Id.della scrivania virtuale
3474        			IntestazioneScrivaniaIO		IN OUT	DMT_SCRIVANIE_VIRTUALI.INTESTAZIONE%type,	-- Attuale intestazione della scrivania virtuale
3475        			IdProfiloOut			OUT		DMT_PROFILI.ID_PROFILO%type ,			-- Id. del profilo di DMT_PROFILI assegnato alla scrivania 
3476        			NomeProfiloOut			OUT		DMT_PROFILI.NOME_PROFILO%type,		-- Nome del profilo di DMT_PROFILI assegnato alla scrivania 	
3477        			XMLDatiProfiloOut			OUT		NOCOPY CLOB,					-- XML (conforme a schema SezioneCache.xsd) che contiene tutti gli attributi del profilo della scrivania (tranne i gruppi di privilegi) 
3478        			XMLGruppiPrivOut			OUT		NOCOPY CLOB,					-- Lista con i gruppi di privilegi assegnati direttamente (ovvero non tramite profilo) alla scrivania (XML conforme a schema LISTA_STD.xsd)					
3479        																	-- Ogni gruppo è un tag "Riga" che può contenere le seguenti colonne:
3480        																	-- 1: Identificativo del gruppo di privilegi
3481        																	-- 2: Nome del gruppo di privilegi 
3482        			XMLGruppiAppOut			OUT		NOCOPY CLOB,					-- Lista con i gruppi cui appartiene la scrivania occupata dall'utente nella relazione
3483        																	-- Ogni gruppo di appartenenza è un tag "Riga" con le colonne:
3484        																	-- 1: Id. del gruppo
3485        																	-- 2: Nome del gruppo
3486        			RowidOut				OUT		VARCHAR2,						-- Rowid del record della scrivania 
3487        			AttributiAddOut			OUT		NOCOPY CLOB,					-- Lista degli eventuali ulteriori attributi con cui caratterizzare la scrivania (XML conforme a schema LISTA_STD.xsd)
3488        																	-- Ogni attributo è un tag "Riga" che contiene le seguenti colonne:
3489        																	-- 1: N.ro (valori da 1 a n) del riquadro (fieldset) in cui mostrare l'attributo
3490        																	-- 2: Nome identificativo dell'attributo (ATTR_NAME)
3491        																	-- 3: Label del campo con cui rappresentare l'attributo 
3492        																	-- 4: Tipo di attributo. Valori: DATE, DATETIME, TEXT, TEXT-AREA, CHECK, INTEGER, EURO, DECIMAL, COMBO-BOX, LISTA
3493        																	-- 5: N.ro massimo di caratteri/cifre
3494        																	-- 6: Larghezza del campo con cui rappresentare l'attributo (size)
3495        																	-- 7: Valore dell'attributo
3496        																	-- 8: Label del riquadro (fieldset) in cui mostrare l'attributo
3497        																	-- 9: (valori 1/0) 1 indica che l'attributo è obbligatorio, 0 che è facoltativo
3498        																	-- 10: Altezza (in nro righe) del campo con cui rappresentare l'attributo (se TEXT-AREA)
3499        																	-- 11:(valori 1/0) 1 indica se l'attributo è modificabile, 0 che è in sola visualizzazione   
3500        			BachSizeOut				OUT		PLS_INTEGER,					-- Indica il massimo n.ro di record per ogni pagina da mostrare nelle liste del dettaglio
3501        			FlgMostraAltriAttrOut		OUT		PLS_INTEGER,					-- (valori 1/0) Se 1 nella GUI vanno mostrati gli attributi addizionali (ce ne sono di visibile all'utente), se 0 no
3502        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
3503        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
3504        			ErrMsgOut				OUT 		VARCHAR2						-- Messaggio d'errore
3505        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine , altrimenti 0 (in caso di errore o warning)
3506        
3507        	/****** funzione per estrarre i dettagli di una relazione di un utente con la struttura organizzativa ******/
3508        	function LoadDettRelUOUser(
3509        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
3510        																	-- (obblig). Codice identificativo del token di connessione
3511        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
3512        			IdUOIO				IN OUT	DMT_STRUTTURA_ORG.ID_UO%type,			-- Id.della UO della relazione 
3513        			NriLivelliUOIO			IN OUT	VARCHAR2,						-- N.ri livelli della UO della relazione 
3514        																	-- I nri vanno indicati così come appaiono nella GUI e con il saparatore previsto nella GUI per i livelli UO
3515        			DenominazioneUOIO			IN OUT	VARCHAR2,						-- Denominazione della UO della relazione.
3516        																	-- Può essere la denominazione semplice o la concatenazione con separatore "|" delle denominazioni delle UO gerarchicamente superiori + quella della UO
3517        			IdUserIO				IN OUT	DMT_USERS.ID_USER%type,				-- Id.dell'utente della relazione 
3518        			DesUserIO				IN OUT	DMT_USERS.DES_USER%type,			-- Descrizione dell'utenza della relazione 
3519        			UsernameIO				IN OUT	DMT_USERS.USERNAME%type,			-- Username dell'utenza della relazione 
3520        			FlgTipoRelIO			IN OUT	VARCHAR2,						-- Tipo della relazione utente - U.O.. Valori possibili:
3521        																			-- A = appartenenza gerarchica
3522        																			-- D = funzionale, ovvero "delega" 
3523        																			-- L = a gestire documentazione della UO anche se quest'ultima è cessata
3524        			DtInizioVldIO			IN OUT 	VARCHAR2,						-- Data di inizio validità della relazione (nel formato dato dal parametro di conf. FMT_STD_DATA).
3525        			DtFineVldOut			OUT		VARCHAR2,						-- Data di fine validità della relazione (nel formato dato dal parametro di conf. FMT_STD_DATA).
3526        			FlgInclSottoUOOut			OUT		PLS_INTEGER,					-- (valori 1/0; può essere 1 solo se la relazione è di tipo L o D) Indica se la relazione dell'utente è anche verso le sotto-UO della U.O. indicata 
3527        			FlgInclScrivVirtOut		OUT		PLS_INTEGER,					-- (valori 1/0; può essere 1 solo se la relazione è di tipo L o D) Indica se la relazione dell'utente è anche verso le scrivanie virtuali della U.O. indicata (e delle sue sotto-UO se anch'esse sono incluse nella relazione)
3528        			IdScrivaniaOut			OUT		DMT_SCRIVANIE_VIRTUALI.ID_SCRIVANIA%type,	-- Id. della scrivania occupata dall'utente nella relazione
3529        			IntestazioneScrivaniaOut	OUT		DMT_SCRIVANIE_VIRTUALI.INTESTAZIONE%type,	-- Intestazione della scrivania occupata dall'utente nella relazione
3530        			IdRuoloAmmIO			IN OUT	DMT_RUOLI_AMM.ID_RUOLO_AMM%type,		-- Id. del ruolo ricoperto dall'utente nella sua relazione con la UO
3531        			DesRuoloAmmOut			OUT		DMT_RUOLI_AMM.DES_RUOLO_AMM%type,		-- Descrizione del ruolo ricoperto dall'utente nella sua relazione con la UO
3532        			FlgPrimarioConRuoloOut		OUT		PLS_INTEGER,					--(1/0) Indica se l'utente è il primario degli utenti con lo stesso ruolo (eventualmente nella UO)			
3533        																				-- 			 Diventato flag di abilitazione alla documentazione riservata assegnata/in conoscenza alla UO
3534        			IdProfiloOut			OUT		DMT_PROFILI.ID_PROFILO%type ,			-- Id. del profilo di DMT_PROFILI assegnato alla scrivania occupata dall'utente nella relazione
3535        			NomeProfiloOut			OUT		DMT_PROFILI.NOME_PROFILO%type,		-- Nome del profilo di DMT_PROFILI assegnato alla scrivania occupata dall'utente nella relazione	
3536        			XMLDatiProfiloOut			OUT		NOCOPY CLOB,					-- XML (conforme a schema SezioneCache.xsd) che contiene tutti gli attributi del profilo della scrivania occupata dall'utente nella relazione (tranne i gruppi di privilegi) 
3537        			XMLGruppiPrivOut			OUT		NOCOPY CLOB,					-- Lista con i gruppi di privilegi assegnati direttamente (ovvero non tramite profilo) alla scrivania occupata dall'utente nella relazione (XML conforme a schema LISTA_STD.xsd)					
3538        																	-- Ogni gruppo è un tag "Riga" che può contenere le seguenti colonne:
3539        																	-- 1: Identificativo del gruppo di privilegi
3540        																	-- 2: Nome del gruppo di privilegi 
3541        			XMLGruppiAppOut			OUT		NOCOPY CLOB,					-- Lista con i gruppi cui appartiene la scrivania occupata dall'utente nella relazione
3542        																	-- Ogni gruppo di appartenenza è un tag "Riga" con le colonne:
3543        																	-- 1: Id. del gruppo
3544        																	-- 2: Nome del gruppo
3545        			FlgUOPPOut				OUT		PLS_INTEGER,			-- Se 1 indica che la UO verso cui c'è la relazione è un punto di protocollo
3546        			XMLUOPPOut				OUT		NOCOPY CLOB,			-- Lista delle UO collegate al punto di protocollo verso cui c'è la relazione
3547        																	-- Ogni riga rappresenta una UO collegata al punto di protocollo ed è un tag "Riga" che contiene le seguenti colonne:
3548        																	-- 1: Id UO della UO collegata al punto di protocollo
3549        																	-- 2: Livelli della UO collegata al punto di protocollo (come vanno mostrati nella GUI)
3550        																	-- 3: Denominazione della UO collegata al punto di protocollo 
3551        																	-- 4: (flag 1/0) Se 1 l'utente deriva dalla relazione con il PP quella verso la UO collegata al PP, se 0 no
3552        			RowidOut				OUT		VARCHAR2,				-- Rowid del record della scrivania occupata dall'utente nella relazione
3553        			AttributiAddOut			OUT		NOCOPY CLOB,			-- Lista degli eventuali ulteriori attributi con cui caratterizzare la scrivania occupata dall'utente nella relazione (XML conforme a schema LISTA_STD.xsd)
3554        																	-- Ogni attributo è un tag "Riga" che contiene le seguenti colonne:
3555        																	-- 1: N.ro (valori da 1 a n) del riquadro (fieldset) in cui mostrare l'attributo
3556        																	-- 2: Nome identificativo dell'attributo (ATTR_NAME)
3557        																	-- 3: Label del campo con cui rappresentare l'attributo 
3558        																	-- 4: Tipo di attributo. Valori: DATE, DATETIME, TEXT, TEXT-AREA, CHECK, INTEGER, EURO, DECIMAL, COMBO-BOX, LISTA
3559        																	-- 5: N.ro massimo di caratteri/cifre
3560        																	-- 6: Larghezza del campo con cui rappresentare l'attributo (size)
3561        																	-- 7: Valore dell'attributo
3562        																	-- 8: Label del riquadro (fieldset) in cui mostrare l'attributo
3563        																	-- 9: (valori 1/0) 1 indica che l'attributo è obbligatorio, 0 che è facoltativo
3564        																	-- 10: Altezza (in nro righe) del campo con cui rappresentare l'attributo (se TEXT-AREA)
3565        																	-- 11:(valori 1/0) 1 indica se l'attributo è modificabile, 0 che è in sola visualizzazione   
3566        			BachSizeOut				OUT		PLS_INTEGER,					-- Indica il massimo n.ro di record per ogni pagina da mostrare nelle liste del dettaglio
3567        			FlgMostraAltriAttrOut		OUT		PLS_INTEGER,					-- (valori 1/0) Se 1 nella GUI vanno mostrati gli attributi addizionali (ce ne sono di visibile all'utente), se 0 no
3568        			FlgPresentiDocFascOut	OUT		PLS_INTEGER,					-- Flag 1/0/NULL che indica se c'è almeno un documento o fascicolo assegnato alla scrivania (=1) o nessuno
3569        			FlgTipoDestDocOut		OUT		VARCHAR2,						-- (valori UO/SV) Tipo - UO o SV (=scrivania) - del destinatario a cui a cui spostare documenti e fascicoli assegnati alla scrivania
3570        			IdUOSVDestDocFascOut	OUT		INTEGER,						-- Id. della UO o scrivania a cui spostare documenti e fascicoli assegnati alla scrivania (in genere impostata in caso di cessazione della UO)	
3571        			LivelliUODestDocFascOut	OUT		VARCHAR2,						-- Livelli della UO a cui spostare documenti e fascicoli assegnati alla scrivania (in genere impostata in caso di cessazione della UO)	
3572        			DesUODestDocFascOut		OUT		VARCHAR2,						-- Denominazione della UO o scrivania a cui spostare documenti e fascicoli assegnati alla scrivania (in genere impostata in caso di cessazione della UO)
3573        			StatoSpostDocFascOut	OUT		VARCHAR2,						-- Indica lo stato dello spostamento di documenti e fascicoli dalla scrivania ad altra UO o scrivania indicata: da avviare, in corso, completato
3574        			TsInizioSpostDocFascOut	OUT		VARCHAR2,						-- Data e ora (prevista o effettiva) di inizio spostamento di documenti e fascicoli nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP
3575        			TsFineSpostDocFascOut	OUT		VARCHAR2,						-- Data e ora di fine spostamento di documenti e fascicoli nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP
3576        			NroDocAssOut			OUT		INTEGER,						-- N.ro di documenti ancora assegnati alla scrivania
3577        			TsRilevNroDocAssOut		OUT		VARCHAR2,						-- Data e ora di rilevamento - nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP - del n.ro di documenti assegnati alla scrivania indicato in NroDocAssOut														
3578        			NroFascAssOut			OUT		INTEGER,						-- N.ro di fascicoli ancora assegnati alla scrivania
3579        			TsRilevNroFascAssOut	OUT		VARCHAR2,						-- Data e ora di rilevamento - nel formato dato dal parametro di conf. FMT_STD_TIMESTAMP - del n.ro di fascicoli assegnati alla scrivania indicato in NroDocFascOut														
3580        			FlgAccessoDocLimSVOut	OUT		PLS_INTEGER,					-- (valori 1/0) Se 1 l'utente ha accesso solo ai documenti della sua scrivania e non della UO
3581        			FlgRegistrazioneEOut	OUT		PLS_INTEGER,					-- (valori 1/0) Se 1 l'utente può protocollare/registrare in entrata per la struttura
3582        			FlgRegistrazioneUIOut	OUT		PLS_INTEGER,					-- (valori 1/0) Se 1 l'utente può protocollare/registrare in uscita/interno per la struttura (e creare bozze con mittente la struttura) 
3583        			FlgGestAttiOut			OUT		PLS_INTEGER,					-- (valori 1/0) Se 1 l'utente può avviare atti/gestire atti con la struttura come proponente
3584        			FlgVisPropAttiInIterOut	OUT		PLS_INTEGER,					-- (valori 1/0) Se 1 l'utente può visualizzare proposte di atti ancora in iter e non adottati che abbiano la struttura come proponente
3585        			FlgGestAttiAllOut		OUT		PLS_INTEGER,					-- (valori 1/0) Se 1 l'utente può avviare atti/gestire atti di tutti i tipi per la struttura
3586        			ListaIdProcTyGestAttiOut	OUT		VARCHAR2,					-- Lista con ID dei tipi processi degli atti a cui l'utente è abilitato in avvio/gestione per la data struttura (separati da ;)
3587        			FlgVisPropAttiAllOut		OUT		PLS_INTEGER,				-- (valori 1/0) Se 1 l'utente per la data struttura può visualizzare proposte di atti ancora in iter e non adottati di tutti i tipi
3588        			ListaIdProcTyVisPropAttiOut	OUT		VARCHAR2,					-- Lista con ID dei tipi processi degli atti a cui l'utente è abilitato in visualizzazione per la data struttura (separati da ;)
3589        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
3590        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
3591        			ErrMsgOut				OUT 		VARCHAR2					-- Messaggio d'errore
3592        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine , altrimenti 0 (in caso di errore o warning)
3593        
3594        	/*** Funzione di creazione delega da utente a utente											***/
3595        	/*** se la delega già esiste non viene dato errore (viene solo aggiornato il perido di validità)			***/
3596        	function AddDelegaVsUser(
3597        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
3598        																	-- (obblig). Codice identificativo del token di connessione
3599        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
3600        			DelDa_IdUserIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a cui dare la delega. 
3601        			DelDa_DesUserIn			IN 		DMT_USERS.DES_USER%type DEFAULT NULL,	-- Cognome e nome /descrizione dell'utente a cui dare la delega
3602        			DelDa_UsernameIn			IN		DMT_USERS.USERNAME%type DEFAULT NULL,	-- Username (interna al sistema) dell'utente a cui dare la delega
3603        			DelVs_IdUserIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente verso cui dare la delega. 
3604        			DelVs_DesUserIn			IN 		DMT_USERS.DES_USER%type DEFAULT NULL,	-- Cognome e nome /descrizione dell'utente verso cui dare la delega
3605        			DelVs_UsernameIn			IN		DMT_USERS.USERNAME%type DEFAULT NULL,	-- Username (interna al sistema) dell'utente a cui dare la delega
3606        			DtInizioVldIn			IN		VARCHAR2 DEFAULT NULL,				-- Data di inizio validità (nel formato dato dal parametro di conf. FMT_STD_DATA) della delega.
3607        			DtFineVldIn				IN		VARCHAR2 DEFAULT NULL,				-- Data di fine validità (nel formato dato dal parametro di conf. FMT_STD_DATA) della delega.
3608        			NaturaMotiviIn			IN		VARCHAR2 DEFAULT NULL,				-- Natura/motivi della delega
3609        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
3610        																	-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
3611        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,			-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
3612        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
3613        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
3614        			ErrMsgOut				OUT 		VARCHAR2						-- Messaggio d'errore
3615        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine, altrimenti 0 (in caso di errore o warning)
3616        
3617        	/******** funzione per gestire/aggiornare le deleghe di un dato utente vs altri utenti ********/
3618        	function SetDelegheUserVsUsers(
3619        			CodIdConnectionTokenIn		IN	    DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
3620        																						-- (obblig). Codice identificativo del token di connessione
3621        			IdUserLavoroIn				IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
3622        			IdUserIn					IN 		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente di cui gestire/aggiornare le deleghe
3623        			UsernameIn					IN		DMT_USERS.USERNAME%type DEFAULT NULL,	-- Username (interna al sistema) dell'utente di cui gestire/aggiornare le deleghe
3624        			DesUserIn					IN 		DMT_USERS.DES_USER%type DEFAULT NULL,	-- Cognome e nome/descrizione dell'utente (ricerca case insensitive in like senza forzare il % finale) di cui gestire/aggiornare le deleghe
3625        																						-- ATTENZIONE: Se nessuno dei 3 argomenti precedenti è valorizzato si intende che l'utente di cui gestire/aggiornare le deleghe sia quello connesso
3626        			FlgModDelegheIn				IN		VARCHAR2 DEFAULT 'I',					-- (valori I/C) Indica se le deleghe vs utenti indicate nell'argomento successivo sono fornite in modo incrementale (=I) (solo quelle da aggiungere o cancellare) oppure completo (=C), vale a dire che dovranno soppiantare tutte quelle già specificate (solo quelle relative ad utenti accreditati sul dominio di lavoro)
3627        			XMLDelegheIn				IN		CLOB DEFAULT NULL,						-- Lista delle deleghe vs utenti da aggiornare (XML conforme a schema LISTA_STD.xsd)					
3628        																						-- Ogni delega è un tag "Riga" che contiene le seguenti colonne:
3629        																						-- 1: Rowid che indica il record di delega da aggiornare/eliminare
3630        																						-- 2: Identificativo (ID_USER) dell'utente verso cui c'è la delega
3631        																						-- 3: Denominazione/descrizione dell'utente verso cui c'è la delega (o suo inizio; ricerca case insensitive in like senza forzare il % finale). 
3632        																						-- 4: Data di inizio validità della delega (nel formato dato dal parametro di config. FMT_STD_DATA). Se NULL si intende valida da tempo illimitato	
3633        																						-- 5: Data di fine validità della delega (nel formato dato dal parametro di config. FMT_STD_DATA). Se NULL si intende valida illimitatamente.
3634        																						-- 6: Motivo/i della delega
3635        																						-- 7: (valori 1/0/NULL) Flag di delega da eliminare
3636        			FlgRollBckFullIn		IN 			PLS_INTEGER DEFAULT NULL,				-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
3637        																						-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
3638        			FlgAutoCommitIn			IN 			PLS_INTEGER DEFAULT NULL,				-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
3639        			ErrContextOut			OUT			VARCHAR2,								-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
3640        			ErrCodeOut				OUT			PLS_INTEGER,							-- N.ro errore di uscita
3641        			ErrMsgOut				OUT 		VARCHAR2								-- Messaggio d'errore
3642        			) return PLS_INTEGER;														-- Vale 1 se tutto è andato a buon fine, altrimenti 0 (in caso di errore)
3643        
3644        	/******** funzione per ottenere le deleghe di un dato utente vs altri utenti accreditati sul dominio di lavoro ********/
3645        	function GetDelegheUserVsUsers(
3646        			CodIdConnectionTokenIn		IN	    DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
3647        																						-- (obblig). Codice identificativo del token di connessione
3648        			IdUserLavoroIn				IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
3649        			IdUserIn					IN 		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente di cui ottenere le deleghe va altri utenti accreditati sul dominio di lavoro
3650        			UsernameIn					IN		DMT_USERS.USERNAME%type DEFAULT NULL,	-- Username (interna al sistema) dell'utente di cui ottenere le deleghe va altri utenti accreditati sul dominio di lavoro
3651        			DesUserIn					IN 		DMT_USERS.DES_USER%type DEFAULT NULL,	-- Cognome e nome/descrizione dell'utente (ricerca case insensitive in like senza forzare il % finale) di cui ottenere le deleghe va altri utenti accreditati sul dominio di lavoro
3652        																						-- ATTENZIONE: Se nessuno dei 3 argomenti precedenti è valorizzato si intende che l'utente di cui ottenere le deleghe va altri utenti accreditati sul dominio di lavoro sia quello connesso
3653        			XMLDelegheOut				OUT		NOCOPY CLOB,							-- Lista delle deleghe vs utenti accreditati sul dato dominio (XML conforme a schema LISTA_STD.xsd)					
3654        																						-- Ogni delega è un tag "Riga" che contiene le seguenti colonne:
3655        																						-- 1: Rowid che indica il record-delega 
3656        																						-- 2: Identificativo (ID_USER) dell'utente verso cui c'è la delega
3657        																						-- 3: Denominazione/descrizione dell'utente verso cui c'è la delega 
3658        																						-- 4: Data di inizio validità della delega (nel formato dato dal parametro di config. FMT_STD_DATA). Se NULL si intende valida da tempo illimitato	
3659        																						-- 5: Data di fine validità della delega (nel formato dato dal parametro di config. FMT_STD_DATA). Se NULL si intende valida illimitatamente.
3660        																						-- 6: Motivo/i della delega
3661        			ErrContextOut			OUT			VARCHAR2,								-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
3662        			ErrCodeOut				OUT			PLS_INTEGER,							-- N.ro errore di uscita
3663        			ErrMsgOut				OUT 		VARCHAR2								-- Messaggio d'errore
3664        			) return PLS_INTEGER;														-- Vale 1 se tutto è andato a buon fine, altrimenti 0 (in caso di errore)
3665        
3666        	/*########mancano 
3667        	ricerca profili e load. dett. profilo
3668        	*/
3669        
3670        	--------funzione per sapere il tipo di relazione - appartenenza gerarchica o funzionale/delega - da proporre
3671        	--------per una nuova collocazione di un dato utente in una data UO (eventualmente come sostituzione di altro utente)
3672        	function GetTipoNuovaRelUOUser(
3673        		IdUOIn						IN		DMT_STRUTTURA_ORG.ID_UO%type,	-- (obblig.) Id. della UO in cui creare la nuova postazione in organigramma
3674        		IdUserIn					IN		DMT_USERS.ID_USER%type,			-- (obblig.) Id. dell'utente cui assegnare la nuova postazione in organigramma
3675        		DtInizioVldIn				IN		VARCHAR2 DEFAULT NULL,			-- Data di inizio validità della relazione da creare (nel formato DD/MM/RRRR)
3676        																			-- Se non valorizzata si intende pari alla data odierna 
3677        		CIRelUserUOToSubstIn		IN 		VARCHAR2,						-- Codice identificativo della relazione UO-utente da sostituire con la nuova postazione. 
3678        																			-- E' dato da <ID_UO>.<ID_USER>.<flag del tipo di relazione (A/L/D)>.<inizio validità relazione nel formato DD/MM/RRRR>.<ID_RUOLO_AMM>
3679        		FlgTipoRelOut				OUT		VARCHAR2,						-- Indica il tipo di relazione da proporre per la nuova postazione
3680        																			-- A = appartenenza gerarchica 
3681        																			-- D = funzionale/delega
3682        		ErrContextOut				OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
3683        		ErrCodeOut					OUT		PLS_INTEGER,					-- N.ro errore di uscita
3684        		ErrMsgOut					OUT 	VARCHAR2						-- Messaggio d'errore
3685        		) return PLS_INTEGER;												-- Vale 1 se tutto è andato a buon fine, altrimenti 0 (in caso di errore)
3686        
3687        	------ funzione per sostituire un utente nella postazione di un altro
3688        	function SubstUserInRelUO(
3689        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
3690        																	-- (obblig). Codice identificativo del token di connessione
3691        			IdUserLavoroIn			IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
3692        			CIRelUserUOIO			IN OUT	VARCHAR2,						-- Codice identificativo della relazione UO-utente in cui mettere in nuovo utente
3693        																			-- E' dato da <ID_UO>.<ID_USER>.<flag del tipo di relazione (A/L/D)>.<inizio validità relazione nel formato DD/MM/RRRR>.<ID_RUOLO_AMM>
3694        			IdUserNewIn				IN		DMT_USERS.ID_USER%type DEFAULT NULL,
3695        																			-- Id.del nuovo utente da mettere nella postazione
3696        			DesUserNewIn			IN		DMT_USERS.DES_USER%type DEFAULT NULL,
3697        																			-- Nome del nuovo utente da mettere nella postazione
3698        			UsernameNewIn			IN		DMT_USERS.USERNAME%type DEFAULT NULL,
3699        																			-- Username del nuovo utente da mettere nella postazione
3700        			DtInizioVldIn			IN		VARCHAR2,						-- (obblig.) Data di decorrenza associazione nuovo utente con la postazione(nel formato dato dal parametro di conf. FMT_STD_DATA).
3701        			DtFineVldIn				IN		VARCHAR2 DEFAULT NULL,			-- Data di fine validità associazione nuovo utente con la postazione (nel formato dato dal parametro di conf. FMT_STD_DATA).
3702        			FlgTipoRelIn			IN		VARCHAR2,						-- (obblig.) Tipo della relazione utente - U.O.. Valori possibili:
3703        																			-- A = appartenenza gerarchica
3704        																			-- D = funzionale, ovvero "delega" 
3705        																			-- L = a gestire documentazione della UO anche se quest'ultima è cessata
3706        			FlgInclSottoUOIn		IN		PLS_INTEGER DEFAULT NULL,		-- (valori 1/0) Indica se la relazione del nuovo utente con la UO è anche verso le sotto-UO della U.O. indicata 
3707        			FlgInclScrivVirtIn		IN		PLS_INTEGER DEFAULT NULL,		-- (valori 1/0) Indica se la relazione del nuovo utente è anche verso le scrivanie virtuali della U.O. indicata (e delle sue sotto-UO se anch'esse sono incluse nella relazione)
3708        			IdRuoloAmmIn			IN		DMT_RUOLI_AMM.ID_RUOLO_AMM%type DEFAULT NULL,
3709        																			-- Id. del ruolo ricoperto dal nuovo utente nella sua relazione con la UO
3710        			DesRuoloAmmIn			IN		DMT_RUOLI_AMM.DES_RUOLO_AMM%type DEFAULT NULL,
3711        																			-- Descrizione del ruolo ricoperto dal nuovo utente nella sua relazione con la UO
3712        			FlgPrimarioConRuoloIn		IN		PLS_INTEGER DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),
3713        																			--(1/0/NULL) Indica se l'utente è il primario degli utenti con lo stesso ruolo (eventualmente nella UO)		
3714        																			-- Diventato flag di abilitazione alla documentazione riservata assegnata/in conoscenza alla UO
3715        			ListaEsclusioniUOPPIn	IN			VARCHAR2 DEFAULT NULL,
3716        																			-- Esclusioni delle UO collegate al Punto di Protocollo vs cui è definita la relazione: sono le UO collegate al punto di protocollo vs le quali l'utente non deve acquisire relazione di tipo L come altrimenti accade
3717        																			-- E' una lista di ID_UO separati da ; o ,
3718        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,	-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
3719        																			-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
3720        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,		-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
3721        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
3722        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
3723        			ErrMsgOut				OUT 		VARCHAR2,					-- Messaggio d'errore
3724        			FlgAccessoDocLimSVIn	IN		PLS_INTEGER DEFAULT NULL,		-- (valori 1/0) Se 1 l'utente ha accesso solo ai documenti della sua scrivania e non della UO
3725        			FlgRegistrazioneEIn		IN		PLS_INTEGER DEFAULT NULL,		-- (valori 1/0) Se 1 l'utente può protocollare/registrare in entrata per la struttura
3726        			FlgRegistrazioneUIIn	IN		PLS_INTEGER DEFAULT NULL,		-- (valori 1/0) Se 1 l'utente può protocollare/registrare in uscita/interno per la struttura (e creare bozze con mittente la struttura) 
3727        			FlgGestAttiIn			IN		PLS_INTEGER DEFAULT NULL,		-- (valori 1/0) Se 1 l'utente può avviare atti/gestire atti con la struttura come proponente
3728        			FlgVisPropAttiInIterIn	IN		PLS_INTEGER DEFAULT NULL,		-- (valori 1/0) Se 1 l'utente può visualizzare proposte di atti ancora in iter e non adottati che abbiano la struttura come proponente
3729        			FlgGestAttiAllIn		IN		PLS_INTEGER DEFAULT NULL,		-- (valori 1/0) Se 1 l'utente può avviare atti/gestire atti di tutti i tipi per la struttura
3730        			ListaIdProcTyGestAttiIn	IN		VARCHAR2 DEFAULT NULL,			-- Lista con ID dei tipi processi degli atti a cui l'utente è abilitato in avvio/gestione per la data struttura (separati da ;)
3731        			FlgVisPropAttiAllIn		IN		PLS_INTEGER DEFAULT NULL,		-- (valori 1/0) Se 1 l'utente per la data struttura può visualizzare proposte di atti ancora in iter e non adottati di tutti i tipi
3732        			ListaIdProcTyVisPropAttiIn	IN		VARCHAR2 DEFAULT NULL		-- Lista con ID dei tipi processi degli atti a cui l'utente è abilitato in visualizzazione per la data struttura (separati da ;)
3733        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine, altrimenti 0 (in caso di errore)
3734        
3735        	/***** funzione per associare ad una o più UO uno o più punti di protocollo 	 *****/
3736        	/***** se il punto di protocollo era già associato alla UO non viene dato errore *****/
3737        	function AssociaPuntiProtocollo(
3738        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
3739        																			-- (obblig). Codice identificativo del token di connessione
3740        			IdUserLavoroIn				IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
3741        			XMLUOIn						IN		CLOB,						-- Lista xml (secondo schema ListaStd.xsd) delle UO cui aggiungere i punti di protocollo.
3742        																			-- Ogni UO è una riga con una sola colonna con l'ID_UO
3743        			XMLPuntiProtIn				IN		CLOB,						-- Lista xml (secondo schema ListaStd.xsd) dei punti di protocollo
3744        																			-- Ogni punto di protocollo è una riga con una sola colonna con l'ID_UO
3745        			EsitiOut					OUT		NOCOPY CLOB,				-- Lista XML conforme a schema ListaSTD.xsd che contiene gli esiti dell'operazione su ciascuna UO in input
3746        																			-- Ogni UO corrisponde ad un tag riga con le colonne:
3747        																				-- 1: ID_UO
3748        																				-- 2: Codice/livelli UO
3749        																				-- 3: Denominazione UO
3750        																				-- 4: Esito operazione: OK, KO
3751        																				-- 5: Messaggio di errore
3752        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,	-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
3753        																			-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
3754        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,		-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
3755        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
3756        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
3757        			ErrMsgOut				OUT 		VARCHAR2					-- Messaggio d'errore
3758        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine, altrimenti 0 (in caso di errore)
3759        
3760        	/***** funzione per scollegare da una o più UO uno o più punti di protocollo 	 	 *****/
3761        	/***** se il punto di protocollo NON era già associato alla UO non viene dato errore *****/
3762        	function ScollegaPuntiProtocollo(
3763        			CodIdConnectionTokenIn		IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
3764        																			-- (obblig). Codice identificativo del token di connessione
3765        			IdUserLavoroIn				IN		DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
3766        			XMLUOIn						IN		CLOB,						-- Lista xml (secondo schema ListaStd.xsd) delle UO da cui togliere i punti di protocollo.
3767        																			-- Ogni UO è una riga con una sola colonna con l'ID_UO
3768        			XMLPuntiProtIn				IN		CLOB,						-- Lista xml (secondo schema ListaStd.xsd) dei punti di protocollo
3769        																			-- Ogni punto di protocollo è una riga con una sola colonna con l'ID_UO
3770        			EsitiOut					OUT		NOCOPY CLOB,				-- Lista XML conforme a schema ListaSTD.xsd che contiene gli esiti dell'operazione su ciascuna UO in input
3771        																			-- Ogni UO corrisponde ad un tag riga con le colonne:
3772        																				-- 1: ID_UO
3773        																				-- 2: Codice/livelli UO
3774        																				-- 3: Denominazione UO
3775        																				-- 4: Esito operazione: OK, KO
3776        																				-- 5: Messaggio di errore
3777        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,	-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
3778        																			-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
3779        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,		-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
3780        			ErrContextOut			OUT		VARCHAR2,						-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
3781        			ErrCodeOut				OUT		PLS_INTEGER,					-- N.ro errore di uscita
3782        			ErrMsgOut				OUT 		VARCHAR2					-- Messaggio d'errore
3783        			) return PLS_INTEGER;											-- Vale 1 se tutto è andato a buon fine, altrimenti 0 (in caso di errore)
3784        
3785        	---- funzione per aggiungere o toglere dai destinatari preferiti di un utente - quello collegato o per cui si sta lavorano - una UO o scrivania o utente o gruppo
3786        	function AddDelDestPreferito(
3787        			CodIdConnectionTokenIn	IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
3788        																						-- (obblig). Codice identificativo del token di connessione
3789        			IdUserLavoroIn			IN			DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
3790        			FlgTipoIn				IN			VARCHAR2,								-- (obblig.) Tipo di destinatario: UO = Unità Operativa, SV = Scrivania, UT = Utente, G = Gruppo
3791        			IdDestPrefIn			IN			INTEGER,								-- (obblig.) Id. della UO/scrivania/utente/gruppo da mettere tra i preferiti
3792        			FlgAddDelIn				IN			VARCHAR2 DEFAULT 'A',					-- (obblig.) Indica se UO/scrivania/utente/gruppo da aggiungere (A) o togliere (D) dai preferiti
3793        			FlgRollBckFullIn			IN 		PLS_INTEGER DEFAULT NULL,				-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
3794        																						-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
3795        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,					-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
3796        			ErrContextOut			OUT		VARCHAR2,									-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
3797        			ErrCodeOut				OUT		PLS_INTEGER,								-- N.ro errore di uscita
3798        			ErrMsgOut				OUT 		VARCHAR2								-- Messaggio d'errore
3799        			) return PLS_INTEGER;														-- Vale 1 se tutto è andato a buon fine, altrimenti 0 (in caso di errore)
3800        
3801        	-----------funzione che data una UO - il suo ID - trova l'id. della UO - la stessa in input o la prima superiore - che risulta presente nell'atto di definizione organigramma
3802        	function GetIdUOSupInAtto(
3803        			IdUOIn					IN		DMT_STRUTTURA_ORG.ID_UO%type,				-- (obblig.) Id. della UO per cui trovare la UO superiore o coincidente che risulta presente nell'atto di definizione organigramma
3804        			TsRifIn			IN		VARCHAR2 default TO_CHAR(sysdate, 'DD/MM/RRRR HH24:MI:SS')
3805        																						-- Stringa con il timestamp (nel formato GG/MM/AAAA HH24:MI:SS) al quale si richiede di determinare la UO superiore o coincidente che risulta presente nell'atto di definizione organigramma
3806        			) return DMT_STRUTTURA_ORG.ID_UO%type;										-- Id. della UO superiore o coincidente che risulta presente nell'atto di definizione organigramma
3807        
3808        	-----------procedura che resetta le preference di idUODefault e cod.organigramma degli utenti per tener conto dei cambi di organigramma (da lanciare ogni notte dopo mezzanotte)
3809        	procedure ResetUOCodOrgDefault;
3810        
3811        
3812        	/****** funzione per spostare una postazione utente sotto una diversa UO ******/
3813        	function MovePostazioneUtente(
3814        			CodIdConnectionTokenIn	IN	    	DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%TYPE,
3815        																						-- (obblig). Codice identificativo del token di connessione
3816        			IdUserLavoroIn			IN			DMT_USERS.ID_USER%type DEFAULT NULL,	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
3817        			CIRelUserUOIO			IN OUT		VARCHAR2,								-- Codice identificativo della relazione UO-utente da spostare. 
3818        																						-- E' dato da <ID_UO>.<ID_USER>.<flag del tipo di relazione (A/L/D)>.<inizio validità relazione nel formato DD/MM/RRRR>.<ID_RUOLO_AMM>
3819        			IdUOIn					IN			DMT_STRUTTURA_ORG.ID_UO%type DEFAULT NULL,
3820        																						-- Id.della UO sotto cui spostare l'utente. 
3821        			NriLivelliUOIn			IN			VARCHAR2 DEFAULT NULL,					-- N.ri livelli della UO sotto cui spostare l'utente. 
3822        																						-- I nri vanno indicati così come appaiono nella GUI e con il saparatore previsto nella GUI per i livelli UO
3823        			DenominazioneUOIn		IN			VARCHAR2 DEFAULT NULL,					-- Denominazione della UO sotto cui spostare l'utente. 
3824        																						-- Può essere la denominazione semplice o la concatenazione con separatore "|" delle denominazioni delle UO gerarchicamente superiori + quella della UO
3825        			DtInizioVldIn			IN			VARCHAR2,								-- (obblig.) Data di inizio validità della relazione con la nuova UO(nel formato dato dal parametro di conf. FMT_STD_DATA).
3826        			DtFineVldIn				IN			VARCHAR2,								-- Data di fine validità della relazione con la nuova UO(nel formato dato dal parametro di conf. FMT_STD_DATA).
3827        			FlgTipoRelIn			IN			VARCHAR2 DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
3828        																						-- (obblig.) Tipo della relazione utente - U.O.. Valori possibili:
3829        																						-- A = appartenenza gerarchica
3830        																						-- D = funzionale, ovvero "delega" 
3831        																						-- L = a gestire documentazione della UO anche se quest'ultima è cessata
3832        			FlgInclSottoUOIn		IN			PLS_INTEGER DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),
3833        																						-- (valori 1/0) Indica se la relazione dell'utente è anche verso le sotto-UO della U.O. indicata 
3834        			FlgInclScrivVirtIn		IN			PLS_INTEGER DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),
3835        																						-- (valori 1/0) Indica se la relazione dell'utente è anche verso le scrivanie virtuali della U.O. indicata (e delle sue sotto-UO se anch'esse sono incluse nella relazione)
3836        			NuovaIntestazioneScrivaniaIO IN OUT	DMT_SCRIVANIE_VIRTUALI.INTESTAZIONE%type,	-- Nuova intestazione della scrivania che è occupata dall'utente nella relazione
3837        																						-- Se in input non è valorizzata o è valorizzata a <COMPOSIZIONE AUTOMATICA> e c'è la scrivania, la sua intestazione verrà creata o aggiornata in automatico e restituita in output
3838        			IdRuoloAmmIn			IN			DMT_RUOLI_AMM.ID_RUOLO_AMM%type DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),
3839        																						-- Id. del ruolo ricoperto dall'utente nella sua relazione con la UO
3840        			DesRuoloAmmIn			IN			DMT_RUOLI_AMM.DES_RUOLO_AMM%type DEFAULT dmpk_utility.GetValConfigParamText(1, NULL, 'STR_VAL_NO_UPD'),
3841        																						-- Descrizione del ruolo ricoperto dall'utente nella sua relazione con la UO
3842        			ListaEsclusioniUOPPIn	IN			VARCHAR2 DEFAULT NULL,
3843        																						-- Esclusioni delle UO collegate al Punto di Protocollo vs cui viene spostata relazione: sono le UO collegate al punto di protocollo vs le quali l'utente non deve acquisire relazione di tipo L come altrimenti accade
3844        																						-- E' una lista di ID_UO separati da ; o ,
3845        			FlgPrimarioConRuoloIn	IN			PLS_INTEGER DEFAULT dmpk_utility.GetValConfigParamNumber(1, NULL, 'NUM_VAL_NO_UPD'),
3846        																						--(1/0/NULL) Indica se l'utente è il primario degli utenti con lo stesso ruolo (eventualmente nella UO)			
3847        																						-- Diventato flag di abilitazione alla documentazione riservata assegnata/in conoscenza alla UO
3848        			AttributiAddIn			IN			CLOB DEFAULT NULL,						-- XML contenente nomi e valori degli attributi dinamici della scrivania da spostare (conforme allo schema SezioneCache.xsd) 
3849        																						-- Gli attributi già presenti in DB e per i quali non c'è corrispondente nell'XML restano invariati
3850        																						-- Per tutti gli attributi vale quanto segue:
3851        																						-- Un attributo da settare è un tag "Variabile" dell'XML il cui tag "Nome" contiene il nome identificativo dell'attributo (ATTR_NAME di DMT_ATTRIBUTES_DEF)
3852        																						-- Un attributo da settare è una variabile con tag "ValoreSemplice" se è un attributo a singolo valore e non strutturato (cioè con tipo diverso da COMPLEX)
3853        																						-- altrimenti è una variabile con tag "Lista" che ha un'unica colonna con "Nro" pari a 1 se l'attributo non è strutturato, che ha invece tante colonne quanti gli attributi componenti (ordinate in base al loro NRO_ORD_IN_SUP) se l'attributo è complesso 
3854        																						-- Nel caso di variabili con tag "Lista" i valori specificati nell'XML si aggiungono o sostituiscono quelli già presenti in DB a seconda che nell'XML sia presente o meno una variabile con tag "Nome" pari a #Append_<Nome attributo> e tag "ValoreSemplice" pari a 1  
3855        																						-- In particolare se non sono specificati valori nell'XML (tag Lista vuoto) e se i valori non sono da aggiungere significa che tutti i valori dell'attributo già presenti in DB vanno rimossi
3856        			FlgRollBckFullIn		IN 		PLS_INTEGER DEFAULT NULL,					-- (valori 1/0/NULL) Se 1 in caso di errore viene fatta la rollback completa (non a savepoint), altrimenti la rollback delle sole modifiche effettuate nella stored
3857        																						-- ATTENZIONE: La rollback, di qualsiasi tipo, non riguarda la scrittura di eventuali log
3858        			FlgAutoCommitIn			IN 		PLS_INTEGER DEFAULT NULL,					-- (valori 1/0/NULL) Se vale 1, dopo la rollback e qualunque sia l'esito (positivo o meno), la funzione esegue una commit finale
3859        			ErrContextOut			OUT		VARCHAR2,									-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
3860        			ErrCodeOut				OUT		PLS_INTEGER,								-- N.ro errore di uscita
3861        			ErrMsgOut				OUT 		VARCHAR2,								-- Messaggio d'errore
3862        			FlgAccessoDocLimSVIn	IN		PLS_INTEGER DEFAULT NULL,		-- (valori 1/0) Se 1 l'utente ha accesso solo ai documenti della sua scrivania e non della UO
3863        			FlgRegistrazioneEIn		IN		PLS_INTEGER DEFAULT NULL,		-- (valori 1/0) Se 1 l'utente può protocollare/registrare in entrata per la struttura
3864        			FlgRegistrazioneUIIn	IN		PLS_INTEGER DEFAULT NULL,		-- (valori 1/0) Se 1 l'utente può protocollare/registrare in uscita/interno per la struttura (e creare bozze con mittente la struttura) 
3865        			FlgGestAttiIn			IN		PLS_INTEGER DEFAULT NULL,		-- (valori 1/0) Se 1 l'utente può avviare atti/gestire atti con la struttura come proponente
3866        			FlgVisPropAttiInIterIn	IN		PLS_INTEGER DEFAULT NULL,		-- (valori 1/0) Se 1 l'utente può visualizzare proposte di atti ancora in iter e non adottati che abbiano la struttura come proponente
3867        			FlgGestAttiAllIn		IN		PLS_INTEGER DEFAULT NULL,		-- (valori 1/0) Se 1 l'utente può avviare atti/gestire atti di tutti i tipi per la struttura
3868        			ListaIdProcTyGestAttiIn	IN		VARCHAR2 DEFAULT NULL,			-- Lista con ID dei tipi processi degli atti a cui l'utente è abilitato in avvio/gestione per la data struttura (separati da ;)
3869        			FlgVisPropAttiAllIn		IN		PLS_INTEGER DEFAULT NULL,		-- (valori 1/0) Se 1 l'utente per la data struttura può visualizzare proposte di atti ancora in iter e non adottati di tutti i tipi
3870        			ListaIdProcTyVisPropAttiIn	IN		VARCHAR2 DEFAULT NULL		-- Lista con ID dei tipi processi degli atti a cui l'utente è abilitato in visualizzazione per la data struttura (separati da ;)
3871        			) return PLS_INTEGER;														-- Vale 1 se tutto è andato a buon fine, altrimenti 0 (in caso di errore)
3872        
3873        	----------funzione per ottenere le variazioni (storicizzate) dei dati di una UO o postazione utente indicata in input
3874        	function GetVariazioniDatiUOSV(
3875        			FlgUOSVIn				IN		VARCHAR2,									-- (obblig.) Flag SV/UO: indica se le variazioni dati da estrarre sono di una UO o di una postazione utente (SV)
3876        			IdUOSVIn				IN		INTEGER,									-- (obblig.) Id. della UO o postazione utente per cui estrarre i dati storici
3877        			VariazioniDalIn			IN		VARCHAR2,									-- Estremo inferiore dell'eventuale intervello temporale in cui devono essersi verificate le variazioni da estrarre (nel formato dato dal parametro di conf. FMT_STD_DATA)
3878        			VariazioniAlIn			IN		VARCHAR2,									-- Estremo superiore dell'eventuale intervello temporale in cui devono essersi verificate le variazioni da estrarre (nel formato dato dal parametro di conf. FMT_STD_DATA)																		-- 
3879        			VariazioniMLOut		OUT		NOCOPY CLOB,									-- Lista XML (secondo schema ListaStd.xsd) con le variazioni dati della UO/postazione utente
3880        																						-- Ogni riga è una variazione e contiene le seguenti colonne:
3881        																						-- 1: Data della variazione (nel formato dato dal parametro di conf. FMT_STD_DATA)
3882        																						-- 2: Data di istituzione della UO (nel formato dato dal parametro di conf. FMT_STD_DATA) prima della variazione
3883        																						-- 3: Livello gerarchico della UO prima della variazione
3884        																						-- 4: Tipo della UO prima della variazione
3885        																						-- 5: Codice/livelli della UO prima della variazione
3886        																						-- 6: Denominazione UO
3887        																						-- 7: Utente collegato alla postazione (Cognome e Nome + Username)
3888        																						-- 8: Motivo variazione
3889        																						-- 9: Estremi atto variazione
3890        																						-- 10: Intestazione della scrivania prima della variazione
3891        																						-- 11: Ruolo dell'utente nella UO
3892        																						-- 12: Flag 1/0 di delega alle UO subordinate
3893        																						-- 13: Flag 1/0 di delega alle postazioni utente subordinate
3894        																						-- 14: Utente che ha effettuato la variazione
3895        			ErrContextOut			OUT		VARCHAR2,									-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
3896        			ErrCodeOut				OUT		PLS_INTEGER,								-- N.ro errore di uscita
3897        			ErrMsgOut				OUT 	VARCHAR2									-- Messaggio d'errore
3898        			) return PLS_INTEGER;														-- Vale 1 se tutto è andato a buon fine, altrimenti 0 (in caso di errore)
3899        
3900        	----procedura che elimina le relazioni di UO e utenti vs i Punti di Protocollo cessati
3901        	procedure RimuoviRelVsPPCessati;	
3902        
3903        	----------funzione per popolare il modulo organigramma grafico
3904        	---------- carica solo UO e relazioni utente-UO attive prese dall'organigramma vigente
3905        	function LoadOrganigrammaXModGrafico(
3906        			 CodIdConnectionTokenIn IN      DMT_CONNECTION_TOKEN.CI_CONNECTION_TOKEN%type,
3907        																						-- (obblig). Codice identificativo del token di connessione
3908                    IdUserLavoroIn          IN      DMT_USERS.ID_USER%type DEFAULT NULL,    	-- Id. dell'utente a nome di cui si lavora. Se non valorizzato è l'utente connesso
3909                    FlgIncludiUtentiIn      IN      PLS_INTEGER DEFAULT NULL,            		-- (valori 2/1/0/NULL): se 2 indica che nell'albero vanno mostrare sia le UO e tutti gli utenti collegati (con o senza scrivania), se 1 che vanno mostrate le UO e gli utenti con scrivania, se 0 o NULL solo le UO
3910                    TipoRelUtentiConUOIn    IN      VARCHAR2 DEFAULT NULL,               		-- (viene considerato solo se FlgIncludiUtentiIn>0) Indica il/i tipi di relazione che gli utenti da mostrare devono avere all'istante TsRifIn con le UO:
3911        																						--  Valori ammessi:
3912        																						--  A = Appartenenza
3913        																						--  D = Delega (ovvero Funzionale)
3914        																						--  L = a Lavorare per (ovvero "A gestire la documentazione della UO")
3915        																						-- o una loro cancatenazione con ";" come separatore
3916        																						-- Se non valorizzato è come se contenesse tutti i valori previsti
3917        			IdUORootIn            	IN		VARCHAR2 DEFAULT NULL,                 		-- Identificativo della UO a partire della quale caricare l'organigramma
3918        																						-- Se in input non è valorizzato si intende pari l'intera struttura organizzativa
3919                    LivelloMaxIn			IN		PLS_INTEGER,								-- Indica il max livello gerarchico delle UO da estrarre
3920        																						-- ad es. se 3 significa che verranno estratte solo UO del livelli 1, 2 e 3
3921        			CodTipiUOIn				IN		VARCHAR2 DEFAULT NULL,						-- Codice/i dei tipi UO da estrarre
3922        																						-- Se più di uno sono separati da ;
3923        																						-- es: se vale DIREZIONE;AREA significa che verranno estratte solo le UO di questi tipi
3924        			OrganigrammaXMLOut      OUT     NOCOPY CLOB,                    			-- XML con strutture ed utenti della porzione di organigramma chiesta
3925        																						-- XML lista standard in cui ogni riga ha le colonne:
3926        																						-- Colonna 1           Flag UO o UT
3927        																						-- Colonna 2           idNode  (valorizzato solo per le UO)
3928        																						-- Colonna 3           Id UO o Id User                                                                                                                                                                                                                                                                                                         
3929        																						-- Colonna 4           Cod. tipo UO
3930        																						-- Colonna 5           parentId              (anche per utenti, idNode della UO di appartenenza)
3931        																						-- Colonna 6           Denominazione UO / Cognome e nome
3932        																						-- Colonna 7           nroProgr
3933        																						-- Colonna 8           codice rapido UO
3934        																						-- Colonna 9           flgEsplodiNodo  (1 se UO che ha UO figlie, se no 0)
3935        																						-- Colonna 10         competenze
3936        																						-- Colonna 11         livello gerarchico UO
3937        																						-- Colonna 12         matricola
3938        																						-- Colonna 13         Id. ruolo
3939        																						-- Colonna 14         Nome ruolo
3940        																						-- Colonna 15         Id scrivania
3941        																						-- Colonna 16         Intestazione scrivania      
3942                    ErrContextOut           OUT        VARCHAR2,                        		-- Contesto (ovvero package e/o funzione/procedura) in cui si è verificato l'errore
3943                    ErrCodeOut              OUT        PLS_INTEGER,                    			-- N.ro errore di uscita
3944                    ErrMsgOut               OUT        VARCHAR2)                        		-- Messaggio d'errore
3945                    return PLS_INTEGER;                                           				-- Vale 1 se tutto è andato a buon fine, altrimenti 0
3946        
3947        END DMPK_DEF_SECURITY;
